(function(){function a(){if(!h&&(h=!0,k)){for(var a=0;a<k.length;a++)k[a].call(window,[]);k=[]}}function b(a){var b=window.onload;window.onload="function"!=typeof window.onload?a:function(){b&&b();a()}}function c(){if(!g){g=!0;document.addEventListener&&!f.opera&&document.addEventListener("DOMContentLoaded",a,!1);f.msie&&window==top&&function(){if(!h){try{document.documentElement.doScroll("left")}catch(b){setTimeout(arguments.callee,0);return}a()}}();f.opera&&document.addEventListener("DOMContentLoaded",
function(){if(!h){for(var b=0;b<document.styleSheets.length;b++)if(document.styleSheets[b].disabled){setTimeout(arguments.callee,0);return}a()}},!1);if(f.safari){var c;(function(){if(!h)if("loaded"!=document.readyState&&"complete"!=document.readyState)setTimeout(arguments.callee,0);else{if(void 0===c){for(var b=document.getElementsByTagName("link"),d=0;d<b.length;d++)"stylesheet"==b[d].getAttribute("rel")&&c++;b=document.getElementsByTagName("style");c+=b.length}document.styleSheets.length!=c?setTimeout(arguments.callee,
0):a()}})()}b(a)}}var d=window.DomReady={},e=navigator.userAgent.toLowerCase(),f={version:(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(e),opera:/opera/.test(e),msie:/msie/.test(e)&&!/opera/.test(e),mozilla:/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)},g=!1,h=!1,k=[];d.ready=function(a,b){c();h?a.call(window,[]):k.push(function(){return a.call(window,[])})};c()})();
(function(){function a(a){return function(b,c,d,e){c=B(c,e,4);var f=!H(b)&&u.keys(b),g=(f||b).length,h=0<a?0:g-1;3>arguments.length&&(d=b[f?f[h]:h],h+=a);for(var k=c,l=d;0<=h&&h<g;h+=a)var r=f?f[h]:h,l=k(l,b[r],r,b);return l}}function b(a){return function(b,c,d){c=G(c,d);d=D(b);for(var e=0<a?0:d-1;0<=e&&e<d;e+=a)if(c(b[e],e,b))return e;return-1}}function c(a,b,c){return function(d,e,f){var g=0,h=D(d);if("number"==typeof f)0<a?g=0<=f?f:Math.max(f+h,g):h=0<=f?Math.min(f+1,h):f+h+1;else if(c&&f&&h)return f=
c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(l.call(d,g,h),u.isNaN),0<=f?f+g:-1;for(f=0<a?g:h-1;0<=f&&f<h;f+=a)if(d[f]===e)return f;return-1}}function d(a,b){var c=J.length,d=a.constructor,d=u.isFunction(d)&&d.prototype||h,e="constructor";for(u.has(a,e)&&!u.contains(b,e)&&b.push(e);c--;)e=J[c],e in a&&a[e]!==d[e]&&!u.contains(b,e)&&b.push(e)}var e=this,f=e._,g=Array.prototype,h=Object.prototype,k=g.push,l=g.slice,m=h.toString,v=h.hasOwnProperty,q=Array.isArray,y=Object.keys,x=Function.prototype.bind,
w=Object.create,z=function(){},u=function(a){if(a instanceof u)return a;if(!(this instanceof u))return new u(a);this._wrapped=a};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=u),exports._=u):e._=u;u.VERSION="1.8.3";var B=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,
d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},G=function(a,b,c){return null==a?u.identity:u.isFunction(a)?B(a,b,c):u.isObject(a)?u.matcher(a):u.property(a)};u.iteratee=function(a,b){return G(a,b,Infinity)};var A=function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var e=1;e<d;e++)for(var f=arguments[e],g=a(f),h=g.length,k=0;k<h;k++){var l=g[k];b&&void 0!==c[l]||(c[l]=f[l])}return c}},C=function(a){if(!u.isObject(a))return{};if(w)return w(a);
z.prototype=a;a=new z;z.prototype=null;return a},F=function(a){return function(b){return null==b?void 0:b[a]}},I=Math.pow(2,53)-1,D=F("length"),H=function(a){a=D(a);return"number"==typeof a&&0<=a&&a<=I};u.each=u.forEach=function(a,b,c){b=B(b,c);var d;if(H(a))for(c=0,d=a.length;c<d;c++)b(a[c],c,a);else{var e=u.keys(a);c=0;for(d=e.length;c<d;c++)b(a[e[c]],e[c],a)}return a};u.map=u.collect=function(a,b,c){b=G(b,c);c=!H(a)&&u.keys(a);for(var d=(c||a).length,e=Array(d),f=0;f<d;f++){var g=c?c[f]:f;e[f]=
b(a[g],g,a)}return e};u.reduce=u.foldl=u.inject=a(1);u.reduceRight=u.foldr=a(-1);u.find=u.detect=function(a,b,c){b=H(a)?u.findIndex(a,b,c):u.findKey(a,b,c);if(void 0!==b&&-1!==b)return a[b]};u.filter=u.select=function(a,b,c){var d=[];b=G(b,c);u.each(a,function(a,c,e){b(a,c,e)&&d.push(a)});return d};u.reject=function(a,b,c){return u.filter(a,u.negate(G(b)),c)};u.every=u.all=function(a,b,c){b=G(b,c);c=!H(a)&&u.keys(a);for(var d=(c||a).length,e=0;e<d;e++){var f=c?c[e]:e;if(!b(a[f],f,a))return!1}return!0};
u.some=u.any=function(a,b,c){b=G(b,c);c=!H(a)&&u.keys(a);for(var d=(c||a).length,e=0;e<d;e++){var f=c?c[e]:e;if(b(a[f],f,a))return!0}return!1};u.contains=u.includes=u.include=function(a,b,c,d){H(a)||(a=u.values(a));if("number"!=typeof c||d)c=0;return 0<=u.indexOf(a,b,c)};u.invoke=function(a,b){var c=l.call(arguments,2),d=u.isFunction(b);return u.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})};u.pluck=function(a,b){return u.map(a,u.property(b))};u.where=function(a,b){return u.filter(a,
u.matcher(b))};u.findWhere=function(a,b){return u.find(a,u.matcher(b))};u.max=function(a,b,c){var d=-Infinity,e=-Infinity,f;if(null==b&&null!=a){a=H(a)?a:u.values(a);for(var g=0,h=a.length;g<h;g++)c=a[g],c>d&&(d=c)}else b=G(b,c),u.each(a,function(a,c,g){f=b(a,c,g);if(f>e||-Infinity===f&&-Infinity===d)d=a,e=f});return d};u.min=function(a,b,c){var d=Infinity,e=Infinity,f;if(null==b&&null!=a){a=H(a)?a:u.values(a);for(var g=0,h=a.length;g<h;g++)c=a[g],c<d&&(d=c)}else b=G(b,c),u.each(a,function(a,c,g){f=
b(a,c,g);if(f<e||Infinity===f&&Infinity===d)d=a,e=f});return d};u.shuffle=function(a){a=H(a)?a:u.values(a);for(var b=a.length,c=Array(b),d=0,e;d<b;d++)e=u.random(0,d),e!==d&&(c[d]=c[e]),c[e]=a[d];return c};u.sample=function(a,b,c){return null==b||c?(H(a)||(a=u.values(a)),a[u.random(a.length-1)]):u.shuffle(a).slice(0,Math.max(0,b))};u.sortBy=function(a,b,c){b=G(b,c);return u.pluck(u.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==
d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-b.index}),"value")};var E=function(a){return function(b,c,d){var e={};c=G(c,d);u.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)});return e}};u.groupBy=E(function(a,b,c){u.has(a,c)?a[c].push(b):a[c]=[b]});u.indexBy=E(function(a,b,c){a[c]=b});u.countBy=E(function(a,b,c){u.has(a,c)?a[c]++:a[c]=1});u.toArray=function(a){return a?u.isArray(a)?l.call(a):H(a)?u.map(a,u.identity):u.values(a):[]};u.size=function(a){return null==a?0:H(a)?
a.length:u.keys(a).length};u.partition=function(a,b,c){b=G(b,c);var d=[],e=[];u.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)});return[d,e]};u.first=u.head=u.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:u.initial(a,a.length-b)};u.initial=function(a,b,c){return l.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))};u.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:u.rest(a,Math.max(0,a.length-b))};u.rest=u.tail=u.drop=function(a,b,c){return l.call(a,null==b||c?1:b)};u.compact=
function(a){return u.filter(a,u.identity)};var L=function(a,b,c,d){var e=[],f=0;d=d||0;for(var g=D(a);d<g;d++){var h=a[d];if(H(h)&&(u.isArray(h)||u.isArguments(h))){b||(h=L(h,b,c));var k=0,l=h.length;for(e.length+=l;k<l;)e[f++]=h[k++]}else c||(e[f++]=h)}return e};u.flatten=function(a,b){return L(a,b,!1)};u.without=function(a){return u.difference(a,l.call(arguments,1))};u.uniq=u.unique=function(a,b,c,d){u.isBoolean(b)||(d=c,c=b,b=!1);null!=c&&(c=G(c,d));d=[];for(var e=[],f=0,g=D(a);f<g;f++){var h=
a[f],k=c?c(h,f,a):h;b?(f&&e===k||d.push(h),e=k):c?u.contains(e,k)||(e.push(k),d.push(h)):u.contains(d,h)||d.push(h)}return d};u.union=function(){return u.uniq(L(arguments,!0,!0))};u.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=D(a);d<e;d++){var f=a[d];if(!u.contains(b,f)){for(var g=1;g<c&&u.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b};u.difference=function(a){var b=L(arguments,!0,!0,1);return u.filter(a,function(a){return!u.contains(b,a)})};u.zip=function(){return u.unzip(arguments)};
u.unzip=function(a){for(var b=a&&u.max(a,D).length||0,c=Array(b),d=0;d<b;d++)c[d]=u.pluck(a,d);return c};u.object=function(a,b){for(var c={},d=0,e=D(a);d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};u.findIndex=b(1);u.findLastIndex=b(-1);u.sortedIndex=function(a,b,c,d){c=G(c,d,1);b=c(b);d=0;for(var e=D(a);d<e;){var f=Math.floor((d+e)/2);c(a[f])<b?d=f+1:e=f}return d};u.indexOf=c(1,u.findIndex,u.sortedIndex);u.lastIndexOf=c(-1,u.findLastIndex);u.range=function(a,b,c){null==b&&(b=a||0,a=0);c=c||
1;b=Math.max(Math.ceil((b-a)/c),0);for(var d=Array(b),e=0;e<b;e++,a+=c)d[e]=a;return d};var U=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);b=C(a.prototype);a=a.apply(b,e);return u.isObject(a)?a:b};u.bind=function(a,b){if(x&&a.bind===x)return x.apply(a,l.call(arguments,1));if(!u.isFunction(a))throw new TypeError("Bind must be called on a function");var c=l.call(arguments,2),d=function(){return U(a,d,b,this,c.concat(l.call(arguments)))};return d};u.partial=function(a){var b=l.call(arguments,
1),c=function(){for(var d=0,e=b.length,f=Array(e),g=0;g<e;g++)f[g]=b[g]===u?arguments[d++]:b[g];for(;d<arguments.length;)f.push(arguments[d++]);return U(a,c,this,this,f)};return c};u.bindAll=function(a){var b,c=arguments.length,d;if(1>=c)throw Error("bindAll must be passed function names");for(b=1;b<c;b++)d=arguments[b],a[d]=u.bind(a[d],a);return a};u.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);u.has(e,f)||(e[f]=a.apply(this,arguments));return e[f]};c.cache=
{};return c};u.delay=function(a,b){var c=l.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};u.defer=u.partial(u.delay,u,1);u.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var k=function(){h=!1===c.leading?0:u.now();g=null;f=a.apply(d,e);g||(d=e=null)};return function(){var l=u.now();h||!1!==c.leading||(h=l);var r=b-(l-h);d=this;e=arguments;0>=r||r>b?(g&&(clearTimeout(g),g=null),h=l,f=a.apply(d,e),g||(d=e=null)):g||!1===c.trailing||(g=setTimeout(k,r));return f}};
u.debounce=function(a,b,c){var d,e,f,g,h,k=function(){var l=u.now()-g;l<b&&0<=l?d=setTimeout(k,b-l):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this;e=arguments;g=u.now();var l=c&&!d;d||(d=setTimeout(k,b));l&&(h=a.apply(f,e),f=e=null);return h}};u.wrap=function(a,b){return u.partial(b,a)};u.negate=function(a){return function(){return!a.apply(this,arguments)}};u.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,
d);return d}};u.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};u.before=function(a,b){var c;return function(){0<--a&&(c=b.apply(this,arguments));1>=a&&(b=null);return c}};u.once=u.partial(u.before,2);var O=!{toString:null}.propertyIsEnumerable("toString"),J="valueOf isPrototypeOf toString propertyIsEnumerable hasOwnProperty toLocaleString".split(" ");u.keys=function(a){if(!u.isObject(a))return[];if(y)return y(a);var b=[],c;for(c in a)u.has(a,c)&&b.push(c);O&&d(a,b);
return b};u.allKeys=function(a){if(!u.isObject(a))return[];var b=[],c;for(c in a)b.push(c);O&&d(a,b);return b};u.values=function(a){for(var b=u.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=a[b[e]];return d};u.mapObject=function(a,b,c){b=G(b,c);c=u.keys(a);for(var d=c.length,e={},f,g=0;g<d;g++)f=c[g],e[f]=b(a[f],f,a);return e};u.pairs=function(a){for(var b=u.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=[b[e],a[b[e]]];return d};u.invert=function(a){for(var b={},c=u.keys(a),d=0,e=c.length;d<e;d++)b[a[c[d]]]=
c[d];return b};u.functions=u.methods=function(a){var b=[],c;for(c in a)u.isFunction(a[c])&&b.push(c);return b.sort()};u.extend=A(u.allKeys);u.extendOwn=u.assign=A(u.keys);u.findKey=function(a,b,c){b=G(b,c);c=u.keys(a);for(var d,e=0,f=c.length;e<f;e++)if(d=c[e],b(a[d],d,a))return d};u.pick=function(a,b,c){var d={},e=a,f,g;if(null==e)return d;u.isFunction(b)?(g=u.allKeys(e),f=B(b,c)):(g=L(arguments,!1,!1,1),f=function(a,b,c){return b in c},e=Object(e));for(var h=0,k=g.length;h<k;h++){var l=g[h],r=e[l];
f(r,l,e)&&(d[l]=r)}return d};u.omit=function(a,b,c){if(u.isFunction(b))b=u.negate(b);else{var d=u.map(L(arguments,!1,!1,1),String);b=function(a,b){return!u.contains(d,b)}}return u.pick(a,b,c)};u.defaults=A(u.allKeys,!0);u.create=function(a,b){var c=C(a);b&&u.extendOwn(c,b);return c};u.clone=function(a){return u.isObject(a)?u.isArray(a)?a.slice():u.extend({},a):a};u.tap=function(a,b){b(a);return a};u.isMatch=function(a,b){var c=u.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;f<d;f++){var g=
c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var P=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof u&&(a=a._wrapped);b instanceof u&&(b=b._wrapped);var e=m.call(a);if(e!==m.call(b))return!1;switch(e){case "[object RegExp]":case "[object String]":return""+a===""+b;case "[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case "[object Date]":case "[object Boolean]":return+a===+b}e="[object Array]"===e;if(!e){if("object"!=typeof a||
"object"!=typeof b)return!1;var f=a.constructor,g=b.constructor;if(f!==g&&!(u.isFunction(f)&&f instanceof f&&u.isFunction(g)&&g instanceof g)&&"constructor"in a&&"constructor"in b)return!1}c=c||[];d=d||[];for(f=c.length;f--;)if(c[f]===a)return d[f]===b;c.push(a);d.push(b);if(e){f=a.length;if(f!==b.length)return!1;for(;f--;)if(!P(a[f],b[f],c,d))return!1}else{e=u.keys(a);f=e.length;if(u.keys(b).length!==f)return!1;for(;f--;)if(g=e[f],!u.has(b,g)||!P(a[g],b[g],c,d))return!1}c.pop();d.pop();return!0};
u.isEqual=function(a,b){return P(a,b)};u.isEmpty=function(a){return null==a?!0:H(a)&&(u.isArray(a)||u.isString(a)||u.isArguments(a))?0===a.length:0===u.keys(a).length};u.isElement=function(a){return!(!a||1!==a.nodeType)};u.isArray=q||function(a){return"[object Array]"===m.call(a)};u.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a};u.each("Arguments Function String Number Date RegExp Error".split(" "),function(a){u["is"+a]=function(b){return m.call(b)==="[object "+a+"]"}});
u.isArguments(arguments)||(u.isArguments=function(a){return u.has(a,"callee")});"function"!=typeof/./&&"object"!=typeof Int8Array&&(u.isFunction=function(a){return"function"==typeof a||!1});u.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};u.isNaN=function(a){return u.isNumber(a)&&a!==+a};u.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"===m.call(a)};u.isNull=function(a){return null===a};u.isUndefined=function(a){return void 0===a};u.has=function(a,b){return null!=a&&
v.call(a,b)};u.noConflict=function(){e._=f;return this};u.identity=function(a){return a};u.constant=function(a){return function(){return a}};u.noop=function(){};u.property=F;u.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}};u.matcher=u.matches=function(a){a=u.extendOwn({},a);return function(b){return u.isMatch(b,a)}};u.times=function(a,b,c){var d=Array(Math.max(0,a));b=B(b,c,1);for(c=0;c<a;c++)d[c]=b(c);return d};u.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*
(b-a+1))};u.now=Date.now||function(){return(new Date).getTime()};q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};A=u.invert(q);F=function(a){var b=function(b){return a[b]},c="(?:"+u.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){a=null==a?"":""+a;return d.test(a)?a.replace(e,b):a}};u.escape=F(q);u.unescape=F(A);u.result=function(a,b,c){b=null==a?void 0:a[b];void 0===b&&(b=c);return u.isFunction(b)?b.call(a):b};var T=0;u.uniqueId=function(a){var b=
++T+"";return a?a+b:b};u.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var S=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},ba=/\\|'|\r|\n|\u2028|\u2029/g,N=function(a){return"\\"+R[a]};u.template=function(a,b,c){!b&&c&&(b=c);b=u.defaults({},b,u.templateSettings);c=RegExp([(b.escape||S).source,(b.interpolate||S).source,(b.evaluate||S).source].join("|")+"|$","g");var d=0,e="__p+='";a.replace(c,function(b,c,f,
g,h){e+=a.slice(d,h).replace(ba,N);d=h+b.length;c?e+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":f?e+="'+\n((__t=("+f+"))==null?'':__t)+\n'":g&&(e+="';\n"+g+"\n__p+='");return b});e+="';\n";b.variable||(e="with(obj||{}){\n"+e+"}\n");e="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+e+"return __p;\n";try{var f=new Function(b.variable||"obj","_",e)}catch(g){throw g.source=e,g;}c=function(a){return f.call(this,a,u)};c.source="function("+(b.variable||"obj")+
"){\n"+e+"}";return c};u.chain=function(a){a=u(a);a._chain=!0;return a};var ja=function(a,b){return a._chain?u(b).chain():b};u.mixin=function(a){u.each(u.functions(a),function(b){var c=u[b]=a[b];u.prototype[b]=function(){var a=[this._wrapped];k.apply(a,arguments);return ja(this,c.apply(u,a))}})};u.mixin(u);u.each("pop push reverse shift sort splice unshift".split(" "),function(a){var b=g[a];u.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);"shift"!==a&&"splice"!==a||0!==c.length||
delete c[0];return ja(this,c)}});u.each(["concat","join","slice"],function(a){var b=g[a];u.prototype[a]=function(){return ja(this,b.apply(this._wrapped,arguments))}});u.prototype.value=function(){return this._wrapped};u.prototype.valueOf=u.prototype.toJSON=u.prototype.value;u.prototype.toString=function(){return""+this._wrapped};"function"===typeof define&&define.amd&&define("underscore",[],function(){return u})}).call(this);
(function(a,b){"function"===typeof define&&define.amd?define(b):"object"===typeof exports?module.exports=b():a.returnExports=b()})(this,function(){var a=Array.prototype,b=Object.prototype,c=Function.prototype,d=String.prototype,e=Number.prototype,f=a.slice,g=a.splice,h=a.push,k=a.unshift,l=a.concat,m=c.call,v=b.toString,q=Array.isArray||function(a){return"[object Array]"===v.call(a)},y="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag,x,w=Function.prototype.toString;x=function(a){if("function"!==
typeof a)return!1;if(y){var b;try{w.call(a),b=!0}catch(c){b=!1}return b}a=v.call(a);return"[object Function]"===a||"[object GeneratorFunction]"===a};var z,u=RegExp.prototype.exec;z=function(a){if("object"!==typeof a)return!1;var b;if(y)try{u.call(a),b=!0}catch(c){b=!1}else b="[object RegExp]"===v.call(a);return b};var B,G=String.prototype.valueOf;B=function(a){if("string"===typeof a)return!0;if("object"!==typeof a)return!1;var b;if(y)try{G.call(a),b=!0}catch(c){b=!1}else b="[object String]"===v.call(a);
return b};var A=function(a){var b="[object Arguments]"===v.call(a);b||(b=!q(a)&&null!==a&&"object"===typeof a&&"number"===typeof a.length&&0<=a.length&&x(a.callee));return b},C=function(a){var b;b=Object.defineProperty&&function(){try{var a={};Object.defineProperty(a,"x",{enumerable:!1,value:a});for(var b in a)return!1;return a.x===a}catch(c){return!1}}()?function(a,b,c,d){!d&&b in a||Object.defineProperty(a,b,{configurable:!0,enumerable:!1,writable:!0,value:c})}:function(a,b,c,d){!d&&b in a||(a[b]=
c)};return function(c,d,e){for(var f in d)a.call(d,f)&&b(c,f,d[f],e)}}(b.hasOwnProperty),F=function(a){var b=typeof a;return null===a||"object"!==b&&"function"!==b},I={ToInteger:function(a){a=+a;a!==a?a=0:0!==a&&a!==1/0&&a!==-(1/0)&&(a=(0<a||-1)*Math.floor(Math.abs(a)));return a},ToPrimitive:function(a){var b;if(F(a))return a;b=a.valueOf;if(x(b)&&(b=b.call(a),F(b)))return b;b=a.toString;if(x(b)&&(b=b.call(a),F(b)))return b;throw new TypeError;},ToObject:function(a){if(null==a)throw new TypeError("can't convert "+
a+" to object");return Object(a)},ToUint32:function(a){return a>>>0}},D=function(){};C(c,{bind:function(a){var b=this;if(!x(b))throw new TypeError("Function.prototype.bind called on incompatible "+b);for(var c=f.call(arguments,1),d,e=Math.max(0,b.length-c.length),g=[],h=0;h<e;h++)g.push("$"+h);d=Function("binder","return function ("+g.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof d){var e=b.apply(this,l.call(c,f.call(arguments)));return Object(e)===e?e:this}return b.apply(a,
l.call(c,f.call(arguments)))});b.prototype&&(D.prototype=b.prototype,d.prototype=new D,D.prototype=null);return d}});var H=m.bind(b.hasOwnProperty),b=function(){var a=[1,2],b=a.splice();return 2===a.length&&q(b)&&0===b.length}();C(a,{splice:function(a,b){return 0===arguments.length?[]:g.apply(this,arguments)}},!b);b=function(){var b={};a.splice.call(b,0,0,1);return 1===b.length}();C(a,{splice:function(a,b){if(0===arguments.length)return[];var c=arguments;this.length=Math.max(I.ToInteger(this.length),
0);0<arguments.length&&"number"!==typeof b&&(c=f.call(arguments),2>c.length?c.push(this.length-a):c[1]=I.ToInteger(b));return g.apply(this,c)}},!b);b=1!==[].unshift(0);C(a,{unshift:function(){k.apply(this,arguments);return this.length}},b);C(Array,{isArray:q});var b=Object("a"),E="a"!==b[0]||!(0 in b),b=function(a){var b=!0,c=!0;a&&(a.call("foo",function(a,c,d){"object"!==typeof d&&(b=!1)}),a.call([1],function(){c="string"===typeof this},"x"));return!!a&&b&&c};C(a,{forEach:function(a){var b=I.ToObject(this),
c=E&&B(this)?this.split(""):b,d=-1,e=c.length>>>0,f;1<arguments.length&&(f=arguments[1]);if(!x(a))throw new TypeError("Array.prototype.forEach callback must be a function");for(;++d<e;)d in c&&("undefined"!==typeof f?a.call(f,c[d],d,b):a(c[d],d,b))}},!b(a.forEach));C(a,{map:function(a){var b=I.ToObject(this),c=E&&B(this)?this.split(""):b,d=c.length>>>0,e=Array(d),f;1<arguments.length&&(f=arguments[1]);if(!x(a))throw new TypeError("Array.prototype.map callback must be a function");for(var g=0;g<d;g++)g in
c&&(e[g]="undefined"!==typeof f?a.call(f,c[g],g,b):a(c[g],g,b));return e}},!b(a.map));C(a,{filter:function(a){var b=I.ToObject(this),c=E&&B(this)?this.split(""):b,d=c.length>>>0,e=[],f,g;1<arguments.length&&(g=arguments[1]);if(!x(a))throw new TypeError("Array.prototype.filter callback must be a function");for(var h=0;h<d;h++)h in c&&(f=c[h],("undefined"===typeof g?a(f,h,b):a.call(g,f,h,b))&&e.push(f));return e}},!b(a.filter));C(a,{every:function(a){var b=I.ToObject(this),c=E&&B(this)?this.split(""):
b,d=c.length>>>0,e;1<arguments.length&&(e=arguments[1]);if(!x(a))throw new TypeError("Array.prototype.every callback must be a function");for(var f=0;f<d;f++)if(f in c&&("undefined"===typeof e?!a(c[f],f,b):!a.call(e,c[f],f,b)))return!1;return!0}},!b(a.every));C(a,{some:function(a){var b=I.ToObject(this),c=E&&B(this)?this.split(""):b,d=c.length>>>0,e;1<arguments.length&&(e=arguments[1]);if(!x(a))throw new TypeError("Array.prototype.some callback must be a function");for(var f=0;f<d;f++)if(f in c&&
("undefined"===typeof e?a(c[f],f,b):a.call(e,c[f],f,b)))return!0;return!1}},!b(a.some));b=!1;a.reduce&&(b="object"===typeof a.reduce.call("es5",function(a,b,c,d){return d}));C(a,{reduce:function(a){var b=I.ToObject(this),c=E&&B(this)?this.split(""):b,d=c.length>>>0;if(!x(a))throw new TypeError("Array.prototype.reduce callback must be a function");if(0===d&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var e=0,f;if(2<=arguments.length)f=arguments[1];else{do{if(e in
c){f=c[e++];break}if(++e>=d)throw new TypeError("reduce of empty array with no initial value");}while(1)}for(;e<d;e++)e in c&&(f=a(f,c[e],e,b));return f}},!b);b=!1;a.reduceRight&&(b="object"===typeof a.reduceRight.call("es5",function(a,b,c,d){return d}));C(a,{reduceRight:function(a){var b=I.ToObject(this),c=E&&B(this)?this.split(""):b,d=c.length>>>0;if(!x(a))throw new TypeError("Array.prototype.reduceRight callback must be a function");if(0===d&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");
var e,d=d-1;if(2<=arguments.length)e=arguments[1];else{do{if(d in c){e=c[d--];break}if(0>--d)throw new TypeError("reduceRight of empty array with no initial value");}while(1)}if(0>d)return e;do d in c&&(e=a(e,c[d],d,b));while(d--);return e}},!b);b=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);C(a,{indexOf:function(a){var b=E&&B(this)?this.split(""):I.ToObject(this),c=b.length>>>0;if(0===c)return-1;var d=0;1<arguments.length&&(d=I.ToInteger(arguments[1]));for(d=0<=d?d:Math.max(0,c+d);d<c;d++)if(d in
b&&b[d]===a)return d;return-1}},b);b=Array.prototype.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);C(a,{lastIndexOf:function(a){var b=E&&B(this)?this.split(""):I.ToObject(this),c=b.length>>>0;if(0===c)return-1;var d=c-1;1<arguments.length&&(d=Math.min(d,I.ToInteger(arguments[1])));for(d=0<=d?d:c-Math.abs(d);0<=d;d--)if(d in b&&a===b[d])return d;return-1}},b);var L=!{toString:null}.propertyIsEnumerable("toString"),U=function(){}.propertyIsEnumerable("prototype"),O=!H("x","0"),J="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),
P=J.length;C(Object,{keys:function(a){var b=x(a),c=A(a),d=null!==a&&"object"===typeof a,e=d&&B(a);if(!d&&!b&&!c)throw new TypeError("Object.keys called on a non-object");d=[];b=U&&b;if(e&&O||c)for(e=0;e<a.length;++e)d.push(String(e));if(!c)for(var f in a)b&&"prototype"===f||!H(a,f)||d.push(String(f));if(L)for(c=(c=a.constructor)&&c.prototype===a,f=0;f<P;f++)e=J[f],c&&"constructor"===e||!H(a,e)||d.push(e);return d}});var b=Object.keys&&function(){return 2===Object.keys(arguments).length}(1,2),T=Object.keys;
C(Object,{keys:function(b){return A(b)?T(a.slice.call(b)):T(b)}},!b);b=Date.prototype.toISOString&&-1===(new Date(-621987552E5)).toISOString().indexOf("-000001");C(Date.prototype,{toISOString:function(){var a,b,c,d;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");d=this.getUTCFullYear();a=this.getUTCMonth();d+=Math.floor(a/12);a=[(a%12+12)%12+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()];d=(0>d?"-":9999<d?"+":"")+
("00000"+Math.abs(d)).slice(0<=d&&9999>=d?-4:-6);for(b=a.length;b--;)c=a[b],10>c&&(a[b]="0"+c);return d+"-"+a.slice(0,2).join("-")+"T"+a.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}},b);(function(){try{return Date.prototype.toJSON&&null===(new Date(NaN)).toJSON()&&-1!==(new Date(-621987552E5)).toJSON().indexOf("-000001")&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(a){return!1}})()||(Date.prototype.toJSON=function(a){a=Object(this);var b=I.ToPrimitive(a);
if("number"===typeof b&&!isFinite(b))return null;b=a.toISOString;if(!x(b))throw new TypeError("toISOString property is not callable");return b.call(a)});b=1E15===Date.parse("+033658-09-27T01:46:40.000Z");c=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"));m=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(!Date.parse||m||c||!b)Date=function(a){var b=function(c,d,e,f,g,h,k){var l=arguments.length,l=this instanceof a?1===l&&String(c)===c?new a(b.parse(c)):
7<=l?new a(c,d,e,f,g,h,k):6<=l?new a(c,d,e,f,g,h):5<=l?new a(c,d,e,f,g):4<=l?new a(c,d,e,f):3<=l?new a(c,d,e):2<=l?new a(c,d):1<=l?new a(c):new a:a.apply(this,arguments);C(l,{constructor:b},!0);return l},c=/^(\d{4}|[+-]\d{6})(?:-(\d{2})(?:-(\d{2})(?:T(\d{2}):(\d{2})(?::(\d{2})(?:(\.\d{1,}))?)?(Z|(?:([-+])(\d{2}):(\d{2})))?)?)?)?$/,d=[0,31,59,90,120,151,181,212,243,273,304,334,365],e=function(a,b){var c=1<b?1:0;return d[b]+Math.floor((a-1969+c)/4)-Math.floor((a-1901+c)/100)+Math.floor((a-1601+c)/400)+
365*(a-1970)},f;for(f in a)H(a,f)&&(b[f]=a[f]);C(b,{now:a.now,UTC:a.UTC},!0);b.prototype=a.prototype;C(b.prototype,{constructor:b},!0);b.parse=function(b){var d=c.exec(b);if(d){var f=Number(d[1]),g=Number(d[2]||1)-1,h=Number(d[3]||1)-1,k=Number(d[4]||0),l=Number(d[5]||0),m=Number(d[6]||0),q=Math.floor(1E3*Number(d[7]||0)),u=Boolean(d[4]&&!d[8]),v="-"===d[9]?1:-1,x=Number(d[10]||0),d=Number(d[11]||0);return k<(0<l||0<m||0<q?24:25)&&60>l&&60>m&&1E3>q&&-1<g&&12>g&&24>x&&60>d&&-1<h&&h<e(f,g+1)-e(f,g)&&
(f=60*(24*(e(f,g)+h)+k+x*v),f=1E3*(60*(f+l+d*v)+m)+q,u&&(f=Number(new a(1970,0,1,0,0,0,f))),-864E13<=f&&864E13>=f)?f:NaN}return a.parse.apply(this,arguments)};return b}(Date);Date.now||(Date.now=function(){return(new Date).getTime()});var b=e.toFixed&&("0.000"!==(8E-5).toFixed(3)||"1"!==(.9).toFixed(0)||"1.25"!==(1.255).toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0)),S={base:1E7,size:6,data:[0,0,0,0,0,0],multiply:function(a,b){for(var c=-1,d=b;++c<S.size;)d+=a*S.data[c],S.data[c]=
d%S.base,d=Math.floor(d/S.base)},divide:function(a){for(var b=S.size,c=0;0<=--b;)c+=S.data[b],S.data[b]=Math.floor(c/a),c=c%a*S.base},numToString:function(){for(var a=S.size,b="";0<=--a;)if(""!==b||0===a||0!==S.data[a])var c=String(S.data[a]),b=""===b?c:b+("0000000".slice(0,7-c.length)+c);return b},pow:function K(a,b,c){return 0===b?c:1===b%2?K(a,b-1,c*a):K(a*a,b/2,c)},log:function(a){for(var b=0;4096<=a;)b+=12,a/=4096;for(;2<=a;)b+=1,a/=2;return b}};C(e,{toFixed:function(a){var b,c,d;a=Number(a);
a=a!==a?0:Math.floor(a);if(0>a||20<a)throw new RangeError("Number.toFixed called with invalid number of decimals");b=Number(this);if(b!==b)return"NaN";if(-1E21>=b||1E21<=b)return String(b);c="";0>b&&(c="-",b=-b);d="0";if(1E-21<b)if(d=S.log(b*S.pow(2,69,1))-69,b=0>d?b*S.pow(2,-d,1):b/S.pow(2,d,1),b*=4503599627370496,d=52-d,0<d){S.multiply(0,b);for(b=a;7<=b;)S.multiply(1E7,0),b-=7;S.multiply(S.pow(10,b,1),0);for(b=d-1;23<=b;)S.divide(8388608),b-=23;S.divide(1<<b);S.multiply(1,1);S.divide(2);d=S.numToString()}else S.multiply(0,
b),S.multiply(1<<-d,0),d=S.numToString()+"0.00000000000000000000".slice(2,2+a);0<a?(b=d.length,d=b<=a?c+"0.0000000000000000000".slice(0,a-b+2)+d:c+d.slice(0,b-a)+"."+d.slice(b-a)):d=c+d;return d}},b);var R=d.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||1<".".split(/()()/).length?function(){var a="undefined"===typeof/()??/.exec("")[1];d.split=function(b,c){var d=this;if("undefined"===
typeof b&&0===c)return[];if(!z(b))return R.call(this,b,c);var e=[],f=(b.ignoreCase?"i":"")+(b.multiline?"m":"")+(b.extended?"x":"")+(b.sticky?"y":""),g=0,k,l,m,q=new RegExp(b.source,f+"g"),d=d+"";a||(k=new RegExp("^"+q.source+"$(?!\\s)",f));var u="undefined"===typeof c?4294967295:I.ToUint32(c);for(l=q.exec(d);l;){f=l.index+l[0].length;if(f>g&&(e.push(d.slice(g,l.index)),!a&&1<l.length&&l[0].replace(k,function(){for(var a=1;a<arguments.length-2;a++)"undefined"===typeof arguments[a]&&(l[a]=void 0)}),
1<l.length&&l.index<d.length&&h.apply(e,l.slice(1)),m=l[0].length,g=f,e.length>=u))break;q.lastIndex===l.index&&q.lastIndex++;l=q.exec(d)}g===d.length?!m&&q.test("")||e.push(""):e.push(d.slice(g));return e.length>u?e.slice(0,u):e}}():"0".split(void 0,0).length&&(d.split=function(a,b){return"undefined"===typeof a&&0===b?[]:R.call(this,a,b)});var ba=d.replace;(function(){var a=[];"x".replace(/x(.)?/g,function(b,c){a.push(c)});return 1===a.length&&"undefined"===typeof a[0]})()||(d.replace=function(a,
b){var c=x(b),d=z(a)&&/\)[*?]/.test(a.source);return c&&d?ba.call(this,a,function(c){var d=arguments.length,e=a.lastIndex;a.lastIndex=0;var f=a.exec(c)||[];a.lastIndex=e;f.push(arguments[d-2],arguments[d-1]);return b.apply(this,f)}):ba.call(this,a,b)});var N=d.substr,e="".substr&&"b"!=="0b".substr(-1);C(d,{substr:function(a,b){var c=a;0>a&&(c=Math.max(this.length+a,0));return N.call(this,c,b)}},e);var ja=/^[\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,
pa=/[\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,e=d.trim&&("\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff".trim()||!"\u200b".trim());C(d,{trim:function(){if("undefined"===typeof this||
null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(ja,"").replace(pa,"")}},e);if(8!==parseInt("\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff08")||22!==parseInt("\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff0x16"))parseInt=function(a){var b=/^0[xX]/;return function(c,d){var e=String(c).trim(),
f=Number(d)||(b.test(e)?16:10);return a(e,f)}}(parseInt)});var THREE={REVISION:"71"};"object"===typeof module&&(module.exports=THREE);void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a});THREE.log=function(){console.log.apply(console,arguments)};THREE.warn=function(){console.warn.apply(console,arguments)};THREE.error=function(){console.error.apply(console,arguments)};THREE.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;
THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;
THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.MinEquation=103;THREE.MaxEquation=104;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=300;
THREE.CubeReflectionMapping=301;THREE.CubeRefractionMapping=302;THREE.EquirectangularReflectionMapping=303;THREE.EquirectangularRefractionMapping=304;THREE.SphericalReflectionMapping=305;THREE.RepeatWrapping=1E3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;
THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.HalfFloatType=1025;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGBEFormat=THREE.RGBAFormat;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;
THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.RGB_PVRTC_4BPPV1_Format=2100;THREE.RGB_PVRTC_2BPPV1_Format=2101;THREE.RGBA_PVRTC_4BPPV1_Format=2102;THREE.RGBA_PVRTC_2BPPV1_Format=2103;
THREE.Projector=function(){THREE.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");this.projectVector=function(a,b){THREE.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){THREE.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(a,b){THREE.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}};
THREE.CanvasRenderer=function(){THREE.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js");this.domElement=document.createElement("canvas");this.clear=function(){};this.render=function(){};this.setClearColor=function(){};this.setSize=function(){}};THREE.Color=function(a){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(a)};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){a instanceof THREE.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(a,b,c){if(0===b)this.r=this.g=this.b=c;else{var d=function(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:
.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a};b=.5>=c?c*(1+b):c+b-c*b;c=2*c-b;this.r=d(c,b,a+1/3);this.g=d(c,b,a);this.b=d(c,b,a-1/3)}return this},setStyle:function(a){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(a))return a=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(a),this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,this;if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(a))return a=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(a),this.r=
Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(a))return a=/^\#([0-9a-f]{6})$/i.exec(a),this.setHex(parseInt(a[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a))return a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.setHex(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this;if(/^(\w+)$/i.test(a))return this.setHex(THREE.ColorKeywords[a]),this},copy:function(a){this.r=a.r;this.g=
a.g;this.b=a.b;return this},copyGammaToLinear:function(a,b){void 0===b&&(b=2);this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);var c=0<b?1/b:1;this.r=Math.pow(a.r,c);this.g=Math.pow(a.g,c);this.b=Math.pow(a.b,c);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=
Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=a||{h:0,s:0,l:0};var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h=(f+e)/2;if(f===e)f=g=0;else{var k=e-f,f=.5>=h?k/(e+f):k/(2-e-f);switch(e){case b:g=(c-d)/k+(c<d?6:0);break;case c:g=(d-b)/k+2;break;case d:g=(b-c)/k+4}g/=6}a.h=g;a.s=f;a.l=h;return a},getStyle:function(){return"rgb("+
(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,b,c){var d=this.getHSL();d.h+=a;d.s+=b;d.l+=c;this.setHSL(d.h,d.s,d.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;
return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a){this.r=a[0];this.g=a[1];this.b=a[2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.r;a[b+1]=this.g;a[b+2]=this.b;return a},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};
THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get w(){return this._w},set w(a){this._w=a;this.onChangeCallback()},set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;this.onChangeCallback();return this},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;
this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!1===a instanceof THREE.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var c=Math.cos(a._x/2),d=Math.cos(a._y/2),e=Math.cos(a._z/2),f=Math.sin(a._x/2),g=Math.sin(a._y/2),h=Math.sin(a._z/2);"XYZ"===a.order?(this._x=f*d*e+c*g*h,this._y=c*g*e-f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e-f*g*h):"YXZ"===a.order?(this._x=f*d*e+c*g*h,this._y=c*g*e-f*d*h,this._z=
c*d*h-f*g*e,this._w=c*d*e+f*g*h):"ZXY"===a.order?(this._x=f*d*e-c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e-f*g*h):"ZYX"===a.order?(this._x=f*d*e-c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h-f*g*e,this._w=c*d*e+f*g*h):"YZX"===a.order?(this._x=f*d*e+c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h-f*g*e,this._w=c*d*e-f*g*h):"XZY"===a.order&&(this._x=f*d*e-c*g*h,this._y=c*g*e-f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e+f*g*h);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,
b){var c=b/2,d=Math.sin(c);this._x=a.x*d;this._y=a.y*d;this._z=a.z*d;this._w=Math.cos(c);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],f=b[5],g=b[9],h=b[2],k=b[6],b=b[10],l=c+f+b;0<l?(c=.5/Math.sqrt(l+1),this._w=.25/c,this._x=(k-g)*c,this._y=(d-h)*c,this._z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(k-g)/c,this._x=.25*c,this._y=(a+e)/c,this._z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this._w=(d-h)/c,this._x=(a+e)/c,this._y=
.25*c,this._z=(g+k)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(e-a)/c,this._x=(d+h)/c,this._y=(g+k)/c,this._z=.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector3);b=c.dot(d)+1;1E-6>b?(b=0,Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,d);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;this.normalize();return this}}(),inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=
-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},
multiply:function(a,b){return void 0!==b?(THREE.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,k=b._z,l=b._w;this._x=c*l+f*g+d*k-e*h;this._y=d*l+f*h+e*g-c*k;this._z=e*l+f*k+c*h-d*g;this._w=f*l-c*g-d*h-e*k;this.onChangeCallback();return this},multiplyVector3:function(a){THREE.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");
return a.applyQuaternion(this)},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a);if(1<=g)return this._w=f,this._x=c,this._y=d,this._z=e,this;var h=Math.acos(g),k=Math.sqrt(1-g*g);if(.001>Math.abs(k))return this._w=.5*(f+this._w),this._x=.5*(c+this._x),this._y=.5*(d+this._y),this._z=.5*(e+this._z),this;g=Math.sin((1-b)*h)/k;h=
Math.sin(b*h)/k;this._w=f*g+this._w*h;this._x=c*g+this._x*h;this._y=d*g+this._y*h;this._z=e*g+this._z*h;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=
a;return this},onChangeCallback:function(){},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}};THREE.Quaternion.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,
b){if(void 0!==b)return THREE.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},sub:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},
subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);
this.y<a.y&&(this.y=a.y);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector2,b=new THREE.Vector2);a.set(c,c);b.set(d,d);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=
Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},
distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},lerpVectors:function(a,b,c){this.subVectors(b,a).multiplyScalar(c).add(a);return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,b){void 0===
a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},fromAttribute:function(a,b,c){void 0===c&&(c=0);b=b*a.itemSize+c;this.x=a.array[b];this.y=a.array[b+1];return this},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=
a;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a;return function(b){!1===b instanceof THREE.Euler&&THREE.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.");void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromEuler(b));return this}}(),applyAxisAngle:function(){var a;return function(b,c){void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromAxisAngle(b,
c));return this}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12];this.y=a[1]*b+a[5]*c+a[9]*d+a[13];this.z=a[2]*b+a[6]*c+a[10]*d+a[14];return this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*
c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*d-g*c,k=a*c+g*b-e*d,l=a*d+e*c-f*b,b=-e*b-f*c-g*d;this.x=h*a+b*-e+k*-g-l*-f;this.y=k*a+b*-f+l*-e-h*-g;this.z=l*a+b*-g+h*-f-k*-e;return this},project:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyProjection(a)}}(),
unproject:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyProjection(a)}}(),transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=
a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector3,
b=new THREE.Vector3);a.set(c,c,c);b.set(d,d,d);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):
Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,b,c){this.subVectors(b,a).multiplyScalar(c).add(a);return this},cross:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,d=this.y,e=this.z;this.x=d*a.z-e*a.y;this.y=
e*a.x-c*a.z;this.z=c*a.y-d*a.x;return this},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;this.x=d*h-e*g;this.y=e*f-c*h;this.z=c*g-d*f;return this},projectOnVector:function(){var a,b;return function(c){void 0===a&&(a=new THREE.Vector3);a.copy(c).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a;return function(b){void 0===a&&(a=new THREE.Vector3);a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a;return function(b){void 0===
a&&(a=new THREE.Vector3);return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/(this.length()*a.length());return Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},setEulerFromRotationMatrix:function(a,b){THREE.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},
setEulerFromQuaternion:function(a,b){THREE.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){THREE.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){THREE.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,
b){THREE.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(a,b)},setFromMatrixPosition:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setFromMatrixScale:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a;
return this},setFromMatrixColumn:function(a,b){var c=4*a,d=b.elements;this.x=d[c];this.y=d[c+1];this.z=d[c+2];return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromAttribute:function(a,b,c){void 0===c&&(c=0);b=b*a.itemSize+c;this.x=a.array[b];this.y=a.array[b+1];this.z=
a.array[b+2];return this},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};THREE.Vector4=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,
b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},sub:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=
a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>
b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,c,d;a=a.elements;var e=a[0];d=a[4];var f=a[8],g=a[1],h=a[5],k=a[9];c=a[2];b=a[6];var l=a[10];if(.01>Math.abs(d-g)&&.01>Math.abs(f-c)&&.01>Math.abs(k-b)){if(.1>Math.abs(d+g)&&.1>Math.abs(f+c)&&.1>Math.abs(k+b)&&.1>Math.abs(e+h+l-3))return this.set(1,0,0,0),this;a=Math.PI;e=(e+1)/2;h=(h+1)/2;l=(l+1)/2;d=(d+g)/4;f=(f+c)/4;k=(k+b)/4;e>h&&e>l?.01>e?(b=0,d=c=.707106781):(b=
Math.sqrt(e),c=d/b,d=f/b):h>l?.01>h?(b=.707106781,c=0,d=.707106781):(c=Math.sqrt(h),b=d/c,d=k/c):.01>l?(c=b=.707106781,d=0):(d=Math.sqrt(l),b=f/d,c=k/d);this.set(b,c,d,a);return this}a=Math.sqrt((b-k)*(b-k)+(f-c)*(f-c)+(g-d)*(g-d));.001>Math.abs(a)&&(a=1);this.x=(b-k)/a;this.y=(f-c)/a;this.z=(g-d)/a;this.w=Math.acos((e+h+l-1)/2);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.w>a.w&&(this.w=a.w);return this},max:function(a){this.x<a.x&&
(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);this.w<a.w&&(this.w=a.w);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w);return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector4,b=new THREE.Vector4);a.set(c,c,c,c);b.set(d,d,d,d);return this.clamp(a,b)}}(),floor:function(){this.x=
Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);
this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+
Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a,b,c){this.subVectors(b,a).multiplyScalar(c).add(a);return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},
fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromAttribute:function(a,b,c){void 0===c&&(c=0);b=b*a.itemSize+c;this.x=a.array[b];this.y=a.array[b+1];this.z=a.array[b+2];this.w=a.array[b+3];return this},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};
THREE.Euler=function(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");THREE.Euler.DefaultOrder="XYZ";
THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get order(){return this._order},set order(a){this._order=a;this.onChangeCallback()},set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._order=d||this._order;this.onChangeCallback();return this},copy:function(a){this._x=
a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,c){var d=THREE.Math.clamp,e=a.elements;a=e[0];var f=e[4],g=e[8],h=e[1],k=e[5],l=e[9],m=e[2],v=e[6],e=e[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(d(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(-l,e),this._z=Math.atan2(-f,a)):(this._x=Math.atan2(v,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-d(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(g,e),this._z=Math.atan2(h,
k)):(this._y=Math.atan2(-m,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(v,-1,1)),.99999>Math.abs(v)?(this._y=Math.atan2(-m,e),this._z=Math.atan2(-f,k)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-d(m,-1,1)),.99999>Math.abs(m)?(this._x=Math.atan2(v,e),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-f,k))):"YZX"===b?(this._z=Math.asin(d(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(-l,k),this._y=Math.atan2(-m,a)):(this._x=0,this._y=Math.atan2(g,e))):"XZY"===b?(this._z=
Math.asin(-d(f,-1,1)),.99999>Math.abs(f)?(this._x=Math.atan2(v,k),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-l,e),this._y=0)):THREE.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Matrix4);a.makeRotationFromQuaternion(b);this.setFromRotationMatrix(a,c,d);return this}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,
b||this._order)},reorder:function(){var a=new THREE.Quaternion;return function(b){a.setFromEuler(this);this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?
a.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}};THREE.Line3=function(a,b){this.start=void 0!==a?a:new THREE.Vector3;this.end=void 0!==b?b:new THREE.Vector3};
THREE.Line3.prototype={constructor:THREE.Line3,set:function(a,b){this.start.copy(a);this.end.copy(b);return this},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},center:function(a){return(a||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(a){return(a||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,
b){var c=b||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);var e=b.dot(b),e=b.dot(a)/e;d&&(e=THREE.Math.clamp(e,0,1));return e}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);c=c||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}};THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new THREE.Vector2;return function(b,c){var d=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=
this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>
this.max.y?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&
a.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new THREE.Vector3;return function(b,c){var d=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),setFromObject:function(){var a=new THREE.Vector3;return function(b){var c=this;b.updateMatrixWorld(!0);
this.makeEmpty();b.traverse(function(b){var e=b.geometry;if(void 0!==e)if(e instanceof THREE.Geometry)for(var f=e.vertices,e=0,g=f.length;e<g;e++)a.copy(f[e]),a.applyMatrix4(b.matrixWorld),c.expandByPoint(a);else if(e instanceof THREE.BufferGeometry&&void 0!==e.attributes.position)for(f=e.attributes.position.array,e=0,g=f.length;e<g;e+=3)a.set(f[e],f[e+1],f[e+2]),a.applyMatrix4(b.matrixWorld),c.expandByPoint(a)});return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},
makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);
this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector3).set((a.x-this.min.x)/(this.max.x-
this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=
new THREE.Vector3;return function(b){b=b||new THREE.Sphere;b.center=this.center();b.radius=.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){a[0].set(this.min.x,this.min.y,
this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);
this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]);0<arguments.length&&THREE.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(a,b,c,d,e,f,g,h,k){var l=this.elements;l[0]=a;l[3]=b;l[6]=c;l[1]=d;l[4]=e;l[7]=f;l[2]=g;l[5]=h;l[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){THREE.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
multiplyVector3Array:function(a){THREE.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(a)},applyToVector3Array:function(){var a=new THREE.Vector3;return function(b,c,d){void 0===c&&(c=0);void 0===d&&(d=b.length);for(var e=0;e<d;e+=3,c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix3(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=
a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7],a=a[8];return b*f*a-b*g*k-c*e*a+c*g*h+d*e*k-d*f*h},getInverse:function(a,b){var c=a.elements,d=this.elements;d[0]=c[10]*c[5]-c[6]*c[9];d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];
c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");THREE.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];
a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]},clone:function(){return(new THREE.Matrix3).fromArray(this.elements)}};
THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);0<arguments.length&&THREE.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,d,e,f,g,h,k,l,m,v,q,y,x,w){var z=this.elements;z[0]=a;z[4]=b;z[8]=c;z[12]=d;z[1]=e;z[5]=f;z[9]=g;z[13]=h;z[2]=k;z[6]=l;z[10]=m;z[14]=v;z[3]=q;z[7]=y;z[11]=x;z[15]=w;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.elements.set(a.elements);return this},extractPosition:function(a){THREE.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(a)},
copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,c){var d=this.elements;a.set(d[0],d[1],d[2]);b.set(d[4],d[5],d[6]);c.set(d[8],d[9],d[10]);return this},makeBasis:function(a,b,c){this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a=new THREE.Vector3;return function(b){var c=this.elements;b=b.elements;var d=1/a.set(b[0],b[1],b[2]).length(),e=1/a.set(b[4],b[5],b[6]).length(),
f=1/a.set(b[8],b[9],b[10]).length();c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[4]=b[4]*e;c[5]=b[5]*e;c[6]=b[6]*e;c[8]=b[8]*f;c[9]=b[9]*f;c[10]=b[10]*f;return this}}(),makeRotationFromEuler:function(a){!1===a instanceof THREE.Euler&&THREE.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c),c=Math.sin(c),g=Math.cos(d),d=Math.sin(d),h=Math.cos(e),e=Math.sin(e);if("XYZ"===a.order){a=f*h;var k=f*e,
l=c*h,m=c*e;b[0]=g*h;b[4]=-g*e;b[8]=d;b[1]=k+l*d;b[5]=a-m*d;b[9]=-c*g;b[2]=m-a*d;b[6]=l+k*d;b[10]=f*g}else"YXZ"===a.order?(a=g*h,k=g*e,l=d*h,m=d*e,b[0]=a+m*c,b[4]=l*c-k,b[8]=f*d,b[1]=f*e,b[5]=f*h,b[9]=-c,b[2]=k*c-l,b[6]=m+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*h,k=g*e,l=d*h,m=d*e,b[0]=a-m*c,b[4]=-f*e,b[8]=l+k*c,b[1]=k+l*c,b[5]=f*h,b[9]=m-a*c,b[2]=-f*d,b[6]=c,b[10]=f*g):"ZYX"===a.order?(a=f*h,k=f*e,l=c*h,m=c*e,b[0]=g*h,b[4]=l*d-k,b[8]=a*d+m,b[1]=g*e,b[5]=m*d+a,b[9]=k*d-l,b[2]=-d,b[6]=c*g,b[10]=f*g):"YZX"===
a.order?(a=f*g,k=f*d,l=c*g,m=c*d,b[0]=g*h,b[4]=m-a*e,b[8]=l*e+k,b[1]=e,b[5]=f*h,b[9]=-c*h,b[2]=-d*h,b[6]=k*e+l,b[10]=a-m*e):"XZY"===a.order&&(a=f*g,k=f*d,l=c*g,m=c*d,b[0]=g*h,b[4]=-e,b[8]=d*h,b[1]=a*e+m,b[5]=f*h,b[9]=k*e-l,b[2]=l*e-k,b[6]=c*h,b[10]=m*e+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},setRotationFromQuaternion:function(a){THREE.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(a)},
makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,k=e+e;a=c*g;var l=c*h,c=c*k,m=d*h,d=d*k,e=e*k,g=f*g,h=f*h,f=f*k;b[0]=1-(m+e);b[4]=l-f;b[8]=c+h;b[1]=l+f;b[5]=1-(a+e);b[9]=d-g;b[2]=c-h;b[6]=d+g;b[10]=1-(a+m);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f){var g=this.elements;c.subVectors(d,e).normalize();0===c.length()&&(c.z=1);a.crossVectors(f,
c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(f,c).normalize());b.crossVectors(c,a);g[0]=a.x;g[4]=b.x;g[8]=c.x;g[1]=a.y;g[5]=b.y;g[9]=c.y;g[2]=a.z;g[6]=b.z;g[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(THREE.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],
k=c[12],l=c[1],m=c[5],v=c[9],q=c[13],y=c[2],x=c[6],w=c[10],z=c[14],u=c[3],B=c[7],G=c[11],c=c[15],A=d[0],C=d[4],F=d[8],I=d[12],D=d[1],H=d[5],E=d[9],L=d[13],U=d[2],O=d[6],J=d[10],P=d[14],T=d[3],S=d[7],R=d[11],d=d[15];e[0]=f*A+g*D+h*U+k*T;e[4]=f*C+g*H+h*O+k*S;e[8]=f*F+g*E+h*J+k*R;e[12]=f*I+g*L+h*P+k*d;e[1]=l*A+m*D+v*U+q*T;e[5]=l*C+m*H+v*O+q*S;e[9]=l*F+m*E+v*J+q*R;e[13]=l*I+m*L+v*P+q*d;e[2]=y*A+x*D+w*U+z*T;e[6]=y*C+x*H+w*O+z*S;e[10]=y*F+x*E+w*J+z*R;e[14]=y*I+x*L+w*P+z*d;e[3]=u*A+B*D+G*U+c*T;e[7]=u*C+
B*H+G*O+c*S;e[11]=u*F+B*E+G*J+c*R;e[15]=u*I+B*L+G*P+c*d;return this},multiplyToArray:function(a,b,c){var d=this.elements;this.multiplyMatrices(a,b);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=
a;b[15]*=a;return this},multiplyVector3:function(a){THREE.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return a.applyProjection(this)},multiplyVector4:function(a){THREE.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(a){THREE.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");
return this.applyToVector3Array(a)},applyToVector3Array:function(){var a=new THREE.Vector3;return function(b,c,d){void 0===c&&(c=0);void 0===d&&(d=b.length);for(var e=0;e<d;e+=3,c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix4(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),rotateAxis:function(a){THREE.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){THREE.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");
return a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],k=a[13],l=a[2],m=a[6],v=a[10],q=a[14];return a[3]*(+e*h*m-d*k*m-e*g*v+c*k*v+d*g*q-c*h*q)+a[7]*(+b*h*q-b*k*v+e*f*v-d*f*q+d*k*l-e*h*l)+a[11]*(+b*k*m-b*g*q-e*f*m+c*f*q+e*g*l-c*k*l)+a[15]*(-d*g*l-b*h*m+b*g*v+d*f*m-c*f*v+c*h*l)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];
a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=new THREE.Vector3;return function(){THREE.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=
this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],g=d[8],h=d[12],k=d[1],l=d[5],m=d[9],v=d[13],q=d[2],y=d[6],x=d[10],w=d[14],z=d[3],u=d[7],B=d[11],d=d[15];c[0]=m*w*u-v*x*u+v*y*B-l*w*B-m*y*d+l*x*d;c[4]=h*x*u-g*w*u-h*y*B+f*w*B+g*y*d-f*x*d;c[8]=g*v*u-h*m*u+h*l*B-f*v*B-g*l*d+f*m*d;c[12]=h*m*y-g*v*y-h*l*x+f*v*x+g*l*w-f*m*w;c[1]=v*x*z-m*w*z-v*q*B+
k*w*B+m*q*d-k*x*d;c[5]=g*w*z-h*x*z+h*q*B-e*w*B-g*q*d+e*x*d;c[9]=h*m*z-g*v*z-h*k*B+e*v*B+g*k*d-e*m*d;c[13]=g*v*q-h*m*q+h*k*x-e*v*x-g*k*w+e*m*w;c[2]=l*w*z-v*y*z+v*q*u-k*w*u-l*q*d+k*y*d;c[6]=h*y*z-f*w*z-h*q*u+e*w*u+f*q*d-e*y*d;c[10]=f*v*z-h*l*z+h*k*u-e*v*u-f*k*d+e*l*d;c[14]=h*l*q-f*v*q-h*k*y+e*v*y+f*k*w-e*l*w;c[3]=m*y*z-l*x*z-m*q*u+k*x*u+l*q*B-k*y*B;c[7]=f*x*z-g*y*z+g*q*u-e*x*u-f*q*B+e*y*B;c[11]=g*l*z-f*m*z-g*k*u+e*m*u+f*k*B-e*l*B;c[15]=f*m*q-g*l*q+g*k*y-e*m*y-f*k*x+e*l*x;c=e*c[0]+k*c[4]+q*c[8]+z*c[12];
if(0==c){if(b)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");THREE.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},translate:function(a){THREE.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(a){THREE.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(a){THREE.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(a){THREE.error("THREE.Matrix4: .rotateZ() has been removed.")},
rotateByAxis:function(a,b){THREE.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,
c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,k=e*f,l=e*g;this.set(k*f+c,k*g-d*h,k*h+d*g,0,k*g+
d*h,l*g+c,l*h-d*f,0,k*h-d*g,l*h+d*f,e*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a=new THREE.Vector3,b=new THREE.Matrix4;return function(c,d,e){var f=this.elements,g=a.set(f[0],f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),k=a.set(f[8],f[9],f[10]).length();0>this.determinant()&&(g=-g);c.x=f[12];
c.y=f[13];c.z=f[14];b.elements.set(this.elements);c=1/g;var f=1/h,l=1/k;b.elements[0]*=c;b.elements[1]*=c;b.elements[2]*=c;b.elements[4]*=f;b.elements[5]*=f;b.elements[6]*=f;b.elements[8]*=l;b.elements[9]*=l;b.elements[10]*=l;d.setFromRotationMatrix(b);e.x=g;e.y=h;e.z=k;return this}}(),makeFrustum:function(a,b,c,d,e,f){var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(d-c);g[9]=(d+c)/(d-c);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*f*e/(f-e);g[3]=0;g[7]=0;
g[11]=-1;g[15]=0;return this},makePerspective:function(a,b,c,d){a=c*Math.tan(THREE.Math.degToRad(.5*a));var e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=b-a,k=c-d,l=f-e;g[0]=2/h;g[4]=0;g[8]=0;g[12]=-((b+a)/h);g[1]=0;g[5]=2/k;g[9]=0;g[13]=-((c+d)/k);g[2]=0;g[6]=0;g[10]=-2/l;g[14]=-((f+e)/l);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],
a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)}};THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3;this.direction=void 0!==b?b:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new THREE.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);
var d=c.dot(this.direction);return 0>d?c.copy(this.origin):c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceTo(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),distanceSqToSegment:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f,g){a.copy(d).add(e).multiplyScalar(.5);
b.copy(e).sub(d).normalize();c.copy(this.origin).sub(a);var h=.5*d.distanceTo(e),k=-this.direction.dot(b),l=c.dot(this.direction),m=-c.dot(b),v=c.lengthSq(),q=Math.abs(1-k*k),y;0<q?(d=k*m-l,e=k*l-m,y=h*q,0<=d?e>=-y?e<=y?(h=1/q,d*=h,e*=h,k=d*(d+k*e+2*l)+e*(k*d+e+2*m)+v):(e=h,d=Math.max(0,-(k*e+l)),k=-d*d+e*(e+2*m)+v):(e=-h,d=Math.max(0,-(k*e+l)),k=-d*d+e*(e+2*m)+v):e<=-y?(d=Math.max(0,-(-k*h+l)),e=0<d?-h:Math.min(Math.max(-h,-m),h),k=-d*d+e*(e+2*m)+v):e<=y?(d=0,e=Math.min(Math.max(-h,-m),h),k=e*(e+
2*m)+v):(d=Math.max(0,-(k*h+l)),e=0<d?h:Math.min(Math.max(-h,-m),h),k=-d*d+e*(e+2*m)+v)):(e=0<k?-h:h,d=Math.max(0,-(k*e+l)),k=-d*d+e*(e+2*m)+v);f&&f.copy(this.direction).multiplyScalar(d).add(this.origin);g&&g.copy(b).multiplyScalar(e).add(a);return k}}(),isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},intersectSphere:function(){var a=new THREE.Vector3;return function(b,c){a.subVectors(b.center,this.origin);var d=a.dot(this.direction),e=a.dot(a)-d*d,f=b.radius*b.radius;
if(e>f)return null;f=Math.sqrt(f-e);e=d-f;d+=f;return 0>e&&0>d?null:0>e?this.at(d,c):this.at(e,c)}}(),isIntersectionPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0==b)return 0==a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},
isIntersectionBox:function(){var a=new THREE.Vector3;return function(b){return null!==this.intersectBox(b,a)}}(),intersectBox:function(a,b){var c,d,e,f,g;d=1/this.direction.x;f=1/this.direction.y;g=1/this.direction.z;var h=this.origin;0<=d?(c=(a.min.x-h.x)*d,d*=a.max.x-h.x):(c=(a.max.x-h.x)*d,d*=a.min.x-h.x);0<=f?(e=(a.min.y-h.y)*f,f*=a.max.y-h.y):(e=(a.max.y-h.y)*f,f*=a.min.y-h.y);if(c>f||e>d)return null;if(e>c||c!==c)c=e;if(f<d||d!==d)d=f;0<=g?(e=(a.min.z-h.z)*g,g*=a.max.z-h.z):(e=(a.max.z-h.z)*
g,g*=a.min.z-h.z);if(c>g||e>d)return null;if(e>c||c!==c)c=e;if(g<d||d!==d)d=g;return 0>d?null:this.at(0<=c?c:d,b)},intersectTriangle:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(e,f,g,h,k){b.subVectors(f,e);c.subVectors(g,e);d.crossVectors(b,c);f=this.direction.dot(d);if(0<f){if(h)return null;h=1}else if(0>f)h=-1,f=-f;else return null;a.subVectors(this.origin,e);e=h*this.direction.dot(c.crossVectors(a,c));if(0>e)return null;g=h*this.direction.dot(b.cross(a));
if(0>g||e+g>f)return null;e=-h*a.dot(d);return 0>e?null:this.at(e/f,k)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}};THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3;this.radius=void 0!==b?b:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new THREE.Box3;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).center(d);for(var e=0,f=0,g=b.length;f<g;f++)e=Math.max(e,d.distanceToSquared(b[f]));this.radius=Math.sqrt(e);return this}}(),copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=
this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),d=b||new THREE.Vector3;d.copy(a);c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center));return d},getBoundingBox:function(a){a=a||new THREE.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);
return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};
THREE.Frustum=function(a,b,c,d,e,f){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==f?f:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(a,b,c,d,e,f){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(d);g[4].copy(e);g[5].copy(f);return this},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],l=c[7],m=c[8],v=c[9],q=c[10],y=c[11],x=c[12],w=c[13],z=c[14],c=c[15];b[0].setComponents(f-a,l-g,y-m,c-x).normalize();b[1].setComponents(f+
a,l+g,y+m,c+x).normalize();b[2].setComponents(f+d,l+h,y+v,c+w).normalize();b[3].setComponents(f-d,l-h,y-v,c-w).normalize();b[4].setComponents(f-e,l-k,y-q,c-z).normalize();b[5].setComponents(f+e,l+k,y+q,c+z).normalize();return this},intersectsObject:function(){var a=new THREE.Sphere;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere);a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,
c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){for(var d=this.planes,e=0;6>e;e++){var f=d[e];a.x=0<f.normal.x?c.min.x:c.max.x;b.x=0<f.normal.x?c.max.x:c.min.x;a.y=0<f.normal.y?c.min.y:c.max.y;b.y=0<f.normal.y?c.max.y:c.min.y;a.z=0<f.normal.z?c.min.z:c.max.z;b.z=0<f.normal.z?c.max.z:c.min.z;var g=f.distanceToPoint(a),f=f.distanceToPoint(b);if(0>g&&0>f)return!1}return!0}}(),
containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0);this.constant=void 0!==b?b:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,
c);return this}}(),copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,
b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var d=c||new THREE.Vector3,e=b.delta(a),f=this.normal.dot(e);if(0==f){if(0==this.distanceToPoint(b.start))return d.copy(b.start)}else return f=-(b.start.dot(this.normal)+this.constant)/f,0>f||1<f?void 0:d.copy(e).multiplyScalar(f).add(b.start)}}(),
coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(d,e){var f=e||c.getNormalMatrix(d),f=a.copy(this.normal).applyMatrix3(f),g=this.coplanarPoint(b);g.applyMatrix4(d);this.setFromNormalAndCoplanarPoint(f,g);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&
a.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};
THREE.Math={generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,d;return function(){for(var e=0;36>e;e++)8==e||13==e||18==e||23==e?b[e]="-":14==e?b[e]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),d=c&15,c>>=4,b[e]=a[19==e?d&3|8:d]);return b.join("")}}(),clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},smoothstep:function(a,b,c){if(a<=
b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return Math.floor(this.randFloat(a,b))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}(),radToDeg:function(){var a=
180/Math.PI;return function(b){return b*a}}(),isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},nextPowerOfTwo:function(a){a--;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;return a}};
THREE.Spline=function(a){function b(a,b,c,d,e,f,g){a=.5*(c-a);d=.5*(d-b);return(2*(b-c)+a+d)*g+(-3*(b-c)-2*a-d)*f+a*e+b}this.points=a;var c=[],d={x:0,y:0,z:0},e,f,g,h,k,l,m,v,q;this.initFromArray=function(a){this.points=[];for(var b=0;b<a.length;b++)this.points[b]={x:a[b][0],y:a[b][1],z:a[b][2]}};this.getPoint=function(a){e=(this.points.length-1)*a;f=Math.floor(e);g=e-f;c[0]=0===f?f:f-1;c[1]=f;c[2]=f>this.points.length-2?this.points.length-1:f+1;c[3]=f>this.points.length-3?this.points.length-1:f+
2;l=this.points[c[0]];m=this.points[c[1]];v=this.points[c[2]];q=this.points[c[3]];h=g*g;k=g*h;d.x=b(l.x,m.x,v.x,q.x,g,h,k);d.y=b(l.y,m.y,v.y,q.y,g,h,k);d.z=b(l.z,m.z,v.z,q.z,g,h,k);return d};this.getControlPointsArray=function(){var a,b,c=this.points.length,d=[];for(a=0;a<c;a++)b=this.points[a],d[a]=[b.x,b.y,b.z];return d};this.getLength=function(a){var b,c,d,e=b=b=0,f=new THREE.Vector3,g=new THREE.Vector3,h=[],k=0;h[0]=0;a||(a=100);c=this.points.length*a;f.copy(this.points[0]);for(a=1;a<c;a++)b=
a/c,d=this.getPoint(b),g.copy(d),k+=g.distanceTo(f),f.copy(d),b*=this.points.length-1,b=Math.floor(b),b!=e&&(h[b]=k,e=b);h[h.length]=k;return{chunks:h,total:k}};this.reparametrizeByArcLength=function(a){var b,c,d,e,f,g,h=[],k=new THREE.Vector3,l=this.getLength();h.push(k.copy(this.points[0]).clone());for(b=1;b<this.points.length;b++){c=l.chunks[b]-l.chunks[b-1];g=Math.ceil(a*c/l.total);e=(b-1)/(this.points.length-1);f=b/(this.points.length-1);for(c=1;c<g-1;c++)d=e+1/g*c*(f-e),d=this.getPoint(d),h.push(k.copy(d).clone());
h.push(k.copy(this.points[b]).clone())}this.points=h}};THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3;this.b=void 0!==b?b:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,d,e){e=e||new THREE.Vector3;e.subVectors(d,c);a.subVectors(b,c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f,g,h){a.subVectors(g,e);b.subVectors(f,e);c.subVectors(d,e);d=a.dot(a);e=a.dot(b);f=a.dot(c);var k=b.dot(b);g=b.dot(c);var l=d*k-e*e;h=h||new THREE.Vector3;if(0==l)return h.set(-2,-1,-1);l=1/l;k=(k*f-e*g)*l;d=(d*g-e*f)*l;return h.set(1-k-d,d,k)}}();
THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,d,e){b=THREE.Triangle.barycoordFromPoint(b,c,d,e,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return.5*a.cross(b).length()}}(),midpoint:function(a){return(a||
new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},
clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Clock=function(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};
THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;this.autoStart&&!this.running&&this.start();if(this.running){var b=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),
a=.001*(b-this.oldTime);this.oldTime=b;this.elapsedTime+=a}return a}};THREE.EventDispatcher=function(){};
THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(a){a.addEventListener=THREE.EventDispatcher.prototype.addEventListener;a.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;a.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&
c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var d=c.indexOf(b);-1!==d&&c.splice(d,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var c=[],d=b.length,e=0;e<d;e++)c[e]=b[e];for(e=0;e<d;e++)c[e].call(this,a)}}}};
(function(a){a.Raycaster=function(b,c,f,g){this.ray=new a.Ray(b,c);this.near=f||0;this.far=g||Infinity;this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{}}};var b=function(a,b){return a.distance-b.distance},c=function(a,b,f,g){a.raycast(b,f);if(!0===g){a=a.children;g=0;for(var h=a.length;g<h;g++)c(a[g],b,f,!0)}};a.Raycaster.prototype={constructor:a.Raycaster,precision:1E-4,linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(b,c){c instanceof a.PerspectiveCamera?
(this.ray.origin.copy(c.position),this.ray.direction.set(b.x,b.y,.5).unproject(c).sub(c.position).normalize()):c instanceof a.OrthographicCamera?(this.ray.origin.set(b.x,b.y,-1).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld)):a.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(a,e){var f=[];c(a,this,f,e);f.sort(b);return f},intersectObjects:function(d,e){var f=[];if(!1===d instanceof Array)return a.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),
f;for(var g=0,h=d.length;g<h;g++)c(d[g],this,f,e);f.sort(b);return f}}})(THREE);
THREE.Object3D=function(){Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Object3D";this.parent=void 0;this.children=[];this.up=THREE.Object3D.DefaultUp.clone();var a=new THREE.Vector3,b=new THREE.Euler,c=new THREE.Quaternion,d=new THREE.Vector3(1,1,1);b.onChange(function(){c.setFromEuler(b,!1)});c.onChange(function(){b.setFromQuaternion(c,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,value:a},rotation:{enumerable:!0,
value:b},quaternion:{enumerable:!0,value:c},scale:{enumerable:!0,value:d}});this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixAutoUpdate=!0;this.matrixWorldNeedsUpdate=!1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={}};THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0);
THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrder(){THREE.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order.");return this.rotation.order},set eulerOrder(a){THREE.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order.");this.rotation.order=a},get useQuaternion(){THREE.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(a){THREE.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},
applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new THREE.Quaternion;return function(b,c){a.setFromAxisAngle(b,
c);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new THREE.Vector3;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));
return this}}(),translate:function(a,b){THREE.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(b,a)},translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,
b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new THREE.Matrix4;return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return THREE.error("THREE.Object3D.add: object can't be added as a child of itself.",
a),this;a instanceof THREE.Object3D?(void 0!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):THREE.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a);return this},remove:function(a){if(1<arguments.length)for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);b=this.children.indexOf(a);-1!==b&&(a.parent=void 0,a.dispatchEvent({type:"removed"}),this.children.splice(b,1))},getChildByName:function(a){THREE.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");
return this.getObjectByName(a)},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}},getWorldPosition:function(a){a=a||new THREE.Vector3;this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=
new THREE.Vector3,b=new THREE.Vector3;return function(c){c=c||new THREE.Quaternion;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,c,b);return c}}(),getWorldRotation:function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Euler;this.getWorldQuaternion(a);return b.setFromQuaternion(a,this.rotation.order,!1)}}(),getWorldScale:function(){var a=new THREE.Vector3,b=new THREE.Quaternion;return function(c){c=c||new THREE.Vector3;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,
b,c);return c}}(),getWorldDirection:function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Vector3;this.getWorldQuaternion(a);return b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverseVisible(a)}},traverseAncestors:function(a){this.parent&&(a(this.parent),
this.parent.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},
toJSON:function(){var a={metadata:{version:4.3,type:"Object",generator:"ObjectExporter"}},b={},c={},d=function(b){void 0===a.materials&&(a.materials=[]);if(void 0===c[b.uuid]){var d=b.toJSON();delete d.metadata;c[b.uuid]=d;a.materials.push(d)}return b.uuid},e=function(c){var g={};g.uuid=c.uuid;g.type=c.type;""!==c.name&&(g.name=c.name);"{}"!==JSON.stringify(c.userData)&&(g.userData=c.userData);!0!==c.visible&&(g.visible=c.visible);if(c instanceof THREE.PerspectiveCamera)g.fov=c.fov,g.aspect=c.aspect,
g.near=c.near,g.far=c.far;else if(c instanceof THREE.OrthographicCamera)g.left=c.left,g.right=c.right,g.top=c.top,g.bottom=c.bottom,g.near=c.near,g.far=c.far;else if(c instanceof THREE.AmbientLight)g.color=c.color.getHex();else if(c instanceof THREE.DirectionalLight)g.color=c.color.getHex(),g.intensity=c.intensity;else if(c instanceof THREE.PointLight)g.color=c.color.getHex(),g.intensity=c.intensity,g.distance=c.distance,g.decay=c.decay;else if(c instanceof THREE.SpotLight)g.color=c.color.getHex(),
g.intensity=c.intensity,g.distance=c.distance,g.angle=c.angle,g.exponent=c.exponent,g.decay=c.decay;else if(c instanceof THREE.HemisphereLight)g.color=c.color.getHex(),g.groundColor=c.groundColor.getHex();else if(c instanceof THREE.Mesh||c instanceof THREE.Line||c instanceof THREE.PointCloud){var h=c.geometry;void 0===a.geometries&&(a.geometries=[]);if(void 0===b[h.uuid]){var k=h.toJSON();delete k.metadata;b[h.uuid]=k;a.geometries.push(k)}g.geometry=h.uuid;g.material=d(c.material);c instanceof THREE.Line&&
(g.mode=c.mode)}else c instanceof THREE.Sprite&&(g.material=d(c.material));g.matrix=c.matrix.toArray();if(0<c.children.length)for(g.children=[],h=0;h<c.children.length;h++)g.children.push(e(c.children[h]));return g};a.object=e(this);return a},clone:function(a,b){void 0===a&&(a=new THREE.Object3D);void 0===b&&(b=!0);a.name=this.name;a.up.copy(this.up);a.position.copy(this.position);a.quaternion.copy(this.quaternion);a.scale.copy(this.scale);a.rotationAutoUpdate=this.rotationAutoUpdate;a.matrix.copy(this.matrix);
a.matrixWorld.copy(this.matrixWorld);a.matrixAutoUpdate=this.matrixAutoUpdate;a.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;a.visible=this.visible;a.castShadow=this.castShadow;a.receiveShadow=this.receiveShadow;a.frustumCulled=this.frustumCulled;a.userData=JSON.parse(JSON.stringify(this.userData));if(!0===b)for(var c=0;c<this.children.length;c++)a.add(this.children[c].clone());return a}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;
THREE.Face3=function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3;this.vertexNormals=d instanceof Array?d:[];this.color=e instanceof THREE.Color?e:new THREE.Color;this.vertexColors=e instanceof Array?e:[];this.vertexTangents=[];this.materialIndex=void 0!==f?f:0};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal);a.color.copy(this.color);a.materialIndex=this.materialIndex;for(var b=0,c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();return a}};
THREE.Face4=function(a,b,c,d,e,f,g){THREE.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new THREE.Face3(a,b,c,e,f,g)};THREE.BufferAttribute=function(a,b){this.array=a;this.itemSize=b;this.needsUpdate=!1};
THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get length(){return this.array.length},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},setX:function(a,b){this.array[a*this.itemSize]=b;return this},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},setXY:function(a,
b,c){a*=this.itemSize;this.array[a]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a*=this.itemSize;this.array[a]=b;this.array[a+1]=c;this.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a*=this.itemSize;this.array[a]=b;this.array[a+1]=c;this.array[a+2]=d;this.array[a+3]=e;return this},clone:function(){return new THREE.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}};
THREE.Int8Attribute=function(a,b){THREE.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};THREE.Uint8Attribute=function(a,b){THREE.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};
THREE.Uint8ClampedAttribute=function(a,b){THREE.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};THREE.Int16Attribute=function(a,b){THREE.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};
THREE.Uint16Attribute=function(a,b){THREE.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};THREE.Int32Attribute=function(a,b){THREE.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};
THREE.Uint32Attribute=function(a,b){THREE.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};THREE.Float32Attribute=function(a,b){THREE.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};
THREE.Float64Attribute=function(a,b){THREE.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new THREE.BufferAttribute(a,b)};THREE.DynamicBufferAttribute=function(a,b){THREE.BufferAttribute.call(this,a,b);this.updateRange={offset:0,count:-1}};THREE.DynamicBufferAttribute.prototype=Object.create(THREE.BufferAttribute.prototype);THREE.DynamicBufferAttribute.prototype.constructor=THREE.DynamicBufferAttribute;
THREE.DynamicBufferAttribute.prototype.clone=function(){return new THREE.DynamicBufferAttribute(new this.array.constructor(this.array),this.itemSize)};THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="BufferGeometry";this.attributes={};this.attributesKeys=[];this.offsets=this.drawcalls=[];this.boundingSphere=this.boundingBox=null};
THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(a,b,c){!1===b instanceof THREE.BufferAttribute?(THREE.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.attributes[a]={array:b,itemSize:c}):(this.attributes[a]=b,this.attributesKeys=Object.keys(this.attributes))},getAttribute:function(a){return this.attributes[a]},addDrawCall:function(a,b,c){this.drawcalls.push({start:a,count:b,index:void 0!==c?c:0})},applyMatrix:function(a){var b=
this.attributes.position;void 0!==b&&(a.applyToVector3Array(b.array),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new THREE.Matrix3).getNormalMatrix(a).applyToVector3Array(b.array),b.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere()},center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();this.applyMatrix((new THREE.Matrix4).setPosition(a));return a},fromGeometry:function(a,b){b=b||{vertexColors:THREE.NoColors};
var c=a.vertices,d=a.faces,e=a.faceVertexUvs,f=b.vertexColors,g=0<e[0].length,h=3==d[0].vertexNormals.length,k=new Float32Array(9*d.length);this.addAttribute("position",new THREE.BufferAttribute(k,3));var l=new Float32Array(9*d.length);this.addAttribute("normal",new THREE.BufferAttribute(l,3));if(f!==THREE.NoColors){var m=new Float32Array(9*d.length);this.addAttribute("color",new THREE.BufferAttribute(m,3))}if(!0===g){var v=new Float32Array(6*d.length);this.addAttribute("uv",new THREE.BufferAttribute(v,
2))}for(var q=0,y=0,x=0;q<d.length;q++,y+=6,x+=9){var w=d[q],z=c[w.a],u=c[w.b],B=c[w.c];k[x]=z.x;k[x+1]=z.y;k[x+2]=z.z;k[x+3]=u.x;k[x+4]=u.y;k[x+5]=u.z;k[x+6]=B.x;k[x+7]=B.y;k[x+8]=B.z;!0===h?(z=w.vertexNormals[0],u=w.vertexNormals[1],B=w.vertexNormals[2],l[x]=z.x,l[x+1]=z.y,l[x+2]=z.z,l[x+3]=u.x,l[x+4]=u.y,l[x+5]=u.z,l[x+6]=B.x,l[x+7]=B.y,l[x+8]=B.z):(z=w.normal,l[x]=z.x,l[x+1]=z.y,l[x+2]=z.z,l[x+3]=z.x,l[x+4]=z.y,l[x+5]=z.z,l[x+6]=z.x,l[x+7]=z.y,l[x+8]=z.z);f===THREE.FaceColors?(w=w.color,m[x]=
w.r,m[x+1]=w.g,m[x+2]=w.b,m[x+3]=w.r,m[x+4]=w.g,m[x+5]=w.b,m[x+6]=w.r,m[x+7]=w.g,m[x+8]=w.b):f===THREE.VertexColors&&(z=w.vertexColors[0],u=w.vertexColors[1],w=w.vertexColors[2],m[x]=z.r,m[x+1]=z.g,m[x+2]=z.b,m[x+3]=u.r,m[x+4]=u.g,m[x+5]=u.b,m[x+6]=w.r,m[x+7]=w.g,m[x+8]=w.b);!0===g&&(w=e[0][q][0],z=e[0][q][1],u=e[0][q][2],v[y]=w.x,v[y+1]=w.y,v[y+2]=z.x,v[y+3]=z.y,v[y+4]=u.x,v[y+5]=u.y)}this.computeBoundingSphere();return this},computeBoundingBox:function(){var a=new THREE.Vector3;return function(){null===
this.boundingBox&&(this.boundingBox=new THREE.Box3);var b=this.attributes.position.array;if(b){var c=this.boundingBox;c.makeEmpty();for(var d=0,e=b.length;d<e;d+=3)a.set(b[d],b[d+1],b[d+2]),c.expandByPoint(a)}if(void 0===b||0===b.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0);(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&THREE.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}(),
computeBoundingSphere:function(){var a=new THREE.Box3,b=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var c=this.attributes.position.array;if(c){a.makeEmpty();for(var d=this.boundingSphere.center,e=0,f=c.length;e<f;e+=3)b.set(c[e],c[e+1],c[e+2]),a.expandByPoint(b);a.center(d);for(var g=0,e=0,f=c.length;e<f;e+=3)b.set(c[e],c[e+1],c[e+2]),g=Math.max(g,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(g);isNaN(this.boundingSphere.radius)&&
THREE.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.attributes;if(a.position){var b=a.position.array;if(void 0===a.normal)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(b.length),3));else for(var c=a.normal.array,d=0,e=c.length;d<e;d++)c[d]=0;var c=a.normal.array,f,g,h,k=new THREE.Vector3,l=new THREE.Vector3,
m=new THREE.Vector3,v=new THREE.Vector3,q=new THREE.Vector3;if(a.index)for(var y=a.index.array,x=0<this.offsets.length?this.offsets:[{start:0,count:y.length,index:0}],w=0,z=x.length;w<z;++w){e=x[w].start;f=x[w].count;for(var u=x[w].index,d=e,e=e+f;d<e;d+=3)f=3*(u+y[d]),g=3*(u+y[d+1]),h=3*(u+y[d+2]),k.fromArray(b,f),l.fromArray(b,g),m.fromArray(b,h),v.subVectors(m,l),q.subVectors(k,l),v.cross(q),c[f]+=v.x,c[f+1]+=v.y,c[f+2]+=v.z,c[g]+=v.x,c[g+1]+=v.y,c[g+2]+=v.z,c[h]+=v.x,c[h+1]+=v.y,c[h+2]+=v.z}else for(d=
0,e=b.length;d<e;d+=9)k.fromArray(b,d),l.fromArray(b,d+3),m.fromArray(b,d+6),v.subVectors(m,l),q.subVectors(k,l),v.cross(q),c[d]=v.x,c[d+1]=v.y,c[d+2]=v.z,c[d+3]=v.x,c[d+4]=v.y,c[d+5]=v.z,c[d+6]=v.x,c[d+7]=v.y,c[d+8]=v.z;this.normalizeNormals();a.normal.needsUpdate=!0}},computeTangents:function(){function a(a,b,c){v.fromArray(d,3*a);q.fromArray(d,3*b);y.fromArray(d,3*c);x.fromArray(f,2*a);w.fromArray(f,2*b);z.fromArray(f,2*c);u=q.x-v.x;B=y.x-v.x;G=q.y-v.y;A=y.y-v.y;C=q.z-v.z;F=y.z-v.z;I=w.x-x.x;D=
z.x-x.x;H=w.y-x.y;E=z.y-x.y;L=1/(I*E-D*H);U.set((E*u-H*B)*L,(E*G-H*A)*L,(E*C-H*F)*L);O.set((I*B-D*u)*L,(I*A-D*G)*L,(I*F-D*C)*L);k[a].add(U);k[b].add(U);k[c].add(U);l[a].add(O);l[b].add(O);l[c].add(O)}function b(a){da.fromArray(e,3*a);K.copy(da);ia=k[a];ja.copy(ia);ja.sub(da.multiplyScalar(da.dot(ia))).normalize();pa.crossVectors(K,ia);ta=pa.dot(l[a]);ra=0>ta?-1:1;h[4*a]=ja.x;h[4*a+1]=ja.y;h[4*a+2]=ja.z;h[4*a+3]=ra}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||
void 0===this.attributes.uv)THREE.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var c=this.attributes.index.array,d=this.attributes.position.array,e=this.attributes.normal.array,f=this.attributes.uv.array,g=d.length/3;void 0===this.attributes.tangent&&this.addAttribute("tangent",new THREE.BufferAttribute(new Float32Array(4*g),4));for(var h=this.attributes.tangent.array,k=[],l=[],m=0;m<g;m++)k[m]=new THREE.Vector3,
l[m]=new THREE.Vector3;var v=new THREE.Vector3,q=new THREE.Vector3,y=new THREE.Vector3,x=new THREE.Vector2,w=new THREE.Vector2,z=new THREE.Vector2,u,B,G,A,C,F,I,D,H,E,L,U=new THREE.Vector3,O=new THREE.Vector3,J,P,T,S,R;0===this.drawcalls.length&&this.addDrawCall(0,c.length,0);var ba=this.drawcalls,m=0;for(P=ba.length;m<P;++m){J=ba[m].start;T=ba[m].count;var N=ba[m].index,g=J;for(J+=T;g<J;g+=3)T=N+c[g],S=N+c[g+1],R=N+c[g+2],a(T,S,R)}var ja=new THREE.Vector3,pa=new THREE.Vector3,da=new THREE.Vector3,
K=new THREE.Vector3,ra,ia,ta,m=0;for(P=ba.length;m<P;++m)for(J=ba[m].start,T=ba[m].count,N=ba[m].index,g=J,J+=T;g<J;g+=3)T=N+c[g],S=N+c[g+1],R=N+c[g+2],b(T),b(S),b(R)}},computeOffsets:function(a){void 0===a&&(a=65535);for(var b=this.attributes.index.array,c=this.attributes.position.array,d=b.length/3,e=new Uint16Array(b.length),f=0,g=0,h=[{start:0,count:0,index:0}],k=h[0],l=0,m=0,v=new Int32Array(6),q=new Int32Array(c.length),y=new Int32Array(c.length),x=0;x<c.length;x++)q[x]=-1,y[x]=-1;for(c=0;c<
d;c++){for(var w=m=0;3>w;w++)x=b[3*c+w],-1==q[x]?(v[2*w]=x,v[2*w+1]=-1,m++):q[x]<k.index?(v[2*w]=x,v[2*w+1]=-1,l++):(v[2*w]=x,v[2*w+1]=q[x]);if(g+m>k.index+a)for(k={start:f,count:0,index:g},h.push(k),m=0;6>m;m+=2)w=v[m+1],-1<w&&w<k.index&&(v[m+1]=-1);for(m=0;6>m;m+=2)x=v[m],w=v[m+1],-1===w&&(w=g++),q[x]=w,y[w]=x,e[f++]=w-k.index,k.count++}this.reorderBuffers(e,y,g);return this.drawcalls=this.offsets=h},merge:function(a,b){if(!1===a instanceof THREE.BufferGeometry)THREE.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",
a);else{void 0===b&&(b=0);var c=this.attributes,d;for(d in c)if(void 0!==a.attributes[d])for(var e=c[d].array,f=a.attributes[d],g=f.array,h=0,f=f.itemSize*b;h<g.length;h++,f++)e[f]=g[h];return this}},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,c,d,e=0,f=a.length;e<f;e+=3)b=a[e],c=a[e+1],d=a[e+2],b=1/Math.sqrt(b*b+c*c+d*d),a[e]*=b,a[e+1]*=b,a[e+2]*=b},reorderBuffers:function(a,b,c){var d={},e;for(e in this.attributes)"index"!=e&&(d[e]=new this.attributes[e].array.constructor(this.attributes[e].itemSize*
c));for(var f=0;f<c;f++){var g=b[f];for(e in this.attributes)if("index"!=e)for(var h=this.attributes[e].array,k=this.attributes[e].itemSize,l=d[e],m=0;m<k;m++)l[f*k+m]=h[g*k+m]}this.attributes.index.array=a;for(e in this.attributes)"index"!=e&&(this.attributes[e].array=d[e],this.attributes[e].numItems=this.attributes[e].itemSize*c)},toJSON:function(){var a={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type,data:{attributes:{}}},b=this.attributes,
c=this.offsets,d=this.boundingSphere,e;for(e in b){var f=b[e],g=Array.prototype.slice.call(f.array);a.data.attributes[e]={itemSize:f.itemSize,type:f.array.constructor.name,array:g}}0<c.length&&(a.data.offsets=JSON.parse(JSON.stringify(c)));null!==d&&(a.data.boundingSphere={center:d.center.toArray(),radius:d.radius});return a},clone:function(){var a=new THREE.BufferGeometry,b;for(b in this.attributes)a.addAttribute(b,this.attributes[b].clone());b=0;for(var c=this.offsets.length;b<c;b++){var d=this.offsets[b];
a.offsets.push({start:d.start,index:d.index,count:d.count})}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);
THREE.Geometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=
this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(a){for(var b=(new THREE.Matrix3).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){a=this.faces[c];a.normal.applyMatrix3(b).normalize();for(var e=0,f=a.vertexNormals.length;e<f;e++)a.vertexNormals[e].applyMatrix3(b).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();this.normalsNeedUpdate=
this.verticesNeedUpdate=!0},fromBufferGeometry:function(a){for(var b=this,c=a.attributes,d=c.position.array,e=void 0!==c.index?c.index.array:void 0,f=void 0!==c.normal?c.normal.array:void 0,g=void 0!==c.color?c.color.array:void 0,h=void 0!==c.uv?c.uv.array:void 0,k=[],l=[],m=c=0;c<d.length;c+=3,m+=2)b.vertices.push(new THREE.Vector3(d[c],d[c+1],d[c+2])),void 0!==f&&k.push(new THREE.Vector3(f[c],f[c+1],f[c+2])),void 0!==g&&b.colors.push(new THREE.Color(g[c],g[c+1],g[c+2])),void 0!==h&&l.push(new THREE.Vector2(h[m],
h[m+1]));var v=function(a,c,d){var e=void 0!==f?[k[a].clone(),k[c].clone(),k[d].clone()]:[],m=void 0!==g?[b.colors[a].clone(),b.colors[c].clone(),b.colors[d].clone()]:[];b.faces.push(new THREE.Face3(a,c,d,e,m));void 0!==h&&b.faceVertexUvs[0].push([l[a].clone(),l[c].clone(),l[d].clone()])};if(void 0!==e)if(d=a.drawcalls,0<d.length)for(c=0;c<d.length;c++)for(var m=d[c],q=m.start,y=m.count,x=m.index,m=q,q=q+y;m<q;m+=3)v(x+e[m],x+e[m+1],x+e[m+2]);else for(c=0;c<e.length;c+=3)v(e[c],e[c+1],e[c+2]);else for(c=
0;c<d.length/3;c+=3)v(c,c+1,c+2);this.computeFaceNormals();null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this},center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();this.applyMatrix((new THREE.Matrix4).setPosition(a));return a},computeFaceNormals:function(){for(var a=new THREE.Vector3,b=new THREE.Vector3,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],f=this.vertices[e.a],
g=this.vertices[e.b];a.subVectors(this.vertices[e.c],g);b.subVectors(f,g);a.cross(b);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(a){var b,c,d;d=Array(this.vertices.length);b=0;for(c=this.vertices.length;b<c;b++)d[b]=new THREE.Vector3;if(a){var e,f,g,h=new THREE.Vector3,k=new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],e=this.vertices[c.a],f=this.vertices[c.b],g=this.vertices[c.c],h.subVectors(g,f),k.subVectors(e,f),h.cross(k),d[c.a].add(h),d[c.b].add(h),d[c.c].add(h)}else for(a=
0,b=this.faces.length;a<b;a++)c=this.faces[a],d[c.a].add(c.normal),d[c.b].add(c.normal),d[c.c].add(c.normal);b=0;for(c=this.vertices.length;b<c;b++)d[b].normalize();a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.vertexNormals[0]=d[c.a].clone(),c.vertexNormals[1]=d[c.b].clone(),c.vertexNormals[2]=d[c.c].clone()},computeMorphNormals:function(){var a,b,c,d,e;c=0;for(d=this.faces.length;c<d;c++)for(e=this.faces[c],e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=
e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]),a=0,b=e.vertexNormals.length;a<b;a++)e.__originalVertexNormals[a]?e.__originalVertexNormals[a].copy(e.vertexNormals[a]):e.__originalVertexNormals[a]=e.vertexNormals[a].clone();var f=new THREE.Geometry;f.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];e=this.morphNormals[a].faceNormals;var g=
this.morphNormals[a].vertexNormals,h,k;c=0;for(d=this.faces.length;c<d;c++)h=new THREE.Vector3,k={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},e.push(h),g.push(k)}g=this.morphNormals[a];f.vertices=this.morphTargets[a].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],h=g.faceNormals[c],k=g.vertexNormals[c],h.copy(e.normal),k.a.copy(e.vertexNormals[0]),k.b.copy(e.vertexNormals[1]),k.c.copy(e.vertexNormals[2])}c=0;for(d=this.faces.length;c<
d;c++)e=this.faces[c],e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeTangents:function(){var a,b,c,d,e,f,g,h,k,l,m,v,q,y,x,w,z,u=[],B=[];c=new THREE.Vector3;var G=new THREE.Vector3,A=new THREE.Vector3,C=new THREE.Vector3,F=new THREE.Vector3;a=0;for(b=this.vertices.length;a<b;a++)u[a]=new THREE.Vector3,B[a]=new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)e=this.faces[a],f=this.faceVertexUvs[0][a],d=e.a,z=e.b,e=e.c,g=this.vertices[d],h=this.vertices[z],k=this.vertices[e],
l=f[0],m=f[1],v=f[2],f=h.x-g.x,q=k.x-g.x,y=h.y-g.y,x=k.y-g.y,h=h.z-g.z,g=k.z-g.z,k=m.x-l.x,w=v.x-l.x,m=m.y-l.y,l=v.y-l.y,v=1/(k*l-w*m),c.set((l*f-m*q)*v,(l*y-m*x)*v,(l*h-m*g)*v),G.set((k*q-w*f)*v,(k*x-w*y)*v,(k*g-w*h)*v),u[d].add(c),u[z].add(c),u[e].add(c),B[d].add(G),B[z].add(G),B[e].add(G);G=["a","b","c","d"];a=0;for(b=this.faces.length;a<b;a++)for(e=this.faces[a],c=0;c<Math.min(e.vertexNormals.length,3);c++)F.copy(e.vertexNormals[c]),d=e[G[c]],z=u[d],A.copy(z),A.sub(F.multiplyScalar(F.dot(z))).normalize(),
C.crossVectors(e.vertexNormals[c],z),d=C.dot(B[d]),d=0>d?-1:1,e.vertexTangents[c]=new THREE.Vector4(A.x,A.y,A.z,d);this.hasTangents=!0},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,d=b.length;c<d;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);
this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,b,c){if(!1===a instanceof THREE.Geometry)THREE.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a);else{var d,e=this.vertices.length,f=this.vertices,g=a.vertices,h=this.faces,k=a.faces,l=this.faceVertexUvs[0];a=a.faceVertexUvs[0];void 0===c&&(c=0);void 0!==b&&(d=(new THREE.Matrix3).getNormalMatrix(b));for(var m=0,v=g.length;m<v;m++){var q=g[m].clone();void 0!==b&&q.applyMatrix4(b);f.push(q)}m=0;for(v=k.length;m<
v;m++){var g=k[m],y,x=g.vertexNormals,w=g.vertexColors,q=new THREE.Face3(g.a+e,g.b+e,g.c+e);q.normal.copy(g.normal);void 0!==d&&q.normal.applyMatrix3(d).normalize();b=0;for(f=x.length;b<f;b++)y=x[b].clone(),void 0!==d&&y.applyMatrix3(d).normalize(),q.vertexNormals.push(y);q.color.copy(g.color);b=0;for(f=w.length;b<f;b++)y=w[b],q.vertexColors.push(y.clone());q.materialIndex=g.materialIndex+c;h.push(q)}m=0;for(v=a.length;m<v;m++)if(c=a[m],d=[],void 0!==c){b=0;for(f=c.length;b<f;b++)d.push(c[b].clone());
l.push(d)}}},mergeMesh:function(a){!1===a instanceof THREE.Mesh?THREE.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",a):(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,a.matrix))},mergeVertices:function(){var a={},b=[],c=[],d,e=Math.pow(10,4),f,g;f=0;for(g=this.vertices.length;f<g;f++)d=this.vertices[f],d=Math.round(d.x*e)+"_"+Math.round(d.y*e)+"_"+Math.round(d.z*e),void 0===a[d]?(a[d]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[d]];a=[];f=0;for(g=this.faces.length;f<
g;f++)for(e=this.faces[f],e.a=c[e.a],e.b=c[e.b],e.c=c[e.c],e=[e.a,e.b,e.c],d=0;3>d;d++)if(e[d]==e[(d+1)%3]){a.push(f);break}for(f=a.length-1;0<=f;f--)for(e=a[f],this.faces.splice(e,1),c=0,g=this.faceVertexUvs.length;c<g;c++)this.faceVertexUvs[c].splice(e,1);f=this.vertices.length-b.length;this.vertices=b;return f},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==l[b])return l[b];l[b]=k.length/3;k.push(a.x,a.y,
a.z);return l[b]}function c(a){var b=a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==v[b])return v[b];v[b]=m.length;m.push(a.getHex());return v[b]}function d(a){var b=a.x.toString()+a.y.toString();if(void 0!==y[b])return y[b];y[b]=q.length/2;q.push(a.x,a.y);return y[b]}var e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type};""!==this.name&&(e.name=this.name);if(void 0!==this.parameters){var f=this.parameters,g;for(g in f)void 0!==
f[g]&&(e[g]=f[g]);return e}f=[];for(g=0;g<this.vertices.length;g++){var h=this.vertices[g];f.push(h.x,h.y,h.z)}var h=[],k=[],l={},m=[],v={},q=[],y={};for(g=0;g<this.faces.length;g++){var x=this.faces[g],w=void 0!==this.faceVertexUvs[0][g],z=0<x.normal.length(),u=0<x.vertexNormals.length,B=1!==x.color.r||1!==x.color.g||1!==x.color.b,G=0<x.vertexColors.length,A=0,A=a(A,0,0),A=a(A,1,!1),A=a(A,2,!1),A=a(A,3,w),A=a(A,4,z),A=a(A,5,u),A=a(A,6,B),A=a(A,7,G);h.push(A);h.push(x.a,x.b,x.c);w&&(w=this.faceVertexUvs[0][g],
h.push(d(w[0]),d(w[1]),d(w[2])));z&&h.push(b(x.normal));u&&(z=x.vertexNormals,h.push(b(z[0]),b(z[1]),b(z[2])));B&&h.push(c(x.color));G&&(x=x.vertexColors,h.push(c(x[0]),c(x[1]),c(x[2])))}e.data={};e.data.vertices=f;e.data.normals=k;0<m.length&&(e.data.colors=m);0<q.length&&(e.data.uvs=[q]);e.data.faces=h;return e},clone:function(){for(var a=new THREE.Geometry,b=this.vertices,c=0,d=b.length;c<d;c++)a.vertices.push(b[c].clone());b=this.faces;c=0;for(d=b.length;c<d;c++)a.faces.push(b[c].clone());c=0;
for(d=this.faceVertexUvs.length;c<d;c++){b=this.faceVertexUvs[c];void 0===a.faceVertexUvs[c]&&(a.faceVertexUvs[c]=[]);for(var e=0,f=b.length;e<f;e++){for(var g=b[e],h=[],k=0,l=g.length;k<l;k++)h.push(g[k].clone());a.faceVertexUvs[c].push(h)}}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount=0;
THREE.Camera=function(){THREE.Object3D.call(this);this.type="Camera";this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.constructor=THREE.Camera;THREE.Camera.prototype.getWorldDirection=function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Vector3;this.getWorldQuaternion(a);return b.set(0,0,-1).applyQuaternion(a)}}();
THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4;return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();THREE.Camera.prototype.clone=function(a){void 0===a&&(a=new THREE.Camera);THREE.Object3D.prototype.clone.call(this,a);a.matrixWorldInverse.copy(this.matrixWorldInverse);a.projectionMatrix.copy(this.projectionMatrix);return a};
THREE.CubeCamera=function(a,b,c){THREE.Object3D.call(this);this.type="CubeCamera";var d=new THREE.PerspectiveCamera(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new THREE.Vector3(1,0,0));this.add(d);var e=new THREE.PerspectiveCamera(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new THREE.Vector3(-1,0,0));this.add(e);var f=new THREE.PerspectiveCamera(90,1,a,b);f.up.set(0,0,1);f.lookAt(new THREE.Vector3(0,1,0));this.add(f);var g=new THREE.PerspectiveCamera(90,1,a,b);g.up.set(0,0,-1);g.lookAt(new THREE.Vector3(0,-1,0));
this.add(g);var h=new THREE.PerspectiveCamera(90,1,a,b);h.up.set(0,-1,0);h.lookAt(new THREE.Vector3(0,0,1));this.add(h);var k=new THREE.PerspectiveCamera(90,1,a,b);k.up.set(0,-1,0);k.lookAt(new THREE.Vector3(0,0,-1));this.add(k);this.renderTarget=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(a,b){var c=this.renderTarget,q=c.generateMipmaps;c.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,d,c);c.activeCubeFace=
1;a.render(b,e,c);c.activeCubeFace=2;a.render(b,f,c);c.activeCubeFace=3;a.render(b,g,c);c.activeCubeFace=4;a.render(b,h,c);c.generateMipmaps=q;c.activeCubeFace=5;a.render(b,k,c)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CubeCamera.prototype.constructor=THREE.CubeCamera;
THREE.OrthographicCamera=function(a,b,c,d,e,f){THREE.Camera.call(this);this.type="OrthographicCamera";this.zoom=1;this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera;
THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(c-a,c+a,d+b,d-b,this.near,this.far)};
THREE.OrthographicCamera.prototype.clone=function(){var a=new THREE.OrthographicCamera;THREE.Camera.prototype.clone.call(this,a);a.zoom=this.zoom;a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.near=this.near;a.far=this.far;a.projectionMatrix.copy(this.projectionMatrix);return a};
THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this);this.type="PerspectiveCamera";this.zoom=1;this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:.1;this.far=void 0!==d?d:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera;
THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,e,f){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=d;this.width=e;this.height=f;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var a=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var b=this.fullWidth/this.fullHeight,a=Math.tan(THREE.Math.degToRad(.5*a))*this.near,c=-a,d=b*c,b=Math.abs(b*a-d),c=Math.abs(a-c);this.projectionMatrix.makeFrustum(d+this.x*b/this.fullWidth,d+(this.x+this.width)*b/this.fullWidth,a-(this.y+this.height)*c/this.fullHeight,a-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(a,
this.aspect,this.near,this.far)};THREE.PerspectiveCamera.prototype.clone=function(){var a=new THREE.PerspectiveCamera;THREE.Camera.prototype.clone.call(this,a);a.zoom=this.zoom;a.fov=this.fov;a.aspect=this.aspect;a.near=this.near;a.far=this.far;a.projectionMatrix.copy(this.projectionMatrix);return a};THREE.Light=function(a){THREE.Object3D.call(this);this.type="Light";this.color=new THREE.Color(a)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.constructor=THREE.Light;
THREE.Light.prototype.clone=function(a){void 0===a&&(a=new THREE.Light);THREE.Object3D.prototype.clone.call(this,a);a.color.copy(this.color);return a};THREE.AmbientLight=function(a){THREE.Light.call(this,a);this.type="AmbientLight"};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.constructor=THREE.AmbientLight;THREE.AmbientLight.prototype.clone=function(){var a=new THREE.AmbientLight;THREE.Light.prototype.clone.call(this,a);return a};
THREE.AreaLight=function(a,b){THREE.Light.call(this,a);this.type="AreaLight";this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=void 0!==b?b:1;this.height=this.width=1;this.constantAttenuation=1.5;this.linearAttenuation=.5;this.quadraticAttenuation=.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);THREE.AreaLight.prototype.constructor=THREE.AreaLight;
THREE.DirectionalLight=function(a,b){THREE.Light.call(this,a);this.type="DirectionalLight";this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=!1;
this.shadowCascadeOffset=new THREE.Vector3(0,0,-1E3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,.99,.998];this.shadowCascadeFarZ=[.99,.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight;
THREE.DirectionalLight.prototype.clone=function(){var a=new THREE.DirectionalLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;a.shadowCameraNear=this.shadowCameraNear;a.shadowCameraFar=this.shadowCameraFar;a.shadowCameraLeft=this.shadowCameraLeft;a.shadowCameraRight=this.shadowCameraRight;a.shadowCameraTop=this.shadowCameraTop;a.shadowCameraBottom=this.shadowCameraBottom;a.shadowCameraVisible=
this.shadowCameraVisible;a.shadowBias=this.shadowBias;a.shadowDarkness=this.shadowDarkness;a.shadowMapWidth=this.shadowMapWidth;a.shadowMapHeight=this.shadowMapHeight;a.shadowCascade=this.shadowCascade;a.shadowCascadeOffset.copy(this.shadowCascadeOffset);a.shadowCascadeCount=this.shadowCascadeCount;a.shadowCascadeBias=this.shadowCascadeBias.slice(0);a.shadowCascadeWidth=this.shadowCascadeWidth.slice(0);a.shadowCascadeHeight=this.shadowCascadeHeight.slice(0);a.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0);
a.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0);return a};THREE.HemisphereLight=function(a,b,c){THREE.Light.call(this,a);this.type="HemisphereLight";this.position.set(0,100,0);this.groundColor=new THREE.Color(b);this.intensity=void 0!==c?c:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);THREE.HemisphereLight.prototype.constructor=THREE.HemisphereLight;
THREE.HemisphereLight.prototype.clone=function(){var a=new THREE.HemisphereLight;THREE.Light.prototype.clone.call(this,a);a.groundColor.copy(this.groundColor);a.intensity=this.intensity;return a};THREE.PointLight=function(a,b,c,d){THREE.Light.call(this,a);this.type="PointLight";this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.decay=void 0!==d?d:1};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);THREE.PointLight.prototype.constructor=THREE.PointLight;
THREE.PointLight.prototype.clone=function(){var a=new THREE.PointLight;THREE.Light.prototype.clone.call(this,a);a.intensity=this.intensity;a.distance=this.distance;a.decay=this.decay;return a};
THREE.SpotLight=function(a,b,c,d,e,f){THREE.Light.call(this,a);this.type="SpotLight";this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/3;this.exponent=void 0!==e?e:10;this.decay=void 0!==f?f:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=.5;this.shadowMapHeight=this.shadowMapWidth=
512;this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.constructor=THREE.SpotLight;
THREE.SpotLight.prototype.clone=function(){var a=new THREE.SpotLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.distance=this.distance;a.angle=this.angle;a.exponent=this.exponent;a.decay=this.decay;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;a.shadowCameraNear=this.shadowCameraNear;a.shadowCameraFar=this.shadowCameraFar;a.shadowCameraFov=this.shadowCameraFov;a.shadowCameraVisible=this.shadowCameraVisible;a.shadowBias=this.shadowBias;
a.shadowDarkness=this.shadowDarkness;a.shadowMapWidth=this.shadowMapWidth;a.shadowMapHeight=this.shadowMapHeight;return a};THREE.Cache={files:{},add:function(a,b){this.files[a]=b},get:function(a){return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};
THREE.Loader=function(a){this.statusDomElement=(this.showStatus=a)?THREE.Loader.prototype.addStatusElement():null;this.imageLoader=new THREE.ImageLoader;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,addStatusElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign="left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1E3;a.innerHTML="Loading ...";return a},updateProgress:function(a){var b="Loaded ",b=a.total?b+((100*a.loaded/a.total).toFixed(0)+
"%"):b+((a.loaded/1024).toFixed(2)+" KB");this.statusDomElement.innerHTML=b},extractUrlBase:function(a){a=a.split("/");if(1===a.length)return"./";a.pop();return a.join("/")+"/"},initMaterials:function(a,b){for(var c=[],d=0;d<a.length;++d)c[d]=this.createMaterial(a[d],b);return c},needsTangents:function(a){for(var b=0,c=a.length;b<c;b++)if(a[b]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(a,b){function c(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function d(a,
d,e,g,h,k,w){var z=b+e,u,B=THREE.Loader.Handlers.get(z);null!==B?u=B.load(z):(u=new THREE.Texture,B=f.imageLoader,B.crossOrigin=f.crossOrigin,B.load(z,function(a){if(!1===THREE.Math.isPowerOfTwo(a.width)||!1===THREE.Math.isPowerOfTwo(a.height)){var b=c(a.width),d=c(a.height),e=document.createElement("canvas");e.width=b;e.height=d;e.getContext("2d").drawImage(a,0,0,b,d);u.image=e}else u.image=a;u.needsUpdate=!0}));u.sourceFile=e;g&&(u.repeat.set(g[0],g[1]),1!==g[0]&&(u.wrapS=THREE.RepeatWrapping),
1!==g[1]&&(u.wrapT=THREE.RepeatWrapping));h&&u.offset.set(h[0],h[1]);k&&(e={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==e[k[0]]&&(u.wrapS=e[k[0]]),void 0!==e[k[1]]&&(u.wrapT=e[k[1]]));w&&(u.anisotropy=w);a[d]=u}function e(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var f=this,g="MeshLambertMaterial",h={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(a.shading){var k=a.shading.toLowerCase();"phong"===k?g="MeshPhongMaterial":
"basic"===k&&(g="MeshBasicMaterial")}void 0!==a.blending&&void 0!==THREE[a.blending]&&(h.blending=THREE[a.blending]);void 0!==a.transparent&&(h.transparent=a.transparent);void 0!==a.opacity&&1>a.opacity&&(h.transparent=!0);void 0!==a.depthTest&&(h.depthTest=a.depthTest);void 0!==a.depthWrite&&(h.depthWrite=a.depthWrite);void 0!==a.visible&&(h.visible=a.visible);void 0!==a.flipSided&&(h.side=THREE.BackSide);void 0!==a.doubleSided&&(h.side=THREE.DoubleSide);void 0!==a.wireframe&&(h.wireframe=a.wireframe);
void 0!==a.vertexColors&&("face"===a.vertexColors?h.vertexColors=THREE.FaceColors:a.vertexColors&&(h.vertexColors=THREE.VertexColors));a.colorDiffuse?h.color=e(a.colorDiffuse):a.DbgColor&&(h.color=a.DbgColor);a.colorSpecular&&(h.specular=e(a.colorSpecular));a.colorEmissive&&(h.emissive=e(a.colorEmissive));void 0!==a.transparency&&(console.warn("THREE.Loader: transparency has been renamed to opacity"),a.opacity=a.transparency);void 0!==a.opacity&&(h.opacity=a.opacity);a.specularCoef&&(h.shininess=
a.specularCoef);a.mapDiffuse&&b&&d(h,"map",a.mapDiffuse,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,a.mapDiffuseAnisotropy);a.mapLight&&b&&d(h,"lightMap",a.mapLight,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy);a.mapBump&&b&&d(h,"bumpMap",a.mapBump,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,a.mapBumpAnisotropy);a.mapNormal&&b&&d(h,"normalMap",a.mapNormal,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy);a.mapSpecular&&b&&d(h,"specularMap",
a.mapSpecular,a.mapSpecularRepeat,a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy);a.mapAlpha&&b&&d(h,"alphaMap",a.mapAlpha,a.mapAlphaRepeat,a.mapAlphaOffset,a.mapAlphaWrap,a.mapAlphaAnisotropy);a.mapBumpScale&&(h.bumpScale=a.mapBumpScale);a.mapNormalFactor&&(h.normalScale=new THREE.Vector2(a.mapNormalFactor,a.mapNormalFactor));g=new THREE[g](h);void 0!==a.DbgName&&(g.name=a.DbgName);return g}};
THREE.Loader.Handlers={handlers:[],add:function(a,b){this.handlers.push(a,b)},get:function(a){for(var b=0,c=this.handlers.length;b<c;b+=2){var d=this.handlers[b+1];if(this.handlers[b].test(a))return d}return null}};THREE.XHRLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(a,b,c,d){var e=this,f=THREE.Cache.get(a);void 0!==f?b&&b(f):(f=new XMLHttpRequest,f.open("GET",a,!0),f.addEventListener("load",function(c){THREE.Cache.add(a,this.response);b&&b(this.response);e.manager.itemEnd(a)},!1),void 0!==c&&f.addEventListener("progress",function(a){c(a)},!1),void 0!==d&&f.addEventListener("error",function(a){d(a)},!1),void 0!==this.crossOrigin&&(f.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(f.responseType=
this.responseType),f.send(null),e.manager.itemStart(a))},setResponseType:function(a){this.responseType=a},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.ImageLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(a,b,c,d){var e=this,f=THREE.Cache.get(a);if(void 0!==f)b(f);else return f=document.createElement("img"),f.addEventListener("load",function(c){THREE.Cache.add(a,this);b&&b(this);e.manager.itemEnd(a)},!1),void 0!==c&&f.addEventListener("progress",function(a){c(a)},!1),void 0!==d&&f.addEventListener("error",function(a){d(a)},!1),void 0!==this.crossOrigin&&(f.crossOrigin=this.crossOrigin),f.src=a,e.manager.itemStart(a),f},setCrossOrigin:function(a){this.crossOrigin=
a}};THREE.JSONLoader=function(a){THREE.Loader.call(this,a);this.withCredentials=!1};THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype);THREE.JSONLoader.prototype.constructor=THREE.JSONLoader;THREE.JSONLoader.prototype.load=function(a,b,c){c=c&&"string"===typeof c?c:this.extractUrlBase(a);this.onLoadStart();this.loadAjaxJSON(this,a,b,c)};
THREE.JSONLoader.prototype.loadAjaxJSON=function(a,b,c,d,e){var f=new XMLHttpRequest,g=0;f.onreadystatechange=function(){if(f.readyState===f.DONE)if(200===f.status||0===f.status){if(f.responseText){var h=JSON.parse(f.responseText),k=h.metadata;if(void 0!==k){if("object"===k.type){THREE.error("THREE.JSONLoader: "+b+" should be loaded with THREE.ObjectLoader instead.");return}if("scene"===k.type){THREE.error("THREE.JSONLoader: "+b+" seems to be a Scene. Use THREE.SceneLoader instead.");return}}h=a.parse(h,
d);c(h.geometry,h.materials)}else THREE.error("THREE.JSONLoader: "+b+" seems to be unreachable or the file is empty.");a.onLoadComplete()}else THREE.error("THREE.JSONLoader: Couldn't load "+b+" ("+f.status+")");else f.readyState===f.LOADING?e&&(0===g&&(g=f.getResponseHeader("Content-Length")),e({total:g,loaded:f.responseText.length})):f.readyState===f.HEADERS_RECEIVED&&void 0!==e&&(g=f.getResponseHeader("Content-Length"))};f.open("GET",b,!0);f.withCredentials=this.withCredentials;f.send(null)};
THREE.JSONLoader.prototype.parse=function(a,b){var c=new THREE.Geometry,d=void 0!==a.scale?1/a.scale:1;(function(b){var d,g,h,k,l,m,v,q,y,x,w,z,u,B=a.faces;m=a.vertices;var G=a.normals,A=a.colors,C=0;if(void 0!==a.uvs){for(d=0;d<a.uvs.length;d++)a.uvs[d].length&&C++;for(d=0;d<C;d++)c.faceVertexUvs[d]=[]}k=0;for(l=m.length;k<l;)d=new THREE.Vector3,d.x=m[k++]*b,d.y=m[k++]*b,d.z=m[k++]*b,c.vertices.push(d);k=0;for(l=B.length;k<l;)if(b=B[k++],y=b&1,h=b&2,d=b&8,v=b&16,x=b&32,m=b&64,b&=128,y){y=new THREE.Face3;
y.a=B[k];y.b=B[k+1];y.c=B[k+3];w=new THREE.Face3;w.a=B[k+1];w.b=B[k+2];w.c=B[k+3];k+=4;h&&(h=B[k++],y.materialIndex=h,w.materialIndex=h);h=c.faces.length;if(d)for(d=0;d<C;d++)for(z=a.uvs[d],c.faceVertexUvs[d][h]=[],c.faceVertexUvs[d][h+1]=[],g=0;4>g;g++)q=B[k++],u=z[2*q],q=z[2*q+1],u=new THREE.Vector2(u,q),2!==g&&c.faceVertexUvs[d][h].push(u),0!==g&&c.faceVertexUvs[d][h+1].push(u);v&&(v=3*B[k++],y.normal.set(G[v++],G[v++],G[v]),w.normal.copy(y.normal));if(x)for(d=0;4>d;d++)v=3*B[k++],x=new THREE.Vector3(G[v++],
G[v++],G[v]),2!==d&&y.vertexNormals.push(x),0!==d&&w.vertexNormals.push(x);m&&(m=B[k++],m=A[m],y.color.setHex(m),w.color.setHex(m));if(b)for(d=0;4>d;d++)m=B[k++],m=A[m],2!==d&&y.vertexColors.push(new THREE.Color(m)),0!==d&&w.vertexColors.push(new THREE.Color(m));c.faces.push(y);c.faces.push(w)}else{y=new THREE.Face3;y.a=B[k++];y.b=B[k++];y.c=B[k++];h&&(h=B[k++],y.materialIndex=h);h=c.faces.length;if(d)for(d=0;d<C;d++)for(z=a.uvs[d],c.faceVertexUvs[d][h]=[],g=0;3>g;g++)q=B[k++],u=z[2*q],q=z[2*q+1],
u=new THREE.Vector2(u,q),c.faceVertexUvs[d][h].push(u);v&&(v=3*B[k++],y.normal.set(G[v++],G[v++],G[v]));if(x)for(d=0;3>d;d++)v=3*B[k++],x=new THREE.Vector3(G[v++],G[v++],G[v]),y.vertexNormals.push(x);m&&(m=B[k++],y.color.setHex(A[m]));if(b)for(d=0;3>d;d++)m=B[k++],y.vertexColors.push(new THREE.Color(A[m]));c.faces.push(y)}})(d);(function(){var b=void 0!==a.influencesPerVertex?a.influencesPerVertex:2;if(a.skinWeights)for(var d=0,g=a.skinWeights.length;d<g;d+=b)c.skinWeights.push(new THREE.Vector4(a.skinWeights[d],
1<b?a.skinWeights[d+1]:0,2<b?a.skinWeights[d+2]:0,3<b?a.skinWeights[d+3]:0));if(a.skinIndices)for(d=0,g=a.skinIndices.length;d<g;d+=b)c.skinIndices.push(new THREE.Vector4(a.skinIndices[d],1<b?a.skinIndices[d+1]:0,2<b?a.skinIndices[d+2]:0,3<b?a.skinIndices[d+3]:0));c.bones=a.bones;c.bones&&0<c.bones.length&&(c.skinWeights.length!==c.skinIndices.length||c.skinIndices.length!==c.vertices.length)&&THREE.warn("THREE.JSONLoader: When skinning, number of vertices ("+c.vertices.length+"), skinIndices ("+
c.skinIndices.length+"), and skinWeights ("+c.skinWeights.length+") should match.");c.animation=a.animation;c.animations=a.animations})();(function(b){if(void 0!==a.morphTargets){var d,g,h,k,l,m;d=0;for(g=a.morphTargets.length;d<g;d++)for(c.morphTargets[d]={},c.morphTargets[d].name=a.morphTargets[d].name,c.morphTargets[d].vertices=[],l=c.morphTargets[d].vertices,m=a.morphTargets[d].vertices,h=0,k=m.length;h<k;h+=3){var v=new THREE.Vector3;v.x=m[h]*b;v.y=m[h+1]*b;v.z=m[h+2]*b;l.push(v)}}if(void 0!==
a.morphColors)for(d=0,g=a.morphColors.length;d<g;d++)for(c.morphColors[d]={},c.morphColors[d].name=a.morphColors[d].name,c.morphColors[d].colors=[],k=c.morphColors[d].colors,l=a.morphColors[d].colors,b=0,h=l.length;b<h;b+=3)m=new THREE.Color(16755200),m.setRGB(l[b],l[b+1],l[b+2]),k.push(m)})(d);c.computeFaceNormals();c.computeBoundingSphere();if(void 0===a.materials||0===a.materials.length)return{geometry:c};d=this.initMaterials(a.materials,b);this.needsTangents(d)&&c.computeTangents();return{geometry:c,
materials:d}};THREE.LoadingManager=function(a,b,c){var d=this,e=0,f=0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(a){f++};this.itemEnd=function(a){e++;if(void 0!==d.onProgress)d.onProgress(a,e,f);if(e===f&&void 0!==d.onLoad)d.onLoad()}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.BufferGeometryLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(a,b,c,d){var e=this,f=new THREE.XHRLoader(e.manager);f.setCrossOrigin(this.crossOrigin);f.load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a){var b=new THREE.BufferGeometry,c=a.data.attributes,d;for(d in c){var e=c[d],f=new self[e.type](e.array);b.addAttribute(d,new THREE.BufferAttribute(f,e.itemSize))}c=a.data.offsets;void 0!==c&&(b.offsets=JSON.parse(JSON.stringify(c)));
a=a.data.boundingSphere;void 0!==a&&(c=new THREE.Vector3,void 0!==a.center&&c.fromArray(a.center),b.boundingSphere=new THREE.Sphere(c,a.radius));return b}};THREE.MaterialLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(a,b,c,d){var e=this,f=new THREE.XHRLoader(e.manager);f.setCrossOrigin(this.crossOrigin);f.load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a){var b=new THREE[a.type];void 0!==a.color&&b.color.setHex(a.color);void 0!==a.emissive&&b.emissive.setHex(a.emissive);void 0!==a.specular&&b.specular.setHex(a.specular);void 0!==a.shininess&&(b.shininess=a.shininess);
void 0!==a.uniforms&&(b.uniforms=a.uniforms);void 0!==a.vertexShader&&(b.vertexShader=a.vertexShader);void 0!==a.fragmentShader&&(b.fragmentShader=a.fragmentShader);void 0!==a.vertexColors&&(b.vertexColors=a.vertexColors);void 0!==a.shading&&(b.shading=a.shading);void 0!==a.blending&&(b.blending=a.blending);void 0!==a.side&&(b.side=a.side);void 0!==a.opacity&&(b.opacity=a.opacity);void 0!==a.transparent&&(b.transparent=a.transparent);void 0!==a.wireframe&&(b.wireframe=a.wireframe);void 0!==a.size&&
(b.size=a.size);void 0!==a.sizeAttenuation&&(b.sizeAttenuation=a.sizeAttenuation);if(void 0!==a.materials)for(var c=0,d=a.materials.length;c<d;c++)b.materials.push(this.parse(a.materials[c]));return b}};THREE.ObjectLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager;this.texturePath=""};
THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(a,b,c,d){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var e=this,f=new THREE.XHRLoader(e.manager);f.setCrossOrigin(this.crossOrigin);f.load(a,function(a){e.parse(JSON.parse(a),b)},c,d)},setTexturePath:function(a){this.texturePath=a},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a,b){var c=this.parseGeometries(a.geometries),d=this.parseImages(a.images,function(){void 0!==b&&b(e)}),
d=this.parseTextures(a.textures,d),d=this.parseMaterials(a.materials,d),e=this.parseObject(a.object,c,d);void 0!==a.images&&0!==a.images.length||void 0===b||b(e);return e},parseGeometries:function(a){var b={};if(void 0!==a)for(var c=new THREE.JSONLoader,d=new THREE.BufferGeometryLoader,e=0,f=a.length;e<f;e++){var g,h=a[e];switch(h.type){case "PlaneGeometry":case "PlaneBufferGeometry":g=new THREE[h.type](h.width,h.height,h.widthSegments,h.heightSegments);break;case "BoxGeometry":case "CubeGeometry":g=
new THREE.BoxGeometry(h.width,h.height,h.depth,h.widthSegments,h.heightSegments,h.depthSegments);break;case "CircleGeometry":g=new THREE.CircleGeometry(h.radius,h.segments);break;case "CylinderGeometry":g=new THREE.CylinderGeometry(h.radiusTop,h.radiusBottom,h.height,h.radialSegments,h.heightSegments,h.openEnded);break;case "SphereGeometry":g=new THREE.SphereGeometry(h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case "IcosahedronGeometry":g=new THREE.IcosahedronGeometry(h.radius,
h.detail);break;case "TorusGeometry":g=new THREE.TorusGeometry(h.radius,h.tube,h.radialSegments,h.tubularSegments,h.arc);break;case "TorusKnotGeometry":g=new THREE.TorusKnotGeometry(h.radius,h.tube,h.radialSegments,h.tubularSegments,h.p,h.q,h.heightScale);break;case "BufferGeometry":g=d.parse(h);break;case "Geometry":g=c.parse(h.data).geometry}g.uuid=h.uuid;void 0!==h.name&&(g.name=h.name);b[h.uuid]=g}return b},parseMaterials:function(a,b){var c={};if(void 0!==a)for(var d=function(a){void 0===b[a]&&
THREE.warn("THREE.ObjectLoader: Undefined texture",a);return b[a]},e=new THREE.MaterialLoader,f=0,g=a.length;f<g;f++){var h=a[f],k=e.parse(h);k.uuid=h.uuid;void 0!==h.name&&(k.name=h.name);void 0!==h.map&&(k.map=d(h.map));void 0!==h.bumpMap&&(k.bumpMap=d(h.bumpMap),h.bumpScale&&(k.bumpScale=new THREE.Vector2(h.bumpScale,h.bumpScale)));void 0!==h.alphaMap&&(k.alphaMap=d(h.alphaMap));void 0!==h.envMap&&(k.envMap=d(h.envMap));void 0!==h.normalMap&&(k.normalMap=d(h.normalMap),h.normalScale&&(k.normalScale=
new THREE.Vector2(h.normalScale,h.normalScale)));void 0!==h.lightMap&&(k.lightMap=d(h.lightMap));void 0!==h.specularMap&&(k.specularMap=d(h.specularMap));c[h.uuid]=k}return c},parseImages:function(a,b){var c=this,d={};if(void 0!==a&&0<a.length){var e=new THREE.LoadingManager(b),f=new THREE.ImageLoader(e);f.setCrossOrigin(this.crossOrigin);for(var e=function(a){c.manager.itemStart(a);return f.load(a,function(){c.manager.itemEnd(a)})},g=0,h=a.length;g<h;g++){var k=a[g],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(k.url)?
k.url:c.texturePath+k.url;d[k.uuid]=e(l)}}return d},parseTextures:function(a,b){var c={};if(void 0!==a)for(var d=0,e=a.length;d<e;d++){var f=a[d];void 0===f.image&&THREE.warn('THREE.ObjectLoader: No "image" speficied for',f.uuid);void 0===b[f.image]&&THREE.warn("THREE.ObjectLoader: Undefined image",f.image);var g=new THREE.Texture(b[f.image]);g.needsUpdate=!0;g.uuid=f.uuid;void 0!==f.name&&(g.name=f.name);void 0!==f.repeat&&(g.repeat=new THREE.Vector2(f.repeat[0],f.repeat[1]));void 0!==f.minFilter&&
(g.minFilter=THREE[f.minFilter]);void 0!==f.magFilter&&(g.magFilter=THREE[f.magFilter]);void 0!==f.anisotropy&&(g.anisotropy=f.anisotropy);f.wrap instanceof Array&&(g.wrapS=THREE[f.wrap[0]],g.wrapT=THREE[f.wrap[1]]);c[f.uuid]=g}return c},parseObject:function(){var a=new THREE.Matrix4;return function(b,c,d){var e;e=function(a){void 0===c[a]&&THREE.warn("THREE.ObjectLoader: Undefined geometry",a);return c[a]};var f=function(a){void 0===d[a]&&THREE.warn("THREE.ObjectLoader: Undefined material",a);return d[a]};
switch(b.type){case "Scene":e=new THREE.Scene;break;case "PerspectiveCamera":e=new THREE.PerspectiveCamera(b.fov,b.aspect,b.near,b.far);break;case "OrthographicCamera":e=new THREE.OrthographicCamera(b.left,b.right,b.top,b.bottom,b.near,b.far);break;case "AmbientLight":e=new THREE.AmbientLight(b.color);break;case "DirectionalLight":e=new THREE.DirectionalLight(b.color,b.intensity);break;case "PointLight":e=new THREE.PointLight(b.color,b.intensity,b.distance,b.decay);break;case "SpotLight":e=new THREE.SpotLight(b.color,
b.intensity,b.distance,b.angle,b.exponent,b.decay);break;case "HemisphereLight":e=new THREE.HemisphereLight(b.color,b.groundColor,b.intensity);break;case "Mesh":e=new THREE.Mesh(e(b.geometry),f(b.material));break;case "Line":e=new THREE.Line(e(b.geometry),f(b.material),b.mode);break;case "PointCloud":e=new THREE.PointCloud(e(b.geometry),f(b.material));break;case "Sprite":e=new THREE.Sprite(f(b.material));break;case "Group":e=new THREE.Group;break;default:e=new THREE.Object3D}e.uuid=b.uuid;void 0!==
b.name&&(e.name=b.name);void 0!==b.matrix?(a.fromArray(b.matrix),a.decompose(e.position,e.quaternion,e.scale)):(void 0!==b.position&&e.position.fromArray(b.position),void 0!==b.rotation&&e.rotation.fromArray(b.rotation),void 0!==b.scale&&e.scale.fromArray(b.scale));void 0!==b.visible&&(e.visible=b.visible);void 0!==b.userData&&(e.userData=b.userData);if(void 0!==b.children)for(var g in b.children)e.add(this.parseObject(b.children[g],c,d));return e}}()};
THREE.TextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(a,b,c,d){var e=new THREE.ImageLoader(this.manager);e.setCrossOrigin(this.crossOrigin);e.load(a,function(a){a=new THREE.Texture(a);a.needsUpdate=!0;void 0!==b&&b(a)},c,d)},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.DataTextureLoader=THREE.BinaryTextureLoader=function(){this._parser=null};
THREE.BinaryTextureLoader.prototype={constructor:THREE.BinaryTextureLoader,load:function(a,b,c,d){var e=this,f=new THREE.DataTexture,g=new THREE.XHRLoader;g.setResponseType("arraybuffer");g.load(a,function(a){if(a=e._parser(a))void 0!==a.image?f.image=a.image:void 0!==a.data&&(f.image.width=a.width,f.image.height=a.height,f.image.data=a.data),f.wrapS=void 0!==a.wrapS?a.wrapS:THREE.ClampToEdgeWrapping,f.wrapT=void 0!==a.wrapT?a.wrapT:THREE.ClampToEdgeWrapping,f.magFilter=void 0!==a.magFilter?a.magFilter:
THREE.LinearFilter,f.minFilter=void 0!==a.minFilter?a.minFilter:THREE.LinearMipMapLinearFilter,f.anisotropy=void 0!==a.anisotropy?a.anisotropy:1,void 0!==a.format&&(f.format=a.format),void 0!==a.type&&(f.type=a.type),void 0!==a.mipmaps&&(f.mipmaps=a.mipmaps),1===a.mipmapCount&&(f.minFilter=THREE.LinearFilter),f.needsUpdate=!0,b&&b(f,a)},c,d);return f}};THREE.CompressedTextureLoader=function(){this._parser=null};
THREE.CompressedTextureLoader.prototype={constructor:THREE.CompressedTextureLoader,load:function(a,b,c){var d=this,e=[],f=new THREE.CompressedTexture;f.image=e;var g=new THREE.XHRLoader;g.setResponseType("arraybuffer");if(a instanceof Array){var h=0;c=function(c){g.load(a[c],function(a){a=d._parser(a,!0);e[c]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps};h+=1;6===h&&(1==a.mipmapCount&&(f.minFilter=THREE.LinearFilter),f.format=a.format,f.needsUpdate=!0,b&&b(f))})};for(var k=0,l=
a.length;k<l;++k)c(k)}else g.load(a,function(a){a=d._parser(a,!0);if(a.isCubemap)for(var c=a.mipmaps.length/a.mipmapCount,g=0;g<c;g++){e[g]={mipmaps:[]};for(var h=0;h<a.mipmapCount;h++)e[g].mipmaps.push(a.mipmaps[g*a.mipmapCount+h]),e[g].format=a.format,e[g].width=a.width,e[g].height=a.height}else f.image.width=a.width,f.image.height=a.height,f.mipmaps=a.mipmaps;1===a.mipmapCount&&(f.minFilter=THREE.LinearFilter);f.format=a.format;f.needsUpdate=!0;b&&b(f)});return f}};
THREE.Material=function(){Object.defineProperty(this,"id",{value:THREE.MaterialIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Material";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.colorWrite=this.depthWrite=this.depthTest=!0;this.polygonOffset=
!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this._needsUpdate=this.visible=!0};
THREE.Material.prototype={constructor:THREE.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update();this._needsUpdate=a},setValues:function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)THREE.warn("THREE.Material: '"+b+"' parameter is undefined.");else if(b in this){var d=this[b];d instanceof THREE.Color?d.set(c):d instanceof THREE.Vector3&&c instanceof THREE.Vector3?d.copy(c):this[b]="overdraw"==b?Number(c):c}}},toJSON:function(){var a={metadata:{version:4.2,
type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};""!==this.name&&(a.name=this.name);this instanceof THREE.MeshBasicMaterial?(a.color=this.color.getHex(),this.vertexColors!==THREE.NoColors&&(a.vertexColors=this.vertexColors),this.blending!==THREE.NormalBlending&&(a.blending=this.blending),this.side!==THREE.FrontSide&&(a.side=this.side)):this instanceof THREE.MeshLambertMaterial?(a.color=this.color.getHex(),a.emissive=this.emissive.getHex(),this.vertexColors!==THREE.NoColors&&
(a.vertexColors=this.vertexColors),this.shading!==THREE.SmoothShading&&(a.shading=this.shading),this.blending!==THREE.NormalBlending&&(a.blending=this.blending),this.side!==THREE.FrontSide&&(a.side=this.side)):this instanceof THREE.MeshPhongMaterial?(a.color=this.color.getHex(),a.emissive=this.emissive.getHex(),a.specular=this.specular.getHex(),a.shininess=this.shininess,this.vertexColors!==THREE.NoColors&&(a.vertexColors=this.vertexColors),this.shading!==THREE.SmoothShading&&(a.shading=this.shading),
this.blending!==THREE.NormalBlending&&(a.blending=this.blending),this.side!==THREE.FrontSide&&(a.side=this.side)):this instanceof THREE.MeshNormalMaterial?(this.blending!==THREE.NormalBlending&&(a.blending=this.blending),this.side!==THREE.FrontSide&&(a.side=this.side)):this instanceof THREE.MeshDepthMaterial?(this.blending!==THREE.NormalBlending&&(a.blending=this.blending),this.side!==THREE.FrontSide&&(a.side=this.side)):this instanceof THREE.PointCloudMaterial?(a.size=this.size,a.sizeAttenuation=
this.sizeAttenuation,a.color=this.color.getHex(),this.vertexColors!==THREE.NoColors&&(a.vertexColors=this.vertexColors),this.blending!==THREE.NormalBlending&&(a.blending=this.blending)):this instanceof THREE.ShaderMaterial?(a.uniforms=this.uniforms,a.vertexShader=this.vertexShader,a.fragmentShader=this.fragmentShader):this instanceof THREE.SpriteMaterial&&(a.color=this.color.getHex());1>this.opacity&&(a.opacity=this.opacity);!1!==this.transparent&&(a.transparent=this.transparent);!1!==this.wireframe&&
(a.wireframe=this.wireframe);return a},clone:function(a){void 0===a&&(a=new THREE.Material);a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;a.blending=this.blending;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.blendEquation=this.blendEquation;a.blendSrcAlpha=this.blendSrcAlpha;a.blendDstAlpha=this.blendDstAlpha;a.blendEquationAlpha=this.blendEquationAlpha;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=
this.polygonOffsetFactor;a.polygonOffsetUnits=this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;a.visible=this.visible;return a},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);THREE.MaterialIdCount=0;
THREE.LineBasicMaterial=function(a){THREE.Material.call(this);this.type="LineBasicMaterial";this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=THREE.NoColors;this.fog=!0;this.setValues(a)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial;
THREE.LineBasicMaterial.prototype.clone=function(){var a=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.linecap=this.linecap;a.linejoin=this.linejoin;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};
THREE.LineDashedMaterial=function(a){THREE.Material.call(this);this.type="LineDashedMaterial";this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.constructor=THREE.LineDashedMaterial;
THREE.LineDashedMaterial.prototype.clone=function(){var a=new THREE.LineDashedMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.scale=this.scale;a.dashSize=this.dashSize;a.gapSize=this.gapSize;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};
THREE.MeshBasicMaterial=function(a){THREE.Material.call(this);this.type="MeshBasicMaterial";this.color=new THREE.Color(16777215);this.envMap=this.alphaMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};
THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial;
THREE.MeshBasicMaterial.prototype.clone=function(){var a=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.alphaMap=this.alphaMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;
a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;return a};
THREE.MeshLambertMaterial=function(a){THREE.Material.call(this);this.type="MeshLambertMaterial";this.color=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.alphaMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
"round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial;
THREE.MeshLambertMaterial.prototype.clone=function(){var a=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.alphaMap=this.alphaMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=
this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshPhongMaterial=function(a){THREE.Material.call(this);this.type="MeshPhongMaterial";this.color=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.wrapAround=this.metal=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.alphaMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=
1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial;
THREE.MeshPhongMaterial.prototype.clone=function(){var a=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.emissive.copy(this.emissive);a.specular.copy(this.specular);a.shininess=this.shininess;a.metal=this.metal;a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.bumpMap=this.bumpMap;a.bumpScale=this.bumpScale;a.normalMap=this.normalMap;a.normalScale.copy(this.normalScale);a.specularMap=this.specularMap;
a.alphaMap=this.alphaMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshDepthMaterial=function(a){THREE.Material.call(this);this.type="MeshDepthMaterial";this.wireframe=this.morphTargets=!1;this.wireframeLinewidth=1;this.setValues(a)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial;
THREE.MeshDepthMaterial.prototype.clone=function(){var a=new THREE.MeshDepthMaterial;THREE.Material.prototype.clone.call(this,a);a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);this.type="MeshNormalMaterial";this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial;THREE.MeshNormalMaterial.prototype.clone=function(){var a=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,a);a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};THREE.MeshFaceMaterial=function(a){this.uuid=THREE.Math.generateUUID();this.type="MeshFaceMaterial";this.materials=a instanceof Array?a:[]};
THREE.MeshFaceMaterial.prototype={constructor:THREE.MeshFaceMaterial,toJSON:function(){for(var a={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},b=0,c=this.materials.length;b<c;b++)a.materials.push(this.materials[b].toJSON());return a},clone:function(){for(var a=new THREE.MeshFaceMaterial,b=0;b<this.materials.length;b++)a.materials.push(this.materials[b].clone());return a}};
THREE.PointCloudMaterial=function(a){THREE.Material.call(this);this.type="PointCloudMaterial";this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.vertexColors=THREE.NoColors;this.fog=!0;this.setValues(a)};THREE.PointCloudMaterial.prototype=Object.create(THREE.Material.prototype);THREE.PointCloudMaterial.prototype.constructor=THREE.PointCloudMaterial;
THREE.PointCloudMaterial.prototype.clone=function(){var a=new THREE.PointCloudMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.size=this.size;a.sizeAttenuation=this.sizeAttenuation;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.ParticleBasicMaterial=function(a){THREE.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial.");return new THREE.PointCloudMaterial(a)};
THREE.ParticleSystemMaterial=function(a){THREE.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial.");return new THREE.PointCloudMaterial(a)};
THREE.ShaderMaterial=function(a){THREE.Material.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.attributes=null;this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.morphNormals=
this.morphTargets=this.skinning=!1;this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.setValues(a)};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial;
THREE.ShaderMaterial.prototype.clone=function(){var a=new THREE.ShaderMaterial;THREE.Material.prototype.clone.call(this,a);a.fragmentShader=this.fragmentShader;a.vertexShader=this.vertexShader;a.uniforms=THREE.UniformsUtils.clone(this.uniforms);a.attributes=this.attributes;a.defines=this.defines;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.fog=this.fog;a.lights=this.lights;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=
this.morphTargets;a.morphNormals=this.morphNormals;return a};THREE.RawShaderMaterial=function(a){THREE.ShaderMaterial.call(this,a);this.type="RawShaderMaterial"};THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype);THREE.RawShaderMaterial.prototype.constructor=THREE.RawShaderMaterial;THREE.RawShaderMaterial.prototype.clone=function(){var a=new THREE.RawShaderMaterial;THREE.ShaderMaterial.prototype.clone.call(this,a);return a};
THREE.SpriteMaterial=function(a){THREE.Material.call(this);this.type="SpriteMaterial";this.color=new THREE.Color(16777215);this.map=null;this.rotation=0;this.fog=!1;this.setValues(a)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteMaterial.prototype.constructor=THREE.SpriteMaterial;
THREE.SpriteMaterial.prototype.clone=function(){var a=new THREE.SpriteMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.rotation=this.rotation;a.fog=this.fog;return a};
THREE.Texture=function(a,b,c,d,e,f,g,h,k){Object.defineProperty(this,"id",{value:THREE.TextureIdCount++});this.uuid=THREE.Math.generateUUID();this.sourceFile=this.name="";this.image=void 0!==a?a:THREE.Texture.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:THREE.Texture.DEFAULT_MAPPING;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==e?e:THREE.LinearFilter;this.minFilter=void 0!==f?f:THREE.LinearMipMapLinearFilter;
this.anisotropy=void 0!==k?k:1;this.format=void 0!==g?g:THREE.RGBAFormat;this.type=void 0!==h?h:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this._needsUpdate=!1;this.onUpdate=null};THREE.Texture.DEFAULT_IMAGE=void 0;THREE.Texture.DEFAULT_MAPPING=THREE.UVMapping;
THREE.Texture.prototype={constructor:THREE.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update();this._needsUpdate=a},clone:function(a){void 0===a&&(a=new THREE.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=
this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=this.unpackAlignment;return a},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.CubeTexture=function(a,b,c,d,e,f,g,h,k){b=void 0!==b?b:THREE.CubeReflectionMapping;THREE.Texture.call(this,a,b,c,d,e,f,g,h,k);this.images=a};
THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CubeTexture.prototype.constructor=THREE.CubeTexture;THREE.CubeTexture.clone=function(a){void 0===a&&(a=new THREE.CubeTexture);THREE.Texture.prototype.clone.call(this,a);a.images=this.images;return a};THREE.CompressedTexture=function(a,b,c,d,e,f,g,h,k,l,m){THREE.Texture.call(this,null,f,g,h,k,l,d,e,m);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=this.flipY=!1};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);
THREE.CompressedTexture.prototype.constructor=THREE.CompressedTexture;THREE.CompressedTexture.prototype.clone=function(){var a=new THREE.CompressedTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.DataTexture=function(a,b,c,d,e,f,g,h,k,l,m){THREE.Texture.call(this,null,f,g,h,k,l,d,e,m);this.image={data:a,width:b,height:c}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.constructor=THREE.DataTexture;
THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.VideoTexture=function(a,b,c,d,e,f,g,h,k){THREE.Texture.call(this,a,b,c,d,e,f,g,h,k);this.generateMipmaps=!1;var l=this,m=function(){requestAnimationFrame(m);a.readyState===a.HAVE_ENOUGH_DATA&&(l.needsUpdate=!0)};m()};THREE.VideoTexture.prototype=Object.create(THREE.Texture.prototype);THREE.VideoTexture.prototype.constructor=THREE.VideoTexture;
THREE.Group=function(){THREE.Object3D.call(this);this.type="Group"};THREE.Group.prototype=Object.create(THREE.Object3D.prototype);THREE.Group.prototype.constructor=THREE.Group;THREE.PointCloud=function(a,b){THREE.Object3D.call(this);this.type="PointCloud";this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.PointCloudMaterial({color:16777215*Math.random()})};THREE.PointCloud.prototype=Object.create(THREE.Object3D.prototype);THREE.PointCloud.prototype.constructor=THREE.PointCloud;
THREE.PointCloud.prototype.raycast=function(){var a=new THREE.Matrix4,b=new THREE.Ray;return function(c,d){var e=this,f=e.geometry,g=c.params.PointCloud.threshold;a.getInverse(this.matrixWorld);b.copy(c.ray).applyMatrix4(a);if(null===f.boundingBox||!1!==b.isIntersectionBox(f.boundingBox)){var h=g/((this.scale.x+this.scale.y+this.scale.z)/3),k=new THREE.Vector3,g=function(a,f){var g=b.distanceToPoint(a);if(g<h){var k=b.closestPointToPoint(a);k.applyMatrix4(e.matrixWorld);var l=c.ray.origin.distanceTo(k);
d.push({distance:l,distanceToRay:g,point:k.clone(),index:f,face:null,object:e})}};if(f instanceof THREE.BufferGeometry){var l=f.attributes,m=l.position.array;if(void 0!==l.index){var l=l.index.array,v=f.offsets;0===v.length&&(v=[{start:0,count:l.length,index:0}]);for(var q=0,y=v.length;q<y;++q)for(var x=v[q].start,w=v[q].index,f=x,x=x+v[q].count;f<x;f++){var z=w+l[f];k.fromArray(m,3*z);g(k,z)}}else for(l=m.length/3,f=0;f<l;f++)k.set(m[3*f],m[3*f+1],m[3*f+2]),g(k,f)}else for(k=this.geometry.vertices,
f=0;f<k.length;f++)g(k[f],f)}}}();THREE.PointCloud.prototype.clone=function(a){void 0===a&&(a=new THREE.PointCloud(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.ParticleSystem=function(a,b){THREE.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud.");return new THREE.PointCloud(a,b)};
THREE.Line=function(a,b,c){THREE.Object3D.call(this);this.type="Line";this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.mode=void 0!==c?c:THREE.LineStrip};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.constructor=THREE.Line;
THREE.Line.prototype.raycast=function(){var a=new THREE.Matrix4,b=new THREE.Ray,c=new THREE.Sphere;return function(d,e){var f=d.linePrecision,f=f*f,g=this.geometry;null===g.boundingSphere&&g.computeBoundingSphere();c.copy(g.boundingSphere);c.applyMatrix4(this.matrixWorld);if(!1!==d.ray.isIntersectionSphere(c)){a.getInverse(this.matrixWorld);b.copy(d.ray).applyMatrix4(a);var h=new THREE.Vector3,k=new THREE.Vector3,l=new THREE.Vector3,m=new THREE.Vector3,v=this.mode===THREE.LineStrip?1:2;if(g instanceof
THREE.BufferGeometry){var q=g.attributes;if(void 0!==q.index){var y=q.index.array,q=q.position.array,x=g.offsets;0===x.length&&(x=[{start:0,count:y.length,index:0}]);for(var w=0;w<x.length;w++)for(var z=x[w].start,u=x[w].count,B=x[w].index,g=z;g<z+u-1;g+=v){var G=B+y[g+1];h.fromArray(q,3*(B+y[g]));k.fromArray(q,3*G);G=b.distanceSqToSegment(h,k,m,l);G>f||(G=b.origin.distanceTo(m),G<d.near||G>d.far||e.push({distance:G,point:l.clone().applyMatrix4(this.matrixWorld),index:g,offsetIndex:w,face:null,faceIndex:null,
object:this}))}}else for(q=q.position.array,g=0;g<q.length/3-1;g+=v)h.fromArray(q,3*g),k.fromArray(q,3*g+3),G=b.distanceSqToSegment(h,k,m,l),G>f||(G=b.origin.distanceTo(m),G<d.near||G>d.far||e.push({distance:G,point:l.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else if(g instanceof THREE.Geometry)for(h=g.vertices,k=h.length,g=0;g<k-1;g+=v)G=b.distanceSqToSegment(h[g],h[g+1],m,l),G>f||(G=b.origin.distanceTo(m),G<d.near||G>d.far||e.push({distance:G,point:l.clone().applyMatrix4(this.matrixWorld),
index:g,face:null,faceIndex:null,object:this}))}}}();THREE.Line.prototype.clone=function(a){void 0===a&&(a=new THREE.Line(this.geometry,this.material,this.mode));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Mesh=function(a,b){THREE.Object3D.call(this);this.type="Mesh";this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);
THREE.Mesh.prototype.constructor=THREE.Mesh;THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];THREE.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};
THREE.Mesh.prototype.raycast=function(){var a=new THREE.Matrix4,b=new THREE.Ray,c=new THREE.Sphere,d=new THREE.Vector3,e=new THREE.Vector3,f=new THREE.Vector3;return function(g,h){var k=this.geometry;null===k.boundingSphere&&k.computeBoundingSphere();c.copy(k.boundingSphere);c.applyMatrix4(this.matrixWorld);if(!1!==g.ray.isIntersectionSphere(c)&&(a.getInverse(this.matrixWorld),b.copy(g.ray).applyMatrix4(a),null===k.boundingBox||!1!==b.isIntersectionBox(k.boundingBox)))if(k instanceof THREE.BufferGeometry){var l=
this.material;if(void 0!==l){var m=k.attributes,v,q,y=g.precision;if(void 0!==m.index){var x=m.index.array,w=m.position.array,z=k.offsets;0===z.length&&(z=[{start:0,count:x.length,index:0}]);for(var u=0,B=z.length;u<B;++u)for(var m=z[u].start,G=z[u].index,k=m,A=m+z[u].count;k<A;k+=3){m=G+x[k];v=G+x[k+1];q=G+x[k+2];d.fromArray(w,3*m);e.fromArray(w,3*v);f.fromArray(w,3*q);var C=l.side===THREE.BackSide?b.intersectTriangle(f,e,d,!0):b.intersectTriangle(d,e,f,l.side!==THREE.DoubleSide);if(null!==C){C.applyMatrix4(this.matrixWorld);
var F=g.ray.origin.distanceTo(C);F<y||F<g.near||F>g.far||h.push({distance:F,point:C,face:new THREE.Face3(m,v,q,THREE.Triangle.normal(d,e,f)),faceIndex:null,object:this})}}}else for(w=m.position.array,x=k=0,A=w.length;k<A;k+=3,x+=9)m=k,v=k+1,q=k+2,d.fromArray(w,x),e.fromArray(w,x+3),f.fromArray(w,x+6),C=l.side===THREE.BackSide?b.intersectTriangle(f,e,d,!0):b.intersectTriangle(d,e,f,l.side!==THREE.DoubleSide),null!==C&&(C.applyMatrix4(this.matrixWorld),F=g.ray.origin.distanceTo(C),F<y||F<g.near||F>
g.far||h.push({distance:F,point:C,face:new THREE.Face3(m,v,q,THREE.Triangle.normal(d,e,f)),faceIndex:null,object:this}))}}else if(k instanceof THREE.Geometry)for(x=this.material instanceof THREE.MeshFaceMaterial,w=!0===x?this.material.materials:null,y=g.precision,z=k.vertices,u=0,B=k.faces.length;u<B;u++)if(G=k.faces[u],l=!0===x?w[G.materialIndex]:this.material,void 0!==l){m=z[G.a];v=z[G.b];q=z[G.c];if(!0===l.morphTargets){C=k.morphTargets;F=this.morphTargetInfluences;d.set(0,0,0);e.set(0,0,0);f.set(0,
0,0);for(var A=0,I=C.length;A<I;A++){var D=F[A];if(0!==D){var H=C[A].vertices;d.x+=(H[G.a].x-m.x)*D;d.y+=(H[G.a].y-m.y)*D;d.z+=(H[G.a].z-m.z)*D;e.x+=(H[G.b].x-v.x)*D;e.y+=(H[G.b].y-v.y)*D;e.z+=(H[G.b].z-v.z)*D;f.x+=(H[G.c].x-q.x)*D;f.y+=(H[G.c].y-q.y)*D;f.z+=(H[G.c].z-q.z)*D}}d.add(m);e.add(v);f.add(q);m=d;v=e;q=f}C=l.side===THREE.BackSide?b.intersectTriangle(q,v,m,!0):b.intersectTriangle(m,v,q,l.side!==THREE.DoubleSide);null!==C&&(C.applyMatrix4(this.matrixWorld),F=g.ray.origin.distanceTo(C),F<y||
F<g.near||F>g.far||h.push({distance:F,point:C,face:G,faceIndex:u,object:this}))}}}();THREE.Mesh.prototype.clone=function(a,b){void 0===a&&(a=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a,b);return a};THREE.Bone=function(a){THREE.Object3D.call(this);this.type="Bone";this.skin=a};THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.constructor=THREE.Bone;
THREE.Skeleton=function(a,b,c){this.useVertexTexture=void 0!==c?c:!0;this.identityMatrix=new THREE.Matrix4;a=a||[];this.bones=a.slice(0);this.useVertexTexture?(this.boneTextureHeight=this.boneTextureWidth=a=256<this.bones.length?64:64<this.bones.length?32:16<this.bones.length?16:8,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),
this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===b)this.calculateInverses();else if(this.bones.length===b.length)this.boneInverses=b.slice(0);else for(THREE.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[],b=0,a=this.bones.length;b<a;b++)this.boneInverses.push(new THREE.Matrix4)};
THREE.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var a=0,b=this.bones.length;a<b;a++){var c=new THREE.Matrix4;this.bones[a]&&c.getInverse(this.bones[a].matrixWorld);this.boneInverses.push(c)}};
THREE.Skeleton.prototype.pose=function(){for(var a,b=0,c=this.bones.length;b<c;b++)(a=this.bones[b])&&a.matrixWorld.getInverse(this.boneInverses[b]);b=0;for(c=this.bones.length;b<c;b++)if(a=this.bones[b])a.parent?(a.matrix.getInverse(a.parent.matrixWorld),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale)};
THREE.Skeleton.prototype.update=function(){var a=new THREE.Matrix4;return function(){for(var b=0,c=this.bones.length;b<c;b++)a.multiplyMatrices(this.bones[b]?this.bones[b].matrixWorld:this.identityMatrix,this.boneInverses[b]),a.flattenToArrayOffset(this.boneMatrices,16*b);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}();
THREE.SkinnedMesh=function(a,b,c){THREE.Mesh.call(this,a,b);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new THREE.Matrix4;this.bindMatrixInverse=new THREE.Matrix4;a=[];if(this.geometry&&void 0!==this.geometry.bones){for(var d,e,f,g,h=0,k=this.geometry.bones.length;h<k;++h)d=this.geometry.bones[h],e=d.pos,f=d.rotq,g=d.scl,b=new THREE.Bone(this),a.push(b),b.name=d.name,b.position.set(e[0],e[1],e[2]),b.quaternion.set(f[0],f[1],f[2],f[3]),void 0!==g?b.scale.set(g[0],g[1],g[2]):b.scale.set(1,
1,1);h=0;for(k=this.geometry.bones.length;h<k;++h)d=this.geometry.bones[h],-1!==d.parent?a[d.parent].add(a[h]):this.add(a[h])}this.normalizeSkinWeights();this.updateMatrixWorld(!0);this.bind(new THREE.Skeleton(a,void 0,c))};THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh;THREE.SkinnedMesh.prototype.bind=function(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.getInverse(b)};
THREE.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()};THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var a=0;a<this.geometry.skinIndices.length;a++){var b=this.geometry.skinWeights[a],c=1/b.lengthManhattan();Infinity!==c?b.multiplyScalar(c):b.set(1)}};
THREE.SkinnedMesh.prototype.updateMatrixWorld=function(a){THREE.Mesh.prototype.updateMatrixWorld.call(this,!0);"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):THREE.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.bindMode)};
THREE.SkinnedMesh.prototype.clone=function(a){void 0===a&&(a=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture));THREE.Mesh.prototype.clone.call(this,a);return a};THREE.MorphAnimMesh=function(a,b){THREE.Mesh.call(this,a,b);this.type="MorphAnimMesh";this.duration=1E3;this.mirroredLoop=!1;this.currentKeyframe=this.lastKeyframe=this.time=0;this.direction=1;this.directionBackwards=!1;this.setFrameRange(0,this.geometry.morphTargets.length-1)};THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype);
THREE.MorphAnimMesh.prototype.constructor=THREE.MorphAnimMesh;THREE.MorphAnimMesh.prototype.setFrameRange=function(a,b){this.startKeyframe=a;this.endKeyframe=b;this.length=this.endKeyframe-this.startKeyframe+1};THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=!1};THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=!0};
THREE.MorphAnimMesh.prototype.parseAnimations=function(){var a=this.geometry;a.animations||(a.animations={});for(var b,c=a.animations,d=/([a-z]+)_?(\d+)/,e=0,f=a.morphTargets.length;e<f;e++){var g=a.morphTargets[e].name.match(d);if(g&&1<g.length){g=g[1];c[g]||(c[g]={start:Infinity,end:-Infinity});var h=c[g];e<h.start&&(h.start=e);e>h.end&&(h.end=e);b||(b=g)}}a.firstAnimation=b};
THREE.MorphAnimMesh.prototype.setAnimationLabel=function(a,b,c){this.geometry.animations||(this.geometry.animations={});this.geometry.animations[a]={start:b,end:c}};THREE.MorphAnimMesh.prototype.playAnimation=function(a,b){var c=this.geometry.animations[a];c?(this.setFrameRange(c.start,c.end),this.duration=(c.end-c.start)/b*1E3,this.time=0):THREE.warn("THREE.MorphAnimMesh: animation["+a+"] undefined in .playAnimation()")};
THREE.MorphAnimMesh.prototype.updateAnimation=function(a){var b=this.duration/this.length;this.time+=this.direction*a;if(this.mirroredLoop){if(this.time>this.duration||0>this.time)this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time&&(this.time=0,this.directionBackwards=!1)}else this.time%=this.duration,0>this.time&&(this.time+=this.duration);a=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/b),0,this.length-1);a!==this.currentKeyframe&&
(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[a]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=a);b=this.time%b/b;this.directionBackwards&&(b=1-b);this.morphTargetInfluences[this.currentKeyframe]=b;this.morphTargetInfluences[this.lastKeyframe]=1-b};
THREE.MorphAnimMesh.prototype.interpolateTargets=function(a,b,c){for(var d=this.morphTargetInfluences,e=0,f=d.length;e<f;e++)d[e]=0;-1<a&&(d[a]=1-c);-1<b&&(d[b]=c)};
THREE.MorphAnimMesh.prototype.clone=function(a){void 0===a&&(a=new THREE.MorphAnimMesh(this.geometry,this.material));a.duration=this.duration;a.mirroredLoop=this.mirroredLoop;a.time=this.time;a.lastKeyframe=this.lastKeyframe;a.currentKeyframe=this.currentKeyframe;a.direction=this.direction;a.directionBackwards=this.directionBackwards;THREE.Mesh.prototype.clone.call(this,a);return a};THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);
THREE.LOD.prototype.constructor=THREE.LOD;THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=0;c<this.objects.length&&!(b<this.objects[c].distance);c++);this.objects.splice(c,0,{distance:b,object:a});this.add(a)};THREE.LOD.prototype.getObjectForDistance=function(a){for(var b=1,c=this.objects.length;b<c&&!(a<this.objects[b].distance);b++);return this.objects[b-1].object};
THREE.LOD.prototype.raycast=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);var d=b.ray.origin.distanceTo(a);this.getObjectForDistance(d).raycast(b,c)}}();
THREE.LOD.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){if(1<this.objects.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);this.objects[0].object.visible=!0;for(var d=1,e=this.objects.length;d<e;d++)if(c>=this.objects[d].distance)this.objects[d-1].object.visible=!1,this.objects[d].object.visible=!0;else break;for(;d<e;d++)this.objects[d].object.visible=!1}}}();
THREE.LOD.prototype.clone=function(a){void 0===a&&(a=new THREE.LOD);THREE.Object3D.prototype.clone.call(this,a);for(var b=0,c=this.objects.length;b<c;b++){var d=this.objects[b].object.clone();d.visible=0===b;a.addLevel(d,this.objects[b].distance)}return a};
THREE.Sprite=function(){var a=new Uint16Array([0,1,2,0,2,3]),b=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),c=new Float32Array([0,0,1,0,1,1,0,1]),d=new THREE.BufferGeometry;d.addAttribute("index",new THREE.BufferAttribute(a,1));d.addAttribute("position",new THREE.BufferAttribute(b,3));d.addAttribute("uv",new THREE.BufferAttribute(c,2));return function(a){THREE.Object3D.call(this);this.type="Sprite";this.geometry=d;this.material=void 0!==a?a:new THREE.SpriteMaterial}}();
THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.constructor=THREE.Sprite;THREE.Sprite.prototype.raycast=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);var d=b.ray.distanceToPoint(a);d>this.scale.x||c.push({distance:d,point:this.position,face:null,object:this})}}();THREE.Sprite.prototype.clone=function(a){void 0===a&&(a=new THREE.Sprite(this.material));THREE.Object3D.prototype.clone.call(this,a);return a};
THREE.Particle=THREE.Sprite;THREE.LensFlare=function(a,b,c,d,e){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==a&&this.add(a,b,c,d,e)};THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare.prototype.constructor=THREE.LensFlare;
THREE.LensFlare.prototype.add=function(a,b,c,d,e,f){void 0===b&&(b=-1);void 0===c&&(c=0);void 0===f&&(f=1);void 0===e&&(e=new THREE.Color(16777215));void 0===d&&(d=THREE.NormalBlending);c=Math.min(c,Math.max(0,c));this.lensFlares.push({texture:a,size:b,distance:c,x:0,y:0,z:0,scale:1,rotation:1,opacity:f,color:e,blending:d})};
THREE.LensFlare.prototype.updateLensFlares=function(){var a,b=this.lensFlares.length,c,d=2*-this.positionScreen.x,e=2*-this.positionScreen.y;for(a=0;a<b;a++)c=this.lensFlares[a],c.x=this.positionScreen.x+d*c.distance,c.y=this.positionScreen.y+e*c.distance,c.wantedRotation=c.x*Math.PI*.25,c.rotation+=.25*(c.wantedRotation-c.rotation)};THREE.Scene=function(){THREE.Object3D.call(this);this.type="Scene";this.overrideMaterial=this.fog=null;this.autoUpdate=!0};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);
THREE.Scene.prototype.constructor=THREE.Scene;THREE.Scene.prototype.clone=function(a){void 0===a&&(a=new THREE.Scene);THREE.Object3D.prototype.clone.call(this,a);null!==this.fog&&(a.fog=this.fog.clone());null!==this.overrideMaterial&&(a.overrideMaterial=this.overrideMaterial.clone());a.autoUpdate=this.autoUpdate;a.matrixAutoUpdate=this.matrixAutoUpdate;return a};THREE.Fog=function(a,b,c){this.name="";this.color=new THREE.Color(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3};
THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(a,b){this.name="";this.color=new THREE.Color(a);this.density=void 0!==b?b:2.5E-4};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};THREE.ShaderChunk={};THREE.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n\tfloat distance = dot( planeNormal, point-pointOnPlane );\n\treturn point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n\tif ( decayExponent > 0.0 ) {\n\t  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n\t}\n\treturn 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n\treturn a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n\treturn a;\n#endif\n}\n";
THREE.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n";THREE.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n\tfloat dotProduct = dot( transformedNormal, dirVector );\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t#endif\n\n\t#endif\n\n\t#ifdef WRAP_AROUND\n\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n\t\t#endif\n\n\t#endif\n\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n\t#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\t\tlVector = normalize( lVector );\n\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n\t\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\n\n\t\t\t#endif\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n\t\t#endif\n\n\t}\n\n#endif\n\nvLightFront += ambientLightColor;\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack += ambientLightColor;\n\n#endif\n";
THREE.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n\n#endif\n";THREE.ShaderChunk.default_vertex="#ifdef USE_SKINNING\n\n\tvec4 mvPosition = modelViewMatrix * skinned;\n\n#elif defined( USE_MORPHTARGETS )\n\n\tvec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#else\n\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n";
THREE.ShaderChunk.map_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif";THREE.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\t#ifdef USE_MORPHNORMALS\n\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n\t#else\n\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n\tuniform float logDepthBufFC;\n\n#endif";THREE.ShaderChunk.lightmap_pars_vertex="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\n#endif";THREE.ShaderChunk.lights_phong_fragment="#ifndef FLAT_SHADED\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n\t#endif\n\n#else\n\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef USE_NORMALMAP\n\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\ttotalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\n\n\t\t\t\t// specular\n\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\t// diffuse\n\n\t\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n\t\t\t#else\n\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t\t#endif\n\n\t\t\ttotalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\n\n\t\t\t// specular\n\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n\t\t\ttotalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, dirVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\ttotalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\n\n\t\t// specular\n\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n\t\t/*\n\t\t// fresnel term from skin shader\n\t\tconst float F0 = 0.128;\n\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\n\t\tfloat exponential = pow( base, 5.0 );\n\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\n\t\t*/\n\n\t\t/*\n\t\t// fresnel term from fresnel shader\n\t\tconst float mFresnelBias = 0.08;\n\t\tconst float mFresnelScale = 0.3;\n\t\tconst float mFresnelPower = 5.0;\n\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n\t\t*/\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\ttotalDiffuseLight += hemiColor;\n\n\t\t// specular (sky light)\n\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n\t\t// specular (ground light)\n\n\t\tvec3 lVectorGround = -lVector;\n\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n\t}\n\n#endif\n\n#ifdef METAL\n\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\n\n#else\n\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\n\n#endif\n";
THREE.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n\n#endif";THREE.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n\tvec3 morphedNormal = vec3( 0.0 );\n\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n\tmorphedNormal += normal;\n\n#endif";
THREE.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tuniform float refractionRatio;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\n\t#endif\n\n#endif\n";THREE.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif";
THREE.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\t// Per-Pixel Tangent Space Normal Mapping\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n";
THREE.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n";THREE.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\tuniform sampler2D lightMap;\n\n#endif";THREE.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n\t}\n\n#endif";
THREE.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif";THREE.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\n\n\tdiffuseColor *= texelColor;\n\n#endif";THREE.ShaderChunk.lightmap_vertex="#ifdef USE_LIGHTMAP\n\n\tvUv2 = uv2;\n\n#endif";THREE.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n";
THREE.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n";THREE.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n\tvColor.xyz = inputToLinear( color.xyz );\n\n#endif";THREE.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n\t#ifdef USE_MORPHTARGETS\n\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n\n#endif\n";
THREE.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvarying vec3 vReflect;\n\n\tuniform float refractionRatio;\n\n#endif\n";THREE.ShaderChunk.linear_to_gamma_fragment="\n\toutgoingLight = linearToOutput( outgoingLight );\n";THREE.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif";THREE.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n";
THREE.ShaderChunk.map_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n\n#endif\n";THREE.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\n\tenvColor.xyz = inputToLinear( envColor.xyz );\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif";THREE.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n\t#endif\n\n#endif";THREE.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif";
THREE.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif";THREE.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n\t#else\n\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\n\t#endif\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\n\t\tfogFactor = whiteCompliment( fogFactor );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\n\t#endif\n\t\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif";
THREE.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n";
THREE.ShaderChunk.defaultnormal_vertex="#ifdef USE_SKINNING\n\n\tvec3 objectNormal = skinnedNormal.xyz;\n\n#elif defined( USE_MORPHNORMALS )\n\n\tvec3 objectNormal = morphedNormal;\n\n#else\n\n\tvec3 objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n\tobjectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n";THREE.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n";
THREE.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif";THREE.ShaderChunk.map_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif";
THREE.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n\toutgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\n\n#endif";THREE.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif";THREE.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif";THREE.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n\tvec3 morphed = vec3( 0.0 );\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n\tmorphed += position;\n\n#endif";
THREE.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t#else\n\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n\t#ifdef SHADOWMAP_DEBUG\n\n\t\tvec3 frustumColors[3];\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n\t#endif\n\n\t#ifdef SHADOWMAP_CASCADE\n\n\t\tint inFrustumCount = 0;\n\n\t#endif\n\n\tfloat fDepth;\n\tvec3 shadowColor = vec3( 1.0 );\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\t\t\t// don't shadow pixels outside of light frustum\n\t\t\t\t// use just first frustum (for cascades)\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\n\n\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\tinFrustumCount += int( inFrustum );\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n\t\t#else\n\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\t#endif\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t/*\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n\t\t\t\t\t\t// must enroll loop manually\n\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\t\t\tshadow += 1.0;\n\n\t\t\t\t}\n\n\t\t\t\tshadow /= 9.0;\n\n\t\t*/\n\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\n\n\t\t\t\tmat3 shadowKernel;\n\t\t\t\tmat3 depthKernel;\n\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\n\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n\t\t\t\tvec4 shadowValues;\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#else\n\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\tif ( fDepth < shadowCoord.z )\n\n\t\t// spot with multiple shadows is darker\n\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n\t\t// spot with multiple shadows has the same color as single shadow spot\n\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n\t\t\t#endif\n\n\t\t}\n\n\n\t\t#ifdef SHADOWMAP_DEBUG\n\n\t\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\n\n\t\t\t#else\n\n\t\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t}\n\n\t// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\n\tshadowColor = inputToLinear( shadowColor );\n\n\toutgoingLight = outgoingLight * shadowColor;\n\n#endif\n";
THREE.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n\t#ifdef USE_SKINNING\n\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\n\t#elif defined( USE_MORPHTARGETS )\n\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n#endif\n";THREE.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform float shadowBias[ MAX_SHADOWS ];\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\tfloat depth = dot( rgba_depth, bit_shift );\n\t\treturn depth;\n\n\t}\n\n#endif";
THREE.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n\tuniform float logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\t#extension GL_EXT_frag_depth : enable\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n#endif";THREE.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n";THREE.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n";
THREE.UniformsUtils={merge:function(a){for(var b={},c=0;c<a.length;c++){var d=this.clone(a[c]),e;for(e in d)b[e]=d[e]}return b},clone:function(a){var b={},c;for(c in a){b[c]={};for(var d in a[c]){var e=a[c][d];b[c][d]=e instanceof THREE.Color||e instanceof THREE.Vector2||e instanceof THREE.Vector3||e instanceof THREE.Vector4||e instanceof THREE.Matrix4||e instanceof THREE.Texture?e.clone():e instanceof Array?e.slice():e}}return b}};
THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",
value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",
value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",
value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};
THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",
THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"\t#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"\t#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,
"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",
THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"\toutgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},
lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,
THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,
THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,
THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,
THREE.ShaderChunk.specularmap_fragment,"\t#ifdef DOUBLE_SIDED\n\t\tif ( gl_FrontFacing )\n\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\n\t\telse\n\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;\n\t#else\n\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\n\t#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},
phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",THREE.ShaderChunk.common,
THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,
THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;",
THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,
"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,
THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\tgl_Position = projectionMatrix * mvPosition;",
THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( psColor, opacity );",
THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphatest_fragment,"\toutgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),
vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",
THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.color_fragment,"\toutgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},
depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",value:1}},vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;\nuniform float mFar;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,
"void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\n\tgl_FragColor = vec4( vec3( color ), opacity );\n}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,
"void main() {\n\tvNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vNormal;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},
tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,
"void main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",
THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\nvec3 direction = normalize( vWorldPosition );\nvec2 sampleUV;\nsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\nsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\ngl_FragColor = texture2D( tEquirect, sampleUV );",THREE.ShaderChunk.logdepthbuf_fragment,
"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nvoid main() {",
THREE.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n\t#else\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n\t#endif\n}"].join("\n")}};
THREE.WebGLRenderer=function(a){function b(a){var b=a.geometry;a=a.material;var c=b.vertices.length;if(a.attributes){void 0===b.__webglCustomAttributesList&&(b.__webglCustomAttributesList=[]);for(var d in a.attributes){var e=a.attributes[d];if(!e.__webglInitialized||e.createUniqueBuffers){e.__webglInitialized=!0;var f=1;"v2"===e.type?f=2:"v3"===e.type?f=3:"v4"===e.type?f=4:"c"===e.type&&(f=3);e.size=f;e.array=new Float32Array(c*f);e.buffer=t.createBuffer();e.buffer.belongsToAttribute=d;e.needsUpdate=
!0}b.__webglCustomAttributesList.push(e)}}}function c(a,b){return a.material instanceof THREE.MeshFaceMaterial?a.material.materials[b.materialIndex]:a.material}function d(a,b,c,d){c=c.attributes;var e=b.attributes;b=b.attributesKeys;for(var f=0,g=b.length;f<g;f++){var h=b[f],k=e[h];if(0<=k){var l=c[h];void 0!==l?(h=l.itemSize,t.bindBuffer(t.ARRAY_BUFFER,l.buffer),Y.enableAttribute(k),t.vertexAttribPointer(k,h,t.FLOAT,!1,0,d*h*4)):void 0!==a.defaultAttributeValues&&(2===a.defaultAttributeValues[h].length?
t.vertexAttrib2fv(k,a.defaultAttributeValues[h]):3===a.defaultAttributeValues[h].length&&t.vertexAttrib3fv(k,a.defaultAttributeValues[h]))}}Y.disableUnusedAttributes()}function e(a,b){return a.object.renderOrder!==b.object.renderOrder?a.object.renderOrder-b.object.renderOrder:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function f(a,b){return a.object.renderOrder!==b.object.renderOrder?a.object.renderOrder-b.object.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function g(a,
b){return b[0]-a[0]}function h(a){if(!1!==a.visible){if(!(a instanceof THREE.Scene||a instanceof THREE.Group)){void 0===a.__webglInit&&(a.__webglInit=!0,a._modelViewMatrix=new THREE.Matrix4,a._normalMatrix=new THREE.Matrix3,a.addEventListener("removed",lc));var c=a.geometry;if(void 0!==c&&void 0===c.__webglInit)if(c.__webglInit=!0,c.addEventListener("dispose",mc),c instanceof THREE.BufferGeometry)r.info.memory.geometries++;else if(a instanceof THREE.Mesh)v(a,c);else if(a instanceof THREE.Line){if(void 0===
c.__webglVertexBuffer){c.__webglVertexBuffer=t.createBuffer();c.__webglColorBuffer=t.createBuffer();c.__webglLineDistanceBuffer=t.createBuffer();r.info.memory.geometries++;var d=c.vertices.length;c.__vertexArray=new Float32Array(3*d);c.__colorArray=new Float32Array(3*d);c.__lineDistanceArray=new Float32Array(1*d);c.__webglLineCount=d;b(a);c.verticesNeedUpdate=!0;c.colorsNeedUpdate=!0;c.lineDistancesNeedUpdate=!0}}else a instanceof THREE.PointCloud&&void 0===c.__webglVertexBuffer&&(c.__webglVertexBuffer=
t.createBuffer(),c.__webglColorBuffer=t.createBuffer(),r.info.memory.geometries++,d=c.vertices.length,c.__vertexArray=new Float32Array(3*d),c.__colorArray=new Float32Array(3*d),c.__webglParticleCount=d,b(a),c.verticesNeedUpdate=!0,c.colorsNeedUpdate=!0);if(void 0===a.__webglActive)if(a.__webglActive=!0,a instanceof THREE.Mesh)if(c instanceof THREE.BufferGeometry)q(ia,c,a);else{if(c instanceof THREE.Geometry)for(var c=lb[c.id],d=0,e=c.length;d<e;d++)q(ia,c[d],a)}else a instanceof THREE.Line||a instanceof
THREE.PointCloud?q(ia,c,a):(a instanceof THREE.ImmediateRenderObject||a.immediateRenderCallback)&&ta.push({id:null,object:a,opaque:null,transparent:null,z:0});if(a instanceof THREE.Light)ra.push(a);else if(a instanceof THREE.Sprite)qa.push(a);else if(a instanceof THREE.LensFlare)ha.push(a);else if((c=ia[a.id])&&(!1===a.frustumCulled||!0===mb.intersectsObject(a)))for(d=0,e=c.length;d<e;d++){var f=c[d],g=f,k=g.object,l=g.buffer,m=k.geometry,k=k.material;k instanceof THREE.MeshFaceMaterial?(k=k.materials[m instanceof
THREE.BufferGeometry?0:l.materialIndex],g.material=k,k.transparent?xa.push(g):cb.push(g)):k&&(g.material=k,k.transparent?xa.push(g):cb.push(g));f.render=!0;!0===r.sortObjects&&(ka.setFromMatrixPosition(a.matrixWorld),ka.applyProjection(ab),f.z=ka.z)}}d=0;for(e=a.children.length;d<e;d++)h(a.children[d])}}function k(a,b,c,d,e){for(var f,g=0,h=a.length;g<h;g++){f=a[g];var k=f.object,l=f.buffer;A(k,b);if(e)f=e;else{f=f.material;if(!f)continue;z(f)}r.setMaterialFaces(f);l instanceof THREE.BufferGeometry?
r.renderBufferDirect(b,c,d,f,l,k):r.renderBuffer(b,c,d,f,l,k)}}function l(a,b,c,d,e,f){for(var g,h=0,k=a.length;h<k;h++){g=a[h];var l=g.object;if(l.visible){if(f)g=f;else{g=g[b];if(!g)continue;z(g)}r.renderImmediateObject(c,d,e,g,l)}}}function m(a){var b=a.object.material;b.transparent?(a.transparent=b,a.opaque=null):(a.opaque=b,a.transparent=null)}function v(a,b){var d=a.material,e=!1;if(void 0===lb[b.id]||!0===b.groupsNeedUpdate){delete ia[a.id];for(var f=lb,g=b.id,d=d instanceof THREE.MeshFaceMaterial,
h=ma.get("OES_element_index_uint")?4294967296:65535,k,e={},l=b.morphTargets.length,m=b.morphNormals.length,u,v={},x=[],w=0,y=b.faces.length;w<y;w++){k=b.faces[w];var z=d?k.materialIndex:0;z in e||(e[z]={hash:z,counter:0});k=e[z].hash+"_"+e[z].counter;k in v||(u={id:gb++,faces3:[],materialIndex:z,vertices:0,numMorphTargets:l,numMorphNormals:m},v[k]=u,x.push(u));v[k].vertices+3>h&&(e[z].counter+=1,k=e[z].hash+"_"+e[z].counter,k in v||(u={id:gb++,faces3:[],materialIndex:z,vertices:0,numMorphTargets:l,
numMorphNormals:m},v[k]=u,x.push(u)));v[k].faces3.push(w);v[k].vertices+=3}f[g]=x;b.groupsNeedUpdate=!1}f=lb[b.id];g=0;for(d=f.length;g<d;g++){h=f[g];if(void 0===h.__webglVertexBuffer){e=h;e.__webglVertexBuffer=t.createBuffer();e.__webglNormalBuffer=t.createBuffer();e.__webglTangentBuffer=t.createBuffer();e.__webglColorBuffer=t.createBuffer();e.__webglUVBuffer=t.createBuffer();e.__webglUV2Buffer=t.createBuffer();e.__webglSkinIndicesBuffer=t.createBuffer();e.__webglSkinWeightsBuffer=t.createBuffer();
e.__webglFaceBuffer=t.createBuffer();e.__webglLineBuffer=t.createBuffer();if(m=e.numMorphTargets)for(e.__webglMorphTargetsBuffers=[],l=0;l<m;l++)e.__webglMorphTargetsBuffers.push(t.createBuffer());if(m=e.numMorphNormals)for(e.__webglMorphNormalsBuffers=[],l=0;l<m;l++)e.__webglMorphNormalsBuffers.push(t.createBuffer());r.info.memory.geometries++;e=h;w=a;y=w.geometry;m=e.faces3;l=3*m.length;v=1*m.length;x=3*m.length;m=c(w,e);e.__vertexArray=new Float32Array(3*l);e.__normalArray=new Float32Array(3*l);
e.__colorArray=new Float32Array(3*l);e.__uvArray=new Float32Array(2*l);1<y.faceVertexUvs.length&&(e.__uv2Array=new Float32Array(2*l));y.hasTangents&&(e.__tangentArray=new Float32Array(4*l));w.geometry.skinWeights.length&&w.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*l),e.__skinWeightArray=new Float32Array(4*l));w=null!==ma.get("OES_element_index_uint")&&21845<v?Uint32Array:Uint16Array;e.__typeArray=w;e.__faceArray=new w(3*v);e.__lineArray=new w(2*x);if(y=e.numMorphTargets)for(e.__morphTargetsArrays=
[],w=0;w<y;w++)e.__morphTargetsArrays.push(new Float32Array(3*l));if(y=e.numMorphNormals)for(e.__morphNormalsArrays=[],w=0;w<y;w++)e.__morphNormalsArrays.push(new Float32Array(3*l));e.__webglFaceCount=3*v;e.__webglLineCount=2*x;if(m.attributes)for(v in void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]),v=void 0,m.attributes){var x=m.attributes[v],w={},A;for(A in x)w[A]=x[A];if(!w.__webglInitialized||w.createUniqueBuffers)w.__webglInitialized=!0,y=1,"v2"===w.type?y=2:"v3"===
w.type?y=3:"v4"===w.type?y=4:"c"===w.type&&(y=3),w.size=y,w.array=new Float32Array(l*y),w.buffer=t.createBuffer(),w.buffer.belongsToAttribute=v,x.needsUpdate=!0,w.__original=x;e.__webglCustomAttributesList.push(w)}e.__inittedArrays=!0;b.verticesNeedUpdate=!0;b.morphTargetsNeedUpdate=!0;b.elementsNeedUpdate=!0;b.uvsNeedUpdate=!0;b.normalsNeedUpdate=!0;b.tangentsNeedUpdate=!0;e=b.colorsNeedUpdate=!0}else e=!1;(e||void 0===a.__webglActive)&&q(ia,h,a)}a.__webglActive=!0}function q(a,b,c){var d=c.id;a[d]=
a[d]||[];a[d].push({id:d,buffer:b,object:c,material:null,z:0})}function y(a){var b=a.geometry;if(b instanceof THREE.BufferGeometry)for(var d=b.attributes,e=b.attributesKeys,f=0,g=e.length;f<g;f++){var h=e[f],k=d[h],l="index"===h?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;void 0===k.buffer?(k.buffer=t.createBuffer(),t.bindBuffer(l,k.buffer),t.bufferData(l,k.array,k instanceof THREE.DynamicBufferAttribute?t.DYNAMIC_DRAW:t.STATIC_DRAW),k.needsUpdate=!1):!0===k.needsUpdate&&(t.bindBuffer(l,k.buffer),void 0===
k.updateRange||-1===k.updateRange.count?t.bufferSubData(l,0,k.array):0===k.updateRange.count?console.error("THREE.WebGLRenderer.updateObject: using updateRange for THREE.DynamicBufferAttribute and marked as needsUpdate but count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(l,k.updateRange.offset*k.array.BYTES_PER_ELEMENT,k.array.subarray(k.updateRange.offset,k.updateRange.offset+k.updateRange.count)),k.updateRange.count=0),k.needsUpdate=!1)}else if(a instanceof THREE.Mesh){!0===
b.groupsNeedUpdate&&v(a,b);for(var m=lb[b.id],f=0,q=m.length;f<q;f++){var r=m[f],u=c(a,r),y=u.attributes&&x(u);if(b.verticesNeedUpdate||b.morphTargetsNeedUpdate||b.elementsNeedUpdate||b.uvsNeedUpdate||b.normalsNeedUpdate||b.colorsNeedUpdate||b.tangentsNeedUpdate||y){var z=r,A=a,B=t.DYNAMIC_DRAW,G=!b.dynamic,F=u;if(z.__inittedArrays){var I=!1===F instanceof THREE.MeshPhongMaterial&&F.shading===THREE.FlatShading,C=void 0,D=void 0,H=void 0,E=void 0,L=void 0,J=void 0,S=void 0,O=void 0,R=void 0,T=void 0,
U=void 0,K=void 0,N=void 0,P=void 0,V=void 0,aa=void 0,Cb=void 0,oa=void 0,hb=void 0,Ib=void 0,Jb=void 0,Db=void 0,vb=void 0,tb=void 0,ya=void 0,X=void 0,Kb=void 0,wa=void 0,Na=void 0,ea=void 0,ba=void 0,ha=void 0,cb=void 0,qa=void 0,Y=void 0,cc=void 0,Wa=void 0,xa=void 0,Ca=void 0,pa=void 0,bb=0,da=0,ma=0,ia=0,Pb=0,db=0,Ua=0,wb=0,Xa=0,za=0,Ga=0,Q=0,Qa=void 0,eb=z.__vertexArray,Qb=z.__uvArray,Eb=z.__uv2Array,ja=z.__normalArray,Ha=z.__tangentArray,Ea=z.__colorArray,ka=z.__skinIndexArray,sa=z.__skinWeightArray,
Hb=z.__morphTargetsArrays,fb=z.__morphNormalsArrays,qb=z.__webglCustomAttributesList,M=void 0,Ba=z.__faceArray,ra=z.__lineArray,la=A.geometry,ta=la.elementsNeedUpdate,Ma=la.uvsNeedUpdate,Da=la.normalsNeedUpdate,Ta=la.tangentsNeedUpdate,Fa=la.colorsNeedUpdate,Nb=la.morphTargetsNeedUpdate,Ja=la.vertices,na=z.faces3,Ia=la.faces,rb=la.faceVertexUvs[0],Oa=la.faceVertexUvs[1],ub=la.skinIndices,Ra=la.skinWeights,Fb=la.morphTargets,ab=la.morphNormals;if(la.verticesNeedUpdate){C=0;for(D=na.length;C<D;C++)E=
Ia[na[C]],K=Ja[E.a],N=Ja[E.b],P=Ja[E.c],eb[da]=K.x,eb[da+1]=K.y,eb[da+2]=K.z,eb[da+3]=N.x,eb[da+4]=N.y,eb[da+5]=N.z,eb[da+6]=P.x,eb[da+7]=P.y,eb[da+8]=P.z,da+=9;t.bindBuffer(t.ARRAY_BUFFER,z.__webglVertexBuffer);t.bufferData(t.ARRAY_BUFFER,eb,B)}if(Nb)for(Y=0,cc=Fb.length;Y<cc;Y++){C=Ga=0;for(D=na.length;C<D;C++)Ca=na[C],E=Ia[Ca],K=Fb[Y].vertices[E.a],N=Fb[Y].vertices[E.b],P=Fb[Y].vertices[E.c],Wa=Hb[Y],Wa[Ga]=K.x,Wa[Ga+1]=K.y,Wa[Ga+2]=K.z,Wa[Ga+3]=N.x,Wa[Ga+4]=N.y,Wa[Ga+5]=N.z,Wa[Ga+6]=P.x,Wa[Ga+
7]=P.y,Wa[Ga+8]=P.z,F.morphNormals&&(I?Ib=hb=oa=ab[Y].faceNormals[Ca]:(pa=ab[Y].vertexNormals[Ca],oa=pa.a,hb=pa.b,Ib=pa.c),xa=fb[Y],xa[Ga]=oa.x,xa[Ga+1]=oa.y,xa[Ga+2]=oa.z,xa[Ga+3]=hb.x,xa[Ga+4]=hb.y,xa[Ga+5]=hb.z,xa[Ga+6]=Ib.x,xa[Ga+7]=Ib.y,xa[Ga+8]=Ib.z),Ga+=9;t.bindBuffer(t.ARRAY_BUFFER,z.__webglMorphTargetsBuffers[Y]);t.bufferData(t.ARRAY_BUFFER,Hb[Y],B);F.morphNormals&&(t.bindBuffer(t.ARRAY_BUFFER,z.__webglMorphNormalsBuffers[Y]),t.bufferData(t.ARRAY_BUFFER,fb[Y],B))}if(Ra.length){C=0;for(D=
na.length;C<D;C++)E=Ia[na[C]],tb=Ra[E.a],ya=Ra[E.b],X=Ra[E.c],sa[za]=tb.x,sa[za+1]=tb.y,sa[za+2]=tb.z,sa[za+3]=tb.w,sa[za+4]=ya.x,sa[za+5]=ya.y,sa[za+6]=ya.z,sa[za+7]=ya.w,sa[za+8]=X.x,sa[za+9]=X.y,sa[za+10]=X.z,sa[za+11]=X.w,Kb=ub[E.a],wa=ub[E.b],Na=ub[E.c],ka[za]=Kb.x,ka[za+1]=Kb.y,ka[za+2]=Kb.z,ka[za+3]=Kb.w,ka[za+4]=wa.x,ka[za+5]=wa.y,ka[za+6]=wa.z,ka[za+7]=wa.w,ka[za+8]=Na.x,ka[za+9]=Na.y,ka[za+10]=Na.z,ka[za+11]=Na.w,za+=12;0<za&&(t.bindBuffer(t.ARRAY_BUFFER,z.__webglSkinIndicesBuffer),t.bufferData(t.ARRAY_BUFFER,
ka,B),t.bindBuffer(t.ARRAY_BUFFER,z.__webglSkinWeightsBuffer),t.bufferData(t.ARRAY_BUFFER,sa,B))}if(Fa){C=0;for(D=na.length;C<D;C++)E=Ia[na[C]],S=E.vertexColors,O=E.color,3===S.length&&F.vertexColors===THREE.VertexColors?(Jb=S[0],Db=S[1],vb=S[2]):vb=Db=Jb=O,Ea[Xa]=Jb.r,Ea[Xa+1]=Jb.g,Ea[Xa+2]=Jb.b,Ea[Xa+3]=Db.r,Ea[Xa+4]=Db.g,Ea[Xa+5]=Db.b,Ea[Xa+6]=vb.r,Ea[Xa+7]=vb.g,Ea[Xa+8]=vb.b,Xa+=9;0<Xa&&(t.bindBuffer(t.ARRAY_BUFFER,z.__webglColorBuffer),t.bufferData(t.ARRAY_BUFFER,Ea,B))}if(Ta&&la.hasTangents){C=
0;for(D=na.length;C<D;C++)E=Ia[na[C]],R=E.vertexTangents,V=R[0],aa=R[1],Cb=R[2],Ha[Ua]=V.x,Ha[Ua+1]=V.y,Ha[Ua+2]=V.z,Ha[Ua+3]=V.w,Ha[Ua+4]=aa.x,Ha[Ua+5]=aa.y,Ha[Ua+6]=aa.z,Ha[Ua+7]=aa.w,Ha[Ua+8]=Cb.x,Ha[Ua+9]=Cb.y,Ha[Ua+10]=Cb.z,Ha[Ua+11]=Cb.w,Ua+=12;t.bindBuffer(t.ARRAY_BUFFER,z.__webglTangentBuffer);t.bufferData(t.ARRAY_BUFFER,Ha,B)}if(Da){C=0;for(D=na.length;C<D;C++)if(E=Ia[na[C]],L=E.vertexNormals,J=E.normal,3===L.length&&!1===I)for(ea=0;3>ea;ea++)ha=L[ea],ja[db]=ha.x,ja[db+1]=ha.y,ja[db+2]=ha.z,
db+=3;else for(ea=0;3>ea;ea++)ja[db]=J.x,ja[db+1]=J.y,ja[db+2]=J.z,db+=3;t.bindBuffer(t.ARRAY_BUFFER,z.__webglNormalBuffer);t.bufferData(t.ARRAY_BUFFER,ja,B)}if(Ma&&rb){C=0;for(D=na.length;C<D;C++)if(H=na[C],T=rb[H],void 0!==T)for(ea=0;3>ea;ea++)cb=T[ea],Qb[ma]=cb.x,Qb[ma+1]=cb.y,ma+=2;0<ma&&(t.bindBuffer(t.ARRAY_BUFFER,z.__webglUVBuffer),t.bufferData(t.ARRAY_BUFFER,Qb,B))}if(Ma&&Oa){C=0;for(D=na.length;C<D;C++)if(H=na[C],U=Oa[H],void 0!==U)for(ea=0;3>ea;ea++)qa=U[ea],Eb[ia]=qa.x,Eb[ia+1]=qa.y,ia+=
2;0<ia&&(t.bindBuffer(t.ARRAY_BUFFER,z.__webglUV2Buffer),t.bufferData(t.ARRAY_BUFFER,Eb,B))}if(ta){C=0;for(D=na.length;C<D;C++)Ba[Pb]=bb,Ba[Pb+1]=bb+1,Ba[Pb+2]=bb+2,Pb+=3,ra[wb]=bb,ra[wb+1]=bb+1,ra[wb+2]=bb,ra[wb+3]=bb+2,ra[wb+4]=bb+1,ra[wb+5]=bb+2,wb+=6,bb+=3;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,z.__webglFaceBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,Ba,B);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,z.__webglLineBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,ra,B)}if(qb)for(ea=0,ba=qb.length;ea<ba;ea++)if(M=
qb[ea],M.__original.needsUpdate){Q=0;if(1===M.size)if(void 0===M.boundTo||"vertices"===M.boundTo)for(C=0,D=na.length;C<D;C++)E=Ia[na[C]],M.array[Q]=M.value[E.a],M.array[Q+1]=M.value[E.b],M.array[Q+2]=M.value[E.c],Q+=3;else{if("faces"===M.boundTo)for(C=0,D=na.length;C<D;C++)Qa=M.value[na[C]],M.array[Q]=Qa,M.array[Q+1]=Qa,M.array[Q+2]=Qa,Q+=3}else if(2===M.size)if(void 0===M.boundTo||"vertices"===M.boundTo)for(C=0,D=na.length;C<D;C++)E=Ia[na[C]],K=M.value[E.a],N=M.value[E.b],P=M.value[E.c],M.array[Q]=
K.x,M.array[Q+1]=K.y,M.array[Q+2]=N.x,M.array[Q+3]=N.y,M.array[Q+4]=P.x,M.array[Q+5]=P.y,Q+=6;else{if("faces"===M.boundTo)for(C=0,D=na.length;C<D;C++)P=N=K=Qa=M.value[na[C]],M.array[Q]=K.x,M.array[Q+1]=K.y,M.array[Q+2]=N.x,M.array[Q+3]=N.y,M.array[Q+4]=P.x,M.array[Q+5]=P.y,Q+=6}else if(3===M.size){var Z;Z="c"===M.type?["r","g","b"]:["x","y","z"];if(void 0===M.boundTo||"vertices"===M.boundTo)for(C=0,D=na.length;C<D;C++)E=Ia[na[C]],K=M.value[E.a],N=M.value[E.b],P=M.value[E.c],M.array[Q]=K[Z[0]],M.array[Q+
1]=K[Z[1]],M.array[Q+2]=K[Z[2]],M.array[Q+3]=N[Z[0]],M.array[Q+4]=N[Z[1]],M.array[Q+5]=N[Z[2]],M.array[Q+6]=P[Z[0]],M.array[Q+7]=P[Z[1]],M.array[Q+8]=P[Z[2]],Q+=9;else if("faces"===M.boundTo)for(C=0,D=na.length;C<D;C++)P=N=K=Qa=M.value[na[C]],M.array[Q]=K[Z[0]],M.array[Q+1]=K[Z[1]],M.array[Q+2]=K[Z[2]],M.array[Q+3]=N[Z[0]],M.array[Q+4]=N[Z[1]],M.array[Q+5]=N[Z[2]],M.array[Q+6]=P[Z[0]],M.array[Q+7]=P[Z[1]],M.array[Q+8]=P[Z[2]],Q+=9;else if("faceVertices"===M.boundTo)for(C=0,D=na.length;C<D;C++)Qa=
M.value[na[C]],K=Qa[0],N=Qa[1],P=Qa[2],M.array[Q]=K[Z[0]],M.array[Q+1]=K[Z[1]],M.array[Q+2]=K[Z[2]],M.array[Q+3]=N[Z[0]],M.array[Q+4]=N[Z[1]],M.array[Q+5]=N[Z[2]],M.array[Q+6]=P[Z[0]],M.array[Q+7]=P[Z[1]],M.array[Q+8]=P[Z[2]],Q+=9}else if(4===M.size)if(void 0===M.boundTo||"vertices"===M.boundTo)for(C=0,D=na.length;C<D;C++)E=Ia[na[C]],K=M.value[E.a],N=M.value[E.b],P=M.value[E.c],M.array[Q]=K.x,M.array[Q+1]=K.y,M.array[Q+2]=K.z,M.array[Q+3]=K.w,M.array[Q+4]=N.x,M.array[Q+5]=N.y,M.array[Q+6]=N.z,M.array[Q+
7]=N.w,M.array[Q+8]=P.x,M.array[Q+9]=P.y,M.array[Q+10]=P.z,M.array[Q+11]=P.w,Q+=12;else if("faces"===M.boundTo)for(C=0,D=na.length;C<D;C++)P=N=K=Qa=M.value[na[C]],M.array[Q]=K.x,M.array[Q+1]=K.y,M.array[Q+2]=K.z,M.array[Q+3]=K.w,M.array[Q+4]=N.x,M.array[Q+5]=N.y,M.array[Q+6]=N.z,M.array[Q+7]=N.w,M.array[Q+8]=P.x,M.array[Q+9]=P.y,M.array[Q+10]=P.z,M.array[Q+11]=P.w,Q+=12;else if("faceVertices"===M.boundTo)for(C=0,D=na.length;C<D;C++)Qa=M.value[na[C]],K=Qa[0],N=Qa[1],P=Qa[2],M.array[Q]=K.x,M.array[Q+
1]=K.y,M.array[Q+2]=K.z,M.array[Q+3]=K.w,M.array[Q+4]=N.x,M.array[Q+5]=N.y,M.array[Q+6]=N.z,M.array[Q+7]=N.w,M.array[Q+8]=P.x,M.array[Q+9]=P.y,M.array[Q+10]=P.z,M.array[Q+11]=P.w,Q+=12;t.bindBuffer(t.ARRAY_BUFFER,M.buffer);t.bufferData(t.ARRAY_BUFFER,M.array,B)}G&&(delete z.__inittedArrays,delete z.__colorArray,delete z.__normalArray,delete z.__tangentArray,delete z.__uvArray,delete z.__uv2Array,delete z.__faceArray,delete z.__vertexArray,delete z.__lineArray,delete z.__skinIndexArray,delete z.__skinWeightArray)}}}b.verticesNeedUpdate=
!1;b.morphTargetsNeedUpdate=!1;b.elementsNeedUpdate=!1;b.uvsNeedUpdate=!1;b.normalsNeedUpdate=!1;b.colorsNeedUpdate=!1;b.tangentsNeedUpdate=!1;u.attributes&&w(u)}else if(a instanceof THREE.Line){u=c(a,b);y=u.attributes&&x(u);if(b.verticesNeedUpdate||b.colorsNeedUpdate||b.lineDistancesNeedUpdate||y){var Rb=t.DYNAMIC_DRAW,W,fa,ga,Sa,ca,Sb,dc=b.vertices,Wb=b.colors,xb=b.lineDistances,Pa=dc.length,pc=Wb.length,qc=xb.length,ib=b.__vertexArray,Ob=b.__colorArray,yb=b.__lineDistanceArray,rc=b.colorsNeedUpdate,
Tb=b.lineDistancesNeedUpdate,ec=b.__webglCustomAttributesList,Xb,Uc,Ka,Yb,Ya,ua;if(b.verticesNeedUpdate){for(W=0;W<Pa;W++)Sa=dc[W],ca=3*W,ib[ca]=Sa.x,ib[ca+1]=Sa.y,ib[ca+2]=Sa.z;t.bindBuffer(t.ARRAY_BUFFER,b.__webglVertexBuffer);t.bufferData(t.ARRAY_BUFFER,ib,Rb)}if(rc){for(fa=0;fa<pc;fa++)Sb=Wb[fa],ca=3*fa,Ob[ca]=Sb.r,Ob[ca+1]=Sb.g,Ob[ca+2]=Sb.b;t.bindBuffer(t.ARRAY_BUFFER,b.__webglColorBuffer);t.bufferData(t.ARRAY_BUFFER,Ob,Rb)}if(Tb){for(ga=0;ga<qc;ga++)yb[ga]=xb[ga];t.bindBuffer(t.ARRAY_BUFFER,
b.__webglLineDistanceBuffer);t.bufferData(t.ARRAY_BUFFER,yb,Rb)}if(ec)for(Xb=0,Uc=ec.length;Xb<Uc;Xb++)if(ua=ec[Xb],ua.needsUpdate&&(void 0===ua.boundTo||"vertices"===ua.boundTo)){ca=0;Yb=ua.value.length;if(1===ua.size)for(Ka=0;Ka<Yb;Ka++)ua.array[Ka]=ua.value[Ka];else if(2===ua.size)for(Ka=0;Ka<Yb;Ka++)Ya=ua.value[Ka],ua.array[ca]=Ya.x,ua.array[ca+1]=Ya.y,ca+=2;else if(3===ua.size)if("c"===ua.type)for(Ka=0;Ka<Yb;Ka++)Ya=ua.value[Ka],ua.array[ca]=Ya.r,ua.array[ca+1]=Ya.g,ua.array[ca+2]=Ya.b,ca+=3;
else for(Ka=0;Ka<Yb;Ka++)Ya=ua.value[Ka],ua.array[ca]=Ya.x,ua.array[ca+1]=Ya.y,ua.array[ca+2]=Ya.z,ca+=3;else if(4===ua.size)for(Ka=0;Ka<Yb;Ka++)Ya=ua.value[Ka],ua.array[ca]=Ya.x,ua.array[ca+1]=Ya.y,ua.array[ca+2]=Ya.z,ua.array[ca+3]=Ya.w,ca+=4;t.bindBuffer(t.ARRAY_BUFFER,ua.buffer);t.bufferData(t.ARRAY_BUFFER,ua.array,Rb);ua.needsUpdate=!1}}b.verticesNeedUpdate=!1;b.colorsNeedUpdate=!1;b.lineDistancesNeedUpdate=!1;u.attributes&&w(u)}else if(a instanceof THREE.PointCloud){u=c(a,b);y=u.attributes&&
x(u);if(b.verticesNeedUpdate||b.colorsNeedUpdate||y){var sb=t.DYNAMIC_DRAW,jb,kb,Va,Aa,$a,mb=b.vertices,ob=mb.length,pb=b.colors,Bb=pb.length,gb=b.__vertexArray,zb=b.__colorArray,Ub=b.colorsNeedUpdate,Gb=b.__webglCustomAttributesList,Ab,nb,La,Zb,Za,va;if(b.verticesNeedUpdate){for(jb=0;jb<ob;jb++)Va=mb[jb],Aa=3*jb,gb[Aa]=Va.x,gb[Aa+1]=Va.y,gb[Aa+2]=Va.z;t.bindBuffer(t.ARRAY_BUFFER,b.__webglVertexBuffer);t.bufferData(t.ARRAY_BUFFER,gb,sb)}if(Ub){for(kb=0;kb<Bb;kb++)$a=pb[kb],Aa=3*kb,zb[Aa]=$a.r,zb[Aa+
1]=$a.g,zb[Aa+2]=$a.b;t.bindBuffer(t.ARRAY_BUFFER,b.__webglColorBuffer);t.bufferData(t.ARRAY_BUFFER,zb,sb)}if(Gb)for(Ab=0,nb=Gb.length;Ab<nb;Ab++){va=Gb[Ab];if(va.needsUpdate&&(void 0===va.boundTo||"vertices"===va.boundTo))if(Zb=va.value.length,Aa=0,1===va.size)for(La=0;La<Zb;La++)va.array[La]=va.value[La];else if(2===va.size)for(La=0;La<Zb;La++)Za=va.value[La],va.array[Aa]=Za.x,va.array[Aa+1]=Za.y,Aa+=2;else if(3===va.size)if("c"===va.type)for(La=0;La<Zb;La++)Za=va.value[La],va.array[Aa]=Za.r,va.array[Aa+
1]=Za.g,va.array[Aa+2]=Za.b,Aa+=3;else for(La=0;La<Zb;La++)Za=va.value[La],va.array[Aa]=Za.x,va.array[Aa+1]=Za.y,va.array[Aa+2]=Za.z,Aa+=3;else if(4===va.size)for(La=0;La<Zb;La++)Za=va.value[La],va.array[Aa]=Za.x,va.array[Aa+1]=Za.y,va.array[Aa+2]=Za.z,va.array[Aa+3]=Za.w,Aa+=4;t.bindBuffer(t.ARRAY_BUFFER,va.buffer);t.bufferData(t.ARRAY_BUFFER,va.array,sb);va.needsUpdate=!1}}b.verticesNeedUpdate=!1;b.colorsNeedUpdate=!1;u.attributes&&w(u)}}function x(a){for(var b in a.attributes)if(a.attributes[b].needsUpdate)return!0;
return!1}function w(a){for(var b in a.attributes)a.attributes[b].needsUpdate=!1}function z(a){!0===a.transparent?Y.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst,a.blendEquationAlpha,a.blendSrcAlpha,a.blendDstAlpha):Y.setBlending(THREE.NoBlending);Y.setDepthTest(a.depthTest);Y.setDepthWrite(a.depthWrite);Y.setColorWrite(a.colorWrite);Y.setPolygonOffset(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits)}function u(a,b,c,d,e){var f,g,h,k;sb=0;if(d.needsUpdate){d.program&&jb(d);
d.addEventListener("dispose",zb);var l=Gc[d.type];if(l){var m=THREE.ShaderLib[l];d.__webglShader={uniforms:THREE.UniformsUtils.clone(m.uniforms),vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}}else d.__webglShader={uniforms:d.uniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader};for(var q=0,u=0,v=0,w=0,x=0,y=b.length;x<y;x++){var z=b[x];z.onlyShadow||!1===z.visible||(z instanceof THREE.DirectionalLight&&q++,z instanceof THREE.PointLight&&u++,z instanceof THREE.SpotLight&&
v++,z instanceof THREE.HemisphereLight&&w++)}f=q;g=u;h=v;k=w;for(var A,D=0,E=0,H=b.length;E<H;E++){var K=b[E];K.castShadow&&(K instanceof THREE.SpotLight&&D++,K instanceof THREE.DirectionalLight&&!K.shadowCascade&&D++)}A=D;var J;if(Ub&&e&&e.skeleton&&e.skeleton.useVertexTexture)J=1024;else{var N=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),S=Math.floor((N-20)/4);void 0!==e&&e instanceof THREE.SkinnedMesh&&(S=Math.min(e.skeleton.bones.length,S),S<e.skeleton.bones.length&&THREE.warn("WebGLRenderer: too many bones - "+
e.skeleton.bones.length+", this GPU supports just "+S+" (try OpenGL instead of ANGLE)"));J=S}var O={precision:P,supportsVertexTextures:Gb,map:!!d.map,envMap:!!d.envMap,envMapMode:d.envMap&&d.envMap.mapping,lightMap:!!d.lightMap,bumpMap:!!d.bumpMap,normalMap:!!d.normalMap,specularMap:!!d.specularMap,alphaMap:!!d.alphaMap,combine:d.combine,vertexColors:d.vertexColors,fog:c,useFog:d.fog,fogExp:c instanceof THREE.FogExp2,flatShading:d.shading===THREE.FlatShading,sizeAttenuation:d.sizeAttenuation,logarithmicDepthBuffer:pa,
skinning:d.skinning,maxBones:J,useVertexTexture:Ub&&e&&e.skeleton&&e.skeleton.useVertexTexture,morphTargets:d.morphTargets,morphNormals:d.morphNormals,maxMorphTargets:r.maxMorphTargets,maxMorphNormals:r.maxMorphNormals,maxDirLights:f,maxPointLights:g,maxSpotLights:h,maxHemiLights:k,maxShadows:A,shadowMapEnabled:r.shadowMapEnabled&&e.receiveShadow&&0<A,shadowMapType:r.shadowMapType,shadowMapDebug:r.shadowMapDebug,shadowMapCascade:r.shadowMapCascade,alphaTest:d.alphaTest,metal:d.metal,wrapAround:d.wrapAround,
doubleSided:d.side===THREE.DoubleSide,flipSided:d.side===THREE.BackSide},R=[];l?R.push(l):(R.push(d.fragmentShader),R.push(d.vertexShader));if(void 0!==d.defines)for(var T in d.defines)R.push(T),R.push(d.defines[T]);for(T in O)R.push(T),R.push(O[T]);for(var ha=R.join(),ba,Y=0,cb=Ea.length;Y<cb;Y++){var qa=Ea[Y];if(qa.code===ha){ba=qa;ba.usedTimes++;break}}void 0===ba&&(ba=new THREE.WebGLProgram(r,ha,d,O),Ea.push(ba),r.info.memory.programs=Ea.length);d.program=ba;var xa=ba.attributes;if(d.morphTargets){d.numSupportedMorphTargets=
0;for(var aa,Cb="morphTarget",oa=0;oa<r.maxMorphTargets;oa++)aa=Cb+oa,0<=xa[aa]&&d.numSupportedMorphTargets++}if(d.morphNormals)for(d.numSupportedMorphNormals=0,Cb="morphNormal",oa=0;oa<r.maxMorphNormals;oa++)aa=Cb+oa,0<=xa[aa]&&d.numSupportedMorphNormals++;d.uniformsList=[];for(var hb in d.__webglShader.uniforms){var Ib=d.program.uniforms[hb];Ib&&d.uniformsList.push([d.__webglShader.uniforms[hb],Ib])}d.needsUpdate=!1}d.morphTargets&&!e.__webglMorphTargetInfluences&&(e.__webglMorphTargetInfluences=
new Float32Array(r.maxMorphTargets));var Jb=!1,Db=!1,vb=!1,tb=d.program,ya=tb.uniforms,X=d.__webglShader.uniforms;tb.id!==Hb&&(t.useProgram(tb.program),Hb=tb.id,vb=Db=Jb=!0);d.id!==qb&&(-1===qb&&(vb=!0),qb=d.id,Db=!0);if(Jb||a!==rb)t.uniformMatrix4fv(ya.projectionMatrix,!1,a.projectionMatrix.elements),pa&&t.uniform1f(ya.logDepthBufFC,2/(Math.log(a.far+1)/Math.LN2)),a!==rb&&(rb=a),(d instanceof THREE.ShaderMaterial||d instanceof THREE.MeshPhongMaterial||d.envMap)&&null!==ya.cameraPosition&&(ka.setFromMatrixPosition(a.matrixWorld),
t.uniform3f(ya.cameraPosition,ka.x,ka.y,ka.z)),(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshBasicMaterial||d instanceof THREE.ShaderMaterial||d.skinning)&&null!==ya.viewMatrix&&t.uniformMatrix4fv(ya.viewMatrix,!1,a.matrixWorldInverse.elements);if(d.skinning)if(e.bindMatrix&&null!==ya.bindMatrix&&t.uniformMatrix4fv(ya.bindMatrix,!1,e.bindMatrix.elements),e.bindMatrixInverse&&null!==ya.bindMatrixInverse&&t.uniformMatrix4fv(ya.bindMatrixInverse,
!1,e.bindMatrixInverse.elements),Ub&&e.skeleton&&e.skeleton.useVertexTexture){if(null!==ya.boneTexture){var Kb=G();t.uniform1i(ya.boneTexture,Kb);r.setTexture(e.skeleton.boneTexture,Kb)}null!==ya.boneTextureWidth&&t.uniform1i(ya.boneTextureWidth,e.skeleton.boneTextureWidth);null!==ya.boneTextureHeight&&t.uniform1i(ya.boneTextureHeight,e.skeleton.boneTextureHeight)}else e.skeleton&&e.skeleton.boneMatrices&&null!==ya.boneGlobalMatrices&&t.uniformMatrix4fv(ya.boneGlobalMatrices,!1,e.skeleton.boneMatrices);
if(Db){c&&d.fog&&(X.fogColor.value=c.color,c instanceof THREE.Fog?(X.fogNear.value=c.near,X.fogFar.value=c.far):c instanceof THREE.FogExp2&&(X.fogDensity.value=c.density));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights){if(Ba){var vb=!0,wa,Na,ea,da=0,sa=0,ma=0,ia,ja,cc,Wa,ra,Ca=sc,Fc=Ca.directional.colors,bb=Ca.directional.positions,fb=Ca.point.colors,ta=Ca.point.positions,Ma=Ca.point.distances,Pb=Ca.point.decays,db=Ca.spot.colors,Ua=Ca.spot.positions,wb=
Ca.spot.distances,Xa=Ca.spot.directions,za=Ca.spot.anglesCos,Ga=Ca.spot.exponents,Q=Ca.spot.decays,Qa=Ca.hemi.skyColors,eb=Ca.hemi.groundColors,Qb=Ca.hemi.positions,Eb=0,Da=0,Ha=0,Ja=0,Va=0,$a=0,ab=0,oc=0,Ta=0,M=0,Lb=0,Fa=0;wa=0;for(Na=b.length;wa<Na;wa++)ea=b[wa],ea.onlyShadow||(ia=ea.color,Wa=ea.intensity,ra=ea.distance,ea instanceof THREE.AmbientLight?ea.visible&&(da+=ia.r,sa+=ia.g,ma+=ia.b):ea instanceof THREE.DirectionalLight?(Va+=1,ea.visible&&(V.setFromMatrixPosition(ea.matrixWorld),ka.setFromMatrixPosition(ea.target.matrixWorld),
V.sub(ka),V.normalize(),Ta=3*Eb,bb[Ta]=V.x,bb[Ta+1]=V.y,bb[Ta+2]=V.z,C(Fc,Ta,ia,Wa),Eb+=1)):ea instanceof THREE.PointLight?($a+=1,ea.visible&&(M=3*Da,C(fb,M,ia,Wa),ka.setFromMatrixPosition(ea.matrixWorld),ta[M]=ka.x,ta[M+1]=ka.y,ta[M+2]=ka.z,Ma[Da]=ra,Pb[Da]=0===ea.distance?0:ea.decay,Da+=1)):ea instanceof THREE.SpotLight?(ab+=1,ea.visible&&(Lb=3*Ha,C(db,Lb,ia,Wa),V.setFromMatrixPosition(ea.matrixWorld),Ua[Lb]=V.x,Ua[Lb+1]=V.y,Ua[Lb+2]=V.z,wb[Ha]=ra,ka.setFromMatrixPosition(ea.target.matrixWorld),
V.sub(ka),V.normalize(),Xa[Lb]=V.x,Xa[Lb+1]=V.y,Xa[Lb+2]=V.z,za[Ha]=Math.cos(ea.angle),Ga[Ha]=ea.exponent,Q[Ha]=0===ea.distance?0:ea.decay,Ha+=1)):ea instanceof THREE.HemisphereLight&&(oc+=1,ea.visible&&(V.setFromMatrixPosition(ea.matrixWorld),V.normalize(),Fa=3*Ja,Qb[Fa]=V.x,Qb[Fa+1]=V.y,Qb[Fa+2]=V.z,ja=ea.color,cc=ea.groundColor,C(Qa,Fa,ja,Wa),C(eb,Fa,cc,Wa),Ja+=1)));wa=3*Eb;for(Na=Math.max(Fc.length,3*Va);wa<Na;wa++)Fc[wa]=0;wa=3*Da;for(Na=Math.max(fb.length,3*$a);wa<Na;wa++)fb[wa]=0;wa=3*Ha;for(Na=
Math.max(db.length,3*ab);wa<Na;wa++)db[wa]=0;wa=3*Ja;for(Na=Math.max(Qa.length,3*oc);wa<Na;wa++)Qa[wa]=0;wa=3*Ja;for(Na=Math.max(eb.length,3*oc);wa<Na;wa++)eb[wa]=0;Ca.directional.length=Eb;Ca.point.length=Da;Ca.spot.length=Ha;Ca.hemi.length=Ja;Ca.ambient[0]=da;Ca.ambient[1]=sa;Ca.ambient[2]=ma;Ba=!1}if(vb){var la=sc;X.ambientLightColor.value=la.ambient;X.directionalLightColor.value=la.directional.colors;X.directionalLightDirection.value=la.directional.positions;X.pointLightColor.value=la.point.colors;
X.pointLightPosition.value=la.point.positions;X.pointLightDistance.value=la.point.distances;X.pointLightDecay.value=la.point.decays;X.spotLightColor.value=la.spot.colors;X.spotLightPosition.value=la.spot.positions;X.spotLightDistance.value=la.spot.distances;X.spotLightDirection.value=la.spot.directions;X.spotLightAngleCos.value=la.spot.anglesCos;X.spotLightExponent.value=la.spot.exponents;X.spotLightDecay.value=la.spot.decays;X.hemisphereLightSkyColor.value=la.hemi.skyColors;X.hemisphereLightGroundColor.value=
la.hemi.groundColors;X.hemisphereLightDirection.value=la.hemi.positions;B(X,!0)}else B(X,!1)}if(d instanceof THREE.MeshBasicMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial){X.opacity.value=d.opacity;X.diffuse.value=d.color;X.map.value=d.map;X.lightMap.value=d.lightMap;X.specularMap.value=d.specularMap;X.alphaMap.value=d.alphaMap;d.bumpMap&&(X.bumpMap.value=d.bumpMap,X.bumpScale.value=d.bumpScale);d.normalMap&&(X.normalMap.value=d.normalMap,X.normalScale.value.copy(d.normalScale));
var Mb;d.map?Mb=d.map:d.specularMap?Mb=d.specularMap:d.normalMap?Mb=d.normalMap:d.bumpMap?Mb=d.bumpMap:d.alphaMap&&(Mb=d.alphaMap);if(void 0!==Mb){var gb=Mb.offset,lb=Mb.repeat;X.offsetRepeat.value.set(gb.x,gb.y,lb.x,lb.y)}X.envMap.value=d.envMap;X.flipEnvMap.value=d.envMap instanceof THREE.WebGLRenderTargetCube?1:-1;X.reflectivity.value=d.reflectivity;X.refractionRatio.value=d.refractionRatio}if(d instanceof THREE.LineBasicMaterial)X.diffuse.value=d.color,X.opacity.value=d.opacity;else if(d instanceof
THREE.LineDashedMaterial)X.diffuse.value=d.color,X.opacity.value=d.opacity,X.dashSize.value=d.dashSize,X.totalSize.value=d.dashSize+d.gapSize,X.scale.value=d.scale;else if(d instanceof THREE.PointCloudMaterial){if(X.psColor.value=d.color,X.opacity.value=d.opacity,X.size.value=d.size,X.scale.value=U.height/2,X.map.value=d.map,null!==d.map){var mb=d.map.offset,pb=d.map.repeat;X.offsetRepeat.value.set(mb.x,mb.y,pb.x,pb.y)}}else d instanceof THREE.MeshPhongMaterial?(X.shininess.value=d.shininess,X.emissive.value=
d.emissive,X.specular.value=d.specular,d.wrapAround&&X.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshLambertMaterial?(X.emissive.value=d.emissive,d.wrapAround&&X.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshDepthMaterial?(X.mNear.value=a.near,X.mFar.value=a.far,X.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&(X.opacity.value=d.opacity);if(e.receiveShadow&&!d._shadowPass&&X.shadowMatrix)for(var Nb=0,nb=0,na=b.length;nb<na;nb++){var Ia=b[nb];Ia.castShadow&&(Ia instanceof
THREE.SpotLight||Ia instanceof THREE.DirectionalLight&&!Ia.shadowCascade)&&(X.shadowMap.value[Nb]=Ia.shadowMap,X.shadowMapSize.value[Nb]=Ia.shadowMapSize,X.shadowMatrix.value[Nb]=Ia.shadowMatrix,X.shadowDarkness.value[Nb]=Ia.shadowDarkness,X.shadowBias.value[Nb]=Ia.shadowBias,Nb++)}for(var ob=d.uniformsList,Oa,ub,Ra,Fb=0,Bb=ob.length;Fb<Bb;Fb++){var Z=ob[Fb][0];if(!1!==Z.needsUpdate){var Rb=Z.type,W=Z.value,fa=ob[Fb][1];switch(Rb){case "1i":t.uniform1i(fa,W);break;case "1f":t.uniform1f(fa,W);break;
case "2f":t.uniform2f(fa,W[0],W[1]);break;case "3f":t.uniform3f(fa,W[0],W[1],W[2]);break;case "4f":t.uniform4f(fa,W[0],W[1],W[2],W[3]);break;case "1iv":t.uniform1iv(fa,W);break;case "3iv":t.uniform3iv(fa,W);break;case "1fv":t.uniform1fv(fa,W);break;case "2fv":t.uniform2fv(fa,W);break;case "3fv":t.uniform3fv(fa,W);break;case "4fv":t.uniform4fv(fa,W);break;case "Matrix3fv":t.uniformMatrix3fv(fa,!1,W);break;case "Matrix4fv":t.uniformMatrix4fv(fa,!1,W);break;case "i":t.uniform1i(fa,W);break;case "f":t.uniform1f(fa,
W);break;case "v2":t.uniform2f(fa,W.x,W.y);break;case "v3":t.uniform3f(fa,W.x,W.y,W.z);break;case "v4":t.uniform4f(fa,W.x,W.y,W.z,W.w);break;case "c":t.uniform3f(fa,W.r,W.g,W.b);break;case "iv1":t.uniform1iv(fa,W);break;case "iv":t.uniform3iv(fa,W);break;case "fv1":t.uniform1fv(fa,W);break;case "fv":t.uniform3fv(fa,W);break;case "v2v":void 0===Z._array&&(Z._array=new Float32Array(2*W.length));for(var ga=0,Sa=W.length;ga<Sa;ga++)Ra=2*ga,Z._array[Ra]=W[ga].x,Z._array[Ra+1]=W[ga].y;t.uniform2fv(fa,Z._array);
break;case "v3v":void 0===Z._array&&(Z._array=new Float32Array(3*W.length));ga=0;for(Sa=W.length;ga<Sa;ga++)Ra=3*ga,Z._array[Ra]=W[ga].x,Z._array[Ra+1]=W[ga].y,Z._array[Ra+2]=W[ga].z;t.uniform3fv(fa,Z._array);break;case "v4v":void 0===Z._array&&(Z._array=new Float32Array(4*W.length));ga=0;for(Sa=W.length;ga<Sa;ga++)Ra=4*ga,Z._array[Ra]=W[ga].x,Z._array[Ra+1]=W[ga].y,Z._array[Ra+2]=W[ga].z,Z._array[Ra+3]=W[ga].w;t.uniform4fv(fa,Z._array);break;case "m3":t.uniformMatrix3fv(fa,!1,W.elements);break;case "m3v":void 0===
Z._array&&(Z._array=new Float32Array(9*W.length));ga=0;for(Sa=W.length;ga<Sa;ga++)W[ga].flattenToArrayOffset(Z._array,9*ga);t.uniformMatrix3fv(fa,!1,Z._array);break;case "m4":t.uniformMatrix4fv(fa,!1,W.elements);break;case "m4v":void 0===Z._array&&(Z._array=new Float32Array(16*W.length));ga=0;for(Sa=W.length;ga<Sa;ga++)W[ga].flattenToArrayOffset(Z._array,16*ga);t.uniformMatrix4fv(fa,!1,Z._array);break;case "t":Oa=W;ub=G();t.uniform1i(fa,ub);if(!Oa)continue;if(Oa instanceof THREE.CubeTexture||Oa.image instanceof
Array&&6===Oa.image.length){var ca=Oa,Sb=ub;if(6===ca.image.length)if(ca.needsUpdate){ca.image.__webglTextureCube||(ca.addEventListener("dispose",Ab),ca.image.__webglTextureCube=t.createTexture(),r.info.memory.textures++);t.activeTexture(t.TEXTURE0+Sb);t.bindTexture(t.TEXTURE_CUBE_MAP,ca.image.__webglTextureCube);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ca.flipY);for(var dc=ca instanceof THREE.CompressedTexture,Wb=ca.image[0]instanceof THREE.DataTexture,xb=[],Pa=0;6>Pa;Pa++)xb[Pa]=!r.autoScaleCubemaps||
dc||Wb?Wb?ca.image[Pa].image:ca.image[Pa]:I(ca.image[Pa],Hc);var pc=xb[0],qc=THREE.Math.isPowerOfTwo(pc.width)&&THREE.Math.isPowerOfTwo(pc.height),ib=L(ca.format),Ob=L(ca.type);F(t.TEXTURE_CUBE_MAP,ca,qc);for(Pa=0;6>Pa;Pa++)if(dc)for(var yb,rc=xb[Pa].mipmaps,Tb=0,ec=rc.length;Tb<ec;Tb++)yb=rc[Tb],ca.format!==THREE.RGBAFormat&&ca.format!==THREE.RGBFormat?-1<kb().indexOf(ib)?t.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pa,Tb,ib,yb.width,yb.height,0,yb.data):THREE.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):
t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pa,Tb,ib,yb.width,yb.height,0,ib,Ob,yb.data);else Wb?t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pa,0,ib,xb[Pa].width,xb[Pa].height,0,ib,Ob,xb[Pa].data):t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pa,0,ib,ib,Ob,xb[Pa]);ca.generateMipmaps&&qc&&t.generateMipmap(t.TEXTURE_CUBE_MAP);ca.needsUpdate=!1;if(ca.onUpdate)ca.onUpdate()}else t.activeTexture(t.TEXTURE0+Sb),t.bindTexture(t.TEXTURE_CUBE_MAP,ca.image.__webglTextureCube)}else if(Oa instanceof THREE.WebGLRenderTargetCube){var Xb=
Oa;t.activeTexture(t.TEXTURE0+ub);t.bindTexture(t.TEXTURE_CUBE_MAP,Xb.__webglTexture)}else r.setTexture(Oa,ub);break;case "tv":void 0===Z._array&&(Z._array=[]);ga=0;for(Sa=Z.value.length;ga<Sa;ga++)Z._array[ga]=G();t.uniform1iv(fa,Z._array);ga=0;for(Sa=Z.value.length;ga<Sa;ga++)Oa=Z.value[ga],ub=Z._array[ga],Oa&&r.setTexture(Oa,ub);break;default:THREE.warn("THREE.WebGLRenderer: Unknown uniform type: "+Rb)}}}}t.uniformMatrix4fv(ya.modelViewMatrix,!1,e._modelViewMatrix.elements);ya.normalMatrix&&t.uniformMatrix3fv(ya.normalMatrix,
!1,e._normalMatrix.elements);null!==ya.modelMatrix&&t.uniformMatrix4fv(ya.modelMatrix,!1,e.matrixWorld.elements);return tb}function B(a,b){a.ambientLightColor.needsUpdate=b;a.directionalLightColor.needsUpdate=b;a.directionalLightDirection.needsUpdate=b;a.pointLightColor.needsUpdate=b;a.pointLightPosition.needsUpdate=b;a.pointLightDistance.needsUpdate=b;a.pointLightDecay.needsUpdate=b;a.spotLightColor.needsUpdate=b;a.spotLightPosition.needsUpdate=b;a.spotLightDistance.needsUpdate=b;a.spotLightDirection.needsUpdate=
b;a.spotLightAngleCos.needsUpdate=b;a.spotLightExponent.needsUpdate=b;a.spotLightDecay.needsUpdate=b;a.hemisphereLightSkyColor.needsUpdate=b;a.hemisphereLightGroundColor.needsUpdate=b;a.hemisphereLightDirection.needsUpdate=b}function G(){var a=sb;a>=nb&&THREE.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+nb);sb+=1;return a}function A(a,b){a._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,a.matrixWorld);a._normalMatrix.getNormalMatrix(a._modelViewMatrix)}
function C(a,b,c,d){a[b]=c.r*d;a[b+1]=c.g*d;a[b+2]=c.b*d}function F(a,b,c){c?(t.texParameteri(a,t.TEXTURE_WRAP_S,L(b.wrapS)),t.texParameteri(a,t.TEXTURE_WRAP_T,L(b.wrapT)),t.texParameteri(a,t.TEXTURE_MAG_FILTER,L(b.magFilter)),t.texParameteri(a,t.TEXTURE_MIN_FILTER,L(b.minFilter))):(t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),b.wrapS===THREE.ClampToEdgeWrapping&&b.wrapT===THREE.ClampToEdgeWrapping||THREE.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+
b.sourceFile+" )"),t.texParameteri(a,t.TEXTURE_MAG_FILTER,E(b.magFilter)),t.texParameteri(a,t.TEXTURE_MIN_FILTER,E(b.minFilter)),b.minFilter!==THREE.NearestFilter&&b.minFilter!==THREE.LinearFilter&&THREE.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+b.sourceFile+" )"));(c=ma.get("EXT_texture_filter_anisotropic"))&&b.type!==THREE.FloatType&&b.type!==THREE.HalfFloatType&&(1<b.anisotropy||b.__currentAnisotropy)&&
(t.texParameterf(a,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,r.getMaxAnisotropy())),b.__currentAnisotropy=b.anisotropy)}function I(a,b){if(a.width>b||a.height>b){var c=b/Math.max(a.width,a.height),d=document.createElement("canvas");d.width=Math.floor(a.width*c);d.height=Math.floor(a.height*c);d.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,d.width,d.height);THREE.warn("THREE.WebGLRenderer: image is too big ("+a.width+"x"+a.height+"). Resized to "+d.width+"x"+d.height,a);return d}return a}
function D(a,b){t.bindRenderbuffer(t.RENDERBUFFER,a);b.depthBuffer&&!b.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,b.width,b.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,a)):b.depthBuffer&&b.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,b.width,b.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,a)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,b.width,b.height)}function H(a){a instanceof
THREE.WebGLRenderTargetCube?(t.bindTexture(t.TEXTURE_CUBE_MAP,a.__webglTexture),t.generateMipmap(t.TEXTURE_CUBE_MAP),t.bindTexture(t.TEXTURE_CUBE_MAP,null)):(t.bindTexture(t.TEXTURE_2D,a.__webglTexture),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null))}function E(a){return a===THREE.NearestFilter||a===THREE.NearestMipMapNearestFilter||a===THREE.NearestMipMapLinearFilter?t.NEAREST:t.LINEAR}function L(a){var b;if(a===THREE.RepeatWrapping)return t.REPEAT;if(a===THREE.ClampToEdgeWrapping)return t.CLAMP_TO_EDGE;
if(a===THREE.MirroredRepeatWrapping)return t.MIRRORED_REPEAT;if(a===THREE.NearestFilter)return t.NEAREST;if(a===THREE.NearestMipMapNearestFilter)return t.NEAREST_MIPMAP_NEAREST;if(a===THREE.NearestMipMapLinearFilter)return t.NEAREST_MIPMAP_LINEAR;if(a===THREE.LinearFilter)return t.LINEAR;if(a===THREE.LinearMipMapNearestFilter)return t.LINEAR_MIPMAP_NEAREST;if(a===THREE.LinearMipMapLinearFilter)return t.LINEAR_MIPMAP_LINEAR;if(a===THREE.UnsignedByteType)return t.UNSIGNED_BYTE;if(a===THREE.UnsignedShort4444Type)return t.UNSIGNED_SHORT_4_4_4_4;
if(a===THREE.UnsignedShort5551Type)return t.UNSIGNED_SHORT_5_5_5_1;if(a===THREE.UnsignedShort565Type)return t.UNSIGNED_SHORT_5_6_5;if(a===THREE.ByteType)return t.BYTE;if(a===THREE.ShortType)return t.SHORT;if(a===THREE.UnsignedShortType)return t.UNSIGNED_SHORT;if(a===THREE.IntType)return t.INT;if(a===THREE.UnsignedIntType)return t.UNSIGNED_INT;if(a===THREE.FloatType)return t.FLOAT;b=ma.get("OES_texture_half_float");if(null!==b&&a===THREE.HalfFloatType)return b.HALF_FLOAT_OES;if(a===THREE.AlphaFormat)return t.ALPHA;
if(a===THREE.RGBFormat)return t.RGB;if(a===THREE.RGBAFormat)return t.RGBA;if(a===THREE.LuminanceFormat)return t.LUMINANCE;if(a===THREE.LuminanceAlphaFormat)return t.LUMINANCE_ALPHA;if(a===THREE.AddEquation)return t.FUNC_ADD;if(a===THREE.SubtractEquation)return t.FUNC_SUBTRACT;if(a===THREE.ReverseSubtractEquation)return t.FUNC_REVERSE_SUBTRACT;if(a===THREE.ZeroFactor)return t.ZERO;if(a===THREE.OneFactor)return t.ONE;if(a===THREE.SrcColorFactor)return t.SRC_COLOR;if(a===THREE.OneMinusSrcColorFactor)return t.ONE_MINUS_SRC_COLOR;
if(a===THREE.SrcAlphaFactor)return t.SRC_ALPHA;if(a===THREE.OneMinusSrcAlphaFactor)return t.ONE_MINUS_SRC_ALPHA;if(a===THREE.DstAlphaFactor)return t.DST_ALPHA;if(a===THREE.OneMinusDstAlphaFactor)return t.ONE_MINUS_DST_ALPHA;if(a===THREE.DstColorFactor)return t.DST_COLOR;if(a===THREE.OneMinusDstColorFactor)return t.ONE_MINUS_DST_COLOR;if(a===THREE.SrcAlphaSaturateFactor)return t.SRC_ALPHA_SATURATE;b=ma.get("WEBGL_compressed_texture_s3tc");if(null!==b){if(a===THREE.RGB_S3TC_DXT1_Format)return b.COMPRESSED_RGB_S3TC_DXT1_EXT;
if(a===THREE.RGBA_S3TC_DXT1_Format)return b.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT3_Format)return b.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===THREE.RGBA_S3TC_DXT5_Format)return b.COMPRESSED_RGBA_S3TC_DXT5_EXT}b=ma.get("WEBGL_compressed_texture_pvrtc");if(null!==b){if(a===THREE.RGB_PVRTC_4BPPV1_Format)return b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===THREE.RGB_PVRTC_2BPPV1_Format)return b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===THREE.RGBA_PVRTC_4BPPV1_Format)return b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
if(a===THREE.RGBA_PVRTC_2BPPV1_Format)return b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=ma.get("EXT_blend_minmax");if(null!==b){if(a===THREE.MinEquation)return b.MIN_EXT;if(a===THREE.MaxEquation)return b.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);a=a||{};var U=void 0!==a.canvas?a.canvas:document.createElement("canvas"),O=void 0!==a.context?a.context:null,J=1,P=void 0!==a.precision?a.precision:"highp",T=void 0!==a.alpha?a.alpha:!1,S=void 0!==a.depth?a.depth:!0,R=void 0!==a.stencil?
a.stencil:!0,ba=void 0!==a.antialias?a.antialias:!1,N=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,ja=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,pa=void 0!==a.logarithmicDepthBuffer?a.logarithmicDepthBuffer:!1,da=new THREE.Color(0),K=0,ra=[],ia={},ta=[],cb=[],xa=[],qa=[],ha=[];this.domElement=U;this.context=null;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.gammaFactor=2;this.shadowMapEnabled=this.gammaOutput=this.gammaInput=
!1;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapCascade=this.shadowMapDebug=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var r=this,Ea=[],Hb=null,fb=null,qb=-1,sa="",rb=null,sb=0,$a=0,Ta=0,ob=U.width,pb=U.height,tc=0,Da=0,mb=new THREE.Frustum,ab=new THREE.Matrix4,ka=new THREE.Vector3,V=new THREE.Vector3,Ba=!0,sc={ambient:[0,
0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},t;try{var Va={alpha:T,depth:S,stencil:R,antialias:ba,premultipliedAlpha:N,preserveDrawingBuffer:ja};t=O||U.getContext("webgl",Va)||U.getContext("experimental-webgl",Va);if(null===t){if(null!==U.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";
throw"Error creating WebGL context.";}U.addEventListener("webglcontextlost",function(a){a.preventDefault();fc();uc();ia={}},!1)}catch(Fa){THREE.error("THREE.WebGLRenderer: "+Fa)}var Y=new THREE.WebGLState(t,L);void 0===t.getShaderPrecisionFormat&&(t.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});var ma=new THREE.WebGLExtensions(t);ma.get("OES_texture_float");ma.get("OES_texture_float_linear");ma.get("OES_texture_half_float");ma.get("OES_texture_half_float_linear");
ma.get("OES_standard_derivatives");pa&&ma.get("EXT_frag_depth");var gc=function(a,b,c,d){!0===N&&(a*=d,b*=d,c*=d);t.clearColor(a,b,c,d)},uc=function(){t.clearColor(0,0,0,1);t.clearDepth(1);t.clearStencil(0);t.enable(t.DEPTH_TEST);t.depthFunc(t.LEQUAL);t.frontFace(t.CCW);t.cullFace(t.BACK);t.enable(t.CULL_FACE);t.enable(t.BLEND);t.blendEquation(t.FUNC_ADD);t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA);t.viewport($a,Ta,ob,pb);gc(da.r,da.g,da.b,K)},fc=function(){rb=Hb=null;sa="";qb=-1;Ba=!0;Y.reset()};
uc();this.context=t;this.state=Y;var nb=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),vc=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),wc=t.getParameter(t.MAX_TEXTURE_SIZE),Hc=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),Gb=0<vc,Ub=Gb&&ma.get("OES_texture_float"),xc=t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT),Ic=t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT),Jc=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT),Ma=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT),
kb=function(){var a;return function(){if(void 0!==a)return a;a=[];if(ma.get("WEBGL_compressed_texture_pvrtc")||ma.get("WEBGL_compressed_texture_s3tc"))for(var b=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),c=0;c<b.length;c++)a.push(b[c]);return a}}(),yc=0<xc.precision&&0<Jc.precision,hc=0<Ic.precision&&0<Ma.precision;"highp"!==P||yc||(hc?(P="mediump",THREE.warn("THREE.WebGLRenderer: highp not supported, using mediump.")):(P="lowp",THREE.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp.")));
"mediump"!==P||hc||(P="lowp",THREE.warn("THREE.WebGLRenderer: mediump not supported, using lowp."));var ic=new THREE.ShadowMapPlugin(this,ra,ia,ta),Bb=new THREE.SpritePlugin(this,qa),Kc=new THREE.LensFlarePlugin(this,ha);this.getContext=function(){return t};this.forceContextLoss=function(){ma.get("WEBGL_lose_context").loseContext()};this.supportsVertexTextures=function(){return Gb};this.supportsFloatTextures=function(){return ma.get("OES_texture_float")};this.supportsHalfFloatTextures=function(){return ma.get("OES_texture_half_float")};
this.supportsStandardDerivatives=function(){return ma.get("OES_standard_derivatives")};this.supportsCompressedTextureS3TC=function(){return ma.get("WEBGL_compressed_texture_s3tc")};this.supportsCompressedTexturePVRTC=function(){return ma.get("WEBGL_compressed_texture_pvrtc")};this.supportsBlendMinMax=function(){return ma.get("EXT_blend_minmax")};this.getMaxAnisotropy=function(){var a;return function(){if(void 0!==a)return a;var b=ma.get("EXT_texture_filter_anisotropic");return a=null!==b?t.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT):
0}}();this.getPrecision=function(){return P};this.getPixelRatio=function(){return J};this.setPixelRatio=function(a){J=a};this.setSize=function(a,b,c){U.width=a*J;U.height=b*J;!1!==c&&(U.style.width=a+"px",U.style.height=b+"px");this.setViewport(0,0,a,b)};this.setViewport=function(a,b,c,d){$a=a*J;Ta=b*J;ob=c*J;pb=d*J;t.viewport($a,Ta,ob,pb)};this.setScissor=function(a,b,c,d){t.scissor(a*J,b*J,c*J,d*J)};this.enableScissorTest=function(a){a?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)};this.getClearColor=
function(){return da};this.setClearColor=function(a,b){da.set(a);K=void 0!==b?b:1;gc(da.r,da.g,da.b,K)};this.getClearAlpha=function(){return K};this.setClearAlpha=function(a){K=a;gc(da.r,da.g,da.b,K)};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=t.COLOR_BUFFER_BIT;if(void 0===b||b)d|=t.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=t.STENCIL_BUFFER_BIT;t.clear(d)};this.clearColor=function(){t.clear(t.COLOR_BUFFER_BIT)};this.clearDepth=function(){t.clear(t.DEPTH_BUFFER_BIT)};this.clearStencil=function(){t.clear(t.STENCIL_BUFFER_BIT)};
this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.resetGLState=fc;var lc=function(a){a.target.traverse(function(a){a.removeEventListener("remove",lc);if(a instanceof THREE.Mesh||a instanceof THREE.PointCloud||a instanceof THREE.Line)delete ia[a.id];else if(a instanceof THREE.ImmediateRenderObject||a.immediateRenderCallback)for(var b=ta,c=b.length-1;0<=c;c--)b[c].object===a&&b.splice(c,1);delete a.__webglInit;delete a._modelViewMatrix;delete a._normalMatrix;delete a.__webglActive})},
mc=function(a){a=a.target;a.removeEventListener("dispose",mc);delete a.__webglInit;if(a instanceof THREE.BufferGeometry){for(var b in a.attributes){var c=a.attributes[b];void 0!==c.buffer&&(t.deleteBuffer(c.buffer),delete c.buffer)}r.info.memory.geometries--}else if(b=lb[a.id],void 0!==b){for(var c=0,d=b.length;c<d;c++){var e=b[c];if(void 0!==e.numMorphTargets){for(var f=0,g=e.numMorphTargets;f<g;f++)t.deleteBuffer(e.__webglMorphTargetsBuffers[f]);delete e.__webglMorphTargetsBuffers}if(void 0!==e.numMorphNormals){f=
0;for(g=e.numMorphNormals;f<g;f++)t.deleteBuffer(e.__webglMorphNormalsBuffers[f]);delete e.__webglMorphNormalsBuffers}Ja(e)}delete lb[a.id]}else Ja(a);sa=""},Ab=function(a){a=a.target;a.removeEventListener("dispose",Ab);a.image&&a.image.__webglTextureCube?(t.deleteTexture(a.image.__webglTextureCube),delete a.image.__webglTextureCube):void 0!==a.__webglInit&&(t.deleteTexture(a.__webglTexture),delete a.__webglTexture,delete a.__webglInit);r.info.memory.textures--},jc=function(a){a=a.target;a.removeEventListener("dispose",
jc);if(a&&void 0!==a.__webglTexture){t.deleteTexture(a.__webglTexture);delete a.__webglTexture;if(a instanceof THREE.WebGLRenderTargetCube)for(var b=0;6>b;b++)t.deleteFramebuffer(a.__webglFramebuffer[b]),t.deleteRenderbuffer(a.__webglRenderbuffer[b]);else t.deleteFramebuffer(a.__webglFramebuffer),t.deleteRenderbuffer(a.__webglRenderbuffer);delete a.__webglFramebuffer;delete a.__webglRenderbuffer}r.info.memory.textures--},zb=function(a){a=a.target;a.removeEventListener("dispose",zb);jb(a)},Ja=function(a){for(var b=
"__webglVertexBuffer __webglNormalBuffer __webglTangentBuffer __webglColorBuffer __webglUVBuffer __webglUV2Buffer __webglSkinIndicesBuffer __webglSkinWeightsBuffer __webglFaceBuffer __webglLineBuffer __webglLineDistanceBuffer".split(" "),c=0,d=b.length;c<d;c++){var e=b[c];void 0!==a[e]&&(t.deleteBuffer(a[e]),delete a[e])}if(void 0!==a.__webglCustomAttributesList){for(e in a.__webglCustomAttributesList)t.deleteBuffer(a.__webglCustomAttributesList[e].buffer);delete a.__webglCustomAttributesList}r.info.memory.geometries--},
jb=function(a){var b=a.program.program;if(void 0!==b){a.program=void 0;var c,d,e=!1;a=0;for(c=Ea.length;a<c;a++)if(d=Ea[a],d.program===b){d.usedTimes--;0===d.usedTimes&&(e=!0);break}if(!0===e){e=[];a=0;for(c=Ea.length;a<c;a++)d=Ea[a],d.program!==b&&e.push(d);Ea=e;t.deleteProgram(b);r.info.memory.programs--}}};this.renderBufferImmediate=function(a,b,c){Y.initAttributes();a.hasPositions&&!a.__webglVertexBuffer&&(a.__webglVertexBuffer=t.createBuffer());a.hasNormals&&!a.__webglNormalBuffer&&(a.__webglNormalBuffer=
t.createBuffer());a.hasUvs&&!a.__webglUvBuffer&&(a.__webglUvBuffer=t.createBuffer());a.hasColors&&!a.__webglColorBuffer&&(a.__webglColorBuffer=t.createBuffer());a.hasPositions&&(t.bindBuffer(t.ARRAY_BUFFER,a.__webglVertexBuffer),t.bufferData(t.ARRAY_BUFFER,a.positionArray,t.DYNAMIC_DRAW),Y.enableAttribute(b.attributes.position),t.vertexAttribPointer(b.attributes.position,3,t.FLOAT,!1,0,0));if(a.hasNormals){t.bindBuffer(t.ARRAY_BUFFER,a.__webglNormalBuffer);if(!1===c instanceof THREE.MeshPhongMaterial&&
c.shading===THREE.FlatShading){var d,e,f,g,h,k,l,m,q,r,u,v=3*a.count;for(u=0;u<v;u+=9)r=a.normalArray,d=r[u],e=r[u+1],f=r[u+2],g=r[u+3],k=r[u+4],m=r[u+5],h=r[u+6],l=r[u+7],q=r[u+8],d=(d+g+h)/3,e=(e+k+l)/3,f=(f+m+q)/3,r[u]=d,r[u+1]=e,r[u+2]=f,r[u+3]=d,r[u+4]=e,r[u+5]=f,r[u+6]=d,r[u+7]=e,r[u+8]=f}t.bufferData(t.ARRAY_BUFFER,a.normalArray,t.DYNAMIC_DRAW);Y.enableAttribute(b.attributes.normal);t.vertexAttribPointer(b.attributes.normal,3,t.FLOAT,!1,0,0)}a.hasUvs&&c.map&&(t.bindBuffer(t.ARRAY_BUFFER,a.__webglUvBuffer),
t.bufferData(t.ARRAY_BUFFER,a.uvArray,t.DYNAMIC_DRAW),Y.enableAttribute(b.attributes.uv),t.vertexAttribPointer(b.attributes.uv,2,t.FLOAT,!1,0,0));a.hasColors&&c.vertexColors!==THREE.NoColors&&(t.bindBuffer(t.ARRAY_BUFFER,a.__webglColorBuffer),t.bufferData(t.ARRAY_BUFFER,a.colorArray,t.DYNAMIC_DRAW),Y.enableAttribute(b.attributes.color),t.vertexAttribPointer(b.attributes.color,3,t.FLOAT,!1,0,0));Y.disableUnusedAttributes();t.drawArrays(t.TRIANGLES,0,a.count);a.count=0};this.renderBufferDirect=function(a,
b,c,e,f,g){if(!1!==e.visible)if(y(g),a=u(a,b,c,e,g),b=!1,c="direct_"+f.id+"_"+a.id+"_"+(e.wireframe?1:0),c!==sa&&(sa=c,b=!0),b&&Y.initAttributes(),g instanceof THREE.Mesh){g=!0===e.wireframe?t.LINES:t.TRIANGLES;var h=f.attributes.index;if(h){var k,l;h.array instanceof Uint32Array&&ma.get("OES_element_index_uint")?(k=t.UNSIGNED_INT,l=4):(k=t.UNSIGNED_SHORT,l=2);c=f.offsets;if(0===c.length)b&&(d(e,a,f,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,h.buffer)),t.drawElements(g,h.array.length,k,0),r.info.render.calls++,
r.info.render.vertices+=h.array.length,r.info.render.faces+=h.array.length/3;else{b=!0;for(var m=0,q=c.length;m<q;m++){var v=c[m].index;b&&(d(e,a,f,v),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,h.buffer));t.drawElements(g,c[m].count,k,c[m].start*l);r.info.render.calls++;r.info.render.vertices+=c[m].count;r.info.render.faces+=c[m].count/3}}}else b&&d(e,a,f,0),e=f.attributes.position,t.drawArrays(g,0,e.array.length/e.itemSize),r.info.render.calls++,r.info.render.vertices+=e.array.length/e.itemSize,r.info.render.faces+=
e.array.length/(3*e.itemSize)}else if(g instanceof THREE.PointCloud)if(g=t.POINTS,h=f.attributes.index)if(h.array instanceof Uint32Array&&ma.get("OES_element_index_uint")?(k=t.UNSIGNED_INT,l=4):(k=t.UNSIGNED_SHORT,l=2),c=f.offsets,0===c.length)b&&(d(e,a,f,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,h.buffer)),t.drawElements(g,h.array.length,k,0),r.info.render.calls++,r.info.render.points+=h.array.length;else for(1<c.length&&(b=!0),m=0,q=c.length;m<q;m++)v=c[m].index,b&&(d(e,a,f,v),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,
h.buffer)),t.drawElements(g,c[m].count,k,c[m].start*l),r.info.render.calls++,r.info.render.points+=c[m].count;else if(b&&d(e,a,f,0),e=f.attributes.position,c=f.offsets,0===c.length)t.drawArrays(g,0,e.array.length/3),r.info.render.calls++,r.info.render.points+=e.array.length/3;else for(m=0,q=c.length;m<q;m++)t.drawArrays(g,c[m].index,c[m].count),r.info.render.calls++,r.info.render.points+=c[m].count;else if(g instanceof THREE.Line)if(g=g.mode===THREE.LineStrip?t.LINE_STRIP:t.LINES,Y.setLineWidth(e.linewidth*
J),h=f.attributes.index)if(h.array instanceof Uint32Array?(k=t.UNSIGNED_INT,l=4):(k=t.UNSIGNED_SHORT,l=2),c=f.offsets,0===c.length)b&&(d(e,a,f,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,h.buffer)),t.drawElements(g,h.array.length,k,0),r.info.render.calls++,r.info.render.vertices+=h.array.length;else for(1<c.length&&(b=!0),m=0,q=c.length;m<q;m++)v=c[m].index,b&&(d(e,a,f,v),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,h.buffer)),t.drawElements(g,c[m].count,k,c[m].start*l),r.info.render.calls++,r.info.render.vertices+=
c[m].count;else if(b&&d(e,a,f,0),e=f.attributes.position,c=f.offsets,0===c.length)t.drawArrays(g,0,e.array.length/3),r.info.render.calls++,r.info.render.vertices+=e.array.length/3;else for(m=0,q=c.length;m<q;m++)t.drawArrays(g,c[m].index,c[m].count),r.info.render.calls++,r.info.render.vertices+=c[m].count};this.renderBuffer=function(a,b,c,d,e,f){if(!1!==d.visible){y(f);c=u(a,b,c,d,f);b=c.attributes;a=!1;c=e.id+"_"+c.id+"_"+(d.wireframe?1:0);c!==sa&&(sa=c,a=!0);a&&Y.initAttributes();if(!d.morphTargets&&
0<=b.position)a&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglVertexBuffer),Y.enableAttribute(b.position),t.vertexAttribPointer(b.position,3,t.FLOAT,!1,0,0));else if(f.morphTargetBase){c=d.program.attributes;-1!==f.morphTargetBase&&0<=c.position?(t.bindBuffer(t.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[f.morphTargetBase]),Y.enableAttribute(c.position),t.vertexAttribPointer(c.position,3,t.FLOAT,!1,0,0)):0<=c.position&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglVertexBuffer),Y.enableAttribute(c.position),t.vertexAttribPointer(c.position,
3,t.FLOAT,!1,0,0));if(f.morphTargetForcedOrder.length)for(var h=0,k=f.morphTargetForcedOrder,l=f.morphTargetInfluences,m;h<d.numSupportedMorphTargets&&h<k.length;)m=c["morphTarget"+h],0<=m&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[k[h]]),Y.enableAttribute(m),t.vertexAttribPointer(m,3,t.FLOAT,!1,0,0)),m=c["morphNormal"+h],0<=m&&d.morphNormals&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[k[h]]),Y.enableAttribute(m),t.vertexAttribPointer(m,3,t.FLOAT,!1,0,0)),f.__webglMorphTargetInfluences[h]=
l[k[h]],h++;else{k=[];l=f.morphTargetInfluences;h=f.geometry.morphTargets;l.length>h.length&&(console.warn("THREE.WebGLRenderer: Influences array is bigger than morphTargets array."),l.length=h.length);h=0;for(m=l.length;h<m;h++)k.push([l[h],h]);k.length>d.numSupportedMorphTargets?(k.sort(g),k.length=d.numSupportedMorphTargets):k.length>d.numSupportedMorphNormals?k.sort(g):0===k.length&&k.push([0,0]);for(var h=0,q=d.numSupportedMorphTargets;h<q;h++)if(k[h]){var v=k[h][1];m=c["morphTarget"+h];0<=m&&
(t.bindBuffer(t.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[v]),Y.enableAttribute(m),t.vertexAttribPointer(m,3,t.FLOAT,!1,0,0));m=c["morphNormal"+h];0<=m&&d.morphNormals&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[v]),Y.enableAttribute(m),t.vertexAttribPointer(m,3,t.FLOAT,!1,0,0));f.__webglMorphTargetInfluences[h]=l[v]}else f.__webglMorphTargetInfluences[h]=0}null!==d.program.uniforms.morphTargetInfluences&&t.uniform1fv(d.program.uniforms.morphTargetInfluences,f.__webglMorphTargetInfluences)}if(a){if(e.__webglCustomAttributesList)for(c=
0,l=e.__webglCustomAttributesList.length;c<l;c++)k=e.__webglCustomAttributesList[c],0<=b[k.buffer.belongsToAttribute]&&(t.bindBuffer(t.ARRAY_BUFFER,k.buffer),Y.enableAttribute(b[k.buffer.belongsToAttribute]),t.vertexAttribPointer(b[k.buffer.belongsToAttribute],k.size,t.FLOAT,!1,0,0));0<=b.color&&(0<f.geometry.colors.length||0<f.geometry.faces.length?(t.bindBuffer(t.ARRAY_BUFFER,e.__webglColorBuffer),Y.enableAttribute(b.color),t.vertexAttribPointer(b.color,3,t.FLOAT,!1,0,0)):void 0!==d.defaultAttributeValues&&
t.vertexAttrib3fv(b.color,d.defaultAttributeValues.color));0<=b.normal&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglNormalBuffer),Y.enableAttribute(b.normal),t.vertexAttribPointer(b.normal,3,t.FLOAT,!1,0,0));0<=b.tangent&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglTangentBuffer),Y.enableAttribute(b.tangent),t.vertexAttribPointer(b.tangent,4,t.FLOAT,!1,0,0));0<=b.uv&&(f.geometry.faceVertexUvs[0]?(t.bindBuffer(t.ARRAY_BUFFER,e.__webglUVBuffer),Y.enableAttribute(b.uv),t.vertexAttribPointer(b.uv,2,t.FLOAT,!1,0,
0)):void 0!==d.defaultAttributeValues&&t.vertexAttrib2fv(b.uv,d.defaultAttributeValues.uv));0<=b.uv2&&(f.geometry.faceVertexUvs[1]?(t.bindBuffer(t.ARRAY_BUFFER,e.__webglUV2Buffer),Y.enableAttribute(b.uv2),t.vertexAttribPointer(b.uv2,2,t.FLOAT,!1,0,0)):void 0!==d.defaultAttributeValues&&t.vertexAttrib2fv(b.uv2,d.defaultAttributeValues.uv2));d.skinning&&0<=b.skinIndex&&0<=b.skinWeight&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglSkinIndicesBuffer),Y.enableAttribute(b.skinIndex),t.vertexAttribPointer(b.skinIndex,
4,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),Y.enableAttribute(b.skinWeight),t.vertexAttribPointer(b.skinWeight,4,t.FLOAT,!1,0,0));0<=b.lineDistance&&(t.bindBuffer(t.ARRAY_BUFFER,e.__webglLineDistanceBuffer),Y.enableAttribute(b.lineDistance),t.vertexAttribPointer(b.lineDistance,1,t.FLOAT,!1,0,0))}Y.disableUnusedAttributes();f instanceof THREE.Mesh?(f=e.__typeArray===Uint32Array?t.UNSIGNED_INT:t.UNSIGNED_SHORT,d.wireframe?(Y.setLineWidth(d.wireframeLinewidth*J),a&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,
e.__webglLineBuffer),t.drawElements(t.LINES,e.__webglLineCount,f,0)):(a&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),t.drawElements(t.TRIANGLES,e.__webglFaceCount,f,0)),r.info.render.calls++,r.info.render.vertices+=e.__webglFaceCount,r.info.render.faces+=e.__webglFaceCount/3):f instanceof THREE.Line?(f=f.mode===THREE.LineStrip?t.LINE_STRIP:t.LINES,Y.setLineWidth(d.linewidth*J),t.drawArrays(f,0,e.__webglLineCount),r.info.render.calls++):f instanceof THREE.PointCloud&&(t.drawArrays(t.POINTS,
0,e.__webglParticleCount),r.info.render.calls++,r.info.render.points+=e.__webglParticleCount)}};this.render=function(a,b,c,d){if(!1===b instanceof THREE.Camera)THREE.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var g=a.fog;sa="";qb=-1;rb=null;Ba=!0;!0===a.autoUpdate&&a.updateMatrixWorld();void 0===b.parent&&b.updateMatrixWorld();a.traverse(function(a){a instanceof THREE.SkinnedMesh&&a.skeleton.update()});b.matrixWorldInverse.getInverse(b.matrixWorld);ab.multiplyMatrices(b.projectionMatrix,
b.matrixWorldInverse);mb.setFromMatrix(ab);ra.length=0;cb.length=0;xa.length=0;qa.length=0;ha.length=0;h(a);!0===r.sortObjects&&(cb.sort(e),xa.sort(f));ic.render(a,b);r.info.render.calls=0;r.info.render.vertices=0;r.info.render.faces=0;r.info.render.points=0;this.setRenderTarget(c);(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);d=0;for(var q=ta.length;d<q;d++){var u=ta[d],t=u.object;t.visible&&(A(t,b),m(u))}a.overrideMaterial?(d=a.overrideMaterial,z(d),
k(cb,b,ra,g,d),k(xa,b,ra,g,d),l(ta,"",b,ra,g,d)):(Y.setBlending(THREE.NoBlending),k(cb,b,ra,g,null),l(ta,"opaque",b,ra,g,null),k(xa,b,ra,g,null),l(ta,"transparent",b,ra,g,null));Bb.render(a,b);Kc.render(a,b,tc,Da);c&&c.generateMipmaps&&c.minFilter!==THREE.NearestFilter&&c.minFilter!==THREE.LinearFilter&&H(c);Y.setDepthTest(!0);Y.setDepthWrite(!0);Y.setColorWrite(!0)}};this.renderImmediateObject=function(a,b,c,d,e){var f=u(a,b,c,d,e);sa="";r.setMaterialFaces(d);e.immediateRenderCallback?e.immediateRenderCallback(f,
t,mb):e.render(function(a){r.renderBufferImmediate(a,f,d)})};var lb={},gb=0,Gc={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointCloudMaterial:"particle_basic"};this.setFaceCulling=function(a,b){a===THREE.CullFaceNone?t.disable(t.CULL_FACE):(b===THREE.FrontFaceDirectionCW?t.frontFace(t.CW):t.frontFace(t.CCW),a===THREE.CullFaceBack?t.cullFace(t.BACK):a===
THREE.CullFaceFront?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK),t.enable(t.CULL_FACE))};this.setMaterialFaces=function(a){Y.setDoubleSided(a.side===THREE.DoubleSide);Y.setFlipSided(a.side===THREE.BackSide)};this.uploadTexture=function(a){void 0===a.__webglInit&&(a.__webglInit=!0,a.addEventListener("dispose",Ab),a.__webglTexture=t.createTexture(),r.info.memory.textures++);t.bindTexture(t.TEXTURE_2D,a.__webglTexture);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY);t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
a.premultiplyAlpha);t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment);a.image=I(a.image,wc);var b=a.image,c=THREE.Math.isPowerOfTwo(b.width)&&THREE.Math.isPowerOfTwo(b.height),d=L(a.format),e=L(a.type);F(t.TEXTURE_2D,a,c);var f=a.mipmaps;if(a instanceof THREE.DataTexture)if(0<f.length&&c){for(var g=0,h=f.length;g<h;g++)b=f[g],t.texImage2D(t.TEXTURE_2D,g,d,b.width,b.height,0,d,e,b.data);a.generateMipmaps=!1}else t.texImage2D(t.TEXTURE_2D,0,d,b.width,b.height,0,d,e,b.data);else if(a instanceof THREE.CompressedTexture)for(g=
0,h=f.length;g<h;g++)b=f[g],a.format!==THREE.RGBAFormat&&a.format!==THREE.RGBFormat?-1<kb().indexOf(d)?t.compressedTexImage2D(t.TEXTURE_2D,g,d,b.width,b.height,0,b.data):THREE.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(t.TEXTURE_2D,g,d,b.width,b.height,0,d,e,b.data);else if(0<f.length&&c){g=0;for(h=f.length;g<h;g++)b=f[g],t.texImage2D(t.TEXTURE_2D,g,d,d,e,b);a.generateMipmaps=!1}else t.texImage2D(t.TEXTURE_2D,0,d,d,e,a.image);
a.generateMipmaps&&c&&t.generateMipmap(t.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()};this.setTexture=function(a,b){t.activeTexture(t.TEXTURE0+b);a.needsUpdate?r.uploadTexture(a):t.bindTexture(t.TEXTURE_2D,a.__webglTexture)};this.setRenderTarget=function(a){var b=a instanceof THREE.WebGLRenderTargetCube;if(a&&void 0===a.__webglFramebuffer){void 0===a.depthBuffer&&(a.depthBuffer=!0);void 0===a.stencilBuffer&&(a.stencilBuffer=!0);a.addEventListener("dispose",jc);a.__webglTexture=t.createTexture();
r.info.memory.textures++;var c=THREE.Math.isPowerOfTwo(a.width)&&THREE.Math.isPowerOfTwo(a.height),d=L(a.format),e=L(a.type);if(b){a.__webglFramebuffer=[];a.__webglRenderbuffer=[];t.bindTexture(t.TEXTURE_CUBE_MAP,a.__webglTexture);F(t.TEXTURE_CUBE_MAP,a,c);for(var f=0;6>f;f++){a.__webglFramebuffer[f]=t.createFramebuffer();a.__webglRenderbuffer[f]=t.createRenderbuffer();t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,d,a.width,a.height,0,d,e,null);var g=a,h=t.TEXTURE_CUBE_MAP_POSITIVE_X+f;t.bindFramebuffer(t.FRAMEBUFFER,
a.__webglFramebuffer[f]);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,h,g.__webglTexture,0);D(a.__webglRenderbuffer[f],a)}c&&t.generateMipmap(t.TEXTURE_CUBE_MAP)}else a.__webglFramebuffer=t.createFramebuffer(),a.__webglRenderbuffer=a.shareDepthFrom?a.shareDepthFrom.__webglRenderbuffer:t.createRenderbuffer(),t.bindTexture(t.TEXTURE_2D,a.__webglTexture),F(t.TEXTURE_2D,a,c),t.texImage2D(t.TEXTURE_2D,0,d,a.width,a.height,0,d,e,null),d=t.TEXTURE_2D,t.bindFramebuffer(t.FRAMEBUFFER,a.__webglFramebuffer),
t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,d,a.__webglTexture,0),a.shareDepthFrom?a.depthBuffer&&!a.stencilBuffer?t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,a.__webglRenderbuffer):a.depthBuffer&&a.stencilBuffer&&t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,a.__webglRenderbuffer):D(a.__webglRenderbuffer,a),c&&t.generateMipmap(t.TEXTURE_2D);b?t.bindTexture(t.TEXTURE_CUBE_MAP,null):t.bindTexture(t.TEXTURE_2D,null);t.bindRenderbuffer(t.RENDERBUFFER,
null);t.bindFramebuffer(t.FRAMEBUFFER,null)}a?(b=b?a.__webglFramebuffer[a.activeCubeFace]:a.__webglFramebuffer,c=a.width,a=a.height,e=d=0):(b=null,c=ob,a=pb,d=$a,e=Ta);b!==fb&&(t.bindFramebuffer(t.FRAMEBUFFER,b),t.viewport(d,e,c,a),fb=b);tc=c;Da=a};this.readRenderTargetPixels=function(a,b,c,d,e,f){if(!(a instanceof THREE.WebGLRenderTarget))console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");else if(a.__webglFramebuffer)if(a.format!==THREE.RGBAFormat)console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.");
else{var g=!1;a.__webglFramebuffer!==fb&&(t.bindFramebuffer(t.FRAMEBUFFER,a.__webglFramebuffer),g=!0);t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE?t.readPixels(b,c,d,e,t.RGBA,t.UNSIGNED_BYTE,f):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.");g&&t.bindFramebuffer(t.FRAMEBUFFER,fb)}};this.initMaterial=function(){THREE.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};this.addPrePlugin=function(){THREE.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};
this.addPostPlugin=function(){THREE.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};this.updateShadowMap=function(){THREE.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}};
THREE.WebGLRenderTarget=function(a,b,c){this.width=a;this.height=b;c=c||{};this.wrapS=void 0!==c.wrapS?c.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==c.wrapT?c.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==c.magFilter?c.magFilter:THREE.LinearFilter;this.minFilter=void 0!==c.minFilter?c.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==c.anisotropy?c.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==c.format?c.format:
THREE.RGBAFormat;this.type=void 0!==c.type?c.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=void 0!==c.shareDepthFrom?c.shareDepthFrom:null};
THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,setSize:function(a,b){this.width=a;this.height=b},clone:function(){var a=new THREE.WebGLRenderTarget(this.width,this.height);a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.format=this.format;a.type=this.type;a.depthBuffer=this.depthBuffer;a.stencilBuffer=this.stencilBuffer;a.generateMipmaps=this.generateMipmaps;
a.shareDepthFrom=this.shareDepthFrom;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube=function(a,b,c){THREE.WebGLRenderTarget.call(this,a,b,c);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube;
THREE.WebGLExtensions=function(a){var b={};this.get=function(c){if(void 0!==b[c])return b[c];var d;switch(c){case "EXT_texture_filter_anisotropic":d=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":d=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
break;case "WEBGL_compressed_texture_pvrtc":d=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:d=a.getExtension(c)}null===d&&THREE.warn("THREE.WebGLRenderer: "+c+" extension not supported.");return b[c]=d}};
THREE.WebGLProgram=function(){var a=0;return function(b,c,d,e){var f=b.context,g=d.defines,h=d.__webglShader.uniforms,k=d.attributes,l=d.__webglShader.vertexShader,m=d.__webglShader.fragmentShader,v=d.index0AttributeName;void 0===v&&!0===e.morphTargets&&(v="position");var q="SHADOWMAP_TYPE_BASIC";e.shadowMapType===THREE.PCFShadowMap?q="SHADOWMAP_TYPE_PCF":e.shadowMapType===THREE.PCFSoftShadowMap&&(q="SHADOWMAP_TYPE_PCF_SOFT");var y="ENVMAP_TYPE_CUBE",x="ENVMAP_MODE_REFLECTION",w="ENVMAP_BLENDING_MULTIPLY";
if(e.envMap){switch(d.envMap.mapping){case THREE.CubeReflectionMapping:case THREE.CubeRefractionMapping:y="ENVMAP_TYPE_CUBE";break;case THREE.EquirectangularReflectionMapping:case THREE.EquirectangularRefractionMapping:y="ENVMAP_TYPE_EQUIREC";break;case THREE.SphericalReflectionMapping:y="ENVMAP_TYPE_SPHERE"}switch(d.envMap.mapping){case THREE.CubeRefractionMapping:case THREE.EquirectangularRefractionMapping:x="ENVMAP_MODE_REFRACTION"}switch(d.combine){case THREE.MultiplyOperation:w="ENVMAP_BLENDING_MULTIPLY";
break;case THREE.MixOperation:w="ENVMAP_BLENDING_MIX";break;case THREE.AddOperation:w="ENVMAP_BLENDING_ADD"}}var z=0<b.gammaFactor?b.gammaFactor:1,u,B;u=[];for(var G in g)B=g[G],!1!==B&&(B="#define "+G+" "+B,u.push(B));u=u.join("\n");g=f.createProgram();d instanceof THREE.RawShaderMaterial?b=d="":(d=["precision "+e.precision+" float;","precision "+e.precision+" int;",u,e.supportsVertexTextures?"#define VERTEX_TEXTURES":"",b.gammaInput?"#define GAMMA_INPUT":"",b.gammaOutput?"#define GAMMA_OUTPUT":
"","#define GAMMA_FACTOR "+z,"#define MAX_DIR_LIGHTS "+e.maxDirLights,"#define MAX_POINT_LIGHTS "+e.maxPointLights,"#define MAX_SPOT_LIGHTS "+e.maxSpotLights,"#define MAX_HEMI_LIGHTS "+e.maxHemiLights,"#define MAX_SHADOWS "+e.maxShadows,"#define MAX_BONES "+e.maxBones,e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+x:"",e.lightMap?"#define USE_LIGHTMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":
"",e.alphaMap?"#define USE_ALPHAMAP":"",e.vertexColors?"#define USE_COLOR":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals?"#define USE_MORPHNORMALS":"",e.wrapAround?"#define WRAP_AROUND":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+q:"",e.shadowMapDebug?
"#define SHADOWMAP_DEBUG":"",e.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\n\tattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\n\tattribute vec3 morphTarget0;\n\tattribute vec3 morphTarget1;\n\tattribute vec3 morphTarget2;\n\tattribute vec3 morphTarget3;\n\t#ifdef USE_MORPHNORMALS\n\t\tattribute vec3 morphNormal0;\n\t\tattribute vec3 morphNormal1;\n\t\tattribute vec3 morphNormal2;\n\t\tattribute vec3 morphNormal3;\n\t#else\n\t\tattribute vec3 morphTarget4;\n\t\tattribute vec3 morphTarget5;\n\t\tattribute vec3 morphTarget6;\n\t\tattribute vec3 morphTarget7;\n\t#endif\n#endif\n#ifdef USE_SKINNING\n\tattribute vec4 skinIndex;\n\tattribute vec4 skinWeight;\n#endif\n"].join("\n"),
b=["precision "+e.precision+" float;","precision "+e.precision+" int;",e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",u,"#define MAX_DIR_LIGHTS "+e.maxDirLights,"#define MAX_POINT_LIGHTS "+e.maxPointLights,"#define MAX_SPOT_LIGHTS "+e.maxSpotLights,"#define MAX_HEMI_LIGHTS "+e.maxHemiLights,"#define MAX_SHADOWS "+e.maxShadows,e.alphaTest?"#define ALPHATEST "+e.alphaTest:"",b.gammaInput?"#define GAMMA_INPUT":"",b.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+
z,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+y:"",e.envMap?"#define "+x:"",e.envMap?"#define "+w:"",e.lightMap?"#define USE_LIGHTMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.vertexColors?"#define USE_COLOR":"",e.flatShading?"#define FLAT_SHADED":"",e.metal?"#define METAL":
"",e.wrapAround?"#define WRAP_AROUND":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+q:"",e.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",e.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n"));l=new THREE.WebGLShader(f,f.VERTEX_SHADER,d+l);m=new THREE.WebGLShader(f,f.FRAGMENT_SHADER,
b+m);f.attachShader(g,l);f.attachShader(g,m);void 0!==v&&f.bindAttribLocation(g,0,v);f.linkProgram(g);v=f.getProgramInfoLog(g);!1===f.getProgramParameter(g,f.LINK_STATUS)&&THREE.error("THREE.WebGLProgram: shader error: "+f.getError(),"gl.VALIDATE_STATUS",f.getProgramParameter(g,f.VALIDATE_STATUS),"gl.getPRogramInfoLog",v);""!==v&&THREE.warn("THREE.WebGLProgram: gl.getProgramInfoLog()"+v);f.deleteShader(l);f.deleteShader(m);v="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences bindMatrix bindMatrixInverse".split(" ");
e.useVertexTexture?(v.push("boneTexture"),v.push("boneTextureWidth"),v.push("boneTextureHeight")):v.push("boneGlobalMatrices");e.logarithmicDepthBuffer&&v.push("logDepthBufFC");for(var A in h)v.push(A);h=v;A={};v=0;for(b=h.length;v<b;v++)q=h[v],A[q]=f.getUniformLocation(g,q);this.uniforms=A;v="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(h=0;h<e.maxMorphTargets;h++)v.push("morphTarget"+h);for(h=0;h<e.maxMorphNormals;h++)v.push("morphNormal"+h);for(var C in k)v.push(C);
e=v;k={};C=0;for(h=e.length;C<h;C++)A=e[C],k[A]=f.getAttribLocation(g,A);this.attributes=k;this.attributesKeys=Object.keys(this.attributes);this.id=a++;this.code=c;this.usedTimes=1;this.program=g;this.vertexShader=l;this.fragmentShader=m;return this}}();
THREE.WebGLShader=function(){var a=function(a){a=a.split("\n");for(var c=0;c<a.length;c++)a[c]=c+1+": "+a[c];return a.join("\n")};return function(b,c,d){c=b.createShader(c);b.shaderSource(c,d);b.compileShader(c);!1===b.getShaderParameter(c,b.COMPILE_STATUS)&&THREE.error("THREE.WebGLShader: Shader couldn't compile.");""!==b.getShaderInfoLog(c)&&THREE.warn("THREE.WebGLShader: gl.getShaderInfoLog()",b.getShaderInfoLog(c),a(d));return c}}();
THREE.WebGLState=function(a,b){var c=new Uint8Array(16),d=new Uint8Array(16),e=null,f=null,g=null,h=null,k=null,l=null,m=null,v=null,q=null,y=null,x=null,w=null,z=null,u=null,B=null,G=null;this.initAttributes=function(){for(var a=0,b=c.length;a<b;a++)c[a]=0};this.enableAttribute=function(b){c[b]=1;0===d[b]&&(a.enableVertexAttribArray(b),d[b]=1)};this.disableUnusedAttributes=function(){for(var b=0,e=d.length;b<e;b++)d[b]!==c[b]&&(a.disableVertexAttribArray(b),d[b]=0)};this.setBlending=function(c,d,
q,u,v,w,x){c!==e&&(c===THREE.NoBlending?a.disable(a.BLEND):c===THREE.AdditiveBlending?(a.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE)):c===THREE.SubtractiveBlending?(a.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.ONE_MINUS_SRC_COLOR)):c===THREE.MultiplyBlending?(a.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.SRC_COLOR)):c===THREE.CustomBlending?a.enable(a.BLEND):(a.enable(a.BLEND),a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),
a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)),e=c);if(c===THREE.CustomBlending){v=v||d;w=w||q;x=x||u;if(d!==f||v!==k)a.blendEquationSeparate(b(d),b(v)),f=d,k=v;if(q!==g||u!==h||w!==l||x!==m)a.blendFuncSeparate(b(q),b(u),b(w),b(x)),g=q,h=u,l=w,m=x}else m=l=k=h=g=f=null};this.setDepthTest=function(b){v!==b&&(b?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),v=b)};this.setDepthWrite=function(b){q!==b&&(a.depthMask(b),q=b)};this.setColorWrite=function(b){y!==b&&(a.colorMask(b,
b,b,b),y=b)};this.setDoubleSided=function(b){x!==b&&(b?a.disable(a.CULL_FACE):a.enable(a.CULL_FACE),x=b)};this.setFlipSided=function(b){w!==b&&(b?a.frontFace(a.CW):a.frontFace(a.CCW),w=b)};this.setLineWidth=function(b){b!==z&&(a.lineWidth(b),z=b)};this.setPolygonOffset=function(b,c,d){u!==b&&(b?a.enable(a.POLYGON_OFFSET_FILL):a.disable(a.POLYGON_OFFSET_FILL),u=b);!b||B===c&&G===d||(a.polygonOffset(c,d),B=c,G=d)};this.reset=function(){for(var a=0;a<d.length;a++)d[a]=0;w=x=y=q=v=e=null}};
THREE.LensFlarePlugin=function(a,b){var c,d,e,f,g,h,k,l,m,v,q=a.context,y,x,w,z,u,B;this.render=function(G,A,C,F){if(0!==b.length){G=new THREE.Vector3;var I=F/C,D=.5*C,H=.5*F,E=16/F,L=new THREE.Vector2(E*I,E),U=new THREE.Vector3(1,1,0),O=new THREE.Vector2(1,1);if(void 0===w){var E=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),J=new Uint16Array([0,1,2,0,2,3]);y=q.createBuffer();x=q.createBuffer();q.bindBuffer(q.ARRAY_BUFFER,y);q.bufferData(q.ARRAY_BUFFER,E,q.STATIC_DRAW);q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,
x);q.bufferData(q.ELEMENT_ARRAY_BUFFER,J,q.STATIC_DRAW);u=q.createTexture();B=q.createTexture();q.bindTexture(q.TEXTURE_2D,u);q.texImage2D(q.TEXTURE_2D,0,q.RGB,16,16,0,q.RGB,q.UNSIGNED_BYTE,null);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.NEAREST);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.NEAREST);q.bindTexture(q.TEXTURE_2D,B);q.texImage2D(q.TEXTURE_2D,0,
q.RGBA,16,16,0,q.RGBA,q.UNSIGNED_BYTE,null);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.NEAREST);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.NEAREST);var E=(z=0<q.getParameter(q.MAX_VERTEX_TEXTURE_IMAGE_UNITS))?{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},
J=q.createProgram(),P=q.createShader(q.FRAGMENT_SHADER),T=q.createShader(q.VERTEX_SHADER),S="precision "+a.getPrecision()+" float;\n";q.shaderSource(P,S+E.fragmentShader);q.shaderSource(T,S+E.vertexShader);q.compileShader(P);q.compileShader(T);q.attachShader(J,P);q.attachShader(J,T);q.linkProgram(J);w=J;m=q.getAttribLocation(w,"position");v=q.getAttribLocation(w,"uv");c=q.getUniformLocation(w,"renderType");d=q.getUniformLocation(w,"map");e=q.getUniformLocation(w,"occlusionMap");f=q.getUniformLocation(w,
"opacity");g=q.getUniformLocation(w,"color");h=q.getUniformLocation(w,"scale");k=q.getUniformLocation(w,"rotation");l=q.getUniformLocation(w,"screenPosition")}q.useProgram(w);q.enableVertexAttribArray(m);q.enableVertexAttribArray(v);q.uniform1i(e,0);q.uniform1i(d,1);q.bindBuffer(q.ARRAY_BUFFER,y);q.vertexAttribPointer(m,2,q.FLOAT,!1,16,0);q.vertexAttribPointer(v,2,q.FLOAT,!1,16,8);q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,x);q.disable(q.CULL_FACE);q.depthMask(!1);J=0;for(P=b.length;J<P;J++)if(E=16/F,L.set(E*
I,E),T=b[J],G.set(T.matrixWorld.elements[12],T.matrixWorld.elements[13],T.matrixWorld.elements[14]),G.applyMatrix4(A.matrixWorldInverse),G.applyProjection(A.projectionMatrix),U.copy(G),O.x=U.x*D+D,O.y=U.y*H+H,z||0<O.x&&O.x<C&&0<O.y&&O.y<F){q.activeTexture(q.TEXTURE1);q.bindTexture(q.TEXTURE_2D,u);q.copyTexImage2D(q.TEXTURE_2D,0,q.RGB,O.x-8,O.y-8,16,16,0);q.uniform1i(c,0);q.uniform2f(h,L.x,L.y);q.uniform3f(l,U.x,U.y,U.z);q.disable(q.BLEND);q.enable(q.DEPTH_TEST);q.drawElements(q.TRIANGLES,6,q.UNSIGNED_SHORT,
0);q.activeTexture(q.TEXTURE0);q.bindTexture(q.TEXTURE_2D,B);q.copyTexImage2D(q.TEXTURE_2D,0,q.RGBA,O.x-8,O.y-8,16,16,0);q.uniform1i(c,1);q.disable(q.DEPTH_TEST);q.activeTexture(q.TEXTURE1);q.bindTexture(q.TEXTURE_2D,u);q.drawElements(q.TRIANGLES,6,q.UNSIGNED_SHORT,0);T.positionScreen.copy(U);T.customUpdateCallback?T.customUpdateCallback(T):T.updateLensFlares();q.uniform1i(c,2);q.enable(q.BLEND);for(var S=0,R=T.lensFlares.length;S<R;S++){var ba=T.lensFlares[S];.001<ba.opacity&&.001<ba.scale&&(U.x=
ba.x,U.y=ba.y,U.z=ba.z,E=ba.size*ba.scale/F,L.x=E*I,L.y=E,q.uniform3f(l,U.x,U.y,U.z),q.uniform2f(h,L.x,L.y),q.uniform1f(k,ba.rotation),q.uniform1f(f,ba.opacity),q.uniform3f(g,ba.color.r,ba.color.g,ba.color.b),a.state.setBlending(ba.blending,ba.blendEquation,ba.blendSrc,ba.blendDst),a.setTexture(ba.texture,1),q.drawElements(q.TRIANGLES,6,q.UNSIGNED_SHORT,0))}}q.enable(q.CULL_FACE);q.enable(q.DEPTH_TEST);q.depthMask(!0);a.resetGLState()}}};
THREE.ShadowMapPlugin=function(a,b,c,d){function e(a,b,d){if(b.visible){var f=c[b.id];if(f&&b.castShadow&&(!1===b.frustumCulled||!0===m.intersectsObject(b)))for(var g=0,h=f.length;g<h;g++){var k=f[g];b._modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,b.matrixWorld);w.push(k)}g=0;for(h=b.children.length;g<h;g++)e(a,b.children[g],d)}}var f=a.context,g,h,k,l,m=new THREE.Frustum,v=new THREE.Matrix4,q=new THREE.Vector3,y=new THREE.Vector3,x=new THREE.Vector3,w=[],z=THREE.ShaderLib.depthRGBA,u=THREE.UniformsUtils.clone(z.uniforms);
g=new THREE.ShaderMaterial({uniforms:u,vertexShader:z.vertexShader,fragmentShader:z.fragmentShader});h=new THREE.ShaderMaterial({uniforms:u,vertexShader:z.vertexShader,fragmentShader:z.fragmentShader,morphTargets:!0});k=new THREE.ShaderMaterial({uniforms:u,vertexShader:z.vertexShader,fragmentShader:z.fragmentShader,skinning:!0});l=new THREE.ShaderMaterial({uniforms:u,vertexShader:z.vertexShader,fragmentShader:z.fragmentShader,morphTargets:!0,skinning:!0});g._shadowPass=!0;h._shadowPass=!0;k._shadowPass=
!0;l._shadowPass=!0;this.render=function(c,u){if(!1!==a.shadowMapEnabled){var z,C,F,I,D,H,E,L,U=[];I=0;f.clearColor(1,1,1,1);f.disable(f.BLEND);f.enable(f.CULL_FACE);f.frontFace(f.CCW);a.shadowMapCullFace===THREE.CullFaceFront?f.cullFace(f.FRONT):f.cullFace(f.BACK);a.state.setDepthTest(!0);z=0;for(C=b.length;z<C;z++)if(F=b[z],F.castShadow)if(F instanceof THREE.DirectionalLight&&F.shadowCascade)for(D=0;D<F.shadowCascadeCount;D++){var O;if(F.shadowCascadeArray[D])O=F.shadowCascadeArray[D];else{E=F;
var J=D;O=new THREE.DirectionalLight;O.isVirtual=!0;O.onlyShadow=!0;O.castShadow=!0;O.shadowCameraNear=E.shadowCameraNear;O.shadowCameraFar=E.shadowCameraFar;O.shadowCameraLeft=E.shadowCameraLeft;O.shadowCameraRight=E.shadowCameraRight;O.shadowCameraBottom=E.shadowCameraBottom;O.shadowCameraTop=E.shadowCameraTop;O.shadowCameraVisible=E.shadowCameraVisible;O.shadowDarkness=E.shadowDarkness;O.shadowBias=E.shadowCascadeBias[J];O.shadowMapWidth=E.shadowCascadeWidth[J];O.shadowMapHeight=E.shadowCascadeHeight[J];
O.pointsWorld=[];O.pointsFrustum=[];L=O.pointsWorld;H=O.pointsFrustum;for(var P=0;8>P;P++)L[P]=new THREE.Vector3,H[P]=new THREE.Vector3;L=E.shadowCascadeNearZ[J];E=E.shadowCascadeFarZ[J];H[0].set(-1,-1,L);H[1].set(1,-1,L);H[2].set(-1,1,L);H[3].set(1,1,L);H[4].set(-1,-1,E);H[5].set(1,-1,E);H[6].set(-1,1,E);H[7].set(1,1,E);O.originalCamera=u;H=new THREE.Gyroscope;H.position.copy(F.shadowCascadeOffset);H.add(O);H.add(O.target);u.add(H);F.shadowCascadeArray[D]=O}J=F;L=D;E=J.shadowCascadeArray[L];E.position.copy(J.position);
E.target.position.copy(J.target.position);E.lookAt(E.target);E.shadowCameraVisible=J.shadowCameraVisible;E.shadowDarkness=J.shadowDarkness;E.shadowBias=J.shadowCascadeBias[L];H=J.shadowCascadeNearZ[L];J=J.shadowCascadeFarZ[L];E=E.pointsFrustum;E[0].z=H;E[1].z=H;E[2].z=H;E[3].z=H;E[4].z=J;E[5].z=J;E[6].z=J;E[7].z=J;U[I]=O;I++}else U[I]=F,I++;z=0;for(C=U.length;z<C;z++){F=U[z];F.shadowMap||(D=THREE.LinearFilter,a.shadowMapType===THREE.PCFSoftShadowMap&&(D=THREE.NearestFilter),F.shadowMap=new THREE.WebGLRenderTarget(F.shadowMapWidth,
F.shadowMapHeight,{minFilter:D,magFilter:D,format:THREE.RGBAFormat}),F.shadowMapSize=new THREE.Vector2(F.shadowMapWidth,F.shadowMapHeight),F.shadowMatrix=new THREE.Matrix4);if(!F.shadowCamera){if(F instanceof THREE.SpotLight)F.shadowCamera=new THREE.PerspectiveCamera(F.shadowCameraFov,F.shadowMapWidth/F.shadowMapHeight,F.shadowCameraNear,F.shadowCameraFar);else if(F instanceof THREE.DirectionalLight)F.shadowCamera=new THREE.OrthographicCamera(F.shadowCameraLeft,F.shadowCameraRight,F.shadowCameraTop,
F.shadowCameraBottom,F.shadowCameraNear,F.shadowCameraFar);else{THREE.error("THREE.ShadowMapPlugin: Unsupported light type for shadow",F);continue}c.add(F.shadowCamera);!0===c.autoUpdate&&c.updateMatrixWorld()}F.shadowCameraVisible&&!F.cameraHelper&&(F.cameraHelper=new THREE.CameraHelper(F.shadowCamera),c.add(F.cameraHelper));if(F.isVirtual&&O.originalCamera==u){D=u;I=F.shadowCamera;H=F.pointsFrustum;E=F.pointsWorld;q.set(Infinity,Infinity,Infinity);y.set(-Infinity,-Infinity,-Infinity);for(J=0;8>
J;J++)L=E[J],L.copy(H[J]),L.unproject(D),L.applyMatrix4(I.matrixWorldInverse),L.x<q.x&&(q.x=L.x),L.x>y.x&&(y.x=L.x),L.y<q.y&&(q.y=L.y),L.y>y.y&&(y.y=L.y),L.z<q.z&&(q.z=L.z),L.z>y.z&&(y.z=L.z);I.left=q.x;I.right=y.x;I.top=y.y;I.bottom=q.y;I.updateProjectionMatrix()}I=F.shadowMap;H=F.shadowMatrix;D=F.shadowCamera;D.position.setFromMatrixPosition(F.matrixWorld);x.setFromMatrixPosition(F.target.matrixWorld);D.lookAt(x);D.updateMatrixWorld();D.matrixWorldInverse.getInverse(D.matrixWorld);F.cameraHelper&&
(F.cameraHelper.visible=F.shadowCameraVisible);F.shadowCameraVisible&&F.cameraHelper.update();H.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);H.multiply(D.projectionMatrix);H.multiply(D.matrixWorldInverse);v.multiplyMatrices(D.projectionMatrix,D.matrixWorldInverse);m.setFromMatrix(v);a.setRenderTarget(I);a.clear();w.length=0;e(c,c,D);F=0;for(I=w.length;F<I;F++)E=w[F],H=E.object,E=E.buffer,J=H.material instanceof THREE.MeshFaceMaterial?H.material.materials[0]:H.material,L=void 0!==H.geometry.morphTargets&&
0<H.geometry.morphTargets.length&&J.morphTargets,P=H instanceof THREE.SkinnedMesh&&J.skinning,L=H.customDepthMaterial?H.customDepthMaterial:P?L?l:k:L?h:g,a.setMaterialFaces(J),E instanceof THREE.BufferGeometry?a.renderBufferDirect(D,b,null,L,E,H):a.renderBuffer(D,b,null,L,E,H);F=0;for(I=d.length;F<I;F++)E=d[F],H=E.object,H.visible&&H.castShadow&&(H._modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,H.matrixWorld),a.renderImmediateObject(D,b,null,g,H))}z=a.getClearColor();C=a.getClearAlpha();f.clearColor(z.r,
z.g,z.b,C);f.enable(f.BLEND);a.shadowMapCullFace===THREE.CullFaceFront&&f.cullFace(f.BACK);a.resetGLState()}}};
THREE.SpritePlugin=function(a,b){var c,d,e,f,g,h,k,l,m,v,q,y,x,w,z,u,B;function G(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var A=a.context,C,F,I,D,H=new THREE.Vector3,E=new THREE.Quaternion,L=new THREE.Vector3;this.render=function(U,O){if(0!==b.length){if(void 0===I){var J=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),P=new Uint16Array([0,1,2,0,2,3]);C=A.createBuffer();F=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,C);A.bufferData(A.ARRAY_BUFFER,J,A.STATIC_DRAW);A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,
F);A.bufferData(A.ELEMENT_ARRAY_BUFFER,P,A.STATIC_DRAW);var J=A.createProgram(),P=A.createShader(A.VERTEX_SHADER),T=A.createShader(A.FRAGMENT_SHADER);A.shaderSource(P,["precision "+a.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n"));
A.shaderSource(T,["precision "+a.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n"));
A.compileShader(P);A.compileShader(T);A.attachShader(J,P);A.attachShader(J,T);A.linkProgram(J);I=J;u=A.getAttribLocation(I,"position");B=A.getAttribLocation(I,"uv");c=A.getUniformLocation(I,"uvOffset");d=A.getUniformLocation(I,"uvScale");e=A.getUniformLocation(I,"rotation");f=A.getUniformLocation(I,"scale");g=A.getUniformLocation(I,"color");h=A.getUniformLocation(I,"map");k=A.getUniformLocation(I,"opacity");l=A.getUniformLocation(I,"modelViewMatrix");m=A.getUniformLocation(I,"projectionMatrix");v=
A.getUniformLocation(I,"fogType");q=A.getUniformLocation(I,"fogDensity");y=A.getUniformLocation(I,"fogNear");x=A.getUniformLocation(I,"fogFar");w=A.getUniformLocation(I,"fogColor");z=A.getUniformLocation(I,"alphaTest");J=document.createElement("canvas");J.width=8;J.height=8;P=J.getContext("2d");P.fillStyle="white";P.fillRect(0,0,8,8);D=new THREE.Texture(J);D.needsUpdate=!0}A.useProgram(I);A.enableVertexAttribArray(u);A.enableVertexAttribArray(B);A.disable(A.CULL_FACE);A.enable(A.BLEND);A.bindBuffer(A.ARRAY_BUFFER,
C);A.vertexAttribPointer(u,2,A.FLOAT,!1,16,0);A.vertexAttribPointer(B,2,A.FLOAT,!1,16,8);A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,F);A.uniformMatrix4fv(m,!1,O.projectionMatrix.elements);A.activeTexture(A.TEXTURE0);A.uniform1i(h,0);P=J=0;(T=U.fog)?(A.uniform3f(w,T.color.r,T.color.g,T.color.b),T instanceof THREE.Fog?(A.uniform1f(y,T.near),A.uniform1f(x,T.far),A.uniform1i(v,1),P=J=1):T instanceof THREE.FogExp2&&(A.uniform1f(q,T.density),A.uniform1i(v,2),P=J=2)):(A.uniform1i(v,0),P=J=0);for(var T=0,S=b.length;T<
S;T++){var R=b[T];R._modelViewMatrix.multiplyMatrices(O.matrixWorldInverse,R.matrixWorld);R.z=-R._modelViewMatrix.elements[14]}b.sort(G);for(var ba=[],T=0,S=b.length;T<S;T++){var R=b[T],N=R.material;A.uniform1f(z,N.alphaTest);A.uniformMatrix4fv(l,!1,R._modelViewMatrix.elements);R.matrixWorld.decompose(H,E,L);ba[0]=L.x;ba[1]=L.y;R=0;U.fog&&N.fog&&(R=P);J!==R&&(A.uniform1i(v,R),J=R);null!==N.map?(A.uniform2f(c,N.map.offset.x,N.map.offset.y),A.uniform2f(d,N.map.repeat.x,N.map.repeat.y)):(A.uniform2f(c,
0,0),A.uniform2f(d,1,1));A.uniform1f(k,N.opacity);A.uniform3f(g,N.color.r,N.color.g,N.color.b);A.uniform1f(e,N.rotation);A.uniform2fv(f,ba);a.state.setBlending(N.blending,N.blendEquation,N.blendSrc,N.blendDst);a.state.setDepthTest(N.depthTest);a.state.setDepthWrite(N.depthWrite);N.map&&N.map.image&&N.map.image.width?a.setTexture(N.map,0):a.setTexture(D,0);A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0)}A.enable(A.CULL_FACE);a.resetGLState()}}};
THREE.GeometryUtils={merge:function(a,b,c){THREE.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var d;b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),d=b.matrix,b=b.geometry);a.merge(b,d,c)},center:function(a){THREE.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return a.center()}};
THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(a,b,c,d){var e=new THREE.ImageLoader;e.crossOrigin=this.crossOrigin;var f=new THREE.Texture(void 0,b);e.load(a,function(a){f.image=a;f.needsUpdate=!0;c&&c(f)},void 0,function(a){d&&d(a)});f.sourceFile=a;return f},loadTextureCube:function(a,b,c,d){var e=new THREE.ImageLoader;e.crossOrigin=this.crossOrigin;var f=new THREE.CubeTexture([],b);f.flipY=!1;var g=0;b=function(b){e.load(a[b],function(a){f.images[b]=a;g+=1;6===g&&(f.needsUpdate=!0,c&&
c(f))},void 0,d)};for(var h=0,k=a.length;h<k;++h)b(h);return f},loadCompressedTexture:function(){THREE.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){THREE.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(a,b){var c=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/b,a[1]/b,a[2]/b]};b|=1;var d=a.width,e=a.height,f=document.createElement("canvas");
f.width=d;f.height=e;var g=f.getContext("2d");g.drawImage(a,0,0);for(var h=g.getImageData(0,0,d,e).data,k=g.createImageData(d,e),l=k.data,m=0;m<d;m++)for(var v=0;v<e;v++){var q=0>v-1?0:v-1,y=v+1>e-1?e-1:v+1,x=0>m-1?0:m-1,w=m+1>d-1?d-1:m+1,z=[],u=[0,0,h[4*(v*d+m)]/255*b];z.push([-1,0,h[4*(v*d+x)]/255*b]);z.push([-1,-1,h[4*(q*d+x)]/255*b]);z.push([0,-1,h[4*(q*d+m)]/255*b]);z.push([1,-1,h[4*(q*d+w)]/255*b]);z.push([1,0,h[4*(v*d+w)]/255*b]);z.push([1,1,h[4*(y*d+w)]/255*b]);z.push([0,1,h[4*(y*d+m)]/255*
b]);z.push([-1,1,h[4*(y*d+x)]/255*b]);q=[];x=z.length;for(y=0;y<x;y++){var w=z[y],B=z[(y+1)%x],w=[w[0]-u[0],w[1]-u[1],w[2]-u[2]],B=[B[0]-u[0],B[1]-u[1],B[2]-u[2]];q.push(c([w[1]*B[2]-w[2]*B[1],w[2]*B[0]-w[0]*B[2],w[0]*B[1]-w[1]*B[0]]))}z=[0,0,0];for(y=0;y<q.length;y++)z[0]+=q[y][0],z[1]+=q[y][1],z[2]+=q[y][2];z[0]/=q.length;z[1]/=q.length;z[2]/=q.length;u=4*(v*d+m);l[u]=(z[0]+1)/2*255|0;l[u+1]=(z[1]+1)/2*255|0;l[u+2]=255*z[2]|0;l[u+3]=255}g.putImageData(k,0,0);return f},generateDataTexture:function(a,
b,c){var d=a*b,e=new Uint8Array(3*d),f=Math.floor(255*c.r),g=Math.floor(255*c.g);c=Math.floor(255*c.b);for(var h=0;h<d;h++)e[3*h]=f,e[3*h+1]=g,e[3*h+2]=c;a=new THREE.DataTexture(e,a,b,THREE.RGBFormat);a.needsUpdate=!0;return a}};
THREE.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new THREE.Object3D,d=0,e=b.length;d<e;d++)c.add(new THREE.Mesh(a,b[d]));return c},detach:function(a,b,c){a.applyMatrix(b.matrixWorld);b.remove(a);c.add(a)},attach:function(a,b,c){var d=new THREE.Matrix4;d.getInverse(c.matrixWorld);a.applyMatrix(d);b.remove(a);c.add(a)}};
THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(a){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing.";}},loadFace:function(a){var b=a.familyName.toLowerCase();this.faces[b]=this.faces[b]||{};this.faces[b][a.cssFontWeight]=this.faces[b][a.cssFontWeight]||{};this.faces[b][a.cssFontWeight][a.cssFontStyle]=a;return this.faces[b][a.cssFontWeight][a.cssFontStyle]=
a},drawText:function(a){var b=this.getFace(),c=this.size/b.resolution,d=0,e=String(a).split(""),f=e.length,g=[];for(a=0;a<f;a++){var h=new THREE.Path,h=this.extractGlyphPoints(e[a],b,c,d,h),d=d+h.offset;g.push(h.path)}return{paths:g,offset:d/2}},extractGlyphPoints:function(a,b,c,d,e){var f=[],g,h,k,l,m,v,q,y,x,w,z,u=b.glyphs[a]||b.glyphs["?"];if(u){if(u.o)for(b=u._cachedOutline||(u._cachedOutline=u.o.split(" ")),l=b.length,a=0;a<l;)switch(k=b[a++],k){case "m":k=b[a++]*c+d;m=b[a++]*c;e.moveTo(k,m);
break;case "l":k=b[a++]*c+d;m=b[a++]*c;e.lineTo(k,m);break;case "q":k=b[a++]*c+d;m=b[a++]*c;y=b[a++]*c+d;x=b[a++]*c;e.quadraticCurveTo(y,x,k,m);if(g=f[f.length-1])for(v=g.x,q=g.y,g=1,h=this.divisions;g<=h;g++){var B=g/h;THREE.Shape.Utils.b2(B,v,y,k);THREE.Shape.Utils.b2(B,q,x,m)}break;case "b":if(k=b[a++]*c+d,m=b[a++]*c,y=b[a++]*c+d,x=b[a++]*c,w=b[a++]*c+d,z=b[a++]*c,e.bezierCurveTo(y,x,w,z,k,m),g=f[f.length-1])for(v=g.x,q=g.y,g=1,h=this.divisions;g<=h;g++)B=g/h,THREE.Shape.Utils.b3(B,v,y,w,k),THREE.Shape.Utils.b3(B,
q,x,z,m)}return{offset:u.ha*c,path:e}}}};
THREE.FontUtils.generateShapes=function(a,b){b=b||{};var c=void 0!==b.curveSegments?b.curveSegments:4,d=void 0!==b.font?b.font:"helvetiker",e=void 0!==b.weight?b.weight:"normal",f=void 0!==b.style?b.style:"normal";THREE.FontUtils.size=void 0!==b.size?b.size:100;THREE.FontUtils.divisions=c;THREE.FontUtils.face=d;THREE.FontUtils.weight=e;THREE.FontUtils.style=f;c=THREE.FontUtils.drawText(a).paths;d=[];e=0;for(f=c.length;e<f;e++)Array.prototype.push.apply(d,c[e].toShapes());return d};
(function(a){var b=function(a){for(var b=a.length,e=0,f=b-1,g=0;g<b;f=g++)e+=a[f].x*a[g].y-a[g].x*a[f].y;return.5*e};a.Triangulate=function(a,d){var e=a.length;if(3>e)return null;var f=[],g=[],h=[],k,l,m;if(0<b(a))for(l=0;l<e;l++)g[l]=l;else for(l=0;l<e;l++)g[l]=e-1-l;var v=2*e;for(l=e-1;2<e;){if(0>=v--){THREE.warn("THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()");break}k=l;e<=k&&(k=0);l=k+1;e<=l&&(l=0);m=l+1;e<=m&&(m=0);var q;a:{var y=q=void 0,x=void 0,w=void 0,
z=void 0,u=void 0,B=void 0,G=void 0,A=void 0,y=a[g[k]].x,x=a[g[k]].y,w=a[g[l]].x,z=a[g[l]].y,u=a[g[m]].x,B=a[g[m]].y;if(1E-10>(w-y)*(B-x)-(z-x)*(u-y))q=!1;else{var C=void 0,F=void 0,I=void 0,D=void 0,H=void 0,E=void 0,L=void 0,U=void 0,O=void 0,J=void 0,O=U=L=A=G=void 0,C=u-w,F=B-z,I=y-u,D=x-B,H=w-y,E=z-x;for(q=0;q<e;q++)if(G=a[g[q]].x,A=a[g[q]].y,!(G===y&&A===x||G===w&&A===z||G===u&&A===B)&&(L=G-y,U=A-x,O=G-w,J=A-z,G-=u,A-=B,O=C*J-F*O,L=H*U-E*L,U=I*A-D*G,-1E-10<=O&&-1E-10<=U&&-1E-10<=L)){q=!1;break a}q=
!0}}if(q){f.push([a[g[k]],a[g[l]],a[g[m]]]);h.push([g[k],g[l],g[m]]);k=l;for(m=l+1;m<e;k++,m++)g[k]=g[m];e--;v=2*e}}return d?h:f};a.Triangulate.area=b;return a})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;
THREE.Audio=function(a){THREE.Object3D.call(this);this.type="Audio";this.context=a.context;this.source=this.context.createBufferSource();this.source.onended=this.onEnded.bind(this);this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.panner=this.context.createPanner();this.panner.connect(this.gain);this.autoplay=!1;this.startTime=0;this.isPlaying=!1};THREE.Audio.prototype=Object.create(THREE.Object3D.prototype);THREE.Audio.prototype.constructor=THREE.Audio;
THREE.Audio.prototype.load=function(a){var b=this,c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onload=function(a){b.context.decodeAudioData(this.response,function(a){b.source.buffer=a;b.autoplay&&b.play()})};c.send();return this};
THREE.Audio.prototype.play=function(){if(!0===this.isPlaying)THREE.warn("THREE.Audio: Audio is already playing.");else{var a=this.context.createBufferSource();a.buffer=this.source.buffer;a.loop=this.source.loop;a.onended=this.source.onended;a.connect(this.panner);a.start(0,this.startTime);this.isPlaying=!0;this.source=a}};THREE.Audio.prototype.pause=function(){this.source.stop();this.startTime=this.context.currentTime};THREE.Audio.prototype.stop=function(){this.source.stop();this.startTime=0};
THREE.Audio.prototype.onEnded=function(){this.isPlaying=!1};THREE.Audio.prototype.setLoop=function(a){this.source.loop=a};THREE.Audio.prototype.setRefDistance=function(a){this.panner.refDistance=a};THREE.Audio.prototype.setRolloffFactor=function(a){this.panner.rolloffFactor=a};THREE.Audio.prototype.setVolume=function(a){this.gain.gain.value=a};
THREE.Audio.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3;return function(b){THREE.Object3D.prototype.updateMatrixWorld.call(this,b);a.setFromMatrixPosition(this.matrixWorld);this.panner.setPosition(a.x,a.y,a.z)}}();THREE.AudioListener=function(){THREE.Object3D.call(this);this.type="AudioListener";this.context=new (window.AudioContext||window.webkitAudioContext)};THREE.AudioListener.prototype=Object.create(THREE.Object3D.prototype);THREE.AudioListener.prototype.constructor=THREE.AudioListener;
THREE.AudioListener.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3,b=new THREE.Quaternion,c=new THREE.Vector3,d=new THREE.Vector3,e=new THREE.Vector3,f=new THREE.Vector3;return function(g){THREE.Object3D.prototype.updateMatrixWorld.call(this,g);g=this.context.listener;var h=this.up;this.matrixWorld.decompose(a,b,c);d.set(0,0,-1).applyQuaternion(b);e.subVectors(a,f);g.setPosition(a.x,a.y,a.z);g.setOrientation(d.x,d.y,d.z,h.x,h.y,h.z);g.setVelocity(e.x,e.y,e.z);f.copy(a)}}();
THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(a){THREE.warn("THREE.Curve: Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(a){a=this.getUtoTmapping(a);return this.getPoint(a)};THREE.Curve.prototype.getPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPoint(b/a));return c};THREE.Curve.prototype.getSpacedPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPointAt(b/a));return c};
THREE.Curve.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]};THREE.Curve.prototype.getLengths=function(a){a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c,d=this.getPoint(0),e,f=0;b.push(0);for(e=1;e<=a;e++)c=this.getPoint(e/a),f+=c.distanceTo(d),b.push(f),d=c;return this.cacheArcLengths=b};
THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};THREE.Curve.prototype.getUtoTmapping=function(a,b){var c=this.getLengths(),d=0,e=c.length,f;f=b?b:a*c[e-1];for(var g=0,h=e-1,k;g<=h;)if(d=Math.floor(g+(h-g)/2),k=c[d]-f,0>k)g=d+1;else if(0<k)h=d-1;else{h=d;break}d=h;if(c[d]==f)return d/(e-1);g=c[d];return c=(d+(f-g)/(c[d+1]-g))/(e-1)};THREE.Curve.prototype.getTangent=function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()};
THREE.Curve.prototype.getTangentAt=function(a){a=this.getUtoTmapping(a);return this.getTangent(a)};
THREE.Curve.Utils={tangentQuadraticBezier:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},tangentCubicBezier:function(a,b,c,d,e){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*e},tangentSpline:function(a,b,c,d,e){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},interpolate:function(a,b,c,d,e){a=.5*(c-a);d=.5*(d-b);var f=e*e;return(2*b-2*c+a+d)*e*f+(-3*b+3*c-2*a-d)*f+a*e+b}};
THREE.Curve.create=function(a,b){a.prototype=Object.create(THREE.Curve.prototype);a.prototype.constructor=a;a.prototype.getPoint=b;return a};THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.constructor=THREE.CurvePath;THREE.CurvePath.prototype.add=function(a){this.curves.push(a)};THREE.CurvePath.prototype.checkConnection=function(){};
THREE.CurvePath.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new THREE.LineCurve(b,a))};THREE.CurvePath.prototype.getPoint=function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],b=1-b/a.getLength(),a.getPointAt(b);a++}return null};THREE.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]};
THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a=[],b=0,c,d=this.curves.length;for(c=0;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a};
THREE.CurvePath.prototype.getBoundingBox=function(){var a=this.getPoints(),b,c,d,e,f,g;b=c=Number.NEGATIVE_INFINITY;e=f=Number.POSITIVE_INFINITY;var h,k,l,m,v=a[0]instanceof THREE.Vector3;m=v?new THREE.Vector3:new THREE.Vector2;k=0;for(l=a.length;k<l;k++)h=a[k],h.x>b?b=h.x:h.x<e&&(e=h.x),h.y>c?c=h.y:h.y<f&&(f=h.y),v&&(h.z>d?d=h.z:h.z<g&&(g=h.z)),m.add(h);a={minX:e,minY:f,maxX:b,maxY:c};v&&(a.maxZ=d,a.minZ=g);return a};
THREE.CurvePath.prototype.createPointsGeometry=function(a){a=this.getPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(a){a=this.getSpacedPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createGeometry=function(a){for(var b=new THREE.Geometry,c=0;c<a.length;c++)b.vertices.push(new THREE.Vector3(a[c].x,a[c].y,a[c].z||0));return b};THREE.CurvePath.prototype.addWrapPath=function(a){this.bends.push(a)};
THREE.CurvePath.prototype.getTransformedPoints=function(a,b){var c=this.getPoints(a),d,e;b||(b=this.bends);d=0;for(e=b.length;d<e;d++)c=this.getWrapPoints(c,b[d]);return c};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(a,b){var c=this.getSpacedPoints(a),d,e;b||(b=this.bends);d=0;for(e=b.length;d<e;d++)c=this.getWrapPoints(c,b[d]);return c};
THREE.CurvePath.prototype.getWrapPoints=function(a,b){var c=this.getBoundingBox(),d,e,f,g,h,k;d=0;for(e=a.length;d<e;d++)f=a[d],g=f.x,h=f.y,k=g/c.maxX,k=b.getUtoTmapping(k,g),g=b.getPoint(k),k=b.getTangent(k),k.set(-k.y,k.x).multiplyScalar(h),f.x=g.x+k.x,f.y=g.y+k.y;return a};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);THREE.Gyroscope.prototype.constructor=THREE.Gyroscope;
THREE.Gyroscope.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3,b=new THREE.Quaternion,c=new THREE.Vector3,d=new THREE.Vector3,e=new THREE.Quaternion,f=new THREE.Vector3;return function(g){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||g)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(d,e,f),this.matrix.decompose(a,b,c),this.matrixWorld.compose(d,b,f)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=
!1,g=!0;for(var h=0,k=this.children.length;h<k;h++)this.children[h].updateMatrixWorld(g)}}();THREE.Path=function(a){THREE.CurvePath.call(this);this.actions=[];a&&this.fromPoints(a)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.Path.prototype.constructor=THREE.Path;THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};
THREE.Path.prototype.fromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)};THREE.Path.prototype.moveTo=function(a,b){var c=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:c})};
THREE.Path.prototype.lineTo=function(a,b){var c=Array.prototype.slice.call(arguments),d=this.actions[this.actions.length-1].args,d=new THREE.LineCurve(new THREE.Vector2(d[d.length-2],d[d.length-1]),new THREE.Vector2(a,b));this.curves.push(d);this.actions.push({action:THREE.PathActions.LINE_TO,args:c})};
THREE.Path.prototype.quadraticCurveTo=function(a,b,c,d){var e=Array.prototype.slice.call(arguments),f=this.actions[this.actions.length-1].args,f=new THREE.QuadraticBezierCurve(new THREE.Vector2(f[f.length-2],f[f.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d));this.curves.push(f);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:e})};
THREE.Path.prototype.bezierCurveTo=function(a,b,c,d,e,f){var g=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args,h=new THREE.CubicBezierCurve(new THREE.Vector2(h[h.length-2],h[h.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d),new THREE.Vector2(e,f));this.curves.push(h);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:g})};
THREE.Path.prototype.splineThru=function(a){var b=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,c=[new THREE.Vector2(c[c.length-2],c[c.length-1])];Array.prototype.push.apply(c,a);c=new THREE.SplineCurve(c);this.curves.push(c);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:b})};THREE.Path.prototype.arc=function(a,b,c,d,e,f){var g=this.actions[this.actions.length-1].args;this.absarc(a+g[g.length-2],b+g[g.length-1],c,d,e,f)};
THREE.Path.prototype.absarc=function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)};THREE.Path.prototype.ellipse=function(a,b,c,d,e,f,g){var h=this.actions[this.actions.length-1].args;this.absellipse(a+h[h.length-2],b+h[h.length-1],c,d,e,f,g)};THREE.Path.prototype.absellipse=function(a,b,c,d,e,f,g){var h=Array.prototype.slice.call(arguments),k=new THREE.EllipseCurve(a,b,c,d,e,f,g);this.curves.push(k);k=k.getPoint(1);h.push(k.x);h.push(k.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:h})};
THREE.Path.prototype.getSpacedPoints=function(a,b){a||(a=40);for(var c=[],d=0;d<a;d++)c.push(this.getPoint(d/a));return c};
THREE.Path.prototype.getPoints=function(a,b){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(a,b);a=a||12;var c=[],d,e,f,g,h,k,l,m,v,q,y,x,w;d=0;for(e=this.actions.length;d<e;d++)switch(f=this.actions[d],g=f.action,f=f.args,g){case THREE.PathActions.MOVE_TO:c.push(new THREE.Vector2(f[0],f[1]));break;case THREE.PathActions.LINE_TO:c.push(new THREE.Vector2(f[0],f[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:h=f[2];k=f[3];v=f[0];q=f[1];0<c.length?(g=c[c.length-1],y=g.x,
x=g.y):(g=this.actions[d-1].args,y=g[g.length-2],x=g[g.length-1]);for(f=1;f<=a;f++)w=f/a,g=THREE.Shape.Utils.b2(w,y,v,h),w=THREE.Shape.Utils.b2(w,x,q,k),c.push(new THREE.Vector2(g,w));break;case THREE.PathActions.BEZIER_CURVE_TO:h=f[4];k=f[5];v=f[0];q=f[1];l=f[2];m=f[3];0<c.length?(g=c[c.length-1],y=g.x,x=g.y):(g=this.actions[d-1].args,y=g[g.length-2],x=g[g.length-1]);for(f=1;f<=a;f++)w=f/a,g=THREE.Shape.Utils.b3(w,y,v,l,h),w=THREE.Shape.Utils.b3(w,x,q,m,k),c.push(new THREE.Vector2(g,w));break;case THREE.PathActions.CSPLINE_THRU:g=
this.actions[d-1].args;w=[new THREE.Vector2(g[g.length-2],g[g.length-1])];g=a*f[0].length;w=w.concat(f[0]);w=new THREE.SplineCurve(w);for(f=1;f<=g;f++)c.push(w.getPointAt(f/g));break;case THREE.PathActions.ARC:h=f[0];k=f[1];q=f[2];l=f[3];g=f[4];v=!!f[5];y=g-l;x=2*a;for(f=1;f<=x;f++)w=f/x,v||(w=1-w),w=l+w*y,g=h+q*Math.cos(w),w=k+q*Math.sin(w),c.push(new THREE.Vector2(g,w));break;case THREE.PathActions.ELLIPSE:for(h=f[0],k=f[1],q=f[2],m=f[3],l=f[4],g=f[5],v=!!f[6],y=g-l,x=2*a,f=1;f<=x;f++)w=f/x,v||
(w=1-w),w=l+w*y,g=h+q*Math.cos(w),w=k+m*Math.sin(w),c.push(new THREE.Vector2(g,w))}d=c[c.length-1];1E-10>Math.abs(d.x-c[0].x)&&1E-10>Math.abs(d.y-c[0].y)&&c.splice(c.length-1,1);b&&c.push(c[0]);return c};
THREE.Path.prototype.toShapes=function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=new THREE.Shape;f.actions=e.actions;f.curves=e.curves;b.push(f)}return b}function d(a,b){for(var c=b.length,d=!1,e=c-1,f=0;f<c;e=f++){var g=b[e],h=b[f],k=h.x-g.x,l=h.y-g.y;if(1E-10<Math.abs(l)){if(0>l&&(g=b[f],k=-k,h=b[e],l=-l),!(a.y<g.y||a.y>h.y))if(a.y==g.y){if(a.x==g.x)return!0}else{e=l*(a.x-g.x)-k*(a.y-g.y);if(0==e)return!0;0>e||(d=!d)}}else if(a.y==g.y&&(h.x<=a.x&&a.x<=g.x||g.x<=a.x&&a.x<=
h.x))return!0}return d}var e=function(a){var b,c,d,e,f=[],g=new THREE.Path;b=0;for(c=a.length;b<c;b++)d=a[b],e=d.args,d=d.action,d==THREE.PathActions.MOVE_TO&&0!=g.actions.length&&(f.push(g),g=new THREE.Path),g[d].apply(g,e);0!=g.actions.length&&f.push(g);return f}(this.actions);if(0==e.length)return[];if(!0===b)return c(e);var f,g,h,k=[];if(1==e.length)return g=e[0],h=new THREE.Shape,h.actions=g.actions,h.curves=g.curves,k.push(h),k;var l=!THREE.Shape.Utils.isClockWise(e[0].getPoints()),l=a?!l:l;
h=[];var m=[],v=[],q=0,y;m[q]=void 0;v[q]=[];var x,w;x=0;for(w=e.length;x<w;x++)g=e[x],y=g.getPoints(),f=THREE.Shape.Utils.isClockWise(y),(f=a?!f:f)?(!l&&m[q]&&q++,m[q]={s:new THREE.Shape,p:y},m[q].s.actions=g.actions,m[q].s.curves=g.curves,l&&q++,v[q]=[]):v[q].push({h:g,p:y[0]});if(!m[0])return c(e);if(1<m.length){x=!1;w=[];g=0;for(e=m.length;g<e;g++)h[g]=[];g=0;for(e=m.length;g<e;g++)for(f=v[g],l=0;l<f.length;l++){q=f[l];y=!0;for(var z=0;z<m.length;z++)d(q.p,m[z].p)&&(g!=z&&w.push({froms:g,tos:z,
hole:l}),y?(y=!1,h[z].push(q)):x=!0);y&&h[g].push(q)}0<w.length&&(x||(v=h))}x=0;for(w=m.length;x<w;x++)for(h=m[x].s,k.push(h),g=v[x],e=0,f=g.length;e<f;e++)h.holes.push(g[e].h);return k};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);THREE.Shape.prototype.constructor=THREE.Shape;THREE.Shape.prototype.extrude=function(a){return new THREE.ExtrudeGeometry(this,a)};
THREE.Shape.prototype.makeGeometry=function(a){return new THREE.ShapeGeometry(this,a)};THREE.Shape.prototype.getPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedPoints(a,this.bends);return d};THREE.Shape.prototype.getSpacedPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedSpacedPoints(a,this.bends);return d};
THREE.Shape.prototype.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}};THREE.Shape.prototype.extractPoints=function(a){return this.useSpacedPoints?this.extractAllSpacedPoints(a):this.extractAllPoints(a)};THREE.Shape.prototype.extractAllSpacedPoints=function(a){return{shape:this.getTransformedSpacedPoints(a),holes:this.getSpacedPointsHoles(a)}};
THREE.Shape.Utils={triangulateShape:function(a,b){function c(a,b,c){return a.x!=b.x?a.x<b.x?a.x<=c.x&&c.x<=b.x:b.x<=c.x&&c.x<=a.x:a.y<b.y?a.y<=c.y&&c.y<=b.y:b.y<=c.y&&c.y<=a.y}function d(a,b,d,e,f){var g=b.x-a.x,h=b.y-a.y,k=e.x-d.x,l=e.y-d.y,m=a.x-d.x,v=a.y-d.y,I=h*k-g*l,D=h*m-g*v;if(1E-10<Math.abs(I)){if(0<I){if(0>D||D>I)return[];k=l*m-k*v;if(0>k||k>I)return[]}else{if(0<D||D<I)return[];k=l*m-k*v;if(0<k||k<I)return[]}if(0==k)return!f||0!=D&&D!=I?[a]:[];if(k==I)return!f||0!=D&&D!=I?[b]:[];if(0==D)return[d];
if(D==I)return[e];f=k/I;return[{x:a.x+f*g,y:a.y+f*h}]}if(0!=D||l*m!=k*v)return[];h=0==g&&0==h;k=0==k&&0==l;if(h&&k)return a.x!=d.x||a.y!=d.y?[]:[a];if(h)return c(d,e,a)?[a]:[];if(k)return c(a,b,d)?[d]:[];0!=g?(a.x<b.x?(g=a,k=a.x,h=b,a=b.x):(g=b,k=b.x,h=a,a=a.x),d.x<e.x?(b=d,I=d.x,l=e,d=e.x):(b=e,I=e.x,l=d,d=d.x)):(a.y<b.y?(g=a,k=a.y,h=b,a=b.y):(g=b,k=b.y,h=a,a=a.y),d.y<e.y?(b=d,I=d.y,l=e,d=e.y):(b=e,I=e.y,l=d,d=d.y));return k<=I?a<I?[]:a==I?f?[]:[b]:a<=d?[b,h]:[b,l]:k>d?[]:k==d?f?[]:[g]:a<=d?[g,h]:
[g,l]}function e(a,b,c,d){var e=b.x-a.x,f=b.y-a.y;b=c.x-a.x;c=c.y-a.y;var g=d.x-a.x;d=d.y-a.y;a=e*c-f*b;e=e*d-f*g;return 1E-10<Math.abs(a)?(b=g*c-d*b,0<a?0<=e&&0<=b:0<=e||0<=b):0<e}var f,g,h,k,l,m={};h=a.concat();f=0;for(g=b.length;f<g;f++)Array.prototype.push.apply(h,b[f]);f=0;for(g=h.length;f<g;f++)l=h[f].x+":"+h[f].y,void 0!==m[l]&&THREE.warn("THREE.Shape: Duplicate point",l),m[l]=f;f=function(a,b){function c(a,b){var d=h.length-1,f=a-1;0>f&&(f=d);var g=a+1;g>d&&(g=0);d=e(h[a],h[f],h[g],k[b]);
if(!d)return!1;d=k.length-1;f=b-1;0>f&&(f=d);g=b+1;g>d&&(g=0);return(d=e(k[b],k[f],k[g],h[a]))?!0:!1}function f(a,b){var c,e;for(c=0;c<h.length;c++)if(e=c+1,e%=h.length,e=d(a,b,h[c],h[e],!0),0<e.length)return!0;return!1}function g(a,c){var e,f,h,k;for(e=0;e<l.length;e++)for(f=b[l[e]],h=0;h<f.length;h++)if(k=h+1,k%=f.length,k=d(a,c,f[h],f[k],!0),0<k.length)return!0;return!1}var h=a.concat(),k,l=[],m,v,F,I,D,H=[],E,L,U,O=0;for(m=b.length;O<m;O++)l.push(O);E=0;for(var J=2*l.length;0<l.length;){J--;if(0>
J){console.log("Infinite Loop! Holes left:"+l.length+", Probably Hole outside Shape!");break}for(v=E;v<h.length;v++){F=h[v];m=-1;for(O=0;O<l.length;O++)if(I=l[O],D=F.x+":"+F.y+":"+I,void 0===H[D]){k=b[I];for(L=0;L<k.length;L++)if(I=k[L],c(v,L)&&!f(F,I)&&!g(F,I)){m=L;l.splice(O,1);E=h.slice(0,v+1);I=h.slice(v);L=k.slice(m);U=k.slice(0,m+1);h=E.concat(L).concat(U).concat(I);E=v;break}if(0<=m)break;H[D]=!0}if(0<=m)break}}return h}(a,b);var v=THREE.FontUtils.Triangulate(f,!1);f=0;for(g=v.length;f<g;f++)for(k=
v[f],h=0;3>h;h++)l=k[h].x+":"+k[h].y,l=m[l],void 0!==l&&(k[h]=l);return v.concat()},isClockWise:function(a){return 0>THREE.FontUtils.Triangulate.area(a)},b2p0:function(a,b){var c=1-a;return c*c*b},b2p1:function(a,b){return 2*(1-a)*a*b},b2p2:function(a,b){return a*a*b},b2:function(a,b,c,d){return this.b2p0(a,b)+this.b2p1(a,c)+this.b2p2(a,d)},b3p0:function(a,b){var c=1-a;return c*c*c*b},b3p1:function(a,b){var c=1-a;return 3*c*c*a*b},b3p2:function(a,b){return 3*(1-a)*a*a*b},b3p3:function(a,b){return a*
a*a*b},b3:function(a,b,c,d,e){return this.b3p0(a,b)+this.b3p1(a,c)+this.b3p2(a,d)+this.b3p3(a,e)}};THREE.LineCurve=function(a,b){this.v1=a;this.v2=b};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.constructor=THREE.LineCurve;THREE.LineCurve.prototype.getPoint=function(a){var b=this.v2.clone().sub(this.v1);b.multiplyScalar(a).add(this.v1);return b};THREE.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)};
THREE.LineCurve.prototype.getTangent=function(a){return this.v2.clone().sub(this.v1).normalize()};THREE.QuadraticBezierCurve=function(a,b,c){this.v0=a;this.v1=b;this.v2=c};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve;
THREE.QuadraticBezierCurve.prototype.getPoint=function(a){var b=new THREE.Vector2;b.x=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);b.y=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);return b};THREE.QuadraticBezierCurve.prototype.getTangent=function(a){var b=new THREE.Vector2;b.x=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.x,this.v1.x,this.v2.x);b.y=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.y,this.v1.y,this.v2.y);return b.normalize()};
THREE.CubicBezierCurve=function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve;THREE.CubicBezierCurve.prototype.getPoint=function(a){var b;b=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(b,a)};
THREE.CubicBezierCurve.prototype.getTangent=function(a){var b;b=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);b=new THREE.Vector2(b,a);b.normalize();return b};THREE.SplineCurve=function(a){this.points=void 0==a?[]:a};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.constructor=THREE.SplineCurve;
THREE.SplineCurve.prototype.getPoint=function(a){var b=this.points;a*=b.length-1;var c=Math.floor(a);a-=c;var d=b[0==c?c:c-1],e=b[c],f=b[c>b.length-2?b.length-1:c+1],b=b[c>b.length-3?b.length-1:c+2],c=new THREE.Vector2;c.x=THREE.Curve.Utils.interpolate(d.x,e.x,f.x,b.x,a);c.y=THREE.Curve.Utils.interpolate(d.y,e.y,f.y,b.y,a);return c};THREE.EllipseCurve=function(a,b,c,d,e,f,g){this.aX=a;this.aY=b;this.xRadius=c;this.yRadius=d;this.aStartAngle=e;this.aEndAngle=f;this.aClockwise=g};
THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.constructor=THREE.EllipseCurve;THREE.EllipseCurve.prototype.getPoint=function(a){var b=this.aEndAngle-this.aStartAngle;0>b&&(b+=2*Math.PI);b>2*Math.PI&&(b-=2*Math.PI);a=!0===this.aClockwise?this.aEndAngle+(1-a)*(2*Math.PI-b):this.aStartAngle+a*b;b=new THREE.Vector2;b.x=this.aX+this.xRadius*Math.cos(a);b.y=this.aY+this.yRadius*Math.sin(a);return b};
THREE.ArcCurve=function(a,b,c,d,e,f){THREE.EllipseCurve.call(this,a,b,c,c,d,e,f)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);THREE.ArcCurve.prototype.constructor=THREE.ArcCurve;THREE.LineCurve3=THREE.Curve.create(function(a,b){this.v1=a;this.v2=b},function(a){var b=new THREE.Vector3;b.subVectors(this.v2,this.v1);b.multiplyScalar(a);b.add(this.v1);return b});
THREE.QuadraticBezierCurve3=THREE.Curve.create(function(a,b,c){this.v0=a;this.v1=b;this.v2=c},function(a){var b=new THREE.Vector3;b.x=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);b.y=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);b.z=THREE.Shape.Utils.b2(a,this.v0.z,this.v1.z,this.v2.z);return b});
THREE.CubicBezierCurve3=THREE.Curve.create(function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d},function(a){var b=new THREE.Vector3;b.x=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);b.y=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);b.z=THREE.Shape.Utils.b3(a,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return b});
THREE.SplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=this.points;a*=b.length-1;var c=Math.floor(a);a-=c;var d=b[0==c?c:c-1],e=b[c],f=b[c>b.length-2?b.length-1:c+1],b=b[c>b.length-3?b.length-1:c+2],c=new THREE.Vector3;c.x=THREE.Curve.Utils.interpolate(d.x,e.x,f.x,b.x,a);c.y=THREE.Curve.Utils.interpolate(d.y,e.y,f.y,b.y,a);c.z=THREE.Curve.Utils.interpolate(d.z,e.z,f.z,b.z,a);return c});
THREE.ClosedSplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=this.points;a*=b.length-0;var c=Math.floor(a);a-=c;var c=c+(0<c?0:(Math.floor(Math.abs(c)/b.length)+1)*b.length),d=b[(c-1)%b.length],e=b[c%b.length],f=b[(c+1)%b.length],b=b[(c+2)%b.length],c=new THREE.Vector3;c.x=THREE.Curve.Utils.interpolate(d.x,e.x,f.x,b.x,a);c.y=THREE.Curve.Utils.interpolate(d.y,e.y,f.y,b.y,a);c.z=THREE.Curve.Utils.interpolate(d.z,e.z,f.z,b.z,a);return c});
THREE.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){THREE.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){THREE.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){THREE.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(a){if(!0===a.initialized)return a;for(var b=0;b<a.hierarchy.length;b++){for(var c=0;c<a.hierarchy[b].keys.length;c++)if(0>a.hierarchy[b].keys[c].time&&(a.hierarchy[b].keys[c].time=
0),void 0!==a.hierarchy[b].keys[c].rot&&!(a.hierarchy[b].keys[c].rot instanceof THREE.Quaternion)){var d=a.hierarchy[b].keys[c].rot;a.hierarchy[b].keys[c].rot=(new THREE.Quaternion).fromArray(d)}if(a.hierarchy[b].keys.length&&void 0!==a.hierarchy[b].keys[0].morphTargets){d={};for(c=0;c<a.hierarchy[b].keys.length;c++)for(var e=0;e<a.hierarchy[b].keys[c].morphTargets.length;e++){var f=a.hierarchy[b].keys[c].morphTargets[e];d[f]=-1}a.hierarchy[b].usedMorphTargets=d;for(c=0;c<a.hierarchy[b].keys.length;c++){var g=
{};for(f in d){for(e=0;e<a.hierarchy[b].keys[c].morphTargets.length;e++)if(a.hierarchy[b].keys[c].morphTargets[e]===f){g[f]=a.hierarchy[b].keys[c].morphTargetsInfluences[e];break}e===a.hierarchy[b].keys[c].morphTargets.length&&(g[f]=0)}a.hierarchy[b].keys[c].morphTargetsInfluences=g}}for(c=1;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].time===a.hierarchy[b].keys[c-1].time&&(a.hierarchy[b].keys.splice(c,1),c--);for(c=0;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].index=c}a.initialized=
!0;return a},parse:function(a){var b=function(a,c){c.push(a);for(var d=0;d<a.children.length;d++)b(a.children[d],c)},c=[];if(a instanceof THREE.SkinnedMesh)for(var d=0;d<a.skeleton.bones.length;d++)c.push(a.skeleton.bones[d]);else b(a,c);return c},play:function(a){-1===this.animations.indexOf(a)&&this.animations.push(a)},stop:function(a){a=this.animations.indexOf(a);-1!==a&&this.animations.splice(a,1)},update:function(a){for(var b=0;b<this.animations.length;b++)this.animations[b].resetBlendWeights();
for(b=0;b<this.animations.length;b++)this.animations[b].update(a)}};THREE.Animation=function(a,b){this.root=a;this.data=THREE.AnimationHandler.init(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=!0;this.weight=0;this.interpolationType=THREE.AnimationHandler.LINEAR};
THREE.Animation.prototype={constructor:THREE.Animation,keyTypes:["pos","rot","scl"],play:function(a,b){this.currentTime=void 0!==a?a:0;this.weight=void 0!==b?b:1;this.isPlaying=!0;this.reset();THREE.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1;THREE.AnimationHandler.stop(this)},reset:function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a];void 0===c.animationCache&&(c.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});
var d=this.data.name,e=c.animationCache.animations,f=e[d];void 0===f&&(f={prevKey:{pos:0,rot:0,scl:0},nextKey:{pos:0,rot:0,scl:0},originalMatrix:c.matrix},e[d]=f);for(c=0;3>c;c++){for(var d=this.keyTypes[c],e=this.data.hierarchy[a].keys[0],g=this.getNextKeyWith(d,a,1);g.time<this.currentTime&&g.index>e.index;)e=g,g=this.getNextKeyWith(d,a,g.index+1);f.prevKey[d]=e;f.nextKey[d]=g}}},resetBlendWeights:function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a].animationCache;void 0!==
c&&(c=c.blending,c.positionWeight=0,c.quaternionWeight=0,c.scaleWeight=0)}},update:function(){var a=[],b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Quaternion,e=function(a,b){var c=[],d=[],e,v,q,y,x,w;e=(a.length-1)*b;v=Math.floor(e);e-=v;c[0]=0===v?v:v-1;c[1]=v;c[2]=v>a.length-2?v:v+1;c[3]=v>a.length-3?v:v+2;v=a[c[0]];y=a[c[1]];x=a[c[2]];w=a[c[3]];c=e*e;q=e*c;d[0]=f(v[0],y[0],x[0],w[0],e,c,q);d[1]=f(v[1],y[1],x[1],w[1],e,c,q);d[2]=f(v[2],y[2],x[2],w[2],e,c,q);return d},f=function(a,b,c,d,
e,f,q){a=.5*(c-a);d=.5*(d-b);return(2*(b-c)+a+d)*q+(-3*(b-c)-2*a-d)*f+a*e+b};return function(f){if(!1!==this.isPlaying&&(this.currentTime+=f*this.timeScale,0!==this.weight)){f=this.data.length;if(this.currentTime>f||0>this.currentTime)this.loop?(this.currentTime%=f,0>this.currentTime&&(this.currentTime+=f),this.reset()):this.stop();f=0;for(var h=this.hierarchy.length;f<h;f++)for(var k=this.hierarchy[f],l=k.animationCache.animations[this.data.name],m=k.animationCache.blending,v=0;3>v;v++){var q=this.keyTypes[v],
y=l.prevKey[q],x=l.nextKey[q];if(0<this.timeScale&&x.time<=this.currentTime||0>this.timeScale&&y.time>=this.currentTime){y=this.data.hierarchy[f].keys[0];for(x=this.getNextKeyWith(q,f,1);x.time<this.currentTime&&x.index>y.index;)y=x,x=this.getNextKeyWith(q,f,x.index+1);l.prevKey[q]=y;l.nextKey[q]=x}var w=(this.currentTime-y.time)/(x.time-y.time),z=y[q],u=x[q];0>w&&(w=0);1<w&&(w=1);if("pos"===q)if(this.interpolationType===THREE.AnimationHandler.LINEAR)c.x=z[0]+(u[0]-z[0])*w,c.y=z[1]+(u[1]-z[1])*w,
c.z=z[2]+(u[2]-z[2])*w,y=this.weight/(this.weight+m.positionWeight),k.position.lerp(c,y),m.positionWeight+=this.weight;else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)a[0]=this.getPrevKeyWith("pos",f,y.index-1).pos,a[1]=z,a[2]=u,a[3]=this.getNextKeyWith("pos",f,x.index+1).pos,w=.33*w+.33,x=e(a,w),y=this.weight/(this.weight+m.positionWeight),m.positionWeight+=this.weight,q=k.position,q.x+=(x[0]-q.x)*y,q.y+=(x[1]-
q.y)*y,q.z+=(x[2]-q.z)*y,this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(w=e(a,1.01*w),b.set(w[0],w[1],w[2]),b.sub(q),b.y=0,b.normalize(),w=Math.atan2(b.x,b.z),k.rotation.set(0,w,0))}else"rot"===q?(THREE.Quaternion.slerp(z,u,d,w),0===m.quaternionWeight?(k.quaternion.copy(d),m.quaternionWeight=this.weight):(y=this.weight/(this.weight+m.quaternionWeight),THREE.Quaternion.slerp(k.quaternion,d,k.quaternion,y),m.quaternionWeight+=this.weight)):"scl"===q&&(c.x=z[0]+(u[0]-z[0])*w,c.y=
z[1]+(u[1]-z[1])*w,c.z=z[2]+(u[2]-z[2])*w,y=this.weight/(this.weight+m.scaleWeight),k.scale.lerp(c,y),m.scaleWeight+=this.weight)}return!0}}}(),getNextKeyWith:function(a,b,c){var d=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?c<d.length-1?c:d.length-1:c%d.length;c<d.length;c++)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[0]},getPrevKeyWith:function(a,b,c){var d=
this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<c?c:0:0<=c?c:c+d.length;0<=c;c--)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[d.length-1]}};
THREE.KeyFrameAnimation=function(a){this.root=a.node;this.data=THREE.AnimationHandler.init(a);this.hierarchy=THREE.AnimationHandler.parse(this.root);this.currentTime=0;this.timeScale=.001;this.isPlaying=!1;this.loop=this.isPaused=!0;a=0;for(var b=this.hierarchy.length;a<b;a++){var c=this.data.hierarchy[a].sids,d=this.hierarchy[a];if(this.data.hierarchy[a].keys.length&&c){for(var e=0;e<c.length;e++){var f=c[e],g=this.getNextKeyWith(f,a,0);g&&g.apply(f)}d.matrixAutoUpdate=!1;this.data.hierarchy[a].node.updateMatrix();
d.matrixWorldNeedsUpdate=!0}}};
THREE.KeyFrameAnimation.prototype={constructor:THREE.KeyFrameAnimation,play:function(a){this.currentTime=void 0!==a?a:0;if(!1===this.isPlaying){this.isPlaying=!0;var b=this.hierarchy.length,c,d;for(a=0;a<b;a++)c=this.hierarchy[a],d=this.data.hierarchy[a],void 0===d.animationCache&&(d.animationCache={},d.animationCache.prevKey=null,d.animationCache.nextKey=null,d.animationCache.originalMatrix=c.matrix),c=this.data.hierarchy[a].keys,c.length&&(d.animationCache.prevKey=c[0],d.animationCache.nextKey=
c[1],this.startTime=Math.min(c[0].time,this.startTime),this.endTime=Math.max(c[c.length-1].time,this.endTime));this.update(0)}this.isPaused=!1;THREE.AnimationHandler.play(this)},stop:function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.stop(this);for(var a=0;a<this.data.hierarchy.length;a++){var b=this.hierarchy[a],c=this.data.hierarchy[a];if(void 0!==c.animationCache){var d=c.animationCache.originalMatrix;d.copy(b.matrix);b.matrix=d;delete c.animationCache}}},update:function(a){if(!1!==
this.isPlaying){this.currentTime+=a*this.timeScale;a=this.data.length;!0===this.loop&&this.currentTime>a&&(this.currentTime%=a);this.currentTime=Math.min(this.currentTime,a);a=0;for(var b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a],d=this.data.hierarchy[a],e=d.keys,d=d.animationCache;if(e.length){var f=d.prevKey,g=d.nextKey;if(g.time<=this.currentTime){for(;g.time<this.currentTime&&g.index>f.index;)f=g,g=e[f.index+1];d.prevKey=f;d.nextKey=g}g.time>=this.currentTime?f.interpolate(g,this.currentTime):
f.interpolate(g,g.time);this.data.hierarchy[a].node.updateMatrix();c.matrixWorldNeedsUpdate=!0}}}},getNextKeyWith:function(a,b,c){b=this.data.hierarchy[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].hasTarget(a))return b[c];return b[0]},getPrevKeyWith:function(a,b,c){b=this.data.hierarchy[b].keys;for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].hasTarget(a))return b[c];return b[b.length-1]}};
THREE.MorphAnimation=function(a){this.mesh=a;this.frames=a.morphTargetInfluences.length;this.currentTime=0;this.duration=1E3;this.loop=!0;this.currentFrame=this.lastFrame=0;this.isPlaying=!1};
THREE.MorphAnimation.prototype={constructor:THREE.MorphAnimation,play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(a){if(!1!==this.isPlaying){this.currentTime+=a;!0===this.loop&&this.currentTime>this.duration&&(this.currentTime%=this.duration);this.currentTime=Math.min(this.currentTime,this.duration);a=this.duration/this.frames;var b=Math.floor(this.currentTime/a),c=this.mesh.morphTargetInfluences;b!=this.currentFrame&&(c[this.lastFrame]=0,c[this.currentFrame]=
1,c[b]=0,this.lastFrame=this.currentFrame,this.currentFrame=b);c[b]=this.currentTime%a/a;c[this.lastFrame]=1-c[b]}}};
THREE.BoxGeometry=function(a,b,c,d,e,f){function g(a,b,c,d,e,f,g,w){var z,u=h.widthSegments,B=h.heightSegments,G=e/2,A=f/2,C=h.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)z="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)z="y",B=h.depthSegments;else if("z"===a&&"y"===b||"y"===a&&"z"===b)z="x",u=h.depthSegments;var F=u+1,I=B+1,D=e/u,H=f/B,E=new THREE.Vector3;E[z]=0<g?1:-1;for(e=0;e<I;e++)for(f=0;f<F;f++){var L=new THREE.Vector3;L[a]=(f*D-G)*c;L[b]=(e*H-A)*d;L[z]=g;h.vertices.push(L)}for(e=
0;e<B;e++)for(f=0;f<u;f++)A=f+F*e,a=f+F*(e+1),b=f+1+F*(e+1),c=f+1+F*e,d=new THREE.Vector2(f/u,1-e/B),g=new THREE.Vector2(f/u,1-(e+1)/B),z=new THREE.Vector2((f+1)/u,1-(e+1)/B),G=new THREE.Vector2((f+1)/u,1-e/B),A=new THREE.Face3(A+C,a+C,c+C),A.normal.copy(E),A.vertexNormals.push(E.clone(),E.clone(),E.clone()),A.materialIndex=w,h.faces.push(A),h.faceVertexUvs[0].push([d,g,G]),A=new THREE.Face3(a+C,b+C,c+C),A.normal.copy(E),A.vertexNormals.push(E.clone(),E.clone(),E.clone()),A.materialIndex=w,h.faces.push(A),
h.faceVertexUvs[0].push([g.clone(),z,G.clone()])}THREE.Geometry.call(this);this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};this.widthSegments=d||1;this.heightSegments=e||1;this.depthSegments=f||1;var h=this;d=a/2;e=b/2;f=c/2;g("z","y",-1,-1,c,b,d,0);g("z","y",1,-1,c,b,-d,1);g("x","z",1,1,a,c,e,2);g("x","z",1,-1,a,c,-e,3);g("x","y",1,-1,a,b,f,4);g("x","y",-1,-1,a,b,-f,5);this.mergeVertices()};THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.BoxGeometry.prototype.constructor=THREE.BoxGeometry;
THREE.CircleGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};a=a||50;b=void 0!==b?Math.max(3,b):8;c=void 0!==c?c:0;d=void 0!==d?d:2*Math.PI;var e,f=[];e=new THREE.Vector3;var g=new THREE.Vector2(.5,.5);this.vertices.push(e);f.push(g);for(e=0;e<=b;e++){var h=new THREE.Vector3,k=c+e/b*d;h.x=a*Math.cos(k);h.y=a*Math.sin(k);this.vertices.push(h);f.push(new THREE.Vector2((h.x/a+1)/2,(h.y/a+1)/2))}c=new THREE.Vector3(0,
0,1);for(e=1;e<=b;e++)this.faces.push(new THREE.Face3(e,e+1,0,[c.clone(),c.clone(),c.clone()])),this.faceVertexUvs[0].push([f[e].clone(),f[e+1].clone(),g.clone()]);this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CircleGeometry.prototype.constructor=THREE.CircleGeometry;
THREE.CubeGeometry=function(a,b,c,d,e,f){THREE.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry.");return new THREE.BoxGeometry(a,b,c,d,e,f)};
THREE.CylinderGeometry=function(a,b,c,d,e,f,g,h){THREE.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};a=void 0!==a?a:20;b=void 0!==b?b:20;c=void 0!==c?c:100;d=d||8;e=e||1;f=void 0!==f?f:!1;g=void 0!==g?g:0;h=void 0!==h?h:2*Math.PI;var k=c/2,l,m,v=[],q=[];for(m=0;m<=e;m++){var y=[],x=[],w=m/e,z=w*(b-a)+a;for(l=0;l<=d;l++){var u=l/d,B=new THREE.Vector3;B.x=z*Math.sin(u*h+
g);B.y=-w*c+k;B.z=z*Math.cos(u*h+g);this.vertices.push(B);y.push(this.vertices.length-1);x.push(new THREE.Vector2(u,1-w))}v.push(y);q.push(x)}c=(b-a)/c;for(l=0;l<d;l++)for(0!==a?(g=this.vertices[v[0][l]].clone(),h=this.vertices[v[0][l+1]].clone()):(g=this.vertices[v[1][l]].clone(),h=this.vertices[v[1][l+1]].clone()),g.setY(Math.sqrt(g.x*g.x+g.z*g.z)*c).normalize(),h.setY(Math.sqrt(h.x*h.x+h.z*h.z)*c).normalize(),m=0;m<e;m++){var y=v[m][l],x=v[m+1][l],w=v[m+1][l+1],z=v[m][l+1],u=g.clone(),B=g.clone(),
G=h.clone(),A=h.clone(),C=q[m][l].clone(),F=q[m+1][l].clone(),I=q[m+1][l+1].clone(),D=q[m][l+1].clone();this.faces.push(new THREE.Face3(y,x,z,[u,B,A]));this.faceVertexUvs[0].push([C,F,D]);this.faces.push(new THREE.Face3(x,w,z,[B.clone(),G,A.clone()]));this.faceVertexUvs[0].push([F.clone(),I,D.clone()])}if(!1===f&&0<a)for(this.vertices.push(new THREE.Vector3(0,k,0)),l=0;l<d;l++)y=v[0][l],x=v[0][l+1],w=this.vertices.length-1,u=new THREE.Vector3(0,1,0),B=new THREE.Vector3(0,1,0),G=new THREE.Vector3(0,
1,0),C=q[0][l].clone(),F=q[0][l+1].clone(),I=new THREE.Vector2(F.x,0),this.faces.push(new THREE.Face3(y,x,w,[u,B,G])),this.faceVertexUvs[0].push([C,F,I]);if(!1===f&&0<b)for(this.vertices.push(new THREE.Vector3(0,-k,0)),l=0;l<d;l++)y=v[e][l+1],x=v[e][l],w=this.vertices.length-1,u=new THREE.Vector3(0,-1,0),B=new THREE.Vector3(0,-1,0),G=new THREE.Vector3(0,-1,0),C=q[e][l+1].clone(),F=q[e][l].clone(),I=new THREE.Vector2(F.x,1),this.faces.push(new THREE.Face3(y,x,w,[u,B,G])),this.faceVertexUvs[0].push([C,
F,I]);this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry;THREE.ExtrudeGeometry=function(a,b){"undefined"!==typeof a&&(THREE.Geometry.call(this),this.type="ExtrudeGeometry",a=a instanceof Array?a:[a],this.addShapeList(a,b),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry;
THREE.ExtrudeGeometry.prototype.addShapeList=function(a,b){for(var c=a.length,d=0;d<c;d++)this.addShape(a[d],b)};
THREE.ExtrudeGeometry.prototype.addShape=function(a,b){function c(a,b,c){b||THREE.error("THREE.ExtrudeGeometry: vec does not exist");return b.clone().multiplyScalar(c).add(a)}function d(a,b,c){var d=1,d=a.x-b.x,e=a.y-b.y,f=c.x-a.x,g=c.y-a.y,h=d*d+e*e;if(1E-10<Math.abs(d*g-e*f)){var k=Math.sqrt(h),l=Math.sqrt(f*f+g*g),h=b.x-e/k;b=b.y+d/k;f=((c.x-g/l-h)*g-(c.y+f/l-b)*f)/(d*g-e*f);c=h+d*f-a.x;a=b+e*f-a.y;d=c*c+a*a;if(2>=d)return new THREE.Vector2(c,a);d=Math.sqrt(d/2)}else a=!1,1E-10<d?1E-10<f&&(a=!0):
-1E-10>d?-1E-10>f&&(a=!0):Math.sign(e)==Math.sign(g)&&(a=!0),a?(c=-e,a=d,d=Math.sqrt(h)):(c=d,a=e,d=Math.sqrt(h/2));return new THREE.Vector2(c/d,a/d)}function e(a,b){var c,d;for(K=a.length;0<=--K;){c=K;d=K-1;0>d&&(d=a.length-1);for(var e=0,f=y+2*m,e=0;e<f;e++){var g=ja*e,h=ja*(e+1),k=b+c+g,g=b+d+g,l=b+d+h,h=b+c+h,k=k+U,g=g+U,l=l+U,h=h+U;L.faces.push(new THREE.Face3(k,g,h,null,null,B));L.faces.push(new THREE.Face3(g,l,h,null,null,B));k=G.generateSideWallUV(L,k,g,l,h);L.faceVertexUvs[0].push([k[0],
k[1],k[3]]);L.faceVertexUvs[0].push([k[1],k[2],k[3]])}}}function f(a,b,c){L.vertices.push(new THREE.Vector3(a,b,c))}function g(a,b,c){a+=U;b+=U;c+=U;L.faces.push(new THREE.Face3(a,b,c,null,null,u));a=G.generateTopUV(L,a,b,c);L.faceVertexUvs[0].push(a)}var h=void 0!==b.amount?b.amount:100,k=void 0!==b.bevelThickness?b.bevelThickness:6,l=void 0!==b.bevelSize?b.bevelSize:k-2,m=void 0!==b.bevelSegments?b.bevelSegments:3,v=void 0!==b.bevelEnabled?b.bevelEnabled:!0,q=void 0!==b.curveSegments?b.curveSegments:
12,y=void 0!==b.steps?b.steps:1,x=b.extrudePath,w,z=!1,u=b.material,B=b.extrudeMaterial,G=void 0!==b.UVGenerator?b.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,A,C,F,I;x&&(w=x.getSpacedPoints(y),z=!0,v=!1,A=void 0!==b.frames?b.frames:new THREE.TubeGeometry.FrenetFrames(x,y,!1),C=new THREE.Vector3,F=new THREE.Vector3,I=new THREE.Vector3);v||(l=k=m=0);var D,H,E,L=this,U=this.vertices.length,x=a.extractPoints(q),q=x.shape,O=x.holes;if(x=!THREE.Shape.Utils.isClockWise(q)){q=q.reverse();H=0;for(E=
O.length;H<E;H++)D=O[H],THREE.Shape.Utils.isClockWise(D)&&(O[H]=D.reverse());x=!1}var J=THREE.Shape.Utils.triangulateShape(q,O),P=q;H=0;for(E=O.length;H<E;H++)D=O[H],q=q.concat(D);var T,S,R,ba,N,ja=q.length,pa,da=J.length,x=[],K=0;R=P.length;T=R-1;for(S=K+1;K<R;K++,T++,S++)T===R&&(T=0),S===R&&(S=0),x[K]=d(P[K],P[T],P[S]);var ra=[],ia,ta=x.concat();H=0;for(E=O.length;H<E;H++){D=O[H];ia=[];K=0;R=D.length;T=R-1;for(S=K+1;K<R;K++,T++,S++)T===R&&(T=0),S===R&&(S=0),ia[K]=d(D[K],D[T],D[S]);ra.push(ia);ta=
ta.concat(ia)}for(T=0;T<m;T++){R=T/m;ba=k*(1-R);S=l*Math.sin(R*Math.PI/2);K=0;for(R=P.length;K<R;K++)N=c(P[K],x[K],S),f(N.x,N.y,-ba);H=0;for(E=O.length;H<E;H++)for(D=O[H],ia=ra[H],K=0,R=D.length;K<R;K++)N=c(D[K],ia[K],S),f(N.x,N.y,-ba)}S=l;for(K=0;K<ja;K++)N=v?c(q[K],ta[K],S):q[K],z?(F.copy(A.normals[0]).multiplyScalar(N.x),C.copy(A.binormals[0]).multiplyScalar(N.y),I.copy(w[0]).add(F).add(C),f(I.x,I.y,I.z)):f(N.x,N.y,0);for(R=1;R<=y;R++)for(K=0;K<ja;K++)N=v?c(q[K],ta[K],S):q[K],z?(F.copy(A.normals[R]).multiplyScalar(N.x),
C.copy(A.binormals[R]).multiplyScalar(N.y),I.copy(w[R]).add(F).add(C),f(I.x,I.y,I.z)):f(N.x,N.y,h/y*R);for(T=m-1;0<=T;T--){R=T/m;ba=k*(1-R);S=l*Math.sin(R*Math.PI/2);K=0;for(R=P.length;K<R;K++)N=c(P[K],x[K],S),f(N.x,N.y,h+ba);H=0;for(E=O.length;H<E;H++)for(D=O[H],ia=ra[H],K=0,R=D.length;K<R;K++)N=c(D[K],ia[K],S),z?f(N.x,N.y+w[y-1].y,w[y-1].x+ba):f(N.x,N.y,h+ba)}(function(){if(v){var a;a=0*ja;for(K=0;K<da;K++)pa=J[K],g(pa[2]+a,pa[1]+a,pa[0]+a);a=y+2*m;a*=ja;for(K=0;K<da;K++)pa=J[K],g(pa[0]+a,pa[1]+
a,pa[2]+a)}else{for(K=0;K<da;K++)pa=J[K],g(pa[2],pa[1],pa[0]);for(K=0;K<da;K++)pa=J[K],g(pa[0]+ja*y,pa[1]+ja*y,pa[2]+ja*y)}})();(function(){var a=0;e(P,a);a+=P.length;H=0;for(E=O.length;H<E;H++)D=O[H],e(D,a),a+=D.length})()};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,b,c,d){a=a.vertices;b=a[b];c=a[c];d=a[d];return[new THREE.Vector2(b.x,b.y),new THREE.Vector2(c.x,c.y),new THREE.Vector2(d.x,d.y)]},generateSideWallUV:function(a,b,c,d,e){a=a.vertices;b=a[b];c=a[c];d=a[d];e=a[e];return.01>Math.abs(b.y-c.y)?[new THREE.Vector2(b.x,1-b.z),new THREE.Vector2(c.x,1-c.z),new THREE.Vector2(d.x,1-d.z),new THREE.Vector2(e.x,1-e.z)]:[new THREE.Vector2(b.y,1-b.z),new THREE.Vector2(c.y,1-c.z),new THREE.Vector2(d.y,
1-d.z),new THREE.Vector2(e.y,1-e.z)]}};THREE.ShapeGeometry=function(a,b){THREE.Geometry.call(this);this.type="ShapeGeometry";!1===a instanceof Array&&(a=[a]);this.addShapeList(a,b);this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.constructor=THREE.ShapeGeometry;THREE.ShapeGeometry.prototype.addShapeList=function(a,b){for(var c=0,d=a.length;c<d;c++)this.addShape(a[c],b);return this};
THREE.ShapeGeometry.prototype.addShape=function(a,b){void 0===b&&(b={});var c=b.material,d=void 0===b.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:b.UVGenerator,e,f,g,h=this.vertices.length;e=a.extractPoints(void 0!==b.curveSegments?b.curveSegments:12);var k=e.shape,l=e.holes;if(!THREE.Shape.Utils.isClockWise(k))for(k=k.reverse(),e=0,f=l.length;e<f;e++)g=l[e],THREE.Shape.Utils.isClockWise(g)&&(l[e]=g.reverse());var m=THREE.Shape.Utils.triangulateShape(k,l);e=0;for(f=l.length;e<f;e++)g=l[e],
k=k.concat(g);l=k.length;f=m.length;for(e=0;e<l;e++)g=k[e],this.vertices.push(new THREE.Vector3(g.x,g.y,0));for(e=0;e<f;e++)l=m[e],k=l[0]+h,g=l[1]+h,l=l[2]+h,this.faces.push(new THREE.Face3(k,g,l,null,null,c)),this.faceVertexUvs[0].push(d.generateTopUV(this,k,g,l))};
THREE.LatheGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};b=b||12;c=c||0;d=d||2*Math.PI;for(var e=1/(a.length-1),f=1/b,g=0,h=b;g<=h;g++)for(var k=c+g*f*d,l=Math.cos(k),m=Math.sin(k),k=0,v=a.length;k<v;k++){var q=a[k],y=new THREE.Vector3;y.x=l*q.x-m*q.y;y.y=m*q.x+l*q.y;y.z=q.z;this.vertices.push(y)}c=a.length;g=0;for(h=b;g<h;g++)for(k=0,v=a.length-1;k<v;k++){b=m=k+c*g;d=m+c;var l=m+1+c,m=m+1,q=g*f,y=k*e,x=
q+f,w=y+e;this.faces.push(new THREE.Face3(b,d,m));this.faceVertexUvs[0].push([new THREE.Vector2(q,y),new THREE.Vector2(x,y),new THREE.Vector2(q,w)]);this.faces.push(new THREE.Face3(d,l,m));this.faceVertexUvs[0].push([new THREE.Vector2(x,y),new THREE.Vector2(x,w),new THREE.Vector2(q,w)])}this.mergeVertices();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry;
THREE.PlaneGeometry=function(a,b,c,d){console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint.");THREE.Geometry.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};this.fromBufferGeometry(new THREE.PlaneBufferGeometry(a,b,c,d))};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry;
THREE.PlaneBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this);this.type="PlaneBufferGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};var e=a/2,f=b/2;c=c||1;d=d||1;var g=c+1,h=d+1,k=a/c,l=b/d;b=new Float32Array(g*h*3);a=new Float32Array(g*h*3);for(var m=new Float32Array(g*h*2),v=0,q=0,y=0;y<h;y++)for(var x=y*l-f,w=0;w<g;w++)b[v]=w*k-e,b[v+1]=-x,a[v+2]=1,m[q]=w/c,m[q+1]=1-y/d,v+=3,q+=2;v=0;e=new (65535<b.length/3?Uint32Array:Uint16Array)(c*d*6);for(y=0;y<d;y++)for(w=
0;w<c;w++)f=w+g*(y+1),h=w+1+g*(y+1),k=w+1+g*y,e[v]=w+g*y,e[v+1]=f,e[v+2]=k,e[v+3]=f,e[v+4]=h,e[v+5]=k,v+=6;this.addAttribute("index",new THREE.BufferAttribute(e,1));this.addAttribute("position",new THREE.BufferAttribute(b,3));this.addAttribute("normal",new THREE.BufferAttribute(a,3));this.addAttribute("uv",new THREE.BufferAttribute(m,2))};THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry;
THREE.RingGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};a=a||0;b=b||50;e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(1,d):8;var g,h=[],k=a,l=(b-a)/d;for(a=0;a<d+1;a++){for(g=0;g<c+1;g++){var m=new THREE.Vector3,v=e+g/c*f;m.x=k*Math.cos(v);m.y=k*Math.sin(v);this.vertices.push(m);h.push(new THREE.Vector2((m.x/b+1)/2,
(m.y/b+1)/2))}k+=l}b=new THREE.Vector3(0,0,1);for(a=0;a<d;a++)for(e=a*(c+1),g=0;g<c;g++)f=v=g+e,l=v+c+1,m=v+c+2,this.faces.push(new THREE.Face3(f,l,m,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([h[f].clone(),h[l].clone(),h[m].clone()]),f=v,l=v+c+2,m=v+1,this.faces.push(new THREE.Face3(f,l,m,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([h[f].clone(),h[l].clone(),h[m].clone()]);this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,k)};
THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.RingGeometry.prototype.constructor=THREE.RingGeometry;
THREE.SphereGeometry=function(a,b,c,d,e,f,g){THREE.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};a=a||50;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;e=void 0!==e?e:2*Math.PI;f=void 0!==f?f:0;g=void 0!==g?g:Math.PI;var h,k,l=[],m=[];for(k=0;k<=c;k++){var v=[],q=[];for(h=0;h<=b;h++){var y=h/b,x=k/c,w=new THREE.Vector3;w.x=-a*Math.cos(d+y*e)*Math.sin(f+x*g);
w.y=a*Math.cos(f+x*g);w.z=a*Math.sin(d+y*e)*Math.sin(f+x*g);this.vertices.push(w);v.push(this.vertices.length-1);q.push(new THREE.Vector2(y,1-x))}l.push(v);m.push(q)}for(k=0;k<c;k++)for(h=0;h<b;h++){d=l[k][h+1];e=l[k][h];f=l[k+1][h];g=l[k+1][h+1];var v=this.vertices[d].clone().normalize(),q=this.vertices[e].clone().normalize(),y=this.vertices[f].clone().normalize(),x=this.vertices[g].clone().normalize(),w=m[k][h+1].clone(),z=m[k][h].clone(),u=m[k+1][h].clone(),B=m[k+1][h+1].clone();Math.abs(this.vertices[d].y)===
a?(w.x=(w.x+z.x)/2,this.faces.push(new THREE.Face3(d,f,g,[v,y,x])),this.faceVertexUvs[0].push([w,u,B])):Math.abs(this.vertices[f].y)===a?(u.x=(u.x+B.x)/2,this.faces.push(new THREE.Face3(d,e,f,[v,q,y])),this.faceVertexUvs[0].push([w,z,u])):(this.faces.push(new THREE.Face3(d,e,g,[v,q,x])),this.faceVertexUvs[0].push([w,z,B]),this.faces.push(new THREE.Face3(e,f,g,[q.clone(),y,x.clone()])),this.faceVertexUvs[0].push([z.clone(),u,B.clone()]))}this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,
a)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry;THREE.TextGeometry=function(a,b){b=b||{};var c=THREE.FontUtils.generateShapes(a,b);b.amount=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,c,b);this.type="TextGeometry"};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);
THREE.TextGeometry.prototype.constructor=THREE.TextGeometry;
THREE.TorusGeometry=function(a,b,c,d,e){THREE.Geometry.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};a=a||100;b=b||40;c=c||8;d=d||6;e=e||2*Math.PI;for(var f=new THREE.Vector3,g=[],h=[],k=0;k<=c;k++)for(var l=0;l<=d;l++){var m=l/d*e,v=k/c*Math.PI*2;f.x=a*Math.cos(m);f.y=a*Math.sin(m);var q=new THREE.Vector3;q.x=(a+b*Math.cos(v))*Math.cos(m);q.y=(a+b*Math.cos(v))*Math.sin(m);q.z=b*Math.sin(v);this.vertices.push(q);g.push(new THREE.Vector2(l/
d,k/c));h.push(q.clone().sub(f).normalize())}for(k=1;k<=c;k++)for(l=1;l<=d;l++)a=(d+1)*k+l-1,b=(d+1)*(k-1)+l-1,e=(d+1)*(k-1)+l,f=(d+1)*k+l,m=new THREE.Face3(a,b,f,[h[a].clone(),h[b].clone(),h[f].clone()]),this.faces.push(m),this.faceVertexUvs[0].push([g[a].clone(),g[b].clone(),g[f].clone()]),m=new THREE.Face3(b,e,f,[h[b].clone(),h[e].clone(),h[f].clone()]),this.faces.push(m),this.faceVertexUvs[0].push([g[b].clone(),g[e].clone(),g[f].clone()]);this.computeFaceNormals()};
THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry;
THREE.TorusKnotGeometry=function(a,b,c,d,e,f,g){function h(a,b,c,d,e){var f=Math.cos(a),g=Math.sin(a);a*=b/c;b=Math.cos(a);f*=d*(2+b)*.5;g=d*(2+b)*g*.5;d=e*d*Math.sin(a)*.5;return new THREE.Vector3(f,g,d)}THREE.Geometry.call(this);this.type="TorusKnotGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,p:e,q:f,heightScale:g};a=a||100;b=b||40;c=c||64;d=d||8;e=e||2;f=f||3;g=g||1;for(var k=Array(c),l=new THREE.Vector3,m=new THREE.Vector3,v=new THREE.Vector3,q=0;q<c;++q){k[q]=
Array(d);var y=q/c*2*e*Math.PI,x=h(y,f,e,a,g),y=h(y+.01,f,e,a,g);l.subVectors(y,x);m.addVectors(y,x);v.crossVectors(l,m);m.crossVectors(v,l);v.normalize();m.normalize();for(y=0;y<d;++y){var w=y/d*2*Math.PI,z=-b*Math.cos(w),w=b*Math.sin(w),u=new THREE.Vector3;u.x=x.x+z*m.x+w*v.x;u.y=x.y+z*m.y+w*v.y;u.z=x.z+z*m.z+w*v.z;k[q][y]=this.vertices.push(u)-1}}for(q=0;q<c;++q)for(y=0;y<d;++y)e=(q+1)%c,f=(y+1)%d,a=k[q][y],b=k[e][y],e=k[e][f],f=k[q][f],g=new THREE.Vector2(q/c,y/d),l=new THREE.Vector2((q+1)/c,
y/d),m=new THREE.Vector2((q+1)/c,(y+1)/d),v=new THREE.Vector2(q/c,(y+1)/d),this.faces.push(new THREE.Face3(a,b,f)),this.faceVertexUvs[0].push([g,l,v]),this.faces.push(new THREE.Face3(b,e,f)),this.faceVertexUvs[0].push([l.clone(),m,v.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry;
THREE.TubeGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this);this.type="TubeGeometry";this.parameters={path:a,segments:b,radius:c,radialSegments:d,closed:e};b=b||64;c=c||1;d=d||8;e=e||!1;f=f||THREE.TubeGeometry.NoTaper;var g=[],h,k,l=b+1,m,v,q,y,x,w=new THREE.Vector3,z,u,B;z=new THREE.TubeGeometry.FrenetFrames(a,b,e);u=z.normals;B=z.binormals;this.tangents=z.tangents;this.normals=u;this.binormals=B;for(z=0;z<l;z++)for(g[z]=[],m=z/(l-1),x=a.getPointAt(m),h=u[z],k=B[z],q=c*f(m),m=0;m<d;m++)v=
m/d*2*Math.PI,y=-q*Math.cos(v),v=q*Math.sin(v),w.copy(x),w.x+=y*h.x+v*k.x,w.y+=y*h.y+v*k.y,w.z+=y*h.z+v*k.z,g[z][m]=this.vertices.push(new THREE.Vector3(w.x,w.y,w.z))-1;for(z=0;z<b;z++)for(m=0;m<d;m++)f=e?(z+1)%b:z+1,l=(m+1)%d,a=g[z][m],c=g[f][m],f=g[f][l],l=g[z][l],w=new THREE.Vector2(z/b,m/d),u=new THREE.Vector2((z+1)/b,m/d),B=new THREE.Vector2((z+1)/b,(m+1)/d),h=new THREE.Vector2(z/b,(m+1)/d),this.faces.push(new THREE.Face3(a,c,l)),this.faceVertexUvs[0].push([w,u,h]),this.faces.push(new THREE.Face3(c,
f,l)),this.faceVertexUvs[0].push([u.clone(),B,h.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry.prototype.constructor=THREE.TubeGeometry;THREE.TubeGeometry.NoTaper=function(a){return 1};THREE.TubeGeometry.SinusoidalTaper=function(a){return Math.sin(Math.PI*a)};
THREE.TubeGeometry.FrenetFrames=function(a,b,c){var d=new THREE.Vector3,e=[],f=[],g=[],h=new THREE.Vector3,k=new THREE.Matrix4;b+=1;var l,m,v;this.tangents=e;this.normals=f;this.binormals=g;for(l=0;l<b;l++)m=l/(b-1),e[l]=a.getTangentAt(m),e[l].normalize();f[0]=new THREE.Vector3;g[0]=new THREE.Vector3;a=Number.MAX_VALUE;l=Math.abs(e[0].x);m=Math.abs(e[0].y);v=Math.abs(e[0].z);l<=a&&(a=l,d.set(1,0,0));m<=a&&(a=m,d.set(0,1,0));v<=a&&d.set(0,0,1);h.crossVectors(e[0],d).normalize();f[0].crossVectors(e[0],
h);g[0].crossVectors(e[0],f[0]);for(l=1;l<b;l++)f[l]=f[l-1].clone(),g[l]=g[l-1].clone(),h.crossVectors(e[l-1],e[l]),1E-4<h.length()&&(h.normalize(),d=Math.acos(THREE.Math.clamp(e[l-1].dot(e[l]),-1,1)),f[l].applyMatrix4(k.makeRotationAxis(h,d))),g[l].crossVectors(e[l],f[l]);if(c)for(d=Math.acos(THREE.Math.clamp(f[0].dot(f[b-1]),-1,1)),d/=b-1,0<e[0].dot(h.crossVectors(f[0],f[b-1]))&&(d=-d),l=1;l<b;l++)f[l].applyMatrix4(k.makeRotationAxis(e[l],d*l)),g[l].crossVectors(e[l],f[l])};
THREE.PolyhedronGeometry=function(a,b,c,d){function e(a){var b=a.normalize().clone();b.index=k.vertices.push(b)-1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+.5;a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5;b.uv=new THREE.Vector2(c,1-a);return b}function f(a,b,c){var d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]);k.faces.push(d);z.copy(a).add(b).add(c).divideScalar(3);d=Math.atan2(z.z,-z.x);k.faceVertexUvs[0].push([h(a.uv,a,d),h(b.uv,b,d),h(c.uv,c,d)])}function g(a,
b){for(var c=Math.pow(2,b),d=e(k.vertices[a.a]),g=e(k.vertices[a.b]),h=e(k.vertices[a.c]),l=[],m=0;m<=c;m++){l[m]=[];for(var q=e(d.clone().lerp(h,m/c)),v=e(g.clone().lerp(h,m/c)),w=c-m,x=0;x<=w;x++)l[m][x]=0==x&&m==c?q:e(q.clone().lerp(v,x/w))}for(m=0;m<c;m++)for(x=0;x<2*(c-m)-1;x++)d=Math.floor(x/2),0==x%2?f(l[m][d+1],l[m+1][d],l[m][d]):f(l[m][d+1],l[m+1][d+1],l[m+1][d])}function h(a,b,c){0>c&&1===a.x&&(a=new THREE.Vector2(a.x-1,a.y));0===b.x&&0===b.z&&(a=new THREE.Vector2(c/2/Math.PI+.5,a.y));return a.clone()}
THREE.Geometry.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};c=c||1;d=d||0;for(var k=this,l=0,m=a.length;l<m;l+=3)e(new THREE.Vector3(a[l],a[l+1],a[l+2]));a=this.vertices;for(var v=[],q=l=0,m=b.length;l<m;l+=3,q++){var y=a[b[l]],x=a[b[l+1]],w=a[b[l+2]];v[q]=new THREE.Face3(y.index,x.index,w.index,[y.clone(),x.clone(),w.clone()])}for(var z=new THREE.Vector3,l=0,m=v.length;l<m;l++)g(v[l],d);l=0;for(m=this.faceVertexUvs[0].length;l<m;l++)b=this.faceVertexUvs[0][l],
d=b[0].x,a=b[1].x,v=b[2].x,q=Math.max(d,Math.max(a,v)),y=Math.min(d,Math.min(a,v)),.9<q&&.1>y&&(.2>d&&(b[0].x+=1),.2>a&&(b[1].x+=1),.2>v&&(b[2].x+=1));l=0;for(m=this.vertices.length;l<m;l++)this.vertices[l].multiplyScalar(c);this.mergeVertices();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry;
THREE.DodecahedronGeometry=function(a,b){this.parameters={radius:a,detail:b};var c=(1+Math.sqrt(5))/2,d=1/c;THREE.PolyhedronGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,
11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b)};THREE.DodecahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.DodecahedronGeometry.prototype.constructor=THREE.DodecahedronGeometry;
THREE.IcosahedronGeometry=function(a,b){var c=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b}};THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry;THREE.OctahedronGeometry=function(a,b){this.parameters={radius:a,detail:b};THREE.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b}};THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry;
THREE.TetrahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:b}};THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TetrahedronGeometry.prototype.constructor=THREE.TetrahedronGeometry;
THREE.ParametricGeometry=function(a,b,c){THREE.Geometry.call(this);this.type="ParametricGeometry";this.parameters={func:a,slices:b,stacks:c};var d=this.vertices,e=this.faces,f=this.faceVertexUvs[0],g,h,k,l,m=b+1;for(g=0;g<=c;g++)for(l=g/c,h=0;h<=b;h++)k=h/b,k=a(k,l),d.push(k);var v,q,y,x;for(g=0;g<c;g++)for(h=0;h<b;h++)a=g*m+h,d=g*m+h+1,l=(g+1)*m+h+1,k=(g+1)*m+h,v=new THREE.Vector2(h/b,g/c),q=new THREE.Vector2((h+1)/b,g/c),y=new THREE.Vector2((h+1)/b,(g+1)/c),x=new THREE.Vector2(h/b,(g+1)/c),e.push(new THREE.Face3(a,
d,k)),f.push([v,q,x]),e.push(new THREE.Face3(d,l,k)),f.push([q.clone(),y,x.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ParametricGeometry.prototype.constructor=THREE.ParametricGeometry;
THREE.AxisHelper=function(a){a=a||1;var b=new Float32Array([0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a]),c=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);a=new THREE.BufferGeometry;a.addAttribute("position",new THREE.BufferAttribute(b,3));a.addAttribute("color",new THREE.BufferAttribute(c,3));b=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,a,b,THREE.LinePieces)};THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);
THREE.AxisHelper.prototype.constructor=THREE.AxisHelper;
THREE.ArrowHelper=function(){var a=new THREE.Geometry;a.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var b=new THREE.CylinderGeometry(0,.5,1,5,1);b.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0));return function(c,d,e,f,g,h){THREE.Object3D.call(this);void 0===f&&(f=16776960);void 0===e&&(e=1);void 0===g&&(g=.2*e);void 0===h&&(h=.2*g);this.position.copy(d);this.line=new THREE.Line(a,new THREE.LineBasicMaterial({color:f}));this.line.matrixAutoUpdate=!1;this.add(this.line);
this.cone=new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:f}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(c);this.setLength(e,g,h)}}();THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.constructor=THREE.ArrowHelper;
THREE.ArrowHelper.prototype.setDirection=function(){var a=new THREE.Vector3,b;return function(c){.99999<c.y?this.quaternion.set(0,0,0,1):-.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();THREE.ArrowHelper.prototype.setLength=function(a,b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);this.line.scale.set(1,a-b,1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};
THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.set(a);this.cone.material.color.set(a)};THREE.BoxHelper=function(a){var b=new THREE.BufferGeometry;b.addAttribute("position",new THREE.BufferAttribute(new Float32Array(72),3));THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces);void 0!==a&&this.update(a)};THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);THREE.BoxHelper.prototype.constructor=THREE.BoxHelper;
THREE.BoxHelper.prototype.update=function(a){var b=a.geometry;null===b.boundingBox&&b.computeBoundingBox();var c=b.boundingBox.min,b=b.boundingBox.max,d=this.geometry.attributes.position.array;d[0]=b.x;d[1]=b.y;d[2]=b.z;d[3]=c.x;d[4]=b.y;d[5]=b.z;d[6]=c.x;d[7]=b.y;d[8]=b.z;d[9]=c.x;d[10]=c.y;d[11]=b.z;d[12]=c.x;d[13]=c.y;d[14]=b.z;d[15]=b.x;d[16]=c.y;d[17]=b.z;d[18]=b.x;d[19]=c.y;d[20]=b.z;d[21]=b.x;d[22]=b.y;d[23]=b.z;d[24]=b.x;d[25]=b.y;d[26]=c.z;d[27]=c.x;d[28]=b.y;d[29]=c.z;d[30]=c.x;d[31]=b.y;
d[32]=c.z;d[33]=c.x;d[34]=c.y;d[35]=c.z;d[36]=c.x;d[37]=c.y;d[38]=c.z;d[39]=b.x;d[40]=c.y;d[41]=c.z;d[42]=b.x;d[43]=c.y;d[44]=c.z;d[45]=b.x;d[46]=b.y;d[47]=c.z;d[48]=b.x;d[49]=b.y;d[50]=b.z;d[51]=b.x;d[52]=b.y;d[53]=c.z;d[54]=c.x;d[55]=b.y;d[56]=b.z;d[57]=c.x;d[58]=b.y;d[59]=c.z;d[60]=c.x;d[61]=c.y;d[62]=b.z;d[63]=c.x;d[64]=c.y;d[65]=c.z;d[66]=b.x;d[67]=c.y;d[68]=b.z;d[69]=b.x;d[70]=c.y;d[71]=c.z;this.geometry.attributes.position.needsUpdate=!0;this.geometry.computeBoundingSphere();this.matrix=a.matrixWorld;
this.matrixAutoUpdate=!1};THREE.BoundingBoxHelper=function(a,b){var c=void 0!==b?b:8947848;this.object=a;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:c,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.constructor=THREE.BoundingBoxHelper;THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};
THREE.CameraHelper=function(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){d.vertices.push(new THREE.Vector3);d.colors.push(new THREE.Color(b));void 0===f[a]&&(f[a]=[]);f[a].push(d.vertices.length-1)}var d=new THREE.Geometry,e=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),f={};b("n1","n2",16755200);b("n2","n4",16755200);b("n4","n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);b("n1","f1",16755200);
b("n2","f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1","cf2",3355443);b("cf3","cf4",3355443);THREE.Line.call(this,d,e,THREE.LinePieces);this.camera=a;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=f;this.update()};
THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);THREE.CameraHelper.prototype.constructor=THREE.CameraHelper;
THREE.CameraHelper.prototype.update=function(){var a,b,c=new THREE.Vector3,d=new THREE.Camera,e=function(e,g,h,k){c.set(g,h,k).unproject(d);e=b[e];if(void 0!==e)for(g=0,h=e.length;g<h;g++)a.vertices[e[g]].copy(c)};return function(){a=this.geometry;b=this.pointMap;d.projectionMatrix.copy(this.camera.projectionMatrix);e("c",0,0,-1);e("t",0,0,1);e("n1",-1,-1,-1);e("n2",1,-1,-1);e("n3",-1,1,-1);e("n4",1,1,-1);e("f1",-1,-1,1);e("f2",1,-1,1);e("f3",-1,1,1);e("f4",1,1,1);e("u1",.7,1.1,-1);e("u2",-.7,1.1,
-1);e("u3",0,2,-1);e("cf1",-1,0,1);e("cf2",1,0,1);e("cf3",0,-1,1);e("cf4",0,1,1);e("cn1",-1,0,-1);e("cn2",1,0,-1);e("cn3",0,-1,-1);e("cn4",0,1,-1);a.verticesNeedUpdate=!0}}();
THREE.DirectionalLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;b=b||1;var c=new THREE.Geometry;c.vertices.push(new THREE.Vector3(-b,b,0),new THREE.Vector3(b,b,0),new THREE.Vector3(b,-b,0),new THREE.Vector3(-b,-b,0),new THREE.Vector3(-b,b,0));var d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Line(c,d);this.add(this.lightPlane);
c=new THREE.Geometry;c.vertices.push(new THREE.Vector3,new THREE.Vector3);d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(c,d);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.constructor=THREE.DirectionalLightHelper;
THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};
THREE.DirectionalLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,a);this.lightPlane.lookAt(c);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(c);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();
THREE.EdgesHelper=function(a,b,c){b=void 0!==b?b:16777215;c=Math.cos(THREE.Math.degToRad(void 0!==c?c:1));var d=[0,0],e={},f=function(a,b){return a-b},g=["a","b","c"],h=new THREE.BufferGeometry,k;a.geometry instanceof THREE.BufferGeometry?(k=new THREE.Geometry,k.fromBufferGeometry(a.geometry)):k=a.geometry.clone();k.mergeVertices();k.computeFaceNormals();var l=k.vertices;k=k.faces;for(var m=0,v=0,q=k.length;v<q;v++)for(var y=k[v],x=0;3>x;x++){d[0]=y[g[x]];d[1]=y[g[(x+1)%3]];d.sort(f);var w=d.toString();
void 0===e[w]?(e[w]={vert1:d[0],vert2:d[1],face1:v,face2:void 0},m++):e[w].face2=v}d=new Float32Array(6*m);f=0;for(w in e)if(g=e[w],void 0===g.face2||k[g.face1].normal.dot(k[g.face2].normal)<=c)m=l[g.vert1],d[f++]=m.x,d[f++]=m.y,d[f++]=m.z,m=l[g.vert2],d[f++]=m.x,d[f++]=m.y,d[f++]=m.z;h.addAttribute("position",new THREE.BufferAttribute(d,3));THREE.Line.call(this,h,new THREE.LineBasicMaterial({color:b}),THREE.LinePieces);this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1};
THREE.EdgesHelper.prototype=Object.create(THREE.Line.prototype);THREE.EdgesHelper.prototype.constructor=THREE.EdgesHelper;
THREE.FaceNormalsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;b=new THREE.Geometry;c=0;for(var e=this.object.geometry.faces.length;c<e;c++)b.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:a,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper.prototype.constructor=THREE.FaceNormalsHelper;
THREE.FaceNormalsHelper.prototype.update=function(){var a=this.geometry.vertices,b=this.object,c=b.geometry.vertices,d=b.geometry.faces,e=b.matrixWorld;b.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(e);for(var f=b=0,g=d.length;b<g;b++,f+=2){var h=d[b];a[f].copy(c[h.a]).add(c[h.b]).add(c[h.c]).divideScalar(3).applyMatrix4(e);a[f+1].copy(h.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(a[f])}this.geometry.verticesNeedUpdate=!0;return this};
THREE.GridHelper=function(a,b){var c=new THREE.Geometry,d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var e=-a;e<=a;e+=b){c.vertices.push(new THREE.Vector3(-a,0,e),new THREE.Vector3(a,0,e),new THREE.Vector3(e,0,-a),new THREE.Vector3(e,0,a));var f=0===e?this.color1:this.color2;c.colors.push(f,f,f,f)}THREE.Line.call(this,c,d,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);
THREE.GridHelper.prototype.constructor=THREE.GridHelper;THREE.GridHelper.prototype.setColors=function(a,b){this.color1.set(a);this.color2.set(b);this.geometry.colorsNeedUpdate=!0};
THREE.HemisphereLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];var c=new THREE.SphereGeometry(b,4,2);c.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var d=0;8>d;d++)c.faces[d].color=this.colors[4>d?0:1];d=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(c,d);this.add(this.lightSphere);
this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.constructor=THREE.HemisphereLightHelper;THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};
THREE.HemisphereLightHelper.prototype.update=function(){var a=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();
THREE.PointLightHelper=function(a,b){this.light=a;this.light.updateMatrixWorld();var c=new THREE.SphereGeometry(b,4,2),d=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,c,d);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.constructor=THREE.PointLightHelper;
THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.SkeletonHelper=function(a){this.bones=this.getBoneList(a);for(var b=new THREE.Geometry,c=0;c<this.bones.length;c++)this.bones[c].parent instanceof THREE.Bone&&(b.vertices.push(new THREE.Vector3),b.vertices.push(new THREE.Vector3),b.colors.push(new THREE.Color(0,0,1)),b.colors.push(new THREE.Color(0,1,0)));c=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});THREE.Line.call(this,b,c,THREE.LinePieces);this.root=a;this.matrix=a.matrixWorld;
this.matrixAutoUpdate=!1;this.update()};THREE.SkeletonHelper.prototype=Object.create(THREE.Line.prototype);THREE.SkeletonHelper.prototype.constructor=THREE.SkeletonHelper;THREE.SkeletonHelper.prototype.getBoneList=function(a){var b=[];a instanceof THREE.Bone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,this.getBoneList(a.children[c]));return b};
THREE.SkeletonHelper.prototype.update=function(){for(var a=this.geometry,b=(new THREE.Matrix4).getInverse(this.root.matrixWorld),c=new THREE.Matrix4,d=0,e=0;e<this.bones.length;e++){var f=this.bones[e];f.parent instanceof THREE.Bone&&(c.multiplyMatrices(b,f.matrixWorld),a.vertices[d].setFromMatrixPosition(c),c.multiplyMatrices(b,f.parent.matrixWorld),a.vertices[d+1].setFromMatrixPosition(c),d+=2)}a.verticesNeedUpdate=!0;a.computeBoundingSphere()};
THREE.SpotLightHelper=function(a){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;a=new THREE.CylinderGeometry(0,1,1,8,1,!0);a.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0));a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var b=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(a,b);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.SpotLightHelper.prototype.constructor=THREE.SpotLightHelper;THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};
THREE.SpotLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){var c=this.light.distance?this.light.distance:1E4,d=c*Math.tan(this.light.angle);this.cone.scale.set(d,d,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(b.sub(a));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();
THREE.VertexNormalsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:16711680;d=void 0!==d?d:1;c=new THREE.Geometry;a=a.geometry.faces;for(var e=0,f=a.length;e<f;e++)for(var g=0,h=a[e].vertexNormals.length;g<h;g++)c.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:b,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexNormalsHelper.prototype.constructor=THREE.VertexNormalsHelper;
THREE.VertexNormalsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var d=this.geometry.vertices,e=this.object.geometry.vertices,f=this.object.geometry.faces,g=this.object.matrixWorld,h=0,k=0,l=f.length;k<l;k++)for(var m=f[k],v=0,q=m.vertexNormals.length;v<q;v++){var y=m.vertexNormals[v];d[h].copy(e[m[a[v]]]).applyMatrix4(g);b.copy(y).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);
b.add(d[h]);h+=1;d[h].copy(b);h+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.VertexTangentsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:255;d=void 0!==d?d:1;c=new THREE.Geometry;a=a.geometry.faces;for(var e=0,f=a.length;e<f;e++)for(var g=0,h=a[e].vertexTangents.length;g<h;g++)c.vertices.push(new THREE.Vector3),c.vertices.push(new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:b,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.update()};THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexTangentsHelper.prototype.constructor=THREE.VertexTangentsHelper;
THREE.VertexTangentsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var d=this.geometry.vertices,e=this.object.geometry.vertices,f=this.object.geometry.faces,g=this.object.matrixWorld,h=0,k=0,l=f.length;k<l;k++)for(var m=f[k],v=0,q=m.vertexTangents.length;v<q;v++){var y=m.vertexTangents[v];d[h].copy(e[m[a[v]]]).applyMatrix4(g);b.copy(y).transformDirection(g).multiplyScalar(this.size);b.add(d[h]);h+=1;d[h].copy(b);
h+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.WireframeHelper=function(a,b){var c=void 0!==b?b:16777215,d=[0,0],e={},f=function(a,b){return a-b},g=["a","b","c"],h=new THREE.BufferGeometry;if(a.geometry instanceof THREE.Geometry){for(var k=a.geometry.vertices,l=a.geometry.faces,m=0,v=new Uint32Array(6*l.length),q=0,y=l.length;q<y;q++)for(var x=l[q],w=0;3>w;w++){d[0]=x[g[w]];d[1]=x[g[(w+1)%3]];d.sort(f);var z=d.toString();void 0===e[z]&&(v[2*m]=d[0],v[2*m+1]=d[1],e[z]=!0,m++)}d=new Float32Array(6*m);q=0;for(y=m;q<y;q++)for(w=0;2>w;w++)m=
k[v[2*q+w]],g=6*q+3*w,d[g+0]=m.x,d[g+1]=m.y,d[g+2]=m.z;h.addAttribute("position",new THREE.BufferAttribute(d,3))}else if(a.geometry instanceof THREE.BufferGeometry){if(void 0!==a.geometry.attributes.index){k=a.geometry.attributes.position.array;y=a.geometry.attributes.index.array;l=a.geometry.drawcalls;m=0;0===l.length&&(l=[{count:y.length,index:0,start:0}]);for(var v=new Uint32Array(2*y.length),x=0,u=l.length;x<u;++x)for(var w=l[x].start,z=l[x].count,g=l[x].index,q=w,B=w+z;q<B;q+=3)for(w=0;3>w;w++)d[0]=
g+y[q+w],d[1]=g+y[q+(w+1)%3],d.sort(f),z=d.toString(),void 0===e[z]&&(v[2*m]=d[0],v[2*m+1]=d[1],e[z]=!0,m++);d=new Float32Array(6*m);q=0;for(y=m;q<y;q++)for(w=0;2>w;w++)g=6*q+3*w,m=3*v[2*q+w],d[g+0]=k[m],d[g+1]=k[m+1],d[g+2]=k[m+2]}else for(k=a.geometry.attributes.position.array,m=k.length/3,v=m/3,d=new Float32Array(6*m),q=0,y=v;q<y;q++)for(w=0;3>w;w++)g=18*q+6*w,v=9*q+3*w,d[g+0]=k[v],d[g+1]=k[v+1],d[g+2]=k[v+2],m=9*q+(w+1)%3*3,d[g+3]=k[m],d[g+4]=k[m+1],d[g+5]=k[m+2];h.addAttribute("position",new THREE.BufferAttribute(d,
3))}THREE.Line.call(this,h,new THREE.LineBasicMaterial({color:c}),THREE.LinePieces);this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1};THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype);THREE.WireframeHelper.prototype.constructor=THREE.WireframeHelper;THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(a){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.ImmediateRenderObject.prototype.constructor=THREE.ImmediateRenderObject;
THREE.MorphBlendMesh=function(a,b){THREE.Mesh.call(this,a,b);this.animationsMap={};this.animationsList=[];var c=this.geometry.morphTargets.length;this.createAnimation("__default",0,c-1,c/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphBlendMesh.prototype.constructor=THREE.MorphBlendMesh;
THREE.MorphBlendMesh.prototype.createAnimation=function(a,b,c,d){b={startFrame:b,endFrame:c,length:c-b+1,fps:d,duration:(c-b)/d,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[a]=b;this.animationsList.push(b)};
THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(a){for(var b=/([a-z]+)_?(\d+)/,c,d={},e=this.geometry,f=0,g=e.morphTargets.length;f<g;f++){var h=e.morphTargets[f].name.match(b);if(h&&1<h.length){var k=h[1];d[k]||(d[k]={start:Infinity,end:-Infinity});h=d[k];f<h.start&&(h.start=f);f>h.end&&(h.end=f);c||(c=k)}}for(k in d)h=d[k],this.createAnimation(k,h.start,h.end,a);this.firstAnimation=c};
THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(a){if(a=this.animationsMap[a])a.direction=1,a.directionBackwards=!1};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(a){if(a=this.animationsMap[a])a.direction=-1,a.directionBackwards=!0};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(a,b){var c=this.animationsMap[a];c&&(c.fps=b,c.duration=(c.end-c.start)/c.fps)};
THREE.MorphBlendMesh.prototype.setAnimationDuration=function(a,b){var c=this.animationsMap[a];c&&(c.duration=b,c.fps=(c.end-c.start)/c.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(a,b){var c=this.animationsMap[a];c&&(c.weight=b)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(a,b){var c=this.animationsMap[a];c&&(c.time=b)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(a){var b=0;if(a=this.animationsMap[a])b=a.time;return b};
THREE.MorphBlendMesh.prototype.getAnimationDuration=function(a){var b=-1;if(a=this.animationsMap[a])b=a.duration;return b};THREE.MorphBlendMesh.prototype.playAnimation=function(a){var b=this.animationsMap[a];b?(b.time=0,b.active=!0):THREE.warn("THREE.MorphBlendMesh: animation["+a+"] undefined in .playAnimation()")};THREE.MorphBlendMesh.prototype.stopAnimation=function(a){if(a=this.animationsMap[a])a.active=!1};
THREE.MorphBlendMesh.prototype.update=function(a){for(var b=0,c=this.animationsList.length;b<c;b++){var d=this.animationsList[b];if(d.active){var e=d.duration/d.length;d.time+=d.direction*a;if(d.mirroredLoop){if(d.time>d.duration||0>d.time)d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.directionBackwards=!0),0>d.time&&(d.time=0,d.directionBackwards=!1)}else d.time%=d.duration,0>d.time&&(d.time+=d.duration);var f=d.startFrame+THREE.Math.clamp(Math.floor(d.time/e),0,d.length-1),g=d.weight;
f!==d.currentFrame&&(this.morphTargetInfluences[d.lastFrame]=0,this.morphTargetInfluences[d.currentFrame]=1*g,this.morphTargetInfluences[f]=0,d.lastFrame=d.currentFrame,d.currentFrame=f);e=d.time%e/e;d.directionBackwards&&(e=1-e);this.morphTargetInfluences[d.currentFrame]=e*g;this.morphTargetInfluences[d.lastFrame]=(1-e)*g}}};
var tQuery=function(a,b){if(2===arguments.length&&(arguments[0]instanceof THREE.Geometry||arguments[0]instanceof THREE.BufferGeometry||arguments[0]instanceof tQuery.Geometry)&&(arguments[1]instanceof THREE.Material||arguments[1]instanceof tQuery.Material)){var c=arguments[0]instanceof tQuery.Geometry?arguments[0].get(0):arguments[0],d=arguments[1]instanceof tQuery.Material?arguments[1].get(0):arguments[1],c=new THREE.Mesh(c,d);return tQuery(c)}c=Array.isArray(a)?a[0]:a;if(c instanceof THREE.Mesh&&
tQuery.Mesh)return new tQuery.Mesh(a);if(c instanceof THREE.DirectionalLight&&tQuery.DirectionalLight)return new tQuery.DirectionalLight(a);if(c instanceof THREE.AmbientLight&&tQuery.AmbientLight)return new tQuery.AmbientLight(a);if(c instanceof THREE.Light&&tQuery.Light)return new tQuery.Light(a);if(c instanceof THREE.Object3D&&tQuery.Object3D)return new tQuery.Object3D(a);if(c instanceof THREE.Geometry&&tQuery.Geometry)return new tQuery.Geometry(a);if(c instanceof THREE.Material&&tQuery.Material)return new tQuery.Material(a);
if("string"===typeof c&&tQuery.Object3D)return new tQuery.Object3D(a,b);console.assert(!1,"unsupported type")};tQuery.VERSION="r59.0";tQuery.data=function(a,b,c,d){console.assert(a,"invalid parameters");console.assert("string"===typeof b,"invalid parameters");void 0===d&&void 0!==c&&(d=!0);a._tqData=a._tqData||{};d&&console.assert(void 0===a._tqData[b],"This key already exists "+b);c&&(a._tqData[b]=c);return a._tqData[b]};
tQuery.hasData=function(a,b){return void 0===a._tqData||void 0===a._tqData[b]?!1:!0};tQuery.removeData=function(a,b,c){b instanceof Array?b.forEach(function(b){tQuery.removeData(a,b)}):(console.assert("string"===typeof b),c&&console.assert(void 0!==a._tqData[b],"This key doesnt already exists "+b),delete a._tqData[b])};tQuery.each=function(a,b){for(var c=0;c<a.length;c++)if(!1===b(a[c],c,a))return!1;return!0};
tQuery.now=function(){var a=window.performance||{};return a.now?function(){return a.timing.navigationStart+a.now()}:a.mozNow?function(){return a.timing.navigationStart+a.mozNow()}:a.webkitNow?function(){return a.timing.navigationStart+a.webkitNow()}:a.mskitNow?function(){return a.timing.navigationStart+a.msNow()}:a.okitNow?function(){return a.timing.navigationStart+a.oNow()}:function(){return Date.now}}();tQuery.nowSeconds=function(){return tQuery.now()/1E3};
tQuery.inherit=function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;a.parent=b.prototype;a.prototype.constructor=a};tQuery.extend=function(a,b,c){function d(a,b){Object.keys(b).forEach(function(c){a[c]=b[c]})}function e(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},arguments.callee(a[c],b[c])):a[c]=b[c];return a}c=(void 0!==c?c:1)?e:d;var f={};b&&c(f,b);a&&c(f,a);return f};
tQuery._pluginsOn=function(a,b,c){b=b||a.prototype||a;c=c||"";console.assert(void 0===a["register"+c]);console.assert(void 0===a["unregister"+c]);console.assert(void 0===a["registered"+c]);a["register"+c]=function(a,c){console.assert(void 0===b[a],"Conflict! Already method called: "+a);b[a]=c};a["unregister"+c]=function(a){if(!1===b.hasOwnProperty(a))throw Error("Plugin not found: "+a);delete b[a]};a["registered"+c]=function(a){return!0===b.hasOwnProperty(a)}};
tQuery.pluginsInstanceOn=function(a){tQuery._pluginsOn(a,void 0,"Instance")};tQuery.pluginsStaticOn=function(a){tQuery._pluginsOn(a,a,"Static")};tQuery.pluginsStaticOn(tQuery);
tQuery.mixinAttributes=function(a,b){a.prototype._attrProps=tQuery.extend(a.prototype._attrProps,b);a.prototype.attr=function(a,b){a instanceof Object&&void 0===b?Object.keys(a).forEach(function(b){this.attr(b,a[b])}.bind(this)):"string"===typeof a?console.assert(-1!==Object.keys(this._attrProps).indexOf(a),"invalid property name:"+a):console.assert(!1,"invalid parameter");if(void 0!==b){var e=this._attrProps[a],f=e.apply(e,b);this.each(function(b){b[a]=f});return this}return 0===this.length?void 0:
this.get(0)[a]};Object.keys(b).forEach(function(b){a.prototype[b]=function(){return this.attr(b,arguments)}}.bind(this))};
tQuery.Flow=function(){var a,b=[],c=setTimeout(function(){c=null;a._next()},0);return a={destroy:function(){c&&clearTimeout(c)},par:function(c,e){!e&&b[b.length-1]instanceof Array||b.push([]);b[b.length-1].push(c);return a},seq:function(b){return a.par(b,!0)},_next:function(c,e){var f=[],g=[],h=b.shift()||[],k=h.length,l=1==k;h&&h.forEach(function(b,h){b(function(b,c){f[h]=b;g[h]=c;0==--k&&a._next(l?f[0]:f,l?g[0]:g)},c,e)})}}};
tQuery.MicroeventMixin=function(a){a.bind=function(a,c){void 0===this._events&&(this._events={});this._events[a]=this._events[a]||[];this._events[a].push(c);return c};a.unbind=function(a,c){void 0===this._events&&(this._events={});!1!==a in this._events&&this._events[a].splice(this._events[a].indexOf(c),1)};a.trigger=function(a){void 0===this._events&&(this._events={});if(void 0!==this._events[a])for(var c=this._events[a].slice(),d=0;d<c.length;d++){var e=c[d].apply(this,Array.prototype.slice.call(arguments,
1));if(void 0!==e)return e}};a.addEventListener=function(a,c){this.bind(a,c);return this};a.removeEventListener=function(a,c){this.unbind(a,c);return this};a.dispatchEvent=function(a){return this.trigger.apply(this,arguments)};return a};
tQuery.MicroCache=function(){var a={};return{get:function(b){return a[b]},contains:function(b){return b in a},remove:function(b){delete a[b]},set:function(b,c){a[b]=c},values:function(){return a},getSet:function(a,c){this.contains(a)||this.set(a,"function"==typeof c?c():c);return this.get(a)}}};
tQuery.mixinCreatorPattern=function(a,b){var c="klass.create = (function() {\n\tfunction F(args) {\n\t\treturn klass.apply(this, args);\n\t}\n\tF.prototype = klass.prototype;\n\treturn function(){\n\t\treturn new F(arguments);\n\t}\n})()",c=(b=b||a.name)?c.replace(/F/g,b):c;eval(c)};tQuery.convert={};
tQuery.convert.toThreeColor=function(){var a=tQuery.convert.toThreeColor.dispatchEvent("preConvert",arguments);if(void 0!==a)return a;if(1===arguments.length&&"number"===typeof arguments[0]||1===arguments.length&&"string"===typeof arguments[0])return new THREE.Color(arguments[0]);if(1===arguments.length&&arguments[0]instanceof THREE.Color)return arguments[0];if(3===arguments.length&&"number"===typeof arguments[0]&&"number"===typeof arguments[1]&&"number"===typeof arguments[2])return(new THREE.Color).setRGB(arguments[0],
arguments[1],arguments[2]);console.assert(!1,"invalid parameter")};tQuery.MicroeventMixin(tQuery.convert.toThreeColor);tQuery.convert.toThreeMaterial=function(){var a=tQuery.convert.toThreeMaterial.dispatchEvent("preConvert",arguments);if(void 0!==a)return a;if(1===arguments.length&&arguments[0]instanceof THREE.Material)return arguments[0];if(1===arguments.length&&arguments[0]instanceof tQuery.Material)return arguments[0].get(0);console.assert(!1,"invalid parameter")};tQuery.MicroeventMixin(tQuery.convert.toThreeMaterial);
tQuery.convert.toVector3=function(){if(0===arguments.length)return new THREE.Vector3;if(arguments[0]instanceof THREE.Vector3&&1===arguments.length)return arguments[0];if("number"===typeof arguments[0]&&3===arguments.length)return new THREE.Vector3(arguments[0],arguments[1],arguments[2]);if(arguments[0]instanceof Array&&1===arguments.length)return new THREE.Vector3(arguments[0][0],arguments[0][1],arguments[0][2]);console.assert(!1,"invalid parameter for Vector3")};
tQuery.convert.toVector2=function(){if(arguments[0]instanceof THREE.Vector2&&1===arguments.length)return arguments[0];if("number"===typeof arguments[0]&&2===arguments.length)return new THREE.Vector2(arguments[0],arguments[1]);console.assert(!1,"invalid parameter for Vector2")};tQuery.convert.toNumber=function(a){if(1===arguments.length&&"number"===typeof a)return a;console.assert(!1,"invalid parameter")};
tQuery.convert.toNumberZeroToOne=function(a){if(1===arguments.length&&"number"===typeof a)return a=Math.min(a,1),a=Math.max(a,0);console.assert(!1,"invalid parameter")};tQuery.convert.toInteger=function(a){if(1===arguments.length&&"number"===typeof a)return a=Math.floor(a);console.assert(!1,"invalid parameter")};tQuery.convert.identity=function(a){return a};tQuery.convert.toBoolean=function(a){if(1===arguments.length&&"boolean"===typeof a)return a;console.assert(!1,"invalid parameter")};
tQuery.convert.toString=function(a){if(1===arguments.length&&"string"===typeof a)return a;console.assert(!1,"invalid parameter")};tQuery.convert.toTextureCube=function(){var a=this.dispatchEvent("preConvert",arguments);return void 0!==a?a:tQuery.convert.toTexture.apply(tQuery.convert.toTexture,arguments)};tQuery.MicroeventMixin(tQuery.convert.toTextureCube);
tQuery.convert.toTexture=function(a){var b=this.dispatchEvent("preConvert",arguments);if(void 0!==b)return b;if(1===arguments.length&&a instanceof tQuery.Texture)return arguments[0].get(0);if(1===arguments.length&&a instanceof THREE.Texture||1===arguments.length&&a instanceof THREE.WebGLRenderTarget)return a;if(1===arguments.length&&"string"===typeof a)return THREE.ImageUtils.loadTexture(a);if(1===arguments.length&&(a instanceof Image||a instanceof HTMLVideoElement||a instanceof HTMLCanvasElement))return b=
new THREE.Texture(a),b.needsUpdate=!0,b;console.assert(!1,"invalid parameter")};tQuery.MicroeventMixin(tQuery.convert.toTexture);tQuery.Node=function(a){this._lists=a instanceof Array?a:a?[a]:[];this.length=this._lists.length};tQuery.Node.prototype.get=function(a){if(void 0===a)return this._lists;console.assert(this._lists[a],"element not defined");return this._lists[a]};tQuery.Node.prototype.each=function(a){return tQuery.each(this._lists,a)};
tQuery.Node.prototype.back=function(a){if(void 0===a)return this._back;this._back=a;return this};tQuery.Node.prototype.data=function(a,b,c){if(void 0!==b)return this.each(function(d){tQuery.data(d,a,b,c)}),this;if(0<this.length)return tQuery.data(this.get(0),a);console.assert(0===this.length)};tQuery.Node.prototype.removeData=function(a){this.each(function(b){tQuery.removeData(b,a)});return this};
tQuery.Object3D=function(a,b){"string"===typeof a&&(a=tQuery.Object3D._select(a,b));tQuery.Object3D.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.Object3D)})};tQuery.inherit(tQuery.Object3D,tQuery.Node);tQuery.pluginsInstanceOn(tQuery.Object3D);tQuery.pluginsStaticOn(tQuery.Object3D);
tQuery.mixinAttributes(tQuery.Object3D,{eulerOrder:tQuery.convert.toString,doubleSided:tQuery.convert.toBoolean,flipSided:tQuery.convert.toBoolean,rotationAutoUpdate:tQuery.convert.toBoolean,matrixAutoUpdate:tQuery.convert.toBoolean,matrixWorldNeedsUpdate:tQuery.convert.toBoolean,useQuaternion:tQuery.convert.toBoolean,visible:tQuery.convert.toBoolean,receiveShadow:tQuery.convert.toBoolean,castShadow:tQuery.convert.toBoolean});
tQuery.Object3D.prototype.traverse=function(a){this.each(function(b){b.traverse(function(b){a(b,this)})});return this};tQuery.Object3D.prototype.geometry=function(a){var b=[];this.each(function(a){b.push(a.geometry)});return(new tQuery.Geometry(b)).back(this)};tQuery.Object3D.prototype.material=function(){var a=[];this.each(function(b){a.push(b.material)});return new tQuery.Material(a)};tQuery.Object3D.prototype.clone=function(){var a=[];this.each(function(b){b=b.clone();a.push(b)});return tQuery(a)};
tQuery.Object3D.prototype.lookAt=function(a){a=tQuery.convert.toVector3.apply(null,arguments);this.each(function(b){b.lookAt(a)});return this};tQuery.Object3D.prototype.addTo=function(a){console.assert(a instanceof tQuery.World||a instanceof tQuery.Object3D||a instanceof THREE.Object3D);this.each(function(b){a.add(b)}.bind(this));return this};
tQuery.Object3D.prototype.removeFrom=function(a){console.assert(a instanceof tQuery.World||a instanceof tQuery.Object3D);this.each(function(b){a.remove(b)}.bind(this));return this};tQuery.Object3D.prototype.detach=function(){this.each(function(a){a.parent&&a.parent.remove(a)}.bind(this));return this};
tQuery.Object3D.prototype.add=function(a){a instanceof tQuery.Object3D?this.each(function(b){a.each(function(a){b.add(a)})}.bind(this)):a instanceof THREE.Object3D?0<this.length?this.each(function(b){b.add(a)}):this._lists.push(a):console.assert(!1,"invalid parameter");return this};
tQuery.Object3D.prototype.remove=function(a){a instanceof tQuery.Object3D?this.each(function(b){a.each(function(a){b.remove(a)})}.bind(this)):a instanceof THREE.Object3D?this.each(function(b){b.remove(a)}):console.assert(!1,"invalid parameter");return this};tQuery.Object3D.prototype.name=function(a){console.assert(1>=this.length,"tQuery.Object3D.id used on multi-elements");if(void 0===a){if(0===this.length)return;var b=this.get(0);return b.name}if(0!==this.length)return b=this.get(0),b.name=a,this};
tQuery.Object3D.prototype.id=function(a){console.assert(1>=this.length,"tQuery.Object3D.id used on multi-elements");if(void 0!==a){if(0<this.length){var b=this.get(0);b._tqId=a}return this}if(0<this.length)return b=this.get(0),b._tqId};tQuery.Object3D.prototype.addClass=function(a){this.each(function(b){b._tqClasses=b._tqClasses||"";tQuery.Object3D._hasClassOne(b,a)||(b._tqClasses+=" "+a)}.bind(this));return this};
tQuery.Object3D.prototype.removeClass=function(a){this.each(function(b){tQuery.Object3D._removeClassOne(b,a)}.bind(this));return this};tQuery.Object3D.prototype.hasClass=function(a){return this.each(function(b){b._tqClasses=b._tqClasses||"";return tQuery.Object3D._hasClassOne(b,a)?!1:!0}.bind(this))?!1:!0};tQuery.Object3D._hasClassOne=function(a,b){return void 0===a._tqClasses?!1:a._tqClasses.match(new RegExp("(^| |\t)+("+b+")($| |\t)+"))?!0:!1};
tQuery.Object3D._removeClassOne=function(a,b){void 0!==a._tqClasses&&(a._tqClasses=a._tqClasses.replace(new RegExp("(^| |\t)("+b+")($| |\t)")," "))};tQuery.Object3D._select=function(a,b){b=b||tQuery.world.tScene();b instanceof tQuery.Object3D&&(b=b.get(0));var c=a.split(" ").filter(function(a){return 0<a.length});console.assert(b instanceof THREE.Object3D);var d=[];b.children.forEach(function(a){a=this._crawls(a,c);d=d.concat(a)}.bind(this));return d};
tQuery.Object3D._crawls=function(a,b){var c=[];console.assert(1<=b.length);var d=this._selectItemMatch(a,b[0])?b.slice(1):b;if(0===d.length)return[a];a.children.forEach(function(a){a=this._crawls(a,d);c=c.concat(a)}.bind(this));return c};tQuery.Object3D._selectableGeometries=Object.keys(THREE).filter(function(a){return a.match(/.+Geometry$/)}).map(function(a){return a.replace(/Geometry$/,"").toLowerCase()});
tQuery.Object3D._selectableLights=Object.keys(THREE).filter(function(a){return a.match(/.+Light$/)}).map(function(a){return a.replace(/Light$/,"").toLowerCase()});tQuery.Object3D._selectableClasses=["mesh","light"];
tQuery.Object3D._selectItemMatch=function(a,b){console.assert(a instanceof THREE.Object3D);console.assert("string"===typeof b);var c=b.match(/([^.#]+|.[^.#]+|#[^.#]+)/g);return tQuery.each(c,function(b){var c=b.charAt(0),f=b.slice(1);if("."===c)return tQuery.Object3D._hasClassOne(a,f)?!0:!1;if("#"===c)return a._tqId===f?!0:!1;if("["===c){f=b.match(/\[(.*)([=])(.*)\]/);b=f[1];c=f[2];f=f[3].replace(/^['"]/,"").replace(/['"]$/,"");if("name"===b){if("="===c)return a.name===f?!0:!1;console.assert("operator not handled")}else console.assert(!1,
"key not handled:",b);console.assert(!1,"this point should never be reached")}else{if("*"===b)return!0;if(-1!==this._selectableGeometries.indexOf(b))return c=a.geometry,b=b.charAt(0).toUpperCase()+b.slice(1)+"Geometry",c instanceof THREE[b];if(-1!==this._selectableLights.indexOf(b))return b=b.charAt(0).toUpperCase()+b.slice(1)+"Light",a instanceof THREE[b];if(-1!==this._selectableClasses.indexOf(b))return b=b.charAt(0).toUpperCase()+b.slice(1),a instanceof THREE[b];console.assert(!1,"invalid selector: "+
b);return!0}}.bind(this))?!0:!1};tQuery.Geometry=function(a){tQuery.Geometry.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.Geometry)})};tQuery.inherit(tQuery.Geometry,tQuery.Node);tQuery.pluginsInstanceOn(tQuery.Geometry);tQuery.mixinAttributes(tQuery.Geometry,{hasTangents:tQuery.convert.toBoolean,dynamic:tQuery.convert.toBoolean});
tQuery.Material=function(a){tQuery.Material.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.Material)})};tQuery.inherit(tQuery.Material,tQuery.Node);tQuery.pluginsInstanceOn(tQuery.Material);tQuery.mixinAttributes(tQuery.Material,{opacity:tQuery.convert.toNumber,transparent:tQuery.convert.toBoolean});tQuery.Light=function(a){tQuery.Light.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.Light)})};
tQuery.inherit(tQuery.Light,tQuery.Object3D);tQuery.pluginsInstanceOn(tQuery.Light);tQuery.mixinAttributes(tQuery.Light,{color:tQuery.convert.toThreeColor});tQuery.Mesh=function(a){tQuery.Mesh.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.Mesh)})};tQuery.inherit(tQuery.Mesh,tQuery.Object3D);tQuery.pluginsInstanceOn(tQuery.Mesh);tQuery.MicroeventMixin(tQuery.Mesh.prototype);
tQuery.Mesh.prototype.material=function(a){var b=tQuery.Mesh.parent;if(void 0===a)return b.material.call(this);a instanceof tQuery.Material&&(a=a.get(0));console.assert(a instanceof THREE.Material||a instanceof THREE.FaceMaterial);this.each(function(b){b.material=a});return this};
tQuery.registerStatic("createSprite",function(a,b){1===arguments.length&&(a instanceof THREE.Material||a instanceof tQuery.Material)&&(b=tQuery.convert.toThreeMaterial(a),a=void 0);var c=new THREE.Sprite(a),c=new tQuery.Sprite(c);b&&c.material(b);return c});tQuery.registerStatic("Sprite",function(a){tQuery.Sprite.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.Sprite)})});tQuery.inherit(tQuery.Sprite,tQuery.Object3D);tQuery.pluginsInstanceOn(tQuery.Sprite);
tQuery.mixinAttributes(tQuery.Sprite,{rotation:tQuery.convert.toNumber});tQuery.Sprite.prototype.material=function(a){var b=tQuery.Sprite.parent;if(void 0===a)return b.material.call(this);a instanceof tQuery.Material&&(a=a.get(0));console.assert(a instanceof THREE.SpriteMaterial);this.each(function(b){b.material=a});return this};
tQuery.World=function(a){a=a||{};this._opts=a=tQuery.extend(a,{renderW:window.innerWidth,renderH:window.innerHeight,webGLNeeded:!0,autoRendering:!0,scene:null,camera:null,renderer:null});console.assert(!tQuery.word);tQuery.world=this;this._autoRendering=a.autoRendering;this._tScene=a.scene||new THREE.Scene;a.camera?this._tCamera=a.camera:(this._tCamera=new THREE.PerspectiveCamera(45,a.renderW/a.renderH,.01,1E4),this._tCamera.position.set(0,0,3),this._tScene.add(this._tCamera));this._loop=new tQuery.Loop;
this._$loopCb=this._loop.hookOnRender(function(a,c){this.render(a)}.bind(this));if(a.renderer)this._tRenderer=a.renderer;else{if(tQuery.World.hasWebGL())this._tRenderer=new THREE.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0});else{if(a.webGLNeeded)throw this._addGetWebGLMessage(),Error("WebGL required and not available");this._tRenderer=new THREE.CanvasRenderer}this._tRenderer.setClearColor(12303291,1);this._tRenderer.setSize(a.renderW,a.renderH)}};tQuery.pluginsInstanceOn(tQuery.World);tQuery.MicroeventMixin(tQuery.World.prototype);
tQuery.World.prototype.destroy=function(){this.trigger("destroy");this._loop.unhookOnRender(this._$loopCb);this._loop.destroy();this.removeCameraControls();var a=this._tRenderer.domElement.parentElement;a&&a.removeChild(this._tRenderer.domElement);tQuery.world===this&&(tQuery.world=null)};tQuery.World._hasWebGL=void 0;
tQuery.World.hasWebGL=function(){if(void 0!==tQuery.World._hasWebGL)return tQuery.World._hasWebGL;try{tQuery.World._hasWebGL=!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(a){tQuery.World._hasWebGL=!1}return tQuery.World._hasWebGL};
tQuery.World.prototype._addGetWebGLMessage=function(a){a=a||document.body;var b=document.createElement("div");b.style.fontFamily="monospace";b.style.fontSize="13px";b.style.textAlign="center";b.style.background="#eee";b.style.color="#000";b.style.padding="1em";b.style.width="475px";b.style.margin="5em auto 0";b.innerHTML=window.WebGLRenderingContext?'Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>.<br />\nFind out how to get it <a href="http://get.webgl.org/">here</a>.':
'Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>.<br/>\nFind out how to get it <a href="http://get.webgl.org/">here</a>.';a.appendChild(b)};tQuery.World.prototype.setCameraControls=function(a){this.hasCameraControls()&&this.removeCameraControls();this._tCameraControls=a;return this};tQuery.World.prototype.getCameraControls=function(){return this._tCameraControls};
tQuery.World.prototype.removeCameraControls=function(){if(!1===this.hasCameraControls())return this;this._tCameraControls=void 0;return this};tQuery.World.prototype.hasCameraControls=function(){return void 0!==this._tCameraControls?!0:!1};tQuery.World.prototype.add=function(a){a instanceof tQuery.Object3D?a.each(function(a){this._tScene.add(a)}.bind(this)):a instanceof THREE.Object3D?this._tScene.add(a):console.assert(!1,"invalid type");return this};
tQuery.World.prototype.remove=function(a){a instanceof tQuery.Object3D?a.each(function(a){this._tScene.remove(a)}.bind(this)):a instanceof THREE.Object3D?this._tScene.remove(a):console.assert(!1,"invalid type");return this};tQuery.World.prototype.appendTo=function(a){a.appendChild(this._tRenderer.domElement);return this};tQuery.World.prototype.start=function(){this._loop.start();return this};tQuery.World.prototype.stop=function(){this._loop.stop();return this};
tQuery.World.prototype.hook=function(a,b){return this._loop.hook(a,b)};tQuery.World.prototype.unhook=function(a,b){return this._loop.unhook(a,b)};tQuery.World.prototype.loop=function(){return this._loop};tQuery.World.prototype.tRenderer=function(){return this._tRenderer};tQuery.World.prototype.tScene=function(){return this._tScene};tQuery.World.prototype.tCamera=function(){return this._tCamera};tQuery.World.prototype.scene=function(){return tQuery(this._tScene)};tQuery.World.prototype.camera=function(){return tQuery(this._tCamera)};
tQuery.World.prototype.autoRendering=function(a){if(void 0===a)return this._autoRendering;this._autoRendering=a;return this};tQuery.World.prototype.render=function(a){this.hasCameraControls()&&this._tCameraControls.update(a);this._autoRendering&&this._tRenderer.render(this._tScene,this._tCamera)};tQuery.Loop=function(){this._hooks=[];this._lastTime=null};tQuery.pluginsInstanceOn(tQuery.Loop);tQuery.Loop.prototype.destroy=function(){this.stop()};
tQuery.Loop.prototype.start=function(){this._timerId&&this.stop();this._timerId=requestAnimationFrame(this._onAnimationFrame.bind(this));return this};tQuery.Loop.prototype.stop=function(){cancelAnimationFrame(this._timerId);this._timerId=null;return this};tQuery.Loop.prototype.isRunning=function(){return this._timerId?!0:!1};tQuery.Loop.prototype.pauseToggle=function(){this.isRunning()?this.stop():this.start();return this};tQuery.Loop.maxDelta=.2;
tQuery.Loop.prototype._onAnimationFrame=function(){this._timerId=requestAnimationFrame(this._onAnimationFrame.bind(this));this.tick()};tQuery.Loop.prototype.tick=function(){var a=tQuery.nowSeconds();this._lastTime||(this._lastTime=a-1/60);var b=a-tQuery.Loop.maxDelta;this._lastTime<b&&(this._lastTime=b);b=a-this._lastTime;this._lastTime=a;for(var c=0;c<=this._hooks.length;c++)if(void 0!==this._hooks[c])for(var d=this._hooks[c].slice(0),e=0;e<d.length;e++)d[e](b,a)};
tQuery.Loop.prototype.PRE_RENDER=20;tQuery.Loop.prototype.ON_RENDER=50;tQuery.Loop.prototype.POST_RENDER=80;tQuery.Loop.prototype.hook=function(a,b){"function"===typeof a&&(b=a,a=this.PRE_RENDER);this._hooks[a]=this._hooks[a]||[];console.assert(-1===this._hooks[a].indexOf(b));this._hooks[a].push(b);return b};
tQuery.Loop.prototype.unhook=function(a,b){"function"===typeof a&&(b=a,a=this.PRE_RENDER);var c=this._hooks[a].indexOf(b);console.assert(-1!==c);this._hooks[a].splice(c,1);0===this._hooks[a].length&&delete this._hooks[a];return this};tQuery.Loop.prototype.hookPreRender=function(a){return this.hook(this.PRE_RENDER,a)};tQuery.Loop.prototype.hookOnRender=function(a){return this.hook(this.ON_RENDER,a)};tQuery.Loop.prototype.hookPostRender=function(a){return this.hook(this.POST_RENDER,a)};
tQuery.Loop.prototype.unhookPreRender=function(a){return this.unhook(this.PRE_RENDER,a)};tQuery.Loop.prototype.unhookOnRender=function(a){return this.unhook(this.ON_RENDER,a)};tQuery.Loop.prototype.unhookPostRender=function(a){return this.unhook(this.POST_RENDER,a)};tQuery.registerStatic("createWorld",function(a){return new tQuery.World(a)});tQuery.registerStatic("createObject3D",function(){var a=new THREE.Object3D;return tQuery(a)});
tQuery.registerStatic("createVector3",function(a,b,c){return tQuery.convert.toVector3.apply(tQuery.convert,arguments)});tQuery.registerStatic("createVector2",function(a,b){return new THREE.Vector2(a,b)});tQuery.registerStatic("createHemisphereLight",function(){var a=new THREE.HemisphereLight;return new tQuery.HemisphereLight([a])});tQuery.registerStatic("createDirectionalLight",function(){var a=new THREE.DirectionalLight;return new tQuery.DirectionalLight([a])});
tQuery.registerStatic("createSpotLight",function(){var a=new THREE.SpotLight;return new tQuery.SpotLight([a])});tQuery.registerStatic("createPointLight",function(){var a=new THREE.PointLight;return new tQuery.PointLight([a])});tQuery.registerStatic("createAmbientLight",function(){var a=new THREE.AmbientLight;return new tQuery.AmbientLight([a])});tQuery.registerStatic("defaultObject3DMaterial",new THREE.MeshNormalMaterial);
tQuery.Geometry.prototype.toMesh=function(a){var b=[];this.each(function(c){a=a||tQuery.defaultObject3DMaterial;c=new THREE.Mesh(c,a);b.push(c)});return new tQuery.Mesh(b)};tQuery.registerStatic("createCube",function(){return this._createMesh(THREE.CubeGeometry,[1,1,1],arguments)});tQuery.registerStatic("createTorus",function(){return this._createMesh(THREE.TorusGeometry,[.35,.15],arguments)});
tQuery.registerStatic("createTorusKnot",function(){return this._createMesh(THREE.TorusKnotGeometry,[.27,.1,128,32],arguments)});tQuery.registerStatic("createCircle",function(){return this._createMesh(THREE.CircleGeometry,[.5,32],arguments)});tQuery.registerStatic("createSphere",function(){return this._createMesh(THREE.SphereGeometry,[.5,32,16],arguments)});tQuery.registerStatic("createPlane",function(){return this._createMesh(THREE.PlaneGeometry,[1,1,16,16],arguments)});
tQuery.registerStatic("createCylinder",function(){return this._createMesh(THREE.CylinderGeometry,[.5,.5,1,16,4],arguments)});
tQuery.registerStatic("_createMesh",function(a,b,c){c=Array.prototype.slice.call(c);var d=tQuery.defaultObject3DMaterial;c.length&&c[c.length-1]instanceof THREE.Material?d=c.pop():c.length&&c[c.length-1]instanceof tQuery.Material&&(d=c.pop().get(0));0===c.length&&(c=b.slice());c.unshift(a);a=function(a,b,c,d,k,l,m,v,q){console.assert(9>=arguments.length);return new a(b,c,d,k,l,m,v,q)}.apply(this,c);a.dynamic=!0;d=new THREE.Mesh(a,d);return tQuery(d)});
tQuery.registerStatic("createAxis",function(){var a=new THREE.AxisHelper;return tQuery(a)});tQuery.AmbientLight=function(a){tQuery.AmbientLight.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.AmbientLight)})};tQuery.inherit(tQuery.AmbientLight,tQuery.Light);tQuery.pluginsInstanceOn(tQuery.AmbientLight);
tQuery.DirectionalLight=function(a){tQuery.DirectionalLight.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.DirectionalLight)})};tQuery.inherit(tQuery.DirectionalLight,tQuery.Light);tQuery.pluginsInstanceOn(tQuery.DirectionalLight);
tQuery.mixinAttributes(tQuery.DirectionalLight,{intensity:tQuery.convert.toNumber,distance:tQuery.convert.toNumber,shadowDarkness:tQuery.convert.toNumberZeroToOne,shadowBias:tQuery.convert.toNumber,shadowMapWidth:tQuery.convert.toInteger,shadowMapHeight:tQuery.convert.toInteger,shadowCameraRight:tQuery.convert.toNumber,shadowCameraLeft:tQuery.convert.toNumber,shadowCameraTop:tQuery.convert.toNumber,shadowCameraBottom:tQuery.convert.toNumber,shadowCameraVisible:tQuery.convert.toBoolean,shadowCameraNear:tQuery.convert.toNumber,
shadowCameraFar:tQuery.convert.toNumber});tQuery.HemisphereLight=function(a){tQuery.HemisphereLight.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.HemisphereLight)})};tQuery.inherit(tQuery.HemisphereLight,tQuery.Light);tQuery.pluginsInstanceOn(tQuery.HemisphereLight);tQuery.mixinAttributes(tQuery.HemisphereLight,{intensity:tQuery.convert.toNumber,distance:tQuery.convert.toNumber,groundColor:tQuery.convert.toThreeColor});
tQuery.PointLight=function(a){tQuery.PointLight.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.PointLight)})};tQuery.inherit(tQuery.PointLight,tQuery.Light);tQuery.pluginsInstanceOn(tQuery.PointLight);tQuery.mixinAttributes(tQuery.PointLight,{intensity:tQuery.convert.toNumber,distance:tQuery.convert.toNumber});tQuery.SpotLight=function(a){tQuery.SpotLight.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.SpotLight)})};
tQuery.inherit(tQuery.SpotLight,tQuery.Light);tQuery.pluginsInstanceOn(tQuery.SpotLight);
tQuery.mixinAttributes(tQuery.SpotLight,{intensity:tQuery.convert.toNumber,distance:tQuery.convert.toNumber,angle:tQuery.convert.toNumber,exponent:tQuery.convert.toNumber,onlyShadow:tQuery.convert.toBoolean,shadowDarkness:tQuery.convert.toNumberZeroToOne,shadowBias:tQuery.convert.toNumber,shadowMapWidth:tQuery.convert.toInteger,shadowMapHeight:tQuery.convert.toInteger,shadowCameraRight:tQuery.convert.toNumber,shadowCameraLeft:tQuery.convert.toNumber,shadowCameraTop:tQuery.convert.toNumber,shadowCameraBottom:tQuery.convert.toNumber,
shadowCameraVisible:tQuery.convert.toBoolean,shadowCameraNear:tQuery.convert.toNumber,shadowCameraFar:tQuery.convert.toNumber});tQuery.Mesh.registerInstance("setBasicMaterial",function(a){a=tQuery.createMeshBasicMaterial(a);this.material(a.get(0));return a.back(this)});tQuery.registerStatic("createMeshBasicMaterial",function(a){a=new THREE.MeshBasicMaterial(a);return new tQuery.MeshBasicMaterial(a)});
tQuery.MeshBasicMaterial=function(a){tQuery.MeshBasicMaterial.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.MeshBasicMaterial)})};tQuery.inherit(tQuery.MeshBasicMaterial,tQuery.Material);
tQuery.mixinAttributes(tQuery.MeshBasicMaterial,{color:tQuery.convert.toThreeColor,ambient:tQuery.convert.toThreeColor,map:tQuery.convert.toTexture,envMap:tQuery.convert.toTextureCube,refractionRatio:tQuery.convert.toNumber,blending:tQuery.convert.toNumber,side:tQuery.convert.identity,wireframe:tQuery.convert.toBoolean,wireframeLinewidth:tQuery.convert.toInteger,wireframeLinecap:tQuery.convert.toString});
tQuery.Mesh.registerInstance("setLambertMaterial",function(a){a=tQuery.createMeshLambertMaterial(a);this.material(a.get(0));return a.back(this)});tQuery.registerStatic("createMeshLambertMaterial",function(a){a=new THREE.MeshLambertMaterial(a);return new tQuery.MeshLambertMaterial(a)});tQuery.MeshLambertMaterial=function(a){tQuery.MeshLambertMaterial.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.MeshLambertMaterial)})};
tQuery.inherit(tQuery.MeshLambertMaterial,tQuery.Material);tQuery.mixinAttributes(tQuery.MeshLambertMaterial,{color:tQuery.convert.toThreeColor,ambient:tQuery.convert.toThreeColor,map:tQuery.convert.toTexture,bumpMap:tQuery.convert.toTexture,bumpScale:tQuery.convert.toNumber,side:tQuery.convert.identity});tQuery.Mesh.registerInstance("setNormalMaterial",function(a){a=tQuery.createMeshNormalMaterial(a);this.material(a.get(0));return a.back(this)});
tQuery.registerStatic("createMeshNormalMaterial",function(a){a=new THREE.MeshNormalMaterial(a);return new tQuery.MeshNormalMaterial(a)});tQuery.MeshNormalMaterial=function(a){tQuery.MeshNormalMaterial.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.MeshNormalMaterial)})};tQuery.inherit(tQuery.MeshNormalMaterial,tQuery.Material);tQuery.Mesh.registerInstance("setPhongMaterial",function(a){a=tQuery.createMeshPhongMaterial(a);this.material(a.get(0));return a.back(this)});
tQuery.registerStatic("createMeshPhongMaterial",function(a){a=new THREE.MeshPhongMaterial(a);return new tQuery.MeshPhongMaterial(a)});tQuery.MeshPhongMaterial=function(a){tQuery.MeshPhongMaterial.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.MeshPhongMaterial)})};tQuery.inherit(tQuery.MeshPhongMaterial,tQuery.Material);
tQuery.mixinAttributes(tQuery.MeshPhongMaterial,{map:tQuery.convert.toTexture,color:tQuery.convert.toThreeColor,ambient:tQuery.convert.toThreeColor,emissive:tQuery.convert.toThreeColor,specular:tQuery.convert.toThreeColor,shininess:tQuery.convert.toNumber,envMap:tQuery.convert.toTexture,refractionRatio:tQuery.convert.toNumber,reflectivity:tQuery.convert.toNumber,bumpMap:tQuery.convert.toTexture,bumpScale:tQuery.convert.toNumber,metal:tQuery.convert.toBoolean,perPixel:tQuery.convert.toBoolean});
tQuery.Sprite.registerInstance("setSpriteMaterial",function(a){a=tQuery.createSpriteMaterial(a).back(this);this.material(a.get(0));return a});tQuery.registerStatic("createSpriteMaterial",function(a){a=tQuery.extend(a,{useScreenCoordinates:!1});a=new THREE.SpriteMaterial(a);return new tQuery.SpriteMaterial(a)});tQuery.SpriteMaterial=function(a){tQuery.SpriteMaterial.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.SpriteMaterial)})};
tQuery.inherit(tQuery.SpriteMaterial,tQuery.Material);tQuery.mixinAttributes(tQuery.SpriteMaterial,{color:tQuery.convert.toThreeColor,map:tQuery.convert.toTexture,useScreenCoordinates:tQuery.convert.toBoolean,depthTest:tQuery.convert.toBoolean,sizeAttenuation:tQuery.convert.toBoolean,scaleByViewport:tQuery.convert.toBoolean,fog:tQuery.convert.toBoolean,opacity:tQuery.convert.toNumber,blending:tQuery.convert.toNumber});
(function(){tQuery.Geometry.registerInstance("computeAll",function(){this.each(function(a){a.computeBoundingSphere();a.computeBoundingBox();a.computeCentroids();a.computeFaceNormals();a.computeVertexNormals()});return this});tQuery.Geometry.registerInstance("scaleBy",function(a){"number"===typeof a&&1===arguments.length?a=new THREE.Vector3(a,a,a):"number"===typeof a&&3===arguments.length&&(a=new THREE.Vector3(arguments[0],arguments[1],arguments[2]));console.assert(a instanceof THREE.Vector3,"Geometry.vector3 parameter error");
this.each(function(b){for(var c=0;c<b.vertices.length;c++)b.vertices[c].multiply(a);b.verticesNeedUpdate=!0;b.computeBoundingBox()});return this});tQuery.Geometry.registerInstance("size",function(){console.assert(1>=this.length);if(0!==this.length){var a=this.get(0),b=new THREE.Vector3;b.x=a.boundingBox.max.x-a.boundingBox.min.x;b.y=a.boundingBox.max.y-a.boundingBox.min.y;b.z=a.boundingBox.max.z-a.boundingBox.min.z;return b}});tQuery.Geometry.registerInstance("normalize",function(){this.each(function(a){a=
tQuery(a);var b=a.size();b.x>=b.y&&b.x>=b.z?a.zoom(1/b.x):b.y>=b.x&&b.y>=b.z?a.zoom(1/b.y):a.zoom(1/b.z)});return this});tQuery.Geometry.registerInstance("middlePoint",function(){console.assert(1>=this.length);if(0!==this.length){var a=this.get(0),b=new THREE.Vector3;b.x=(a.boundingBox.max.x+a.boundingBox.min.x)/2;b.y=(a.boundingBox.max.y+a.boundingBox.min.y)/2;b.z=(a.boundingBox.max.z+a.boundingBox.min.z)/2;return b}});tQuery.Geometry.registerInstance("translate",function(a){"number"===typeof a&&
3===arguments.length&&(a=new THREE.Vector3(arguments[0],arguments[1],arguments[2]));console.assert(a instanceof THREE.Vector3,"Geometry.translate parameter error");this.each(function(b){for(var c=0;c<b.vertices.length;c++)b.vertices[c].add(a);b.verticesNeedUpdate=!0;b.computeBoundingBox()});return this});tQuery.Geometry.registerInstance("rotate",function(a,b){"number"===typeof a&&3===arguments.length&&(a=new THREE.Vector3(arguments[0],arguments[1],arguments[2]));console.assert(a instanceof THREE.Vector3,
"Geometry.rotate parameter error");b=b||"XYZ";var c=new THREE.Matrix4;c.makeRotationFromEuler(a,b);this.each(function(a){a.applyMatrix(c);a.verticesNeedUpdate=!0;a.computeBoundingBox()});return this});tQuery.Geometry.registerInstance("center",function(a,b,c){this.each(function(d){d=tQuery(d);var e=d.middlePoint().negate();a&&(e.x=0);b&&(e.y=0);c&&(e.z=0);return d.translate(e)});return this});tQuery.Geometry.registerInstance("translateX",function(a){return this.translate(a,0,0)});tQuery.Geometry.registerInstance("translateY",
function(a){return this.translate(0,a,0)});tQuery.Geometry.registerInstance("translateZ",function(a){return this.translate(0,0,a)});tQuery.Geometry.registerInstance("rotateX",function(a){return this.rotate(a,0,0)});tQuery.Geometry.registerInstance("rotateY",function(a){return this.rotate(0,a,0)});tQuery.Geometry.registerInstance("rotateZ",function(a){return this.rotate(0,0,a)});tQuery.Geometry.registerInstance("scaleXBy",function(a){return this.scaleBy(a,1,1)});tQuery.Geometry.registerInstance("scaleYBy",
function(a){return this.scaleBy(1,a,1)});tQuery.Geometry.registerInstance("scaleZBy",function(a){return this.scaleBy(1,1,a)});tQuery.Geometry.registerInstance("zoom",function(a){return this.scaleBy(a)});tQuery.Geometry.registerInstance("zoomX",function(a){return this.zoom(a,1,1)});tQuery.Geometry.registerInstance("zoomY",function(a){return this.zoom(1,a,1)});tQuery.Geometry.registerInstance("zoomZ",function(a){return this.zoom(1,1,a)})})();
tQuery.Object3D.registerInstance("position",function(a){if(void 0===a)return this.get(0).position;a=tQuery.convert.toVector3.apply(null,arguments);this.each(function(b){b.position.copy(a)});return this});tQuery.Object3D.registerInstance("positionX",function(a){if(void 0===a)return this.get(0).position.x;console.assert("number"===typeof a&&1===arguments.length);this.each(function(b){b.position.x=a});return this});
tQuery.Object3D.registerInstance("positionY",function(a){if(void 0===a)return this.get(0).position.y;console.assert("number"===typeof a&&1===arguments.length);this.each(function(b){b.position.y=a});return this});tQuery.Object3D.registerInstance("positionZ",function(a){if(void 0===a)return this.get(0).position.z;console.assert("number"===typeof a&&1===arguments.length);this.each(function(b){b.position.z=a});return this});
tQuery.Object3D.registerInstance("translate",function(a){"number"===typeof a&&3===arguments.length&&(a=new THREE.Vector3(arguments[0],arguments[1],arguments[2]));console.assert(a instanceof THREE.Vector3,"Object3D.translate parameter error");this.each(function(b){b.position.add(a)});return this});tQuery.Object3D.registerInstance("translateX",function(a){return this.translate(a,0,0)});tQuery.Object3D.registerInstance("translateY",function(a){return this.translate(0,a,0)});
tQuery.Object3D.registerInstance("translateZ",function(a){return this.translate(0,0,a)});tQuery.Object3D.registerInstance("rotation",function(a){if(void 0===a)return this.get(0).rotation;"number"===typeof a&&3===arguments.length&&(a=new THREE.Vector3(arguments[0],arguments[1],arguments[2]));console.assert(a instanceof THREE.Vector3,"Object3D.rotation parameter error");this.each(function(b){b.rotation.x=a.x;b.rotation.y=a.y;b.rotation.z=a.z});return this});
tQuery.Object3D.registerInstance("rotationX",function(a){if(void 0===a)return this.get(0).rotation.x;console.assert("number"===typeof a&&1===arguments.length);this.each(function(b){b.rotation.x=a});return this});tQuery.Object3D.registerInstance("rotationY",function(a){if(void 0===a)return this.get(0).rotation.y;console.assert("number"===typeof a&&1===arguments.length);this.each(function(b){b.rotation.y=a});return this});
tQuery.Object3D.registerInstance("rotationZ",function(a){if(void 0===a)return this.get(0).rotation.z;console.assert("number"===typeof a&&1===arguments.length);this.each(function(b){b.rotation.z=a});return this});
tQuery.Object3D.registerInstance("rotate",function(a){"number"===typeof a&&3===arguments.length&&(a=new THREE.Vector3(arguments[0],arguments[1],arguments[2]));console.assert(a instanceof THREE.Vector3,"Object3D.rotate parameter error");this.each(function(b){b.rotation.x+=a.x;b.rotation.y+=a.y;b.rotation.z+=a.z});return this});tQuery.Object3D.registerInstance("rotateX",function(a){return this.rotate(a,0,0)});tQuery.Object3D.registerInstance("rotateY",function(a){return this.rotate(0,a,0)});
tQuery.Object3D.registerInstance("rotateZ",function(a){return this.rotate(0,0,a)});tQuery.Object3D.registerInstance("scale",function(a){if(void 0===a)return this.get(0).scale;"number"===typeof a&&1===arguments.length?a=new THREE.Vector3(a,a,a):"number"===typeof a&&3===arguments.length&&(a=new THREE.Vector3(arguments[0],arguments[1],arguments[2]));console.assert(a instanceof THREE.Vector3,"Object3D.scale parameter error");this.each(function(b){b.scale.copy(a)});return this});
tQuery.Object3D.registerInstance("scaleX",function(a){if(void 0===a)return this.get(0).scale.x;console.assert("number"===typeof a&&1===arguments.length);this.each(function(b){b.scale.x=a});return this});tQuery.Object3D.registerInstance("scaleY",function(a){if(void 0===a)return this.get(0).scale.y;console.assert("number"===typeof a&&1===arguments.length);this.each(function(b){b.scale.y=a});return this});
tQuery.Object3D.registerInstance("scaleZ",function(a){if(void 0===a)return this.get(0).scale.z;console.assert("number"===typeof a&&1===arguments.length);this.each(function(b){b.scale.z=a});return this});
tQuery.Object3D.registerInstance("scaleBy",function(a){"number"===typeof a&&1===arguments.length?a=new THREE.Vector3(a,a,a):"number"===typeof a&&3===arguments.length&&(a=new THREE.Vector3(arguments[0],arguments[1],arguments[2]));console.assert(a instanceof THREE.Vector3,"Object3D.rotate parameter error");this.each(function(b){b.scale.multiply(a)});return this});tQuery.Object3D.registerInstance("scaleXBy",function(a){return this.scaleBy(a,1,1)});
tQuery.Object3D.registerInstance("scaleYBy",function(a){return this.scaleBy(1,a,1)});tQuery.Object3D.registerInstance("scaleZBy",function(a){return this.scaleBy(1,1,a)});tQuery.Texture=function(a){tQuery.Texture.parent.constructor.call(this,a);this._lists.forEach(function(a){console.assert(a instanceof THREE.Texture)})};tQuery.inherit(tQuery.Texture,tQuery.Node);tQuery.pluginsStaticOn(tQuery.Texture);tQuery.pluginsInstanceOn(tQuery.Texture);
tQuery.mixinAttributes(tQuery.Texture,{offset:tQuery.convert.toVector2,repeat:tQuery.convert.toVector2});tQuery.World.registerInstance("fullpage",function(){console.log("world.fullpage() is obsolete. use world.boilerplate() instead.");return this.boilerplate()});tQuery.World.registerInstance("boilerplate",function(a){var b=document.body;b.style.margin="0";b.style.padding="0";b.style.overflow="hidden";this.appendTo(b);this.tRenderer().setSize(b.offsetWidth,b.offsetHeight);this.addBoilerplate(a);return this});
tQuery.World.registerInstance("pageTitle",function(a){"string"===typeof a&&(a=document.querySelector(a));console.assert(a instanceof HTMLElement,".pageTitle(element) needs a HTMLElement");a.style.position="absolute";a.style.top="0px";a.style.width="100%";a.style.textAlign="center";a.style.fontWeight="bolder";a.style.fontColor="white";a.style.paddingTop="0.5em";a.style.fontFamily="arial";return this});
tQuery.World.registerInstance("defaultPageTitle",function(){var a=window.location,b=a.pathname.match(/^\/plugins\/([^/]+)\//),c=b?!0:!1,d=document.createElement("div");c?(b=c?b[1]:null,d.innerHTML=['Example for <a href="https://github.com/jeromeetienne/tquery/tree/dev/plugins/'+b+'#readme" target="_blank">tQuery.'+b+"</a> plugin - ",'<a href="https://github.com/mrdoob/three.js/" target="_blank">three.js</a> thru \n<a href="../../../" target="_blank">tQuery API</a>\n<br/>\nTry it in a \n<a href="../../../www/live/editor/#U/../../..',
a.pathname+'" target="_blank">live editor</a>'].join("\n")):d.innerHTML='Example of tQuery - \n<a href="https://github.com/mrdoob/three.js/" target="_blank">three.js</a> thru \n<a href="../../../" target="_blank">tQuery API</a>';document.body.appendChild(d);this.pageTitle(d);return this});tQuery.World.registerInstance("devicePixelRatio",function(a){this.tRenderer().devicePixelRatio=a;tQuery.data(this,"_boilerplateCtx").windowResize.trigger();return this});
tQuery.World.registerInstance("addBoilerplate",function(a){console.assert(!0!==this.hasBoilerplate());a=tQuery.extend(a,{stats:!0,cameraControls:!0,windowResize:!0,screenshot:!0,fullscreen:!1});var b={};this.tRenderer().domElement.style.display="block";tQuery.data(this,"_boilerplateCtx",b);var c=this.tCamera(),d=this.tRenderer();a.stats&&(b.stats=new Stats,b.stats.domElement.style.position="absolute",b.stats.domElement.style.bottom="0px",d.domElement.parentNode&&d.domElement.parentNode.appendChild(b.stats.domElement),
b.loopStats=function(){b.stats.update()},this.hook(b.loopStats));a.cameraControls&&(b.cameraControls=new THREEx.DragPanControls(c),this.setCameraControls(b.cameraControls));a.windowResize&&(b.windowResize=THREEx.WindowResize.bind(d,c));a.screenshot&&(b.screenshot=THREEx.Screenshot.bindKey(d));a.fullscreen&&THREEx.FullScreen.available()&&(b.fullscreen=THREEx.FullScreen.bindKey());b._$onDestroy=this.bind("destroy",function(){!1!==this.hasBoilerplate()&&this.removeBoilerplate()});"ontouchstart"in window&&
this.devicePixelRatio(.5);return this});tQuery.World.registerInstance("hasBoilerplate",function(){return void 0===tQuery.data(this,"_boilerplateCtx")?!1:!0});
tQuery.World.registerInstance("removeBoilerplate",function(){var a=tQuery.data(this,"_boilerplateCtx");if(void 0===a)return this;tQuery.removeData(this,"_boilerplateCtx");this.unbind("destroy",this._$onDestroy);a.stats&&document.body.removeChild(a.stats.domElement);a.stats&&this.unhook(a.loopStats);a.cameraControls&&this.removeCameraControls();a.windowResize&&a.windowResize.stop();a.screenshot&&a.screenshot.unbind();a.fullscreen&&a.fullscreen.unbind()});var THREEx=THREEx||{};
THREEx.WindowResize=function(a,b){var c=function(){var c=window.innerWidth,e=window.innerHeight;a.setSize(c,e);b.aspect=c/e;b.updateProjectionMatrix()};window.addEventListener("resize",c,!1);return{stop:function(){window.removeEventListener("resize",c)},trigger:function(){c()}}};THREEx.WindowResize.bind=function(a,b){return THREEx.WindowResize(a,b)};THREEx=THREEx||{};
(function(){var a=function(a,c,d,e){var f=function(a,b){return function(){return a.apply(b,arguments)}}(function(){var a,b,f=document.createElement("canvas");f.width=c;f.height=d;var m=f.getContext("2d");m.fillStyle="black";m.fillRect(0,0,f.width,f.height);a=f.width;var v=f.height,q=g.width;b=g.height;var y=b/q;q>=a&&1>=y?(q=a,b=a*y):b>=v&&(b=v,q=v/y);a=q;m.drawImage(g,(f.width-a)/2,(f.height-b)/2,a,b);f=f.toDataURL("image/png");e&&e(f)},this),g=new Image;g.onload=f;g.src=a};THREEx.Screenshot={toDataURL:function(a,
c){return a.domElement.toDataURL(c||"image/png")},bindKey:function(b,c){c=c||{};var d=c.charCode||112,e=c.width,f=c.height,g=c.callback||function(a){window.open(a,"name-"+Math.random())},h=function(a,b){return function(){return a.apply(b,arguments)}}(function(c){c.which===d&&(c=this.toDataURL(b),void 0===e&&void 0===f?g(c):a(c,e,f,g))},this);document.addEventListener("keypress",h,!1);return{unbind:function(){document.removeEventListener("keypress",h,!1)}}}}})();THREEx=THREEx||{};
THREEx.FullScreen=THREEx.FullScreen||{};THREEx.FullScreen.available=function(){return this._hasWebkitFullScreen||this._hasMozFullScreen};THREEx.FullScreen.activated=function(){if(this._hasWebkitFullScreen)return document.webkitIsFullScreen;if(this._hasMozFullScreen)return document.mozFullScreen;console.assert(!1)};
THREEx.FullScreen.request=function(a){a=a||document.body;this._hasWebkitFullScreen?a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):this._hasMozFullScreen?a.mozRequestFullScreen():console.assert(!1)};THREEx.FullScreen.cancel=function(){this._hasWebkitFullScreen?document.webkitCancelFullScreen():this._hasMozFullScreen?document.mozCancelFullScreen():console.assert(!1)};THREEx.FullScreen._hasWebkitFullScreen="webkitCancelFullScreen"in document?!0:!1;
THREEx.FullScreen._hasMozFullScreen="mozCancelFullScreen"in document?!0:!1;
THREEx.FullScreen.bindKey=function(a){a=a||{};var b=a.charCode||102,c=void 0!==a.dblclick?a.dblclick:!1,d=a.element,e=function(){THREEx.FullScreen.activated()?THREEx.FullScreen.cancel():THREEx.FullScreen.request(d)},f=function(a,b){return function(){return a.apply(b,arguments)}}(function(a){a.which===b&&e()},this);document.addEventListener("keypress",f,!1);c&&document.addEventListener("dblclick",e,!1);return{unbind:function(){document.removeEventListener("keypress",f,!1);c&&document.removeEventListener("dblclick",
e,!1)}}};THREEx=THREEx||{};
THREEx.DragPanControls=function(a,b){this._object=a;this._domElement=b||document;this.target=new THREE.Vector3(0,0,0);this.speedY=this.speedX=.03;this.rangeX=-40;this.rangeY=40;this._mouseY=this._mouseX=0;var c=this;this._$onMouseMove=function(){c._onMouseMove.apply(c,arguments)};this._$onTouchStart=function(){c._onTouchStart.apply(c,arguments)};this._$onTouchMove=function(){c._onTouchMove.apply(c,arguments)};this._domElement.addEventListener("mousemove",this._$onMouseMove,!1);this._domElement.addEventListener("touchstart",
this._$onTouchStart,!1);this._domElement.addEventListener("touchmove",this._$onTouchMove,!1)};THREEx.DragPanControls.prototype.destroy=function(){this._domElement.removeEventListener("mousemove",this._$onMouseMove,!1);this._domElement.removeEventListener("touchstart",this._$onTouchStart,!1);this._domElement.removeEventListener("touchmove",this._$onTouchMove,!1)};
THREEx.DragPanControls.prototype.update=function(){this._object.position.x+=(this._mouseX*this.rangeX-this._object.position.x)*this.speedX;this._object.position.y+=(this._mouseY*this.rangeY-this._object.position.y)*this.speedY;this._object.lookAt(this.target)};THREEx.DragPanControls.prototype._onMouseMove=function(a){this._mouseX=a.clientX/window.innerWidth-.5;this._mouseY=a.clientY/window.innerHeight-.5};
THREEx.DragPanControls.prototype._onTouchStart=function(a){1==a.touches.length&&(this._mouseX=a.touches[0].pageX/window.innerWidth-.5,this._mouseY=a.touches[0].pageY/window.innerHeight-.5)};THREEx.DragPanControls.prototype._onTouchMove=function(a){1==a.touches.length&&(a.preventDefault(),this._mouseX=a.touches[0].pageX/window.innerWidth-.5,this._mouseY=a.touches[0].pageY/window.innerHeight-.5)};
var Stats=function(){var a=Date.now(),b=a,c=0,d=Infinity,e=0,f=0,g=Infinity,h=0,k=0,l=0,m=document.createElement("div");m.id="stats";m.addEventListener("mousedown",function(a){a.preventDefault();B(++l%2)},!1);m.style.cssText="width:80px;opacity:0.9;cursor:pointer";var v=document.createElement("div");v.id="fps";v.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002";m.appendChild(v);var q=document.createElement("div");q.id="fpsText";q.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";
q.innerHTML="FPS";v.appendChild(q);var y=document.createElement("div");y.id="fpsGraph";y.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff";for(v.appendChild(y);74>y.children.length;){var x=document.createElement("span");x.style.cssText="width:1px;height:30px;float:left;background-color:#113";y.appendChild(x)}var w=document.createElement("div");w.id="ms";w.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none";m.appendChild(w);var z=document.createElement("div");
z.id="msText";z.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";z.innerHTML="MS";w.appendChild(z);var u=document.createElement("div");u.id="msGraph";u.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0";for(w.appendChild(u);74>u.children.length;)x=document.createElement("span"),x.style.cssText="width:1px;height:30px;float:left;background-color:#131",u.appendChild(x);var B=function(a){l=a;switch(l){case 0:v.style.display=
"block";w.style.display="none";break;case 1:v.style.display="none",w.style.display="block"}};return{REVISION:12,domElement:m,setMode:B,begin:function(){a=Date.now()},end:function(){var l=Date.now();c=l-a;d=Math.min(d,c);e=Math.max(e,c);z.textContent=c+" MS ("+d+"-"+e+")";var m=Math.min(30,30-c/200*30);u.appendChild(u.firstChild).style.height=m+"px";k++;l>b+1E3&&(f=Math.round(1E3*k/(l-b)),g=Math.min(g,f),h=Math.max(h,f),q.textContent=f+" FPS ("+g+"-"+h+")",m=Math.min(30,30-f/100*30),y.appendChild(y.firstChild).style.height=
m+"px",b=l,k=0);return l},update:function(){a=this.end()}}};"object"===typeof module&&(module.exports=Stats);
(function(a,b){"object"===typeof module&&"object"===typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw Error("jQuery requires a window with a document");return b(a)}:b(a)})("undefined"!==typeof window?window:this,function(a,b){function c(a){var b="length"in a&&a.length,c=r.type(a);return"function"===c||r.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"===typeof b&&0<b&&b-1 in a}function d(a,b,c){if(r.isFunction(b))return r.grep(a,function(a,d){return!!b.call(a,
d,a)!==c});if(b.nodeType)return r.grep(a,function(a){return a===b!==c});if("string"===typeof b){if($a.test(b))return r.filter(b,a,c);b=r.filter(b,a)}return r.grep(a,function(a){return 0<=ia.call(b,a)!==c})}function e(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function f(a){var b=mb[a]={};r.each(a.match(Da)||[],function(a,c){b[c]=!0});return b}function g(){ha.removeEventListener("DOMContentLoaded",g,!1);a.removeEventListener("load",g,!1);r.ready()}function h(){Object.defineProperty(this.cache={},
0,{get:function(){return{}}});this.expando=r.expando+h.uid++}function k(a,b,c){if(void 0===c&&1===a.nodeType)if(c="data-"+b.replace(t,"-$1").toLowerCase(),c=a.getAttribute(c),"string"===typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:sc.test(c)?r.parseJSON(c):c}catch(d){}Ba.set(a,b,c)}else c=void 0;return c}function l(){return!0}function m(){return!1}function v(){try{return ha.activeElement}catch(a){}}function q(a,b){return r.nodeName(a,"table")&&r.nodeName(11!==b.nodeType?
b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function y(a){a.type=(null!==a.getAttribute("type"))+"/"+a.type;return a}function x(a){var b=Ic.exec(a.type);b?a.type=b[1]:a.removeAttribute("type");return a}function w(a,b){for(var c=0,d=a.length;c<d;c++)V.set(a[c],"globalEval",!b||V.get(b[c],"globalEval"))}function z(a,b){var c,d,e,f;if(1===b.nodeType){if(V.hasData(a)&&(f=V.access(a),c=V.set(b,f),f=f.events))for(e in delete c.handle,
c.events={},f)for(c=0,d=f[e].length;c<d;c++)r.event.add(b,e,f[e][c]);Ba.hasData(a)&&(e=Ba.access(a),e=r.extend({},e),Ba.set(b,e))}}function u(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&r.nodeName(a,b)?r.merge([a],c):c}function B(b,c){var d,e=r(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:r.css(e[0],"display");e.detach();return f}function G(a){var b=
ha,c=yc[a];c||(c=B(a,b),"none"!==c&&c||(kb=(kb||r("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=kb[0].contentDocument,b.write(),b.close(),c=B(a,b),kb.detach()),yc[a]=c);return c}function A(a,b,c){var d,e,f=a.style;(c=c||Bb(a))&&(e=c.getPropertyValue(b)||c[b]);c&&(""!==e||r.contains(a.ownerDocument,a)||(e=r.style(a,b)),ic.test(e)&&hc.test(b)&&(a=f.width,b=f.minWidth,d=f.maxWidth,f.minWidth=f.maxWidth=f.width=e,e=c.width,f.width=a,f.minWidth=b,f.maxWidth=d));return void 0!==
e?e+"":e}function C(a,b){return{get:function(){if(a())delete this.get;else return(this.get=b).apply(this,arguments)}}}function F(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=zb.length;e--;)if(b=zb[e]+c,b in a)return b;return d}function I(a,b,c){return(a=lc.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function D(a,b,c,d,e){b=c===(d?"border":"content")?4:"width"===b?1:0;for(var f=0;4>b;b+=2)"margin"===c&&(f+=r.css(a,c+Fa[b],!0,e)),d?("content"===c&&(f-=r.css(a,"padding"+
Fa[b],!0,e)),"margin"!==c&&(f-=r.css(a,"border"+Fa[b]+"Width",!0,e))):(f+=r.css(a,"padding"+Fa[b],!0,e),"padding"!==c&&(f+=r.css(a,"border"+Fa[b]+"Width",!0,e)));return f}function H(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Bb(a),g="border-box"===r.css(a,"boxSizing",!1,f);if(0>=e||null==e){e=A(a,b,f);if(0>e||null==e)e=a.style[b];if(ic.test(e))return e;d=g&&(qa.boxSizingReliable()||e===a.style[b]);e=parseFloat(e)||0}return e+D(a,b,c||(g?"border":"content"),d,f)+"px"}function E(a,
b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)d=a[g],d.style&&(f[g]=V.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&Y(d)&&(f[g]=V.access(d,"olddisplay",G(d.nodeName)))):(e=Y(d),"none"===c&&e||V.set(d,"olddisplay",e?c:r.css(d,"display"))));for(g=0;g<h;g++)d=a[g],!d.style||b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none");return a}function L(a,b,c,d,e){return new L.prototype.init(a,b,c,d,e)}function U(){setTimeout(function(){Ja=
void 0});return Ja=r.now()}function O(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=Fa[d],e["margin"+c]=e["padding"+c]=a;b&&(e.opacity=e.width=a);return e}function J(a,b,c){for(var d,e=($b[b]||[]).concat($b["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function P(a,b){var c,d,e,f,g;for(c in a)if(d=r.camelCase(c),e=b[d],f=a[c],r.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=r.cssHooks[d])&&"expand"in g)for(c in f=g.expand(f),delete a[d],f)c in a||(a[c]=f[c],b[c]=
e);else b[d]=e}function T(a,b,c){var d,e=0,f=kc.length,g=r.Deferred().always(function(){delete h.elem}),h=function(){if(d)return!1;for(var b=Ja||U(),b=Math.max(0,k.startTime+k.duration-b),c=1-(b/k.duration||0),e=0,f=k.tweens.length;e<f;e++)k.tweens[e].run(c);g.notifyWith(a,[k,c,b]);if(1>c&&f)return b;g.resolveWith(a,[k]);return!1},k=g.promise({elem:a,props:r.extend({},b),opts:r.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Ja||U(),duration:c.duration,tweens:[],createTween:function(b,
c){var d=r.Tween(a,k.opts,b,c,k.opts.specialEasing[b]||k.opts.easing);k.tweens.push(d);return d},stop:function(b){var c=0,e=b?k.tweens.length:0;if(d)return this;for(d=!0;c<e;c++)k.tweens[c].run(1);b?g.resolveWith(a,[k,b]):g.rejectWith(a,[k,b]);return this}});c=k.props;for(P(c,k.opts.specialEasing);e<f;e++)if(b=kc[e].call(k,a,c,k.opts))return b;r.map(c,J,k);r.isFunction(k.opts.start)&&k.opts.start.call(a,k);r.fx.timer(r.extend(h,{elem:a,anim:k,queue:k.opts.queue}));return k.progress(k.opts.progress).done(k.opts.done,
k.opts.complete).fail(k.opts.fail).always(k.opts.always)}function S(a){return function(b,c){"string"!==typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(Da)||[];if(r.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function R(a,b,c,d){function e(h){var k;f[h]=!0;r.each(a[h]||[],function(a,h){var aa=h(b,c,d);if("string"===typeof aa&&!g&&!f[aa])return b.dataTypes.unshift(aa),e(aa),!1;if(g)return!(k=aa)});return k}var f={},g=a===Cc;
return e(b.dataTypes[0])||!f["*"]&&e("*")}function ba(a,b){var c,d,e=r.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);d&&r.extend(!0,a,d);return a}function N(a,b,c,d){var e;if(r.isArray(b))r.each(b,function(b,e){c||bd.test(a)?d(a,e):N(a+"["+("object"===typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==r.type(b))d(a,b);else for(e in b)N(a+"["+e+"]",b[e],c,d)}function ja(a){return r.isWindow(a)?a:9===a.nodeType&&a.defaultView}var pa=[],da=pa.slice,K=pa.concat,ra=
pa.push,ia=pa.indexOf,ta={},cb=ta.toString,xa=ta.hasOwnProperty,qa={},ha=a.document,r=function(a,b){return new r.fn.init(a,b)},Ea=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Hb=/^-ms-/,fb=/-([\da-z])/gi,qb=function(a,b){return b.toUpperCase()};r.fn=r.prototype={jquery:"2.1.4",constructor:r,selector:"",length:0,toArray:function(){return da.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:da.call(this)},pushStack:function(a){a=r.merge(this.constructor(),a);a.prevObject=this;a.context=
this.context;return a},each:function(a,b){return r.each(this,a,b)},map:function(a){return this.pushStack(r.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(da.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length;a=+a+(0>a?b:0);return this.pushStack(0<=a&&a<b?[this[a]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:ra,sort:pa.sort,splice:pa.splice};r.extend=r.fn.extend=
function(){var a,b,c,d,e,f=arguments[0]||{},g=1,h=arguments.length,k=!1;"boolean"===typeof f&&(k=f,f=arguments[g]||{},g++);"object"===typeof f||r.isFunction(f)||(f={});g===h&&(f=this,g--);for(;g<h;g++)if(null!=(a=arguments[g]))for(b in a)c=f[b],d=a[b],f!==d&&(k&&d&&(r.isPlainObject(d)||(e=r.isArray(d)))?(e?(e=!1,c=c&&r.isArray(c)?c:[]):c=c&&r.isPlainObject(c)?c:{},f[b]=r.extend(k,c,d)):void 0!==d&&(f[b]=d));return f};r.extend({expando:"jQuery"+("2.1.4"+Math.random()).replace(/\D/g,""),isReady:!0,
error:function(a){throw Error(a);},noop:function(){},isFunction:function(a){return"function"===r.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!r.isArray(a)&&0<=a-parseFloat(a)+1},isPlainObject:function(a){return"object"!==r.type(a)||a.nodeType||r.isWindow(a)||a.constructor&&!xa.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){for(var b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"===
typeof a||"function"===typeof a?ta[cb.call(a)]||"object":typeof a},globalEval:function(a){var b;b=eval;if(a=r.trim(a))1===a.indexOf("use strict")?(b=ha.createElement("script"),b.text=a,ha.head.appendChild(b).parentNode.removeChild(b)):b(a)},camelCase:function(a){return a.replace(Hb,"ms-").replace(fb,qb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length;e=c(a);if(d)if(e)for(;f<g&&(e=b.apply(a[f],d),!1!==e);f++);else for(f in a){if(e=
b.apply(a[f],d),!1===e)break}else if(e)for(;f<g&&(e=b.call(a[f],f,a[f]),!1!==e);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),!1===e)break;return a},trim:function(a){return null==a?"":(a+"").replace(Ea,"")},makeArray:function(a,b){var d=b||[];null!=a&&(c(Object(a))?r.merge(d,"string"===typeof a?[a]:a):ra.call(d,a));return d},inArray:function(a,b,c){return null==b?-1:ia.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];a.length=e;return a},grep:function(a,b,c){for(var d=
[],e=0,f=a.length,g=!c;e<f;e++)c=!b(a[e],e),c!==g&&d.push(a[e]);return d},map:function(a,b,d){var e,f=0,g=a.length,h=[];if(c(a))for(;f<g;f++)e=b(a[f],f,d),null!=e&&h.push(e);else for(f in a)e=b(a[f],f,d),null!=e&&h.push(e);return K.apply([],h)},guid:1,proxy:function(a,b){var c,d;"string"===typeof b&&(c=a[b],b=a,a=c);if(r.isFunction(a))return d=da.call(arguments,2),c=function(){return a.apply(b||this,d.concat(da.call(arguments)))},c.guid=a.guid=a.guid||r.guid++,c},now:Date.now,support:qa});r.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),
function(a,b){ta["[object "+b+"]"]=b.toLowerCase()});var sa=function(a){function b(a,c,d,e){var f,g,h,k,l;(c?c.ownerDocument||c:U)!==J&&K(c);c=c||J;d=d||[];k=c.nodeType;if("string"!==typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&P){if(11!==k&&(f=Ta.exec(a)))if(h=f[1])if(9===k)if((g=c.getElementById(h))&&g.parentNode){if(g.id===h)return d.push(g),d}else return d;else{if(c.ownerDocument&&(g=c.ownerDocument.getElementById(h))&&T(c,g)&&g.id===h)return d.push(g),d}else{if(f[2])return ja.apply(d,c.getElementsByTagName(a)),
d;if((h=f[3])&&B.getElementsByClassName)return ja.apply(d,c.getElementsByClassName(h)),d}if(B.qsa&&(!O||!O.test(a))){g=f=R;h=c;l=1!==k&&a;if(1===k&&"object"!==c.nodeName.toLowerCase()){k=D(a);(f=c.getAttribute("id"))?g=f.replace(Va,"\\$&"):c.setAttribute("id",g);g="[id='"+g+"'] ";for(h=k.length;h--;)k[h]=g+q(k[h]);h=Z.test(a)&&m(c.parentNode)||c;l=k.join(",")}if(l)try{return ja.apply(d,h.querySelectorAll(l)),d}catch(aa){}finally{f||c.removeAttribute("id")}}}return G(a.replace(xa,"$1"),c,d,e)}function c(){function a(c,
d){b.push(c+" ")>A.cacheLength&&delete a[b.shift()];return a[c+" "]=d}var b=[];return a}function d(a){a[R]=!0;return a}function e(a){var b=J.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)A.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||-2147483648)-(~a.sourceIndex||-2147483648);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;
return a?1:-1}function h(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function k(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function l(a){return d(function(b){b=+b;return d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function m(a){return a&&"undefined"!==typeof a.getElementsByTagName&&a}function r(){}function q(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;
return d}function t(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Y++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,k,l=[V,f];if(g)for(;b=b[d];){if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){k=b[R]||(b[R]={});if((h=k[d])&&h[0]===V&&h[1]===f)return l[2]=h[2];k[d]=l;if(l[2]=a(b,c,g))return!0}}}function u(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function v(a,
b,c,d,e){for(var f,g=[],h=0,k=a.length,l=null!=b;h<k;h++)if(f=a[h])if(!c||c(f,d,e))g.push(f),l&&b.push(h);return g}function w(a,c,e,f,g,h){f&&!f[R]&&(f=w(f));g&&!g[R]&&(g=w(g,h));return d(function(d,h,k,l){var aa,m,r=[],q=[],t=h.length,u;if(!(u=d)){u=c||"*";for(var oa=k.nodeType?[k]:k,w=[],x=0,hb=oa.length;x<hb;x++)b(u,oa[x],w);u=w}u=!a||!d&&c?u:v(u,r,a,k,l);oa=e?g||(d?a:t||f)?[]:h:u;e&&e(u,oa,k,l);if(f)for(aa=v(oa,q),f(aa,[],k,l),k=aa.length;k--;)if(m=aa[k])oa[q[k]]=!(u[q[k]]=m);if(d){if(g||a){if(g){aa=
[];for(k=oa.length;k--;)(m=oa[k])&&aa.push(u[k]=m);g(null,oa=[],aa,l)}for(k=oa.length;k--;)(m=oa[k])&&-1<(aa=g?la(d,m):r[k])&&(d[aa]=!(h[aa]=m))}}else oa=v(oa===h?oa.splice(t,oa.length):oa),g?g(null,h,oa,l):ja.apply(h,oa)})}function x(a){var b,c,d,e=a.length,f=A.relative[a[0].type];c=f||A.relative[" "];for(var g=f?1:0,h=t(function(a){return a===b},c,!0),k=t(function(a){return-1<la(b,a)},c,!0),l=[function(a,c,d){a=!f&&(d||c!==H)||((b=c).nodeType?h(a,c,d):k(a,c,d));b=null;return a}];g<e;g++)if(c=A.relative[a[g].type])l=
[t(u(l),c)];else{c=A.filter[a[g].type].apply(null,a[g].matches);if(c[R]){for(d=++g;d<e&&!A.relative[a[d].type];d++);return w(1<g&&u(l),1<g&&q(a.slice(0,g-1).concat({value:" "===a[g-2].type?"*":""})).replace(xa,"$1"),c,g<d&&x(a.slice(g,d)),d<e&&x(a=a.slice(d)),d<e&&q(a))}l.push(c)}return u(l)}function y(a,c){var e=0<c.length,f=0<a.length,g=function(d,g,h,k,l){var aa,m,r,q=0,t="0",u=d&&[],oa=[],w=H,x=d||f&&A.find.TAG("*",l),hb=V+=null==w?1:Math.random()||.1,y=x.length;for(l&&(H=g!==J&&g);t!==y&&null!=
(aa=x[t]);t++){if(f&&aa){for(m=0;r=a[m++];)if(r(aa,g,h)){k.push(aa);break}l&&(V=hb)}e&&((aa=!r&&aa)&&q--,d&&u.push(aa))}q+=t;if(e&&t!==q){for(m=0;r=c[m++];)r(u,oa,g,h);if(d){if(0<q)for(;t--;)u[t]||oa[t]||(oa[t]=pa.call(k));oa=v(oa)}ja.apply(k,oa);l&&!d&&0<oa.length&&1<q+c.length&&b.uniqueSort(k)}l&&(V=hb,H=w);return u};return e?d(g):g}var z,B,A,C,E,D,F,G,H,I,L,K,J,N,P,O,S,Q,T,R="sizzle"+1*new Date,U=a.document,V=0,Y=0,ba=c(),da=c(),ha=c(),ia=function(a,b){a===b&&(L=!0);return 0},ma={}.hasOwnProperty,
ka=[],pa=ka.pop,M=ka.push,ja=ka.push,qa=ka.slice,la=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},ra="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),sa="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ra+"))|)[\\x20\\t\\r\\n\\f]*\\]",ta=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+
sa+")*)|.*)\\)|)",Ba=/[\x20\t\r\n\f]+/g,xa=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,Da=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Ea=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,na=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,Ia=new RegExp(ta),Ja=new RegExp("^"+ra+"$"),Oa={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:new RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:new RegExp("^"+sa),PSEUDO:new RegExp("^"+ta),
CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},Ma=/^(?:input|select|textarea|button)$/i,Ra=/^h\d$/i,Fa=
/^[^{]+\{\s*\[native \w/,Ta=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/[+~]/,Va=/'|\\/g,W=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,fa=function(a,b,c){a="0x"+b-65536;return a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,a&1023|56320)},ga=function(){K()};try{ja.apply(ka=qa.call(U.childNodes),U.childNodes),ka[U.childNodes.length].nodeType}catch(Sa){ja={apply:ka.length?function(a,b){M.apply(a,qa.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=
c-1}}}B=b.support={};E=b.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};K=b.setDocument=function(a){var b=a?a.ownerDocument||a:U;if(b===J||9!==b.nodeType||!b.documentElement)return J;J=b;N=b.documentElement;(a=b.defaultView)&&a!==a.top&&(a.addEventListener?a.addEventListener("unload",ga,!1):a.attachEvent&&a.attachEvent("onunload",ga));P=!E(b);B.attributes=e(function(a){a.className="i";return!a.getAttribute("className")});B.getElementsByTagName=e(function(a){a.appendChild(b.createComment(""));
return!a.getElementsByTagName("*").length});B.getElementsByClassName=Fa.test(b.getElementsByClassName);B.getById=e(function(a){N.appendChild(a).id=R;return!b.getElementsByName||!b.getElementsByName(R).length});B.getById?(A.find.ID=function(a,b){if("undefined"!==typeof b.getElementById&&P){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},A.filter.ID=function(a){var b=a.replace(W,fa);return function(a){return a.getAttribute("id")===b}}):(delete A.find.ID,A.filter.ID=function(a){var b=a.replace(W,
fa);return function(a){return(a="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===b}});A.find.TAG=B.getElementsByTagName?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a);if(B.qsa)return b.querySelectorAll(a)}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f};A.find.CLASS=B.getElementsByClassName&&function(a,b){if(P)return b.getElementsByClassName(a)};
S=[];O=[];if(B.qsa=Fa.test(b.querySelectorAll))e(function(a){N.appendChild(a).innerHTML="<a id='"+R+"'></a><select id='"+R+"-\f]' msallowcapture=''><option selected=''></option></select>";a.querySelectorAll("[msallowcapture^='']").length&&O.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll("[selected]").length||O.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");a.querySelectorAll("[id~="+
R+"-]").length||O.push("~=");a.querySelectorAll(":checked").length||O.push(":checked");a.querySelectorAll("a#"+R+"+*").length||O.push(".#.+[+~]")}),e(function(a){var c=b.createElement("input");c.setAttribute("type","hidden");a.appendChild(c).setAttribute("name","D");a.querySelectorAll("[name=d]").length&&O.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");a.querySelectorAll(":enabled").length||O.push(":enabled",":disabled");a.querySelectorAll("*,:x");O.push(",.*:")});(B.matchesSelector=Fa.test(Q=N.matches||
N.webkitMatchesSelector||N.mozMatchesSelector||N.oMatchesSelector||N.msMatchesSelector))&&e(function(a){B.disconnectedMatch=Q.call(a,"div");Q.call(a,"[s!='']:x");S.push("!=",ta)});O=O.length&&new RegExp(O.join("|"));S=S.length&&new RegExp(S.join("|"));T=(a=Fa.test(N.compareDocumentPosition))||Fa.test(N.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!!(d&&1===d.nodeType&&(c.contains?c.contains(d):a.compareDocumentPosition&&a.compareDocumentPosition(d)&
16))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};ia=a?function(a,c){if(a===c)return L=!0,0;var d=!a.compareDocumentPosition-!c.compareDocumentPosition;if(d)return d;d=(a.ownerDocument||a)===(c.ownerDocument||c)?a.compareDocumentPosition(c):1;return d&1||!B.sortDetached&&c.compareDocumentPosition(a)===d?a===b||a.ownerDocument===U&&T(U,a)?-1:c===b||c.ownerDocument===U&&T(U,c)?1:I?la(I,a)-la(I,c):0:d&4?-1:1}:function(a,c){if(a===c)return L=!0,0;var d,e=0;d=a.parentNode;var f=
c.parentNode,h=[a],k=[c];if(!d||!f)return a===b?-1:c===b?1:d?-1:f?1:I?la(I,a)-la(I,c):0;if(d===f)return g(a,c);for(d=a;d=d.parentNode;)h.unshift(d);for(d=c;d=d.parentNode;)k.unshift(d);for(;h[e]===k[e];)e++;return e?g(h[e],k[e]):h[e]===U?-1:k[e]===U?1:0};return b};b.matches=function(a,c){return b(a,null,null,c)};b.matchesSelector=function(a,c){(a.ownerDocument||a)!==J&&K(a);c=c.replace(na,"='$1']");if(!(!B.matchesSelector||!P||S&&S.test(c)||O&&O.test(c)))try{var d=Q.call(a,c);if(d||B.disconnectedMatch||
a.document&&11!==a.document.nodeType)return d}catch(e){}return 0<b(c,J,null,[a]).length};b.contains=function(a,b){(a.ownerDocument||a)!==J&&K(a);return T(a,b)};b.attr=function(a,b){(a.ownerDocument||a)!==J&&K(a);var c=A.attrHandle[b.toLowerCase()],c=c&&ma.call(A.attrHandle,b.toLowerCase())?c(a,b,!P):void 0;return void 0!==c?c:B.attributes||!P?a.getAttribute(b):(c=a.getAttributeNode(b))&&c.specified?c.value:null};b.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};b.uniqueSort=
function(a){var b,c=[],d=0,e=0;L=!B.detectDuplicates;I=!B.sortStable&&a.slice(0);a.sort(ia);if(L){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}I=null;return a};C=b.getText=function(a){var b,c="",d=0;b=a.nodeType;if(!b)for(;b=a[d++];)c+=C(b);else if(1===b||9===b||11===b){if("string"===typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=C(a)}else if(3===b||4===b)return a.nodeValue;return c};A=b.selectors={cacheLength:50,createPseudo:d,match:Oa,attrHandle:{},
find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){a[1]=a[1].replace(W,fa);a[3]=(a[3]||a[4]||a[5]||"").replace(W,fa);"~="===a[2]&&(a[3]=" "+a[3]+" ");return a.slice(0,4)},CHILD:function(a){a[1]=a[1].toLowerCase();"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]);return a},PSEUDO:function(a){var b,
c=!a[6]&&a[2];if(Oa.CHILD.test(a[0]))return null;a[3]?a[2]=a[4]||a[5]||"":c&&Ia.test(c)&&(b=D(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b));return a.slice(0,3)}},filter:{TAG:function(a){var b=a.replace(W,fa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=ba[a+" "];return b||(b=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&ba(a,function(a){return b.test("string"===
typeof a.className&&a.className||"undefined"!==typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){e=b.attr(e,a);if(null==e)return"!="===c;if(!c)return!0;e+="";return"="===c?e===d:"!="===c?e!==d:"^="===c?d&&0===e.indexOf(d):"*="===c?d&&-1<e.indexOf(d):"$="===c?d&&e.slice(-d.length)===d:"~="===c?-1<(" "+e.replace(Ba," ")+" ").indexOf(d):"|="===c?e===d||e.slice(0,d.length+1)===d+"-":!1}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),
h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,k){var l,aa,m,r,q;c=f!==g?"nextSibling":"previousSibling";var t=b.parentNode,u=h&&b.nodeName.toLowerCase();k=!k&&!h;if(t){if(f){for(;c;){for(aa=b;aa=aa[c];)if(h?aa.nodeName.toLowerCase()===u:1===aa.nodeType)return!1;q=c="only"===a&&!q&&"nextSibling"}return!0}q=[g?t.firstChild:t.lastChild];if(g&&k)for(k=t[R]||(t[R]={}),l=k[a]||[],r=l[0]===V&&l[1],m=l[0]===V&&l[2],aa=r&&t.childNodes[r];aa=++r&&aa&&aa[c]||(m=r=0)||q.pop();){if(1===
aa.nodeType&&++m&&aa===b){k[a]=[V,r,m];break}}else if(k&&(l=(b[R]||(b[R]={}))[a])&&l[0]===V)m=l[1];else for(;(aa=++r&&aa&&aa[c]||(m=r=0)||q.pop())&&((h?aa.nodeName.toLowerCase()!==u:1!==aa.nodeType)||!++m||(k&&((aa[R]||(aa[R]={}))[a]=[V,m]),aa!==b)););m-=e;return m===d||0===m%d&&0<=m/d}}},PSEUDO:function(a,c){var e,f=A.pseudos[a]||A.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[R]?f(c):1<f.length?(e=[a,a,"",c],A.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,
e=f(a,c),g=e.length;g--;)d=la(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=F(a.replace(xa,"$1"));return e[R]?d(function(a,b,c,d){d=e(a,null,d,[]);for(var f=a.length;f--;)if(c=d[f])a[f]=!(b[f]=c)}):function(a,d,f){b[0]=a;e(b,null,f,c);b[0]=null;return!c.pop()}}),has:d(function(a){return function(c){return 0<b(a,c).length}}),contains:d(function(a){a=a.replace(W,fa);return function(b){return-1<(b.textContent||b.innerText||C(b)).indexOf(a)}}),
lang:d(function(a){Ja.test(a||"")||b.error("unsupported lang: "+a);a=a.replace(W,fa).toLowerCase();return function(b){var c;do if(c=P?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===N},focus:function(a){return a===J.activeElement&&(!J.hasFocus||J.hasFocus())&&!!(a.type||a.href||
~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(6>a.nodeType)return!1;return!0},parent:function(a){return!A.pseudos.empty(a)},header:function(a){return Ra.test(a.nodeName)},input:function(a){return Ma.test(a.nodeName)},
button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:l(function(){return[0]}),last:l(function(a,b){return[b-1]}),eq:l(function(a,b,c){return[0>c?c+b:c]}),even:l(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:l(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:l(function(a,b,c){for(b=
0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:l(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}};A.pseudos.nth=A.pseudos.eq;for(z in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})A.pseudos[z]=h(z);for(z in{submit:!0,reset:!0})A.pseudos[z]=k(z);r.prototype=A.filters=A.pseudos;A.setFilters=new r;D=b.tokenize=function(a,c){var d,e,f,g,h,k,l;if(h=da[a+" "])return c?0:h.slice(0);h=a;k=[];for(l=A.preFilter;h;){if(!d||(e=Da.exec(h)))e&&(h=h.slice(e[0].length)||h),k.push(f=[]);d=!1;if(e=Ea.exec(h))d=
e.shift(),f.push({value:d,type:e[0].replace(xa," ")}),h=h.slice(d.length);for(g in A.filter)!(e=Oa[g].exec(h))||l[g]&&!(e=l[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):da(a,k).slice(0)};F=b.compile=function(a,b){var c,d=[],e=[],f=ha[a+" "];if(!f){b||(b=D(a));for(c=b.length;c--;)f=x(b[c]),f[R]?d.push(f):e.push(f);f=ha(a,y(e,d));f.selector=a}return f};G=b.select=function(a,b,c,d){var e,f,g,h,k="function"===typeof a&&a,l=!d&&
D(a=k.selector||a);c=c||[];if(1===l.length){f=l[0]=l[0].slice(0);if(2<f.length&&"ID"===(g=f[0]).type&&B.getById&&9===b.nodeType&&P&&A.relative[f[1].type]){b=(A.find.ID(g.matches[0].replace(W,fa),b)||[])[0];if(!b)return c;k&&(b=b.parentNode);a=a.slice(f.shift().value.length)}for(e=Oa.needsContext.test(a)?0:f.length;e--;){g=f[e];if(A.relative[h=g.type])break;if(h=A.find[h])if(d=h(g.matches[0].replace(W,fa),Z.test(f[0].type)&&m(b.parentNode)||b)){f.splice(e,1);a=d.length&&q(f);if(!a)return ja.apply(c,
d),c;break}}}(k||F(a,l))(d,b,!P,c,Z.test(a)&&m(b.parentNode)||b);return c};B.sortStable=R.split("").sort(ia).join("")===R;B.detectDuplicates=!!L;K();B.sortDetached=e(function(a){return a.compareDocumentPosition(J.createElement("div"))&1});e(function(a){a.innerHTML="<a href='#'></a>";return"#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)});B.attributes&&e(function(a){a.innerHTML="<input/>";a.firstChild.setAttribute("value",
"");return""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue});e(function(a){return null==a.getAttribute("disabled")})||f("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(a,b,c){var d;if(!c)return!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null});return b}(a);r.find=sa;r.expr=sa.selectors;r.expr[":"]=r.expr.pseudos;
r.unique=sa.uniqueSort;r.text=sa.getText;r.isXMLDoc=sa.isXML;r.contains=sa.contains;var rb=r.expr.match.needsContext,sb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,$a=/^.[^:#\[\.,]*$/;r.filter=function(a,b,c){var d=b[0];c&&(a=":not("+a+")");return 1===b.length&&1===d.nodeType?r.find.matchesSelector(d,a)?[d]:[]:r.find.matches(a,r.grep(b,function(a){return 1===a.nodeType}))};r.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!==typeof a)return this.pushStack(r(a).filter(function(){for(b=0;b<
c;b++)if(r.contains(e[b],this))return!0}));for(b=0;b<c;b++)r.find(a,e[b],d);d=this.pushStack(1<c?r.unique(d):d);d.selector=this.selector?this.selector+" "+a:a;return d},filter:function(a){return this.pushStack(d(this,a||[],!1))},not:function(a){return this.pushStack(d(this,a||[],!0))},is:function(a){return!!d(this,"string"===typeof a&&rb.test(a)?r(a):a||[],!1).length}});var Ta,ob=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(r.fn.init=function(a,b){var c;if(!a)return this;if("string"===typeof a){c="<"===
a[0]&&">"===a[a.length-1]&&3<=a.length?[null,a,null]:ob.exec(a);if(!c||!c[1]&&b)return!b||b.jquery?(b||Ta).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof r?b[0]:b,r.merge(this,r.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:ha,!0)),sb.test(c[1])&&r.isPlainObject(b))for(c in b)if(r.isFunction(this[c]))this[c](b[c]);else this.attr(c,b[c])}else(c=ha.getElementById(c[2]))&&c.parentNode&&(this.length=1,this[0]=c),this.context=ha,this.selector=a;return this}if(a.nodeType)return this.context=
this[0]=a,this.length=1,this;if(r.isFunction(a))return"undefined"!==typeof Ta.ready?Ta.ready(a):a(r);void 0!==a.selector&&(this.selector=a.selector,this.context=a.context);return r.makeArray(a,this)}).prototype=r.fn;Ta=r(ha);var pb=/^(?:parents|prev(?:Until|All))/,tc={children:!0,contents:!0,next:!0,prev:!0};r.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&r(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===
a.nodeType&&a!==b&&c.push(a);return c}});r.fn.extend({has:function(a){var b=r(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(r.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=rb.test(a)||"string"!==typeof a?r(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(11>c.nodeType&&(g?-1<g.index(c):1===c.nodeType&&r.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(1<f.length?r.unique(f):f)},index:function(a){return a?
"string"===typeof a?ia.call(r(a),this[0]):ia.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(r.unique(r.merge(this.get(),r(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});r.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return r.dir(a,"parentNode")},parentsUntil:function(a,b,c){return r.dir(a,"parentNode",c)},next:function(a){return e(a,
"nextSibling")},prev:function(a){return e(a,"previousSibling")},nextAll:function(a){return r.dir(a,"nextSibling")},prevAll:function(a){return r.dir(a,"previousSibling")},nextUntil:function(a,b,c){return r.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return r.dir(a,"previousSibling",c)},siblings:function(a){return r.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return r.sibling(a.firstChild)},contents:function(a){return a.contentDocument||r.merge([],a.childNodes)}},function(a,
b){r.fn[a]=function(c,d){var e=r.map(this,b,c);"Until"!==a.slice(-5)&&(d=c);d&&"string"===typeof d&&(e=r.filter(d,e));1<this.length&&(tc[a]||r.unique(e),pb.test(a)&&e.reverse());return this.pushStack(e)}});var Da=/\S+/g,mb={};r.Callbacks=function(a){a="string"===typeof a?mb[a]||f(a):r.extend({},a);var b,c,d,e,g,h,k=[],l=!a.once&&[],m=function(f){b=a.memory&&f;c=!0;h=e||0;e=0;g=k.length;for(d=!0;k&&h<g;h++)if(!1===k[h].apply(f[0],f[1])&&a.stopOnFalse){b=!1;break}d=!1;k&&(l?l.length&&m(l.shift()):b?
k=[]:q.disable())},q={add:function(){if(k){var c=k.length;(function Na(b){r.each(b,function(b,c){var d=r.type(c);"function"===d?a.unique&&q.has(c)||k.push(c):c&&c.length&&"string"!==d&&Na(c)})})(arguments);d?g=k.length:b&&(e=c,m(b))}return this},remove:function(){k&&r.each(arguments,function(a,b){for(var c;-1<(c=r.inArray(b,k,c));)k.splice(c,1),d&&(c<=g&&g--,c<=h&&h--)});return this},has:function(a){return a?-1<r.inArray(a,k):!(!k||!k.length)},empty:function(){k=[];g=0;return this},disable:function(){k=
l=b=void 0;return this},disabled:function(){return!k},lock:function(){l=void 0;b||q.disable();return this},locked:function(){return!l},fireWith:function(a,b){!k||c&&!l||(b=b||[],b=[a,b.slice?b.slice():b],d?l.push(b):m(b));return this},fire:function(){q.fireWith(this,arguments);return this},fired:function(){return!!c}};return q};r.extend({Deferred:function(a){var b=[["resolve","done",r.Callbacks("once memory"),"resolved"],["reject","fail",r.Callbacks("once memory"),"rejected"],["notify","progress",
r.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){e.done(arguments).fail(arguments);return this},then:function(){var a=arguments;return r.Deferred(function(c){r.each(b,function(b,f){var g=r.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);if(a&&r.isFunction(a.promise))a.promise().done(c.resolve).fail(c.reject).progress(c.notify);else c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})});a=null}).promise()},promise:function(a){return null!=
a?r.extend(a,d):d}},e={};d.pipe=d.then;r.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add;h&&g.add(function(){c=h},b[a^1][2].disable,b[2][2].lock);e[f[0]]=function(){e[f[0]+"With"](this===e?d:this,arguments);return this};e[f[0]+"With"]=g.fireWith});d.promise(e);a&&a.call(e,e);return e},when:function(a){var b=0,c=da.call(arguments),d=c.length,e=1!==d||a&&r.isFunction(a.promise)?d:0,f=1===e?a:r.Deferred(),g=function(a,b,c){return function(d){b[a]=this;c[a]=1<arguments.length?da.call(arguments):
d;c===h?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},h,k,l;if(1<d)for(h=Array(d),k=Array(d),l=Array(d);b<d;b++)c[b]&&r.isFunction(c[b].promise)?c[b].promise().done(g(b,l,c)).fail(f.reject).progress(g(b,k,h)):--e;e||f.resolveWith(l,c);return f.promise()}});var ab;r.fn.ready=function(a){r.ready.promise().done(a);return this};r.extend({isReady:!1,readyWait:1,holdReady:function(a){a?r.readyWait++:r.ready(!0)},ready:function(a){(!0===a?--r.readyWait:r.isReady)||(r.isReady=!0,!0!==a&&0<--r.readyWait||(ab.resolveWith(ha,
[r]),r.fn.triggerHandler&&(r(ha).triggerHandler("ready"),r(ha).off("ready"))))}});r.ready.promise=function(b){ab||(ab=r.Deferred(),"complete"===ha.readyState?setTimeout(r.ready):(ha.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)));return ab.promise(b)};r.ready.promise();var ka=r.access=function(a,b,c,d,e,f,g){var h=0,k=a.length,l=null==c;if("object"===r.type(c))for(h in e=!0,c)r.access(a,b,h,c[h],!0,f,g);else if(void 0!==d&&(e=!0,r.isFunction(d)||(g=!0),l&&(g?(b.call(a,
d),b=null):(l=b,b=function(a,b,c){return l.call(r(a),c)})),b))for(;h<k;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:l?b.call(a):k?b(a[0],c):f};r.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};h.uid=1;h.accepts=r.acceptData;h.prototype={key:function(a){if(!h.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=h.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,r.extend(a,b)}}this.cache[c]||(this.cache[c]={});return c},
set:function(a,b,c){var d;a=this.key(a);var e=this.cache[a];if("string"===typeof b)e[b]=c;else if(r.isEmptyObject(e))r.extend(this.cache[a],b);else for(d in b)e[d]=b[d];return e},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){if(void 0===b||b&&"string"===typeof b&&void 0===c)return c=this.get(a,b),void 0!==c?c:this.get(a,r.camelCase(b));this.set(a,b,c);return void 0!==c?c:b},remove:function(a,b){var c,d;c=this.key(a);var e=this.cache[c];if(void 0===
b)this.cache[c]={};else for(r.isArray(b)?d=b.concat(b.map(r.camelCase)):(c=r.camelCase(b),b in e?d=[b,c]:(d=c,d=d in e?[d]:d.match(Da)||[])),c=d.length;c--;)delete e[d[c]]},hasData:function(a){return!r.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var V=new h,Ba=new h,sc=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,t=/([A-Z])/g;r.extend({hasData:function(a){return Ba.hasData(a)||V.hasData(a)},data:function(a,b,c){return Ba.access(a,b,
c)},removeData:function(a,b){Ba.remove(a,b)},_data:function(a,b,c){return V.access(a,b,c)},_removeData:function(a,b){V.remove(a,b)}});r.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=Ba.get(f),1===f.nodeType&&!V.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=r.camelCase(d.slice(5)),k(f,d,e[d])));V.set(f,"hasDataAttrs",!0)}return e}return"object"===typeof a?this.each(function(){Ba.set(this,a)}):ka(this,
function(b){var c,d=r.camelCase(a);if(f&&void 0===b){c=Ba.get(f,a);if(void 0!==c)return c;c=Ba.get(f,d);if(void 0!==c)return c;c=k(f,d,void 0);if(void 0!==c)return c}else this.each(function(){var c=Ba.get(this,d);Ba.set(this,d,b);-1!==a.indexOf("-")&&void 0!==c&&Ba.set(this,a,b)})},null,b,1<arguments.length,null,!0)},removeData:function(a){return this.each(function(){Ba.remove(this,a)})}});r.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=V.get(a,b),c&&(!d||r.isArray(c)?d=V.access(a,
b,r.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=r.queue(a,b),d=c.length,e=c.shift(),f=r._queueHooks(a,b),g=function(){r.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--);e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f));!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return V.get(a,c)||V.access(a,c,{empty:r.Callbacks("once memory").add(function(){V.remove(a,[b+"queue",c])})})}});r.fn.extend({queue:function(a,b){var c=2;"string"!==typeof a&&
(b=a,a="fx",c--);return arguments.length<c?r.queue(this[0],a):void 0===b?this:this.each(function(){var c=r.queue(this,a,b);r._queueHooks(this,a);"fx"===a&&"inprogress"!==c[0]&&r.dequeue(this,a)})},dequeue:function(a){return this.each(function(){r.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=r.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!==typeof a&&(b=a,a=void 0);for(a=a||"fx";g--;)(c=V.get(f[g],a+"queueHooks"))&&
c.empty&&(d++,c.empty.add(h));h();return e.promise(b)}});var Va=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Fa=["Top","Right","Bottom","Left"],Y=function(a,b){a=b||a;return"none"===r.css(a,"display")||!r.contains(a.ownerDocument,a)},ma=/^(?:checkbox|radio)$/i;(function(){var a=ha.createDocumentFragment().appendChild(ha.createElement("div")),b=ha.createElement("input");b.setAttribute("type","radio");b.setAttribute("checked","checked");b.setAttribute("name","t");a.appendChild(b);qa.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked;
a.innerHTML="<textarea>x</textarea>";qa.noCloneChecked=!!a.cloneNode(!0).lastChild.defaultValue})();qa.focusinBubbles="onfocusin"in a;var gc=/^key/,uc=/^(?:mouse|pointer|contextmenu)|click/,fc=/^(?:focusinfocus|focusoutblur)$/,nb=/^([^.]*)(?:\.(.+)|)$/;r.event={global:{},add:function(a,b,c,d,e){var f,g,h,k,l,m,q,t,u;if(l=V.get(a))for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=r.guid++),(k=l.events)||(k=l.events={}),(g=l.handle)||(g=l.handle=function(b){return"undefined"!==typeof r&&
r.event.triggered!==b.type?r.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(Da)||[""],l=b.length;l--;)h=nb.exec(b[l])||[],t=m=h[1],u=(h[2]||"").split(".").sort(),t&&(h=r.event.special[t]||{},t=(e?h.delegateType:h.bindType)||t,h=r.event.special[t]||{},m=r.extend({type:t,origType:m,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&r.expr.match.needsContext.test(e),namespace:u.join(".")},f),(q=k[t])||(q=k[t]=[],q.delegateCount=0,h.setup&&!1!==h.setup.call(a,d,u,g)||a.addEventListener&&
a.addEventListener(t,g,!1)),h.add&&(h.add.call(a,m),m.handler.guid||(m.handler.guid=c.guid)),e?q.splice(q.delegateCount++,0,m):q.push(m),r.event.global[t]=!0)},remove:function(a,b,c,d,e){var f,g,h,k,l,m,q,t,u,v,w,x=V.hasData(a)&&V.get(a);if(x&&(k=x.events)){b=(b||"").match(Da)||[""];for(l=b.length;l--;)if(h=nb.exec(b[l])||[],u=w=h[1],v=(h[2]||"").split(".").sort(),u){q=r.event.special[u]||{};u=(d?q.delegateType:q.bindType)||u;t=k[u]||[];h=h[2]&&new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)");
for(g=f=t.length;f--;)m=t[f],!e&&w!==m.origType||c&&c.guid!==m.guid||h&&!h.test(m.namespace)||d&&d!==m.selector&&("**"!==d||!m.selector)||(t.splice(f,1),m.selector&&t.delegateCount--,q.remove&&q.remove.call(a,m));g&&!t.length&&(q.teardown&&!1!==q.teardown.call(a,v,x.handle)||r.removeEvent(a,u,x.handle),delete k[u])}else for(u in k)r.event.remove(a,u+b[l],c,d,!0);r.isEmptyObject(k)&&(delete x.handle,V.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,k,l,m,q=[d||ha],t=xa.call(b,"type")?b.type:
b;m=xa.call(b,"namespace")?b.namespace.split("."):[];g=f=d=d||ha;if(3!==d.nodeType&&8!==d.nodeType&&!fc.test(t+r.event.triggered)&&(0<=t.indexOf(".")&&(m=t.split("."),t=m.shift(),m.sort()),k=0>t.indexOf(":")&&"on"+t,b=b[r.expando]?b:new r.Event(t,"object"===typeof b&&b),b.isTrigger=e?2:3,b.namespace=m.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:r.makeArray(c,[b]),m=r.event.special[t]||{},e||
!m.trigger||!1!==m.trigger.apply(d,c))){if(!e&&!m.noBubble&&!r.isWindow(d)){h=m.delegateType||t;fc.test(h+t)||(g=g.parentNode);for(;g;g=g.parentNode)q.push(g),f=g;f===(d.ownerDocument||ha)&&q.push(f.defaultView||f.parentWindow||a)}for(f=0;(g=q[f++])&&!b.isPropagationStopped();)b.type=1<f?h:m.bindType||t,(l=(V.get(g,"events")||{})[b.type]&&V.get(g,"handle"))&&l.apply(g,c),(l=k&&g[k])&&l.apply&&r.acceptData(g)&&(b.result=l.apply(g,c),!1===b.result&&b.preventDefault());b.type=t;e||b.isDefaultPrevented()||
m._default&&!1!==m._default.apply(q.pop(),c)||!r.acceptData(d)||!k||!r.isFunction(d[t])||r.isWindow(d)||((f=d[k])&&(d[k]=null),r.event.triggered=t,d[t](),r.event.triggered=void 0,f&&(d[k]=f));return b.result}},dispatch:function(a){a=r.event.fix(a);var b,c,d,e,f=[],g=da.call(arguments);b=(V.get(this,"events")||{})[a.type]||[];var h=r.event.special[a.type]||{};g[0]=a;a.delegateTarget=this;if(!h.preDispatch||!1!==h.preDispatch.call(this,a)){f=r.event.handlers.call(this,a,b);for(b=0;(e=f[b++])&&!a.isPropagationStopped();)for(a.currentTarget=
e.elem,c=0;(d=e.handlers[c++])&&!a.isImmediatePropagationStopped();)if(!a.namespace_re||a.namespace_re.test(d.namespace))a.handleObj=d,a.data=d.data,d=((r.event.special[d.origType]||{}).handle||d.handler).apply(e.elem,g),void 0!==d&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation());h.postDispatch&&h.postDispatch.call(this,a);return a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,k=a.target;if(h&&k.nodeType&&(!a.button||"click"!==a.type))for(;k!==this;k=k.parentNode||
this)if(!0!==k.disabled||"click"!==a.type){d=[];for(c=0;c<h;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?0<=r(e,this).index(k):r.find(e,this,null,[k]).length),d[e]&&d.push(f);d.length&&g.push({elem:k,handlers:d})}h<b.length&&g.push({elem:this,handlers:b.slice(h)});return g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,
b){null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e=b.button;null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||ha,d=c.documentElement,c=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||c&&c.scrollLeft||0)-(d&&d.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||c&&c.scrollTop||0)-(d&&d.clientTop||c&&c.clientTop||
0));a.which||void 0===e||(a.which=e&1?1:e&2?3:e&4?2:0);return a}},fix:function(a){if(a[r.expando])return a;var b,c,d;b=a.type;var e=a,f=this.fixHooks[b];f||(this.fixHooks[b]=f=uc.test(b)?this.mouseHooks:gc.test(b)?this.keyHooks:{});d=f.props?this.props.concat(f.props):this.props;a=new r.Event(e);for(b=d.length;b--;)c=d[b],a[c]=e[c];a.target||(a.target=ha);3===a.target.nodeType&&(a.target=a.target.parentNode);return f.filter?f.filter(a,e):a},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==
v()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===v()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&r.nodeName(this,"input"))return this.click(),!1},_default:function(a){return r.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){a=r.extend(new r.Event,c,{type:a,
isSimulated:!0,originalEvent:{}});d?r.event.trigger(a,null,b):r.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};r.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)};r.Event=function(a,b){if(!(this instanceof r.Event))return new r.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?l:m):this.type=a;b&&r.extend(this,b);this.timeStamp=a&&a.timeStamp||
r.now();this[r.expando]=!0};r.Event.prototype={isDefaultPrevented:m,isPropagationStopped:m,isImmediatePropagationStopped:m,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=l;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=l;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=l;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();
this.stopPropagation()}};r.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){r.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=a.relatedTarget,e=a.handleObj;if(!d||d!==this&&!r.contains(this,d))a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b;return c}}});qa.focusinBubbles||r.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){r.event.simulate(b,a.target,r.event.fix(a),!0)};r.event.special[b]=
{setup:function(){var d=this.ownerDocument||this,e=V.access(d,b);e||d.addEventListener(a,c,!0);V.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=V.access(d,b)-1;e?V.access(d,b,e):(d.removeEventListener(a,c,!0),V.remove(d,b))}}});r.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"===typeof a){"string"!==typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"===typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0));
if(!1===d)d=m;else if(!d)return this;1===e&&(f=d,d=function(a){r().off(a);return f.apply(this,arguments)},d.guid=f.guid||(f.guid=r.guid++));return this.each(function(){r.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,r(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"===typeof a){for(d in a)this.off(d,b,a[d]);return this}if(!1===
b||"function"===typeof b)c=b,b=void 0;!1===c&&(c=m);return this.each(function(){r.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){r.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return r.event.trigger(a,b,c,!0)}});var vc=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,wc=/<([\w:]+)/,Hc=/<|&#?\w+;/,Gb=/<(?:script|style|link)/i,Ub=/checked\s*(?:[^=]|=\s*.checked.)/i,xc=/^$|\/(?:java|ecma)script/i,Ic=/^true\/(.*)/,Jc=
/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ma={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ma.optgroup=Ma.option;Ma.tbody=Ma.tfoot=Ma.colgroup=Ma.caption=Ma.thead;Ma.th=Ma.td;r.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),k=r.contains(a.ownerDocument,a);if(!(qa.noCloneChecked||1!==
a.nodeType&&11!==a.nodeType||r.isXMLDoc(a)))for(g=u(h),f=u(a),d=0,e=f.length;d<e;d++){var l=f[d],m=g[d],q=m.nodeName.toLowerCase();if("input"===q&&ma.test(l.type))m.checked=l.checked;else if("input"===q||"textarea"===q)m.defaultValue=l.defaultValue}if(b)if(c)for(f=f||u(a),g=g||u(h),d=0,e=f.length;d<e;d++)z(f[d],g[d]);else z(a,h);g=u(h,"script");0<g.length&&w(g,!k&&u(a,"script"));return h},buildFragment:function(a,b,c,d){for(var e,f,g,h=b.createDocumentFragment(),k=[],l=0,m=a.length;l<m;l++)if((e=
a[l])||0===e)if("object"===r.type(e))r.merge(k,e.nodeType?[e]:e);else if(Hc.test(e)){f=f||h.appendChild(b.createElement("div"));g=(wc.exec(e)||["",""])[1].toLowerCase();g=Ma[g]||Ma._default;f.innerHTML=g[1]+e.replace(vc,"<$1></$2>")+g[2];for(g=g[0];g--;)f=f.lastChild;r.merge(k,f.childNodes);f=h.firstChild;f.textContent=""}else k.push(b.createTextNode(e));h.textContent="";for(l=0;e=k[l++];)if(!d||-1===r.inArray(e,d))if(a=r.contains(e.ownerDocument,e),f=u(h.appendChild(e),"script"),a&&w(f),c)for(g=
0;e=f[g++];)xc.test(e.type||"")&&c.push(e);return h},cleanData:function(a){for(var b,c,d,e,f=r.event.special,g=0;void 0!==(c=a[g]);g++){if(r.acceptData(c)&&(e=c[V.expando])&&(b=V.cache[e])){if(b.events)for(d in b.events)f[d]?r.event.remove(c,d):r.removeEvent(c,d,b.handle);V.cache[e]&&delete V.cache[e]}delete Ba.cache[c[Ba.expando]]}}});r.fn.extend({text:function(a){return ka(this,function(a){return void 0===a?r.text(this):this.empty().each(function(){if(1===this.nodeType||11===this.nodeType||9===
this.nodeType)this.textContent=a})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||q(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=q(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},
after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?r.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||r.cleanData(u(c)),c.parentNode&&(b&&r.contains(c.ownerDocument,c)&&w(u(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(r.cleanData(u(a,!1)),a.textContent="");return this},clone:function(a,b){a=null==
a?!1:a;b=null==b?a:b;return this.map(function(){return r.clone(this,a,b)})},html:function(a){return ka(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"===typeof a&&!Gb.test(a)&&!Ma[(wc.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(vc,"<$1></$2>");try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(r.cleanData(u(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];
this.domManip(arguments,function(b){a=this.parentNode;r.cleanData(u(this));a&&a.replaceChild(b,this)});return a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=K.apply([],a);var c,d,e,f,g=0,h=this.length,k=this,l=h-1,m=a[0],q=r.isFunction(m);if(q||1<h&&"string"===typeof m&&!qa.checkClone&&Ub.test(m))return this.each(function(c){var d=k.eq(c);q&&(a[0]=m.call(this,c,d.html()));d.domManip(a,b)});if(h&&(c=r.buildFragment(a,this[0].ownerDocument,
!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){d=r.map(u(c,"script"),y);for(e=d.length;g<h;g++)f=c,g!==l&&(f=r.clone(f,!0,!0),e&&r.merge(d,u(f,"script"))),b.call(this[g],f,g);if(e)for(c=d[d.length-1].ownerDocument,r.map(d,x),g=0;g<e;g++)f=d[g],xc.test(f.type||"")&&!V.access(f,"globalEval")&&r.contains(c,f)&&(f.src?r._evalUrl&&r._evalUrl(f.src):r.globalEval(f.textContent.replace(Jc,"")))}return this}});r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",
replaceAll:"replaceWith"},function(a,b){r.fn[a]=function(a){for(var c=[],d=r(a),e=d.length-1,f=0;f<=e;f++)a=f===e?this:this.clone(!0),r(d[f])[b](a),ra.apply(c,a.get());return this.pushStack(c)}});var kb,yc={},hc=/^margin/,ic=new RegExp("^("+Va+")(?!px)[a-z%]+$","i"),Bb=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)};(function(){function b(){g.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute";
g.innerHTML="";e.appendChild(f);var h=a.getComputedStyle(g,null);c="1%"!==h.top;d="4px"===h.width;e.removeChild(f)}var c,d,e=ha.documentElement,f=ha.createElement("div"),g=ha.createElement("div");g.style&&(g.style.backgroundClip="content-box",g.cloneNode(!0).style.backgroundClip="",qa.clearCloneStyle="content-box"===g.style.backgroundClip,f.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",f.appendChild(g),a.getComputedStyle&&r.extend(qa,{pixelPosition:function(){b();
return c},boxSizingReliable:function(){null==d&&b();return d},reliableMarginRight:function(){var b,c=g.appendChild(ha.createElement("div"));c.style.cssText=g.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";c.style.marginRight=c.style.width="0";g.style.width="1px";e.appendChild(f);b=!parseFloat(a.getComputedStyle(c,null).marginRight);e.removeChild(f);g.removeChild(c);return b}}))})();r.swap=function(a,b,c,d){var e,
f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];c=c.apply(a,d||[]);for(e in b)a.style[e]=f[e];return c};var Kc=/^(none|table(?!-c[ea]).+)/,lc=new RegExp("^("+Va+")(.*)$","i"),mc=new RegExp("^([+-])=("+Va+")","i"),Ab={position:"absolute",visibility:"hidden",display:"block"},jc={letterSpacing:"0",fontWeight:"400"},zb=["Webkit","O","Moz","ms"];r.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=A(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,
fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=r.camelCase(b),k=a.style;b=r.cssProps[h]||(r.cssProps[h]=F(k,h));g=r.cssHooks[b]||r.cssHooks[h];if(void 0!==c)f=typeof c,"string"===f&&(e=mc.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(r.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||r.cssNumber[h]||(c+="px"),qa.clearCloneStyle||""!==c||0!==b.indexOf("background")||
(k[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(k[b]=c));else return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:k[b]}},css:function(a,b,c,d){var e,f;f=r.camelCase(b);b=r.cssProps[f]||(r.cssProps[f]=F(a.style,f));(f=r.cssHooks[b]||r.cssHooks[f])&&"get"in f&&(e=f.get(a,!0,c));void 0===e&&(e=A(a,b,d));"normal"===e&&b in jc&&(e=jc[b]);return""===c||c?(a=parseFloat(e),!0===c||r.isNumeric(a)?a||0:e):e}});r.each(["height","width"],function(a,b){r.cssHooks[b]={get:function(a,c,d){if(c)return Kc.test(r.css(a,
"display"))&&0===a.offsetWidth?r.swap(a,Ab,function(){return H(a,b,d)}):H(a,b,d)},set:function(a,c,d){var e=d&&Bb(a);return I(a,c,d?D(a,b,d,"border-box"===r.css(a,"boxSizing",!1,e),e):0)}}});r.cssHooks.marginRight=C(qa.reliableMarginRight,function(a,b){if(b)return r.swap(a,{display:"inline-block"},A,[a,"marginRight"])});r.each({margin:"",padding:"",border:"Width"},function(a,b){r.cssHooks[a+b]={expand:function(c){var d=0,e={};for(c="string"===typeof c?c.split(" "):[c];4>d;d++)e[a+Fa[d]+b]=c[d]||c[d-
2]||c[0];return e}};hc.test(a)||(r.cssHooks[a+b].set=I)});r.fn.extend({css:function(a,b){return ka(this,function(a,b,c){var d,e={},f=0;if(r.isArray(b)){c=Bb(a);for(d=b.length;f<d;f++)e[b[f]]=r.css(a,b[f],!1,c);return e}return void 0!==c?r.style(a,b,c):r.css(a,b)},a,b,1<arguments.length)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(a){return"boolean"===typeof a?a?this.show():this.hide():this.each(function(){Y(this)?r(this).show():r(this).hide()})}});r.Tween=L;
L.prototype={constructor:L,init:function(a,b,c,d,e,f){this.elem=a;this.prop=c;this.easing=e||"swing";this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=f||(r.cssNumber[c]?"":"px")},cur:function(){var a=L.propHooks[this.prop];return a&&a.get?a.get(this):L.propHooks._default.get(this)},run:function(a){var b,c=L.propHooks[this.prop];this.pos=this.options.duration?b=r.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):b=a;this.now=(this.end-this.start)*b+this.start;
this.options.step&&this.options.step.call(this.elem,this.now,this);c&&c.set?c.set(this):L.propHooks._default.set(this);return this}};L.prototype.init.prototype=L.prototype;L.propHooks={_default:{get:function(a){return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(a=r.css(a.elem,a.prop,""))&&"auto"!==a?a:0:a.elem[a.prop]},set:function(a){if(r.fx.step[a.prop])r.fx.step[a.prop](a);else a.elem.style&&(null!=a.elem.style[r.cssProps[a.prop]]||r.cssHooks[a.prop])?r.style(a.elem,a.prop,
a.now+a.unit):a.elem[a.prop]=a.now}}};L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}};r.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}};r.fx=L.prototype.init;r.fx.step={};var Ja,jb,lb=/^(?:toggle|show|hide)$/,gb=new RegExp("^(?:([+-])=|)("+Va+")([a-z%]*)$","i"),Gc=/queueHooks$/,kc=[function(a,b,c){var d,e,f,g,h,k,l=this,m={},q=a.style,t=a.nodeType&&Y(a),u=V.get(a,"fxshow");c.queue||(g=
r._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,l.always(function(){l.always(function(){g.unqueued--;r.queue(a,"fx").length||g.empty.fire()})}));1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[q.overflow,q.overflowX,q.overflowY],k=r.css(a,"display"),e="none"===k?V.get(a,"olddisplay")||G(a.nodeName):k,"inline"===e&&"none"===r.css(a,"float")&&(q.display="inline-block"));c.overflow&&(q.overflow="hidden",l.always(function(){q.overflow=
c.overflow[0];q.overflowX=c.overflow[1];q.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],lb.exec(e)){delete b[d];f=f||"toggle"===e;if(e===(t?"hide":"show"))if("show"===e&&u&&void 0!==u[d])t=!0;else continue;m[d]=u&&u[d]||r.style(a,d)}else k=void 0;if(r.isEmptyObject(m))"inline"===("none"===k?G(a.nodeName):k)&&(q.display=k);else for(d in u?"hidden"in u&&(t=u.hidden):u=V.access(a,"fxshow",{}),f&&(u.hidden=!t),t?r(a).show():l.done(function(){r(a).hide()}),l.done(function(){var b;V.remove(a,"fxshow");
for(b in m)r.style(a,b,m[b])}),m)b=J(t?u[d]:0,d,l),d in u||(u[d]=b.start,t&&(b.end=b.start,b.start="width"===d||"height"===d?1:0))}],$b={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=gb.exec(b),f=e&&e[3]||(r.cssNumber[a]?"":"px"),g=(r.cssNumber[a]||"px"!==f&&+d)&&gb.exec(r.css(c.elem,a)),h=1,k=20;if(g&&g[3]!==f){f=f||g[3];e=e||[];g=+d||1;do h=h||".5",g/=h,r.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--k)}e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]);return c}]};
r.Animation=r.extend(T,{tweener:function(a,b){r.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],$b[c]=$b[c]||[],$b[c].unshift(b)},prefilter:function(a,b){b?kc.unshift(a):kc.push(a)}});r.speed=function(a,b,c){var d=a&&"object"===typeof a?r.extend({},a):{complete:c||!c&&b||r.isFunction(a)&&a,duration:a,easing:c&&b||b&&!r.isFunction(b)&&b};d.duration=r.fx.off?0:"number"===typeof d.duration?d.duration:d.duration in r.fx.speeds?r.fx.speeds[d.duration]:r.fx.speeds._default;
if(null==d.queue||!0===d.queue)d.queue="fx";d.old=d.complete;d.complete=function(){r.isFunction(d.old)&&d.old.call(this);d.queue&&r.dequeue(this,d.queue)};return d};r.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Y).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=r.isEmptyObject(a),f=r.speed(b,c,d);b=function(){var b=T(this,r.extend({},a),f);(e||V.get(this,"finish"))&&b.stop(!0)};b.finish=b;return e||!1===f.queue?this.each(b):this.queue(f.queue,b)},
stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop;b(c)};"string"!==typeof a&&(c=b,b=a,a=void 0);b&&!1!==a&&this.queue(a||"fx",[]);return this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=r.timers,g=V.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Gc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||r.dequeue(this,a)})},finish:function(a){!1!==a&&(a=a||"fx");return this.each(function(){var b,
c=V.get(this),d=c[a+"queue"];b=c[a+"queueHooks"];var e=r.timers,f=d?d.length:0;c.finish=!0;r.queue(this,a,[]);b&&b.stop&&b.stop.call(this,!0);for(b=e.length;b--;)e[b].elem===this&&e[b].queue===a&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;b<f;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}});r.each(["toggle","show","hide"],function(a,b){var c=r.fn[b];r.fn[b]=function(a,d,e){return null==a||"boolean"===typeof a?c.apply(this,arguments):this.animate(O(b,!0),a,d,e)}});r.each({slideDown:O("show"),
slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){r.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});r.timers=[];r.fx.tick=function(){var a,b=0,c=r.timers;for(Ja=r.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||r.fx.stop();Ja=void 0};r.fx.timer=function(a){r.timers.push(a);a()?r.fx.start():r.timers.pop()};r.fx.interval=13;r.fx.start=function(){jb||(jb=setInterval(r.fx.tick,r.fx.interval))};
r.fx.stop=function(){clearInterval(jb);jb=null};r.fx.speeds={slow:600,fast:200,_default:400};r.fn.delay=function(a,b){a=r.fx?r.fx.speeds[a]||a:a;return this.queue(b||"fx",function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})};(function(){var a=ha.createElement("input"),b=ha.createElement("select"),c=b.appendChild(ha.createElement("option"));a.type="checkbox";qa.checkOn=""!==a.value;qa.optSelected=c.selected;b.disabled=!0;qa.optDisabled=!c.disabled;a=ha.createElement("input");a.value=
"t";a.type="radio";qa.radioValue="t"===a.value})();var Lc,ac=r.expr.attrHandle;r.fn.extend({attr:function(a,b){return ka(this,r.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){r.removeAttr(this,a)})}});r.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f){if("undefined"===typeof a.getAttribute)return r.prop(a,b,c);1===f&&r.isXMLDoc(a)||(b=b.toLowerCase(),d=r.attrHooks[b]||(r.expr.match.bool.test(b)?Lc:void 0));if(void 0!==c)if(null===c)r.removeAttr(a,
b);else{if(d&&"set"in d&&void 0!==(e=d.set(a,c,b)))return e;a.setAttribute(b,c+"");return c}else{if(d&&"get"in d&&null!==(e=d.get(a,b)))return e;e=r.find.attr(a,b);return null==e?void 0:e}}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(Da);if(f&&1===a.nodeType)for(;c=f[e++];)d=r.propFix[c]||c,r.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!qa.radioValue&&"radio"===b&&r.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);c&&(a.value=c);
return b}}}}});Lc={set:function(a,b,c){!1===b?r.removeAttr(a,c):a.setAttribute(c,c);return c}};r.each(r.expr.match.bool.source.match(/\w+/g),function(a,b){var c=ac[b]||r.find.attr;ac[b]=function(a,b,d){var e,f;d||(f=ac[b],ac[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,ac[b]=f);return e}});var Vc=/^(?:input|select|textarea|button)$/i;r.fn.extend({prop:function(a,b){return ka(this,r.prop,a,b,1<arguments.length)},removeProp:function(a){return this.each(function(){delete this[r.propFix[a]||a]})}});r.extend({propFix:{"for":"htmlFor",
"class":"className"},prop:function(a,b,c){var d,e,f;f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f){if(f=1!==f||!r.isXMLDoc(a))b=r.propFix[b]||b,e=r.propHooks[b];return void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]}},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||Vc.test(a.nodeName)||a.href?a.tabIndex:-1}}}});qa.optSelected||(r.propHooks.selected={get:function(a){(a=a.parentNode)&&a.parentNode&&a.parentNode.selectedIndex;return null}});
r.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){r.propFix[this.toLowerCase()]=this});var zc=/[\t\r\n\f]/g;r.fn.extend({addClass:function(a){var b,c,d,e,f;b="string"===typeof a&&a;var g=0,h=this.length;if(r.isFunction(a))return this.each(function(b){r(this).addClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(Da)||[];g<h;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(zc,
" "):" ")){for(f=0;e=b[f++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");d=r.trim(d);c.className!==d&&(c.className=d)}return this},removeClass:function(a){var b,c,d,e,f;b=0===arguments.length||"string"===typeof a&&a;var g=0,h=this.length;if(r.isFunction(a))return this.each(function(b){r(this).removeClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(Da)||[];g<h;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(zc," "):"")){for(f=0;e=b[f++];)for(;0<=d.indexOf(" "+e+" ");)d=
d.replace(" "+e+" "," ");d=a?r.trim(d):"";c.className!==d&&(c.className=d)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"===typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):r.isFunction(a)?this.each(function(c){r(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=r(this),f=a.match(Da)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else if("undefined"===c||"boolean"===c)this.className&&V.set(this,
"__className__",this.className),this.className=this.className||!1===a?"":V.get(this,"__className__")||""})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;b<c;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(zc," ").indexOf(a))return!0;return!1}});var Wc=/\r/g;r.fn.extend({val:function(a){var b,c,d,e=this[0];if(arguments.length)return d=r.isFunction(a),this.each(function(c){1===this.nodeType&&(c=d?a.call(this,c,r(this).val()):a,null==c?c="":"number"===typeof c?c+="":
r.isArray(c)&&(c=r.map(c,function(a){return null==a?"":a+""})),b=r.valHooks[this.type]||r.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,c,"value")||(this.value=c))});if(e){if((b=r.valHooks[e.type]||r.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value")))return c;c=e.value;return"string"===typeof c?c.replace(Wc,""):null==c?"":c}}});r.extend({valHooks:{option:{get:function(a){var b=r.find.attr(a,"value");return null!=b?b:r.trim(r.text(a))}},select:{get:function(a){for(var b,
c=a.options,d=a.selectedIndex,e=(a="select-one"===a.type||0>d)?null:[],f=a?d+1:c.length,g=0>d?f:a?d:0;g<f;g++)if(b=c[g],!(!b.selected&&g!==d||(qa.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&r.nodeName(b.parentNode,"optgroup"))){b=r(b).val();if(a)return b;e.push(b)}return e},set:function(a,b){for(var c,d,e=a.options,f=r.makeArray(b),g=e.length;g--;)if(d=e[g],d.selected=0<=r.inArray(d.value,f))c=!0;c||(a.selectedIndex=-1);return f}}}});r.each(["radio","checkbox"],
function(){r.valHooks[this]={set:function(a,b){if(r.isArray(b))return a.checked=0<=r.inArray(r(a).val(),b)}};qa.checkOn||(r.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});r.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){r.fn[b]=function(a,c){return 0<arguments.length?this.on(b,
null,a,c):this.trigger(b)}});r.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var Ac=r.now(),Bc=/\?/;r.parseJSON=function(a){return JSON.parse(a+"")};r.parseXML=function(a){var b,c;if(!a||"string"!==typeof a)return null;try{c=new DOMParser,
b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}b&&!b.getElementsByTagName("parsererror").length||r.error("Invalid XML: "+a);return b};var Xc=/#.*$/,Mc=/([?&])_=[^&]*/,Yc=/^(.*?):[ \t]*([^\r\n]*)$/mg,Zc=/^(?:GET|HEAD)$/,$c=/^\/\//,Nc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Oc={},Cc={},Pc="*/".concat("*"),Dc=a.location.href,Vb=Nc.exec(Dc.toLowerCase())||[];r.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Dc,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Vb[1]),
global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Pc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":r.parseJSON,"text xml":r.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?ba(ba(a,
r.ajaxSettings),b):ba(r.ajaxSettings,a)},ajaxPrefilter:S(Oc),ajaxTransport:S(Cc),ajax:function(a,b){function c(a,b,g,k){var m,y,z,A;A=b;if(2!==B){B=2;h&&clearTimeout(h);d=void 0;f=k||"";C.readyState=0<a?4:0;k=200<=a&&300>a||304===a;if(g){z=q;for(var aa=C,D,E,F,G,H=z.contents,I=z.dataTypes;"*"===I[0];)I.shift(),void 0===D&&(D=z.mimeType||aa.getResponseHeader("Content-Type"));if(D)for(E in H)if(H[E]&&H[E].test(D)){I.unshift(E);break}if(I[0]in g)F=I[0];else{for(E in g){if(!I[0]||z.converters[E+" "+I[0]]){F=
E;break}G||(G=E)}F=F||G}F?(F!==I[0]&&I.unshift(F),z=g[F]):z=void 0}a:{g=q;D=z;E=C;F=k;var L,J,K,aa={},H=g.dataTypes.slice();if(H[1])for(J in g.converters)aa[J.toLowerCase()]=g.converters[J];for(G=H.shift();G;)if(g.responseFields[G]&&(E[g.responseFields[G]]=D),!K&&F&&g.dataFilter&&(D=g.dataFilter(D,g.dataType)),K=G,G=H.shift())if("*"===G)G=K;else if("*"!==K&&K!==G){J=aa[K+" "+G]||aa["* "+G];if(!J)for(L in aa)if(z=L.split(" "),z[1]===G&&(J=aa[K+" "+z[0]]||aa["* "+z[0]])){!0===J?J=aa[L]:!0!==aa[L]&&
(G=z[0],H.unshift(z[1]));break}if(!0!==J)if(J&&g["throws"])D=J(D);else try{D=J(D)}catch(N){z={state:"parsererror",error:J?N:"No conversion from "+K+" to "+G};break a}}z={state:"success",data:D}}if(k)q.ifModified&&((A=C.getResponseHeader("Last-Modified"))&&(r.lastModified[e]=A),(A=C.getResponseHeader("etag"))&&(r.etag[e]=A)),204===a||"HEAD"===q.type?A="nocontent":304===a?A="notmodified":(A=z.state,m=z.data,y=z.error,k=!y);else if(y=A,a||!A)A="error",0>a&&(a=0);C.status=a;C.statusText=(b||A)+"";k?v.resolveWith(t,
[m,A,C]):v.rejectWith(t,[C,A,y]);C.statusCode(x);x=void 0;l&&u.trigger(k?"ajaxSuccess":"ajaxError",[C,q,k?m:y]);w.fireWith(t,[C,A]);l&&(u.trigger("ajaxComplete",[C,q]),--r.active||r.event.trigger("ajaxStop"))}}"object"===typeof a&&(b=a,a=void 0);b=b||{};var d,e,f,g,h,k,l,m,q=r.ajaxSetup({},b),t=q.context||q,u=q.context&&(t.nodeType||t.jquery)?r(t):r.event,v=r.Deferred(),w=r.Callbacks("once memory"),x=q.statusCode||{},y={},z={},B=0,A="canceled",C={readyState:0,getResponseHeader:function(a){var b;if(2===
B){if(!g)for(g={};b=Yc.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===B?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();B||(a=z[c]=z[c]||a,y[a]=b);return this},overrideMimeType:function(a){B||(q.mimeType=a);return this},statusCode:function(a){var b;if(a)if(2>B)for(b in a)x[b]=[x[b],a[b]];else C.always(a[C.status]);return this},abort:function(a){a=a||A;d&&d.abort(a);c(0,a);return this}};v.promise(C).complete=
w.add;C.success=C.done;C.error=C.fail;q.url=((a||q.url||Dc)+"").replace(Xc,"").replace($c,Vb[1]+"//");q.type=b.method||b.type||q.method||q.type;q.dataTypes=r.trim(q.dataType||"*").toLowerCase().match(Da)||[""];null==q.crossDomain&&(k=Nc.exec(q.url.toLowerCase()),q.crossDomain=!(!k||k[1]===Vb[1]&&k[2]===Vb[2]&&(k[3]||("http:"===k[1]?"80":"443"))===(Vb[3]||("http:"===Vb[1]?"80":"443"))));q.data&&q.processData&&"string"!==typeof q.data&&(q.data=r.param(q.data,q.traditional));R(Oc,q,b,C);if(2===B)return C;
(l=r.event&&q.global)&&0===r.active++&&r.event.trigger("ajaxStart");q.type=q.type.toUpperCase();q.hasContent=!Zc.test(q.type);e=q.url;q.hasContent||(q.data&&(e=q.url+=(Bc.test(e)?"&":"?")+q.data,delete q.data),!1===q.cache&&(q.url=Mc.test(e)?e.replace(Mc,"$1_="+Ac++):e+(Bc.test(e)?"&":"?")+"_="+Ac++));q.ifModified&&(r.lastModified[e]&&C.setRequestHeader("If-Modified-Since",r.lastModified[e]),r.etag[e]&&C.setRequestHeader("If-None-Match",r.etag[e]));(q.data&&q.hasContent&&!1!==q.contentType||b.contentType)&&
C.setRequestHeader("Content-Type",q.contentType);C.setRequestHeader("Accept",q.dataTypes[0]&&q.accepts[q.dataTypes[0]]?q.accepts[q.dataTypes[0]]+("*"!==q.dataTypes[0]?", "+Pc+"; q=0.01":""):q.accepts["*"]);for(m in q.headers)C.setRequestHeader(m,q.headers[m]);if(q.beforeSend&&(!1===q.beforeSend.call(t,C,q)||2===B))return C.abort();A="abort";for(m in{success:1,error:1,complete:1})C[m](q[m]);if(d=R(Cc,q,b,C)){C.readyState=1;l&&u.trigger("ajaxSend",[C,q]);q.async&&0<q.timeout&&(h=setTimeout(function(){C.abort("timeout")},
q.timeout));try{B=1,d.send(y,c)}catch(D){if(2>B)c(-1,D);else throw D;}}else c(-1,"No Transport");return C},getJSON:function(a,b,c){return r.get(a,b,c,"json")},getScript:function(a,b){return r.get(a,void 0,b,"script")}});r.each(["get","post"],function(a,b){r[b]=function(a,c,d,e){r.isFunction(c)&&(e=e||d,d=c,c=void 0);return r.ajax({url:a,type:b,dataType:e,data:c,success:d})}});r._evalUrl=function(a){return r.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};r.fn.extend({wrapAll:function(a){var b;
if(r.isFunction(a))return this.each(function(b){r(this).wrapAll(a.call(this,b))});this[0]&&(b=r(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this));return this},wrapInner:function(a){return r.isFunction(a)?this.each(function(b){r(this).wrapInner(a.call(this,b))}):this.each(function(){var b=r(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=
r.isFunction(a);return this.each(function(c){r(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){r.nodeName(this,"body")||r(this).replaceWith(this.childNodes)}).end()}});r.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight};r.expr.filters.visible=function(a){return!r.expr.filters.hidden(a)};var ad=/%20/g,bd=/\[\]$/,Qc=/\r?\n/g,cd=/^(?:submit|button|image|reset|file)$/i,dd=/^(?:input|select|textarea|keygen)/i;r.param=function(a,b){var c,
d=[],e=function(a,b){b=r.isFunction(b)?b():null==b?"":b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};void 0===b&&(b=r.ajaxSettings&&r.ajaxSettings.traditional);if(r.isArray(a)||a.jquery&&!r.isPlainObject(a))r.each(a,function(){e(this.name,this.value)});else for(c in a)N(c,a[c],b,e);return d.join("&").replace(ad,"+")};r.fn.extend({serialize:function(){return r.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=r.prop(this,"elements");return a?r.makeArray(a):
this}).filter(function(){var a=this.type;return this.name&&!r(this).is(":disabled")&&dd.test(this.nodeName)&&!cd.test(a)&&(this.checked||!ma.test(a))}).map(function(a,b){var c=r(this).val();return null==c?null:r.isArray(c)?r.map(c,function(a){return{name:b.name,value:a.replace(Qc,"\r\n")}}):{name:b.name,value:c.replace(Qc,"\r\n")}}).get()}});r.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var ed=0,nc={},fd={0:200,1223:204},bc=r.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",
function(){for(var a in nc)nc[a]()});qa.cors=!!bc&&"withCredentials"in bc;qa.ajax=bc=!!bc;r.ajaxTransport(function(a){var b;if(qa.cors||bc&&!a.crossDomain)return{send:function(c,d){var e,f=a.xhr(),g=++ed;f.open(a.type,a.url,a.async,a.username,a.password);if(a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType);a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&
(delete nc[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(fd[f.status]||f.status,f.statusText,"string"===typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}};f.onload=b();f.onerror=b("error");b=nc[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h;}},abort:function(){b&&b()}}});r.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},
converters:{"text script":function(a){r.globalEval(a);return a}}});r.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1);a.crossDomain&&(a.type="GET")});r.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=r("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove();c=null;a&&e("error"===a.type?404:200,a.type)});ha.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Rc=[],Ec=/(=)\?(?=&|$)|\?\?/;r.ajaxSetup({jsonp:"callback",
jsonpCallback:function(){var a=Rc.pop()||r.expando+"_"+Ac++;this[a]=!0;return a}});r.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=!1!==b.jsonp&&(Ec.test(b.url)?"url":"string"===typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ec.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=r.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Ec,"$1"+e):!1!==b.jsonp&&(b.url+=(Bc.test(b.url)?"&":"?")+b.jsonp+"="+
e),b.converters["script json"]=function(){g||r.error(e+" was not called");return g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f;b[e]&&(b.jsonpCallback=c.jsonpCallback,Rc.push(e));g&&r.isFunction(f)&&f(g[0]);g=f=void 0}),"script"});r.parseHTML=function(a,b,c){if(!a||"string"!==typeof a)return null;"boolean"===typeof b&&(c=b,b=!1);b=b||ha;var d=sb.exec(a);c=!c&&[];if(d)return[b.createElement(d[1])];d=r.buildFragment([a],b,c);c&&c.length&&r(c).remove();return r.merge([],
d.childNodes)};var Sc=r.fn.load;r.fn.load=function(a,b,c){if("string"!==typeof a&&Sc)return Sc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");0<=h&&(d=r.trim(a.slice(h)),a=a.slice(0,h));r.isFunction(b)?(c=b,b=void 0):b&&"object"===typeof b&&(e="POST");0<g.length&&r.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments;g.html(d?r("<div>").append(r.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])});return this};r.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),
function(a,b){r.fn[b]=function(a){return this.on(b,a)}});r.expr.filters.animated=function(a){return r.grep(r.timers,function(b){return a===b.elem}).length};var Tc=a.document.documentElement;r.offset={setOffset:function(a,b,c){var d,e,f,g=r.css(a,"position"),h=r(a),k={};"static"===g&&(a.style.position="relative");f=h.offset();e=r.css(a,"top");d=r.css(a,"left");("absolute"===g||"fixed"===g)&&-1<(e+d).indexOf("auto")?(d=h.position(),e=d.top,d=d.left):(e=parseFloat(e)||0,d=parseFloat(d)||0);r.isFunction(b)&&
(b=b.call(a,c,f));null!=b.top&&(k.top=b.top-f.top+e);null!=b.left&&(k.left=b.left-f.left+d);"using"in b?b.using.call(a,k):h.css(k)}};r.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){r.offset.setOffset(this,a,b)});var b,c;c=this[0];var d={top:0,left:0},e=c&&c.ownerDocument;if(e){b=e.documentElement;if(!r.contains(b,c))return d;"undefined"!==typeof c.getBoundingClientRect&&(d=c.getBoundingClientRect());c=ja(e);return{top:d.top+c.pageYOffset-b.clientTop,
left:d.left+c.pageXOffset-b.clientLeft}}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};"fixed"===r.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),r.nodeName(a[0],"html")||(d=a.offset()),d.top+=r.css(a[0],"borderTopWidth",!0),d.left+=r.css(a[0],"borderLeftWidth",!0));return{top:b.top-d.top-r.css(c,"marginTop",!0),left:b.left-d.left-r.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||
Tc;a&&!r.nodeName(a,"html")&&"static"===r.css(a,"position");)a=a.offsetParent;return a||Tc})}});r.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;r.fn[b]=function(e){return ka(this,function(b,e,f){var g=ja(b);if(void 0===f)return g?g[c]:b[e];g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f},b,e,arguments.length,null)}});r.each(["top","left"],function(a,b){r.cssHooks[b]=C(qa.pixelPosition,function(a,c){if(c)return c=A(a,b),ic.test(c)?r(a).position()[b]+
"px":c})});r.each({Height:"height",Width:"width"},function(a,b){r.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){r.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!==typeof d),g=c||(!0===d||!0===e?"margin":"border");return ka(this,function(b,c,d){return r.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(c=b.documentElement,Math.max(b.body["scroll"+a],c["scroll"+a],b.body["offset"+a],c["offset"+a],c["client"+a])):void 0===d?r.css(b,c,g):r.style(b,c,d,g)},b,
f?d:void 0,f,null)}})});r.fn.size=function(){return this.length};r.fn.andSelf=r.fn.addBack;"function"===typeof define&&define.amd&&define("jquery",[],function(){return r});var gd=a.jQuery,hd=a.$;r.noConflict=function(b){a.$===r&&(a.$=hd);b&&a.jQuery===r&&(a.jQuery=gd);return r};"undefined"===typeof b&&(a.jQuery=a.$=r);return r});var MicroEvent=function(){};
MicroEvent.prototype={bind:function(a,b){this._events=this._events||{};this._events[a]=this._events[a]||[];this._events[a].push(b)},unbind:function(a,b){this._events=this._events||{};!1!==a in this._events&&this._events[a].splice(this._events[a].indexOf(b),1)},trigger:function(a){this._events=this._events||{};if(!1!==a in this._events)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}};
MicroEvent.mixin=function(a){for(var b=["bind","unbind","trigger"],c=0;c<b.length;c++)a.prototype[b[c]]=MicroEvent.prototype[b[c]]};"undefined"!==typeof module&&"exports"in module&&(module.exports=MicroEvent);
function microAjax(a,b,c){this.bindFunction=function(a,b){return function(){return a.apply(b,[b])}};this.stateChange=function(a){4==this.request.readyState&&this.callbackFunction(this.request.responseText)};this.getRequest=function(){return window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest?new XMLHttpRequest:!1};this.postBody=c||"";this.callbackFunction=b;this.url=a;if(this.request=this.getRequest())b=this.request,b.onreadystatechange=this.bindFunction(this.stateChange,
this),""!==this.postBody?(b.open("POST",a,!0),b.setRequestHeader("X-Requested-With","XMLHttpRequest"),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),b.setRequestHeader("Connection","close")):b.open("GET",a,!0),b.send(this.postBody)}var \u03c0=Math.PI,\u03c4=2*\u03c0;(function(a){for(var b in a)if(!window[b])throw"Error: ThreeBox requires "+a[b];})({THREE:"Three.js",tQuery:"tQuery.js (bundle)"});window.ThreeBox={};
window.threeBox=function(a,b){!a||a instanceof Node||(b=a,a=null);return tQuery.createWorld(b).threeBox(a,b)};MicroEvent.prototype.on=function(){MicroEvent.prototype.bind.apply(this,arguments);return this};MicroEvent.prototype.emit=function(){MicroEvent.prototype.trigger.apply(this,arguments);return this};MicroEvent.mixin=function(a){for(var b=["bind","unbind","trigger","on","emit"],c=0;c<b.length;c++)a.prototype[b[c]]=MicroEvent.prototype[b[c]]};tQuery.World.prototype.on=tQuery.World.prototype.addEventListener;
tQuery.World.prototype.emit=tQuery.World.prototype.dispatchEvent;tQuery.World.registerInstance("threeBox",function(a,b){!a||a instanceof Node||(b=a,a=null);var c=a=a||document.body;a==document.body?(c.style.margin=0,c.style.padding=0,c.style.overflow="hidden"):(getComputedStyle(a),"static"==a.position&&(a.position="relative"));this.appendTo(c);this.addThreeBox(a,b||{});return this});
tQuery.World.registerInstance("addThreeBox",function(a,b){console.assert(!0!==this.hasThreeBox());b=tQuery.extend(b,{cameraControls:!1,cursor:!0,controlClass:ThreeBox.OrbitControls,elementResize:!0,fullscreen:!0,screenshot:!0,stats:!0,scale:1});this.tRenderer().domElement.style.display="block";var c={};tQuery.data(this,"_threeBoxContext",c);var d=this.tCamera(),e=this.tRenderer();b.stats&&(c.stats=new Stats,c.stats.domElement.style.position="absolute",c.stats.domElement.style.left="10px",c.stats.domElement.style.top=
"10px",a&&a.appendChild(c.stats.domElement),c.loopStats=function(){c.stats.update()},this.loop().hook(c.loopStats));if(b.cameraControls){var f=this.loop(),g=this.render.bind(this);c.cameraControls=new b.controlClass(d,a,b);if(c.cameraControls.on)c.cameraControls.on("change",function(){f._timerId||g()});this.setCameraControls(c.cameraControls)}b.elementResize&&(c.elementResize=ThreeBox.ElementResize.bind(e,d,a,b).on("resize",function(a,b){this._opts.renderW=a;this._opts.renderH=b;this.emit("resize",
a,b)}.bind(this)));null!==b.cursor&&(c.cursor=ThreeBox.Cursor.bind(a,b));THREEx&&THREEx.Screenshot&&b.screenshot&&(c.screenshot=THREEx.Screenshot.bindKey(e));THREEx&&THREEx.FullScreen&&b.fullscreen&&THREEx.FullScreen.available()&&(c.fullscreen=THREEx.FullScreen.bindKey());c._$onDestroy=this.bind("destroy",function(){!1!==this.hasThreeBox()&&this.removeThreeBox()});return this});tQuery.World.registerInstance("hasThreeBox",function(){return void 0===tQuery.data(this,"_threeBoxContext")?!1:!0});
tQuery.World.registerInstance("removeThreeBox",function(){var a=tQuery.data(this,"_threeBoxContext");if(void 0===a)return this;tQuery.removeData(this,"_threeBoxContext");this.unbind("destroy",this._$onDestroy);a.stats&&(document.body.removeChild(a.stats.domElement),this.loop().unhook(a.loopStats));a.cameraControls&&this.removeCameraControls()&&a.cameraControls.stop();a.elementResize&&a.elementResize.unbind();a.cursor&&a.cursor.unbind();a.screenshot&&a.screenshot.unbind();a.fullscreen&&a.fullscreen.unbind()});
ThreeBox.ElementResize=function(a,b,c,d){this.scale=d.scale||1;d=this.callback=function(){var d=Math.floor(c.offsetWidth),f=Math.floor(c.offsetHeight);a.domElement.style.position="absolute";a.domElement.style.width=d+"px";a.domElement.style.height=f+"px";var g=Math.floor(d/this.scale),h=Math.floor(f/this.scale);a.setSize(g,h);b.aspect=d/f;b instanceof THREE.OrthographicCamera&&(d=(b.top-b.bottom)/2,f=(b.left+b.right)/2,b.left=f-d*b.aspect,b.right=f+d*b.aspect);b.updateProjectionMatrix();this.emit("resize",
g,h)}.bind(this);window.addEventListener("resize",d,!1);c.addEventListener("resize",d,!1);setTimeout(d,0)};ThreeBox.ElementResize.bind=function(a,b,c,d){return new ThreeBox.ElementResize(a,b,c,d)};ThreeBox.ElementResize.prototype.scale=function(a){this.scale=a};ThreeBox.ElementResize.prototype.unbind=function(){window.removeEventListener("resize",callback);domElement.removeEventListener("resize",callback)};MicroEvent.mixin(ThreeBox.ElementResize);
ThreeBox.OrbitControls=function(a,b,c){this.element=b;this.camera=a;this.options=tQuery.extend(c,{phi:\u03c4/4,theta:.3,orbit:2,lookAt:[0,0,0],speed:2});this.init();this.start();this.update()};
ThreeBox.OrbitControls.prototype={init:function(){this.width=this.element&&this.element.offsetWidth;this.height=this.element&&this.element.offsetHeight;this.phi=this.options.phi;this.theta=this.options.theta;this.orbit=this.options.orbit;this.speed=this.options.speed;this.lookAt=new THREE.Vector3;this.lookAt.set.apply(this.lookAt,this.options.lookAt||[])},start:function(){var a=this;this._mouseDown=function(b){a.width=a.element&&a.element.offsetWidth;a.height=a.element&&a.element.offsetHeight;a.drag=
!0;a.lastHover=a.origin={x:b.pageX,y:b.pageY};b.preventDefault()};this._mouseUp=function(){a.drag=!1};this._mouseMove=function(b){if(a.drag){var c={x:b.pageX-a.origin.x,y:b.pageY-a.origin.y},d={x:b.pageX-a.lastHover.x,y:b.pageY-a.lastHover.y};a.lastHover={x:b.pageX,y:b.pageY};a.moved(a.origin,c,d)}};this.element&&(this.element.addEventListener("mousedown",this._mouseDown,!1),document.addEventListener("mouseup",this._mouseUp,!1),document.addEventListener("mousemove",this._mouseMove,!1))},stop:function(){this.element&&
(this.element.removeEventListener("mousedown",this._mouseDown),document.removeEventListener("mouseup",this._mouseUp),document.removeEventListener("mousemove",this._mouseMove))},moved:function(a,b,c){this.phi+=c.x*this.speed/this.width;this.theta=Math.min(\u03c0/2,Math.max(-\u03c0/2,this.theta+c.y*this.speed/this.height));this.emit("change")},update:function(){this.camera.position.x=Math.cos(this.phi)*Math.cos(this.theta)*this.orbit;this.camera.position.y=Math.sin(this.theta)*this.orbit;this.camera.position.z=
Math.sin(this.phi)*Math.cos(this.theta)*this.orbit;this.camera.position.addSelf?this.camera.position.addSelf(this.lookAt):this.camera.position.add(this.lookAt);this.camera.lookAt(this.lookAt)}};ThreeBox.OrbitControls.bind=function(a,b,c){return new ThreeBox.OrbitControls(a,b,c)};MicroEvent.mixin(ThreeBox.OrbitControls);
ThreeBox.Cursor=function(a,b){function c(){f||(a.style.cursor=d);clearTimeout(e);f=!1;e=setTimeout(function(){f=!0;a.style.cursor="none"},2E3)}var d=b.cameraControls?"move":"default",e=null,f=!1;b.cursor?a.style.cursor=d:(a.addEventListener("mousemove",c),a.style.cursor="none");return{unbind:function(){a.removeEventListener("mousemove",c)}}};ThreeBox.Cursor.bind=function(a,b){return ThreeBox.Cursor(a,b)};
ThreeBox.preload=function(a,b){a instanceof Function&&(b=a,a=[]);a="string"==typeof a?[a]:a;var c=a.length,d={},e=function(a){_.extend(d,a||{});0==--c&&b(d)},f=ThreeBox.preload,g={},h={html:f.html,jpg:f.image,png:f.image,gif:f.image,mp3:f.audio};_.each(h,function(a,b){g[b]=new RegExp("\\."+b+"$")});_.each(a,function(a){_.each(h,function(b,c){if(a.match(g[c])){var d=a.split(/\//g).pop().replace(/\.[A-Za-z0-9]+$/,"");b(a,d,e)}})})};
ThreeBox.preload.html=function(a,b,c){new microAjax(a,function(b){for(var e;e=b.match(/^(<script\s*>|<script[^>]*type=['"]text\/javascript['"][^>]*>)([\s\S]+?)<\/script>$/m);){try{eval("(function () {"+e[2]+"})()")}catch(f){console.error(f),console.error("While evaluating: "+e[2])}b=b.replace(e[0],"")}""!=b.replace(/\s*/g)&&(e=document.createElement("div"),e.innerHTML=b,document.body.appendChild(e));console.log("Loaded HTML ",a);c()})};
ThreeBox.preload.image=function(a,b,c){THREE.ImageUtils.loadTexture(a,null,function(d){var e={};e[b]=d;console.log("Loaded texture ",a);c(e)})};ThreeBox.preload.audio=function(a,b,c){var d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType="arraybuffer";d.onload=function(){var e={};e[b]=d.response;console.log("Loaded audio ",a);c(e)};d.send()};(function(a){for(var b in a)if(!window[b])throw"Error: ThreeRTT requires "+a[b];})({THREE:"Three.js"});window.ThreeRTT=window.ThreeRTT||{};
ThreeRTT.World=function(){};ThreeRTT.getShader=function(a){var b=document.getElementById(a);return b&&b.innerText||a};ThreeRTT.loop=function(a,b){for(var c=0;c<a;++c)b(c)};ThreeRTT.getShader=function(a){var b=document.getElementById(a);return b&&(b.innerText||b.textContent)||a};ThreeRTT.isPowerOfTwo=function(a){return 0===(a&a-1)};ThreeRTT.toTarget=function(a){return ThreeRTT.Stage&&a instanceof ThreeRTT.Stage?a.target:ThreeRTT.World&&a instanceof ThreeRTT.World?a.target():a};
ThreeRTT.toTexture=function(a,b){a=ThreeRTT.toTarget(a);return ThreeRTT.RenderTarget&&a instanceof ThreeRTT.RenderTarget?a.read():a};MicroEvent.prototype.on=function(){MicroEvent.prototype.bind.apply(this,arguments);return this};MicroEvent.prototype.emit=function(){MicroEvent.prototype.trigger.apply(this,arguments);return this};MicroEvent.mixin=function(a){for(var b=["bind","unbind","trigger","on","emit"],c=0;c<b.length;c++)a.prototype[b[c]]=MicroEvent.prototype[b[c]]};
ThreeRTT.Stage=function(a,b){b=_.extend({history:0,camera:{},scene:null},b);b.camera.aspect=b.camera.aspect||b.width/b.height;this.camera=ThreeRTT.Camera(b.camera);this.target=new ThreeRTT.RenderTarget(a,b);this.reset();this.size(b.width,b.height)};
ThreeRTT.Stage.prototype={options:function(){return this.target.options},reset:function(){this.scenes=[];this.passes=[]},paint:function(a,b){var c=new THREE.Scene;if(!b){var d=new ThreeRTT.FragmentMaterial(this,"generic-fragment-texture"),d=this._surface(d);c.add(d)}c.add(a);this.scenes.push(c);this.passes.push(1)},iterate:function(a,b){var c=this._surface(b),d=new THREE.Scene;d.add(c);this.scenes.push(d);this.passes.push(a);return this},fragment:function(a){this.iterate(1,a);return this},size:function(a,
b){a=Math.floor(a);b=Math.floor(b);this.camera.aspect=a/b;this.camera.updateProjectionMatrix();this.target.size(a,b);return this},read:function(a){return this.target.read(a)},uniform:function(){return this.target.uniform()},render:function(){this.target.clear();_.each(this.passes,function(a,b){ThreeRTT.loop(a,function(a){this.target.render(this.scenes[b],this.camera)}.bind(this))}.bind(this));return this},clear:function(){this.target.clear();return this},destroy:function(){this.target.deallocate();
this.scenes=[];this.passes=[];this.target=this.camera=null},_surface:function(a){var b=new THREE.Mesh(new ThreeRTT.ScreenGeometry,{});b.frustumCulled=!1;b.material=a;b.renderDepth=Infinity;return b}};ThreeRTT.Compose=function(a,b,c,d){THREE.Object3D.call(this);a=new ThreeRTT.FragmentMaterial(a,b,c,d);b=new ThreeRTT.ScreenGeometry;a=this.mesh=new THREE.Mesh(b,a);a.frustumCulled=!1;this.add(a)};ThreeRTT.Compose.prototype=new THREE.Object3D;
ThreeRTT.Camera=function(a){if(a instanceof THREE.Camera)return a;a=_.extend({aspect:1,far:1E4,fov:85,near:.01,ortho:!1,scale:1},a);if(a.ortho){var b=a.scale,c=a.aspect;return new THREE.OrthographicCamera(-b*c,b*c,-b,b,a.near,a.far)}return new THREE.PerspectiveCamera(a.fov,a.aspect,a.near,a.far)};
ThreeRTT.RenderTarget=function(a,b){this.options=b=_.extend({width:256,height:256,texture:{},clear:{color:!1,depth:!1,stencil:!1},clearColor:16777215,clearAlpha:1,history:0,scene:null,camera:null,autoAdvance:!0},b);this.renderer=a;ThreeRTT.isPowerOfTwo(b.width)&&ThreeRTT.isPowerOfTwo(b.height)||b.texture.minFilter||(b.texture.minFilter=THREE.LinearFilter);this.history(this.options.history,!0);this.size(b.width,b.height);this.clear()};
ThreeRTT.RenderTarget.prototype={read:function(a){a=Math.max(0,Math.min(this.options.history,Math.abs(a||0)));return this.virtuals[a]},write:function(){return this.targets[this.index]},history:function(a,b){void 0!==a&&(this._history=a,this.buffers=a+2,b||this.allocate());return this._history},size:function(a,b){void 0!==a&&void 0!==b&&(this.width=Math.max(1,Math.floor(a)),this.height=Math.max(1,Math.floor(b)),this.allocate());return{width:this.width,height:this.height}},deallocate:function(){this.deallocateTargets()},
allocate:function(){this.deallocateTargets();this.allocateTargets();this.allocateVirtuals()},deallocateTargets:function(){_.each(this.targets||[],function(a){a.dispose&&a.dispose()}.bind(this))},allocateTargets:function(){var a=this.options;n=this.buffers;var b=this.targets=[];ThreeRTT.loop(n,function(c){b.push(new THREE.WebGLRenderTarget(this.width,this.height,a.texture));b[c].__index=c}.bind(this))},allocateVirtuals:function(){var a=this.targets[0],b=this.virtuals||[];n=Math.max(1,this.buffers-
1);n>b.length?ThreeRTT.loop(n-b.length,function(){b.push(a.clone())}.bind(this)):b=b.slice(0,n);_.each(b,function(a,b){a.width=this.width;a.height=this.height;a.__index=b}.bind(this));this.virtuals=b;this.index=-1;this.advance()},advance:function(){var a=this.targets,b=this.virtuals,c=this.index,d=this.buffers,e=b.length;this.index=c=(c+1)%d;ThreeRTT.loop(e,function(f){var g=b[f];f=a[(e-f+c)%d];g.__webglTexture=f.__webglTexture;g.__webglFramebuffer=f.__webglFramebuffer;g.__webglRenderbuffer=f.__webglRenderbuffer;
g.__index=f.__index})},clear:function(){var a=this.options,b=a.clear,c=this.renderer,d=c.getClearColor().clone(),e=c.getClearAlpha();c.setClearColor(a.clearColor,a.clearAlpha);c.clearTarget(this.write(),b.color,b.depth,b.stencil);c.setClearColor(d,e)},render:function(a,b){this.emit("render",a,b);var c=this.renderer.autoClear;this.renderer.autoClear=!1;this.clear();this.renderer.render(a,b,this.write());this.renderer.autoClear=c;this.options.autoAdvance&&this.advance()},uniform:function(a){var b=this.history();
if(b){var c=[];ThreeRTT.loop(b+1,function(a){c.push(this.read(-a))}.bind(this));return{type:"tv",value:c,count:b+1}}return{type:"t",value:a,texture:this.read(),count:1}}};MicroEvent.mixin(ThreeRTT.RenderTarget);ThreeRTT.ScreenGeometry=function(){return new THREE.PlaneGeometry(2,2,1,1)};
ThreeRTT.ShaderMaterial=function(a,b,c,d,e){if(d instanceof Array){var f={};_.each(d,function(a,b){f["texture"+(i+1)]=a});d=f}else if(d instanceof THREE.Texture||d instanceof ThreeRTT.World||d instanceof THREE.WebGLRenderTarget)d={texture1:d};a instanceof Array||(a=[a]);a=_.map(a,function(a){return ThreeRTT.toTarget(a)});e=_.extend(e||{},{sampleStep:{type:"v2",value:new THREE.Vector2}});_.each(d,function(a,b){e[b]={type:"t",value:ThreeRTT.toTexture(a)}});_.each(a,function(a,b){var c="texture"+(b+
1);a.read&&!e[c]&&(e[c]={type:"t",value:a.read()})});e.texture1&&!e.texture&&(e.texture=e.texture1);a[0].on("render",function(){var b=a[0].options.texture,c=b.wrapT,d={1E3:0,1001:1,1002:0},f=e.sampleStep.value;f.x=1/(a[0].width-(d[b.wrapS]||0));f.y=1/(a[0].height-(d[c]||0))});return new THREE.ShaderMaterial({uniforms:e,vertexShader:ThreeRTT.getShader(b||"generic-vertex"),fragmentShader:ThreeRTT.getShader(c||"generic-fragment-texture")})};
ThreeRTT.FragmentMaterial=function(a,b,c,d){a=new ThreeRTT.ShaderMaterial(a,"generic-vertex-screen",b,c,d);a.side=THREE.DoubleSide;a.depthTest=!1;a.depthWrite=!1;a.transparent=!0;a.blending=THREE.NoBlending;return a};
ThreeRTT.ScaleMaterial=function(a,b,c){var d={};a=ThreeRTT.toTarget(a);b=ThreeRTT.toTarget(b);d=_.extend(d,{sampleAlignment:{type:"v2",value:new THREE.Vector2},texture:{type:"t",value:a.read()}});b.on("render",function(){var e=a,g=b,h=g.height*c/e.height,k=d.sampleAlignment.value;k.x=g.width*c/e.width;k.y=h});var e=new THREE.ShaderMaterial({uniforms:d,vertexShader:ThreeRTT.getShader("rtt-vertex-downsample"),fragmentShader:ThreeRTT.getShader("generic-fragment-texture")});e.side=THREE.DoubleSide;e.depthTest=
!1;e.depthWrite=!1;e.transparent=!0;e.blending=THREE.NoBlending;return e};ThreeRTT.DownsampleMaterial=function(a,b){return new ThreeRTT.ScaleMaterial(a,b,2)};ThreeRTT.UpsampleMaterial=function(a,b){return new ThreeRTT.ScaleMaterial(a,b,.5)};
ThreeRTT.RaytraceMaterial=function(a,b,c,d,e){a instanceof Array||(a=[a]);c=new ThreeRTT.ShaderMaterial(a,"raytrace-vertex-screen",c,d,e);e=_.extend(c.uniforms||{},{raytraceViewport:{type:"v2",value:new THREE.Vector2},raytracePosition:{type:"v3",value:new THREE.Vector3},raytraceMatrix:{type:"m4",value:new THREE.Matrix4}});a=ThreeRTT.toTarget(a[0]);var f=new THREE.Vector3;a.on("render",function(a){b.updateMatrixWorld();b.fov&&(a=Math.tan(b.fov*\u03c0/360),e.raytraceViewport.value.set(a*b.aspect,a));
b.matrixWorld&&(e.raytraceMatrix.value.copy(b.matrixWorld),e.raytraceMatrix.value.setPosition(f),e.raytracePosition.value.getPositionFromMatrix(b.matrixWorld))});return c};ThreeRTT.Display=function(a,b,c){a instanceof Array||(a=[a]);this.gx=b||a.length;this.gy=c||1;this.targets=a;this.n=a.length;THREE.Object3D.call(this);this.make()};
ThreeRTT.Display.prototype=_.extend(new THREE.Object3D,{make:function(){for(var a=this.n,b=this.gx,c=this.gy,d=this.targets,e=(b-1)/2,f=(c-1)/2,g=new THREE.PlaneGeometry(1,1,1,1),h=0,k=0;h<a&&k<c;++k)for(var l=0;h<a&&l<b;++l,++h){var m=new THREE.MeshBasicMaterial({color:16777215,map:ThreeRTT.toTexture(d[h]),fog:!1});m.side=THREE.DoubleSide;m=new THREE.Mesh(g,m);m.renderDepth=1E4+Math.random();this.add(m);1<b&&(m.position.x=-e+l);1<c&&(m.position.y=f-k)}}});
ThreeRTT.World=function(a,b){b=b||{};b=_.extend({autoRendering:!0,autoSize:!(b.width&&b.height),order:++ThreeRTT.World.sequence,scale:1},b);b.width=!b.autoSize&&b.width||(a._opts&&a._opts.renderW||256)/b.scale;b.height=!b.autoSize&&b.height||(a._opts&&a._opts.renderH||256)/b.scale;a.on("resize",function(a,d){b.autoSize&&(a/=b.scale,d/=b.scale,this.size(a,d))}.bind(this));this._options=b;this._world=a;this._autoRendering=b.autoRendering;this._renderer=a.tRenderer();this._stage=new ThreeRTT.Stage(this._renderer,
b);this._tScene=this._stage.scene;this._tCamera=this._stage.camera;this.queue=ThreeRTT.RenderQueue.bind(a);b.autoRendering&&this.queue.add(this);this.size(b.width,b.height,!0)};ThreeRTT.World.sequence=1E5;
ThreeRTT.World.prototype=_.extend(new THREE.Object3D,tQuery.World.prototype,{stage:function(){return this._stage},target:function(){return this._stage.target},autoSize:function(a){void 0!==a&&(this._options.autoSize=a);return this._options.autoSize},adjust:function(a){var b=this._options.scale,c=this._options.width,d=this._options.height;this._options.autoSize&&(d=this._world._opts,c=d.renderW,d=d.renderH);c/=b;d/=b;this._opts={renderW:c,renderH:d};a||this._stage.size(c,d)},scale:function(a){return a?
(this._options.scale=a,this.adjust(),this):this._options.scale},size:function(a,b,c){return a&&b?(this._options.width=a,this._options.height=b,this.adjust(c),this):{width:this._options.width,height:this._options.height}},options:function(){return this._stage.options()},reset:function(){this._stage.reset();return this},paint:function(a,b){this._stage.paint(a,b);return this},iterate:function(a,b,c,d){b=b instanceof THREE.Material?b:tQuery.createFragmentMaterial(this,b,c,d);this._stage.iterate(a,b);
return this},shader:function(a,b,c,d){a=a instanceof THREE.Material?a:tQuery.createShaderMaterial(this,a,b,c,d);this._stage.fragment(a);return this},fragment:function(a,b,c){a=a instanceof THREE.Material?a:tQuery.createFragmentMaterial(this,a,b,c);this._stage.fragment(a);return this},raytrace:function(a,b,c,d){a=b instanceof THREE.Material?b:tQuery.createRaytraceMaterial(this,a,b,c,d);this._stage.fragment(a);return this},downsample:function(a){if(!a.autoSize()){var b=a.size();this._options.width=
b.width;this._options.height=b.height}b=a.scale();this.scale(2*b);a=tQuery.createDownsampleMaterial(a,this);this._stage.fragment(a);return this},upsample:function(a){if(!a.autoSize()){var b=a.size();this._options.width=b.width;this._options.height=b.height}b=a.scale();this.scale(.5*b);a=tQuery.createUpsampleMaterial(a,this);this._stage.fragment(a);return this},read:function(a){return this._stage.read(a)},uniform:function(){return this._stage.uniform()},render:function(){this._stage.render();return this},
destroy:function(){this._stage.destroy();this._stage=null;this.queue.remove(this);this.trigger("destroy");return this}});tQuery.pluginsInstanceOn(ThreeRTT.World);tQuery.MicroeventMixin(ThreeRTT.World.prototype);ThreeRTT.RenderQueue=function(a){this.world=a;this.queue=[];this.callback=null;this.renderer=a.tRenderer()};
ThreeRTT.RenderQueue.prototype={add:function(a){this.queue.push(a);this.sort();this.init()},remove:function(a){this.queue.splice(this.queue.indexOf(a),1);this.cleanup()},init:function(){var a=this.queue,b=this.world;a.length&&!this.callback&&b.loop().hookPreRender(this.callback=function(){_.each(a,function(a){a.render()})})},cleanup:function(){var a=this.world;!this.queue.length&&this.callback&&(a.loop().unhookPreRender(this.callback),this.callback=null)},sort:function(){this.queue.sort(function(a,
b){return a.order-b.order})}};ThreeRTT.RenderQueue.bind=function(a){return a.__rttRenderQueue?a.__rttRenderQueue:a.__rttRenderQueue=new ThreeRTT.RenderQueue(a)};tQuery.World.registerInstance("rtt",function(a){return tQuery.createRTT(this,a)});tQuery.World.registerInstance("compose",function(a,b,c,d){a=tQuery.createComposeRTT(a,b,c,d);this.add(a);return a});tQuery.World.registerInstance("display",function(a,b,c){a=tQuery.createDisplayRTT(a,b,c);this.add(a);return a});
tQuery.registerStatic("createRTT",function(a,b){return new ThreeRTT.World(a,b)});tQuery.registerStatic("createComposeRTT",function(a,b,c,d){return new ThreeRTT.Compose(a,b,c,d)});tQuery.registerStatic("createDisplayRTT",function(a,b,c){return new ThreeRTT.Display(a,b,c)});tQuery.registerStatic("createShaderMaterial",function(a,b,c,d,e){return new ThreeRTT.FragmentMaterial(a,b,c,d,e)});tQuery.registerStatic("createFragmentMaterial",function(a,b,c,d){return new ThreeRTT.FragmentMaterial(a,b,c,d)});
tQuery.registerStatic("createRaytraceMaterial",function(a,b,c,d,e){return new ThreeRTT.RaytraceMaterial(a,b,c,d,e)});tQuery.registerStatic("createDownsampleMaterial",function(a,b){return new ThreeRTT.DownsampleMaterial(a,b)});tQuery.registerStatic("createUpsampleMaterial",function(a,b){return new ThreeRTT.UpsampleMaterial(a,b)});tQuery.registerStatic("createScaleMaterial",function(a,b,c){return new ThreeRTT.DownsampleMaterial(a,b,c)});
(function(a){for(var b in a)if(!window[b])throw"Error: ShaderGraph requires "+a[b];})({THREE:"Three.js"});window.ShaderGraph={};ShaderGraph.getShader=function(a){var b=document.getElementById(a);return b&&(b.innerText||b.textContent)||a};
(function(a){a.Block=function(b){b=b||new a.Node;this.node(b);this.children=[];this.parent=null;this.properties={};this.index=++a.Block.index;this.refresh()};a.Block.index=0;a.Block.prototype={node:function(a){return void 0!==a?(this._node=a,this):this._node},refresh:function(){this._node.owner(this);this._node.outlets(this.outlets())},fetch:function(a,c,d,e){},id:function(b,c,d,e){if(d.meta.inout){var f=d.node.get(d.name,a.IN).input;if(f)return f.node.owner().fetch(b,c,f,e+1)}return d.id()}};a.Block.Snippet=
function(b){this.snippet=new a.Snippet(b);a.Block.call(this)};a.Block.Snippet.prototype=_.extend({},a.Block.prototype,{insert:function(b,c,d){a.Block.Snippet.compileCall(b,c,this.node(),this.snippet,d)},fetch:function(a,c,d,e){a.include(this,c)||this.insert(a,c,e);return this.id(a,c,d,e)},outlets:function(){return a.Block.Snippet.makeOutlets(this.snippet)}});a.Block.Material=function(b,c){this.vertex=new a.Snippet(b);this.fragment=new a.Snippet(c);a.Block.call(this)};a.Block.Material.prototype=_.extend({},
a.Block.prototype,{compile:function(){if(0<this.node().outputs.length)throw"Can't compile material with outputs";this.node();var b=new a.Program;this.insert(b,"vertex",0);this.insert(b,"fragment",0);b.compile();return b},insert:function(b,c,d){a.Block.Snippet.compileCall(b,c,this.node(),this[c],d)},fetch:function(a,c,d,e){a.include(this,c)||this.insert(a,c,e);"fragment"==c&&(a.include(this,"vertex")||this.insert(a,"vertex",0));return this.id(a,c,d,e)},outlets:function(){var b=a.Block.Snippet.makeOutlets(this.vertex),
c=a.Block.Snippet.makeOutlets(this.fragment);return _.union(b,c)}});a.Block.Snippet.makeOutlets=function(b){var c=[];if(b.outlets)return b.outlets;var d=b.arguments();_.each(d.parameters,function(b){b=_.extend({},b);b.meta={required:!0};b.hint=b.name.replace(/(In|Out)$/,"");b.category="parameter";if(b.inout==a.INOUT){b.meta.inout=!0;var d=_.extend({},b);d.inout=a.IN;c.push(d);b.inout=a.OUT}c.push(b)});_.each(d.uniforms,function(b){b.meta={};b.hint=b.name.replace(/(In|Out)$/,"");b.category="uniform";
b.inout=a.IN;c.push(b)});return b.outlets=c};a.Block.Snippet.compileCall=function(b,c,d,e,f){var g=e.arguments(),h=[];_.each(g.parameters,function(e){var g=d.get(e.name,e.inout==a.INOUT?a.IN:e.inout);if(e.inout==a.IN||e.inout==a.INOUT)if(g.input)g=g.input.node.owner().fetch(b,c,g.input,f+1),b.variable(c,g,e),h.push(g);else throw console.log("Outlet",e,input),["Missing connection on outlet for "+e.name];else e.inout==a.OUT&&(g=g.id(),b.variable(c,g,e),h.push(g))});var k=[];_.each(g.uniforms,function(a){var e=
d.get(a.name);e.input?(e=e.input.node.owner().fetch(b,c,e.input,f+1),b.variable(c,e,a),h.push(e),k.push(a.name)):b.external("uniform",a)});_.each(g.attributes,function(a){b.external("attribute",a)});_.each(g.varyings,function(a){b.external("varying",a)});g=["_sg",c,e.name,d.owner().index].join("_");e=e.compile(g,k,!0);b.add(c,g,h,e,f)}})(ShaderGraph);
(function(a){a.Factory=function(){this.end()};a.Factory.prototype={snippet:function(b,c){c=c||"append";var d=new a.Block.Snippet(ShaderGraph.getShader(b));this[c](d.node());return this},material:function(b,c,d){d=d||"append";b=new a.Block.Material(ShaderGraph.getShader(b),ShaderGraph.getShader(c));this[d](b.node());return this},snippetBefore:function(a){this.snippet(a,"prepend");return this},materialBefore:function(a,c){this.material(code,"prepend");return this},append:function(a){a.graph||this.graph.add(a);
var c=this.stack[0];_.each(c.end,function(c){c.connect(a)});c.start.length||(c.start=[a]);c.end=[a];return this},prepend:function(a){a.graph||this.graph.add(a);var c=this.stack[0];_.each(c.start,function(c){a.connect(c)});c.end.length||(c.end=[a]);c.start=[a];return this},group:function(){this.stack.unshift({start:[],end:[]});this.stack.unshift({start:[],end:[]});return this},pass:function(){this.next();this.stack[0].start.push(null);return this.combine()},next:function(){var a=this.stack.shift(),
c=this.stack[0];c.start=c.start.concat(a.start);c.end=c.end.concat(a.end);this.stack.unshift({start:[],end:[]});return this},combine:function(){if(2>=this.stack.length)throw"Popping factory stack too far.";this.next();this.stack.shift();var a=this.stack.shift(),c=this.stack[0];a.start.length&&(_.each(a.start,function(d){d?_.each(c.end,function(a){a.connect(d,!0)}):a.end=a.end.concat(c.end)}),c.end=a.end);return this},end:function(){var b=this.graph;this.graph=new a.Graph;this.stack=[];this.group();
b&&(b.compile=function(){return b.tail().owner().compile()});return b}}})(ShaderGraph);
(function(a){a.Program=function(){this.calls={vertex:{},fragment:{}};this.variables={vertex:{},fragment:{}};this.externals={};this.compiled=!1;this.attributes={};this.uniforms={};this.fragmentShader=this.vertexShader="";this.includes={vertex:[],fragment:[]}};a.Program.types={f:"float",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4",t:"sampler2D"};a.Program.prototype={include:function(a,c){if(0<=this.includes[c].indexOf(a))return!0;this.includes[c].push(a);return!1},external:function(a,c){c=_.extend({category:a},
c);this.externals[c.name]=c},variable:function(a,c,d){d=_.extend({},d,{name:c});this.variables[a][c]=d},add:function(a,c,d,e,f){var g=this.calls[a][c];g?g.priority=Math.min(g.priority,f):this.calls[a][c]={name:c,args:d,code:e,priority:f}},compile:function(){_.each(this.externals,function(a){"uniform"==a.category&&(this.uniforms[a.name]={type:a.type,value:a.value});"attribute"==a.category&&(this.attributes[a.name]={type:a.type,value:[]})}.bind(this));_.each(["vertex","fragment"],function(b){var c=
[];_.each(this.externals,function(a){"attribute"==a.category&&"fragment"==b||c.push([a.category,a.signature,";"].join(" "))}.bind(this));var c=c.join("\n"),d=_.toArray(this.calls[b]),e=[c],f=["void main() {"];_.each(this.variables[b],function(b){f.push([a.Program.types[b.type],b.name,";"].join(" "))});d.sort(function(a,b){return b.priority-a.priority});_.each(d,function(a){e.push(a.code);f.push([a.name,"(",a.args.join(","),");"].join(""))});f.push("}");this[b+"Shader"]=[e.join("\n"),f.join("\n")].join("\n")}.bind(this));
this.compiled=!0},material:function(){if(!this.compiled)throw"Fetching material from uncompiled program.";return new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertex,fragmentShader:this.fragment})}}})(ShaderGraph);
(function(a){a.Snippet=function(b){if(a.Snippet.cache[b])return a.Snippet.cache[b];a.Snippet.cache[b]=this;this.code=b;this.attributes=[];this.uniforms=[];this.varyings=[];this.parameters=[];this.body=this.signature="";this.parseCode(b)};a.Snippet.cache={};a.Snippet.types={"float":"f",vec2:"v2",vec3:"v3",vec4:"v4",mat3:"m3",mat4:"m4",sampler2D:"t",samplerCube:"t"};a.Snippet.defaults={"float":0,vec2:new THREE.Vector3,vec3:new THREE.Vector3,vec4:new THREE.Vector4,mat4:new THREE.Matrix4,sampler2D:0,
samplerCube:0};a.Snippet.prototype={compile:function(a,c,d){var e=this.signature.slice(),f=[];c=c||[];_.each(this.uniforms,function(a){0<=c.indexOf(a.name)?e.push(a.signature):d||f.push(["uniform",a.signature].join(" "))});!d&&_.each(this.attributes,function(a){f.push(["attribute",a.signature].join(" "))});!d&&_.each(this.varyings,function(a){f.push(["varying",a.signature].join(" "))});a=this.body.replace(/\s*void\s+([A-Za-z0-9]+)\s*\([^\)]*\)/g,["void",a+"(",e.join(", "),")"].join(" "));f.push(a);
return f.join(";\n")},arguments:function(){return{uniforms:this.uniforms,varyings:this.varyings,attributes:this.attributes,parameters:this.parameters}},type:function(b,c){b=(a.Snippet.types[b]||"f")+(c?"v":"");return"fv"==b?"fv1":b},parseAttribute:function(a){var c=a[1];this.attributes.push({name:a[3],type:this.type(a[2],a[4]),signature:c})},parseUniform:function(b){var c=b[1],d=b[2];this.uniforms.push({name:b[3],type:this.type(d,b[4]),value:a.Snippet.defaults[d]||0,signature:c})},parseVarying:function(a){var c=
a[1];this.varyings.push({name:a[3],type:this.type(a[2],a[4]),signature:c})},parseSignature:function(b){this.name=b[1];var c=b[2].replace(/^\s*$/g,"");0==c.length?this.signature=[]:(arguments=this.signature=c.split(","),_.each(arguments,function(b){b=/((?:(in|out|inout)\s+)?([A-Za-z0-9]+)\s+([A-Za-z0-9_]+)\s*(?:\[([^\]]+)\])?)(?:$|(?=;))/.exec(b);var c=b[1];this.parameters.push({inout:{"in":a.IN,out:a.OUT,inout:a.INOUT}[b[2]||"in"],name:b[4],type:this.type(b[3],b[5]),signature:c})}.bind(this)))},parseCode:function(a){function c(a,
b){if(!a.global)throw"Can't findAll non-global regexp";for(var c,d=[];c=a.exec(b);)d.push(c);return d}a=a.replace(/\r\n?/g,"\n").replace(/\/\/[^\n]*\n/g," ").replace(/\/\*(.|\n)*?\*\//g," ");var d=c(/(?:^|;)\s*attribute\s+(([A-Za-z0-9]+)\s+([A-Za-z0-9_]+)\s*(?:\[([^\]]+)\])?)(?:$|(?=;))/g,a),e=c(/(?:^|;)\s*uniform\s+(([A-Za-z0-9]+)\s+([A-Za-z0-9_]+)\s*(?:\[([^\]]+)\])?)(?:$|(?=;))/g,a),f=c(/(?:^|;)\s*varying\s+(([A-Za-z0-9]+)\s+([[A-Za-z0-9_]+)\s*(?:\[([^\]]+)\])?)(?:$|(?=;))/g,a),g=c(/(?:^|;)\s*void\s+([A-Za-z0-9]+)\s*\(([^\)]*)\)\s*{/g,
a);if(!g[0])throw"Could not parse shader snippet. Must contain a void-returning function with in/outs: "+a;var h=a;_.each({parseAttribute:d,parseUniform:e,parseVarying:f},function(a,b){_.each(a,function(a){this[b](a);h=h.replace(a[0],"")}.bind(this))}.bind(this));h=h.replace(/^\s*;/,"");this.parseSignature(g[0]);this.body=h}}})(ShaderGraph);
(function(a){a.Graph=function(a,c){this.parent=c||null;this.nodes=[];a&&this.add(a)};a.Graph.prototype={iterate:function(a){_.each(this.nodes,function(c){a(c,c._owner)})},exposed:function(){var a=[];this.iterate(function(c){_.each(c.outlets(),function(c){c.exposed&&a.push(c)})});return a},inputs:function(){var a=[];this.iterate(function(c){_.each(c.inputs,function(c){null==c.input&&a.push(c)})});return a},outputs:function(){var a=[];this.iterate(function(c){_.each(c.outputs,function(c){0==c.output.length&&
a.push(c)})});return a},tail:function(){return this.nodes[this.nodes.length-1]},add:function(a){if(a.constructor==Array)return _.each(a,function(a){this.add(a)}.bind(this));if(a.graph)throw"Adding node to two graphs at once";a.link(this);this.nodes.push(a)},remove:function(a,c){var d=this;if(a.constructor==Array)return _.each(a,function(a){d.remove(a)});if(a.graph!=this)throw"Removing node from wrong graph.";c||a.disconnect();this.nodes.splice(this.nodes.indexOf(a),1)}};a.IN=0;a.OUT=1;a.INOUT=2})(ShaderGraph);
(function(a){a.Node=function(a,c){this.graph=null;this.inputs=[];this.outputs=[];this._outlets={};this.owner(a);this.outlets(c)};a.Node.prototype={owner:function(a){return void 0!==a?(this._owner=a,this):this._owner},link:function(a){this.graph=a},getIn:function(b){return this.get(b,a.IN)},getOut:function(b){return this.get(b,a.OUT)},get:function(b,c){return void 0===c?this.get(b,a.IN)||this.get(b,a.OUT):this._outlets[[b,c].join("-")]},key:function(a){return[a.name,a.inout].join("-")},outlets:function(b){if(void 0!==
b){var c={};_.each(b,function(a){c[[a.name,a.inout,a.type].join("-")]=!0}.bind(this));_.each(this._outlets,function(a){c[[a.name,a.inout,a.type].join("-")]||this.remove(a)}.bind(this));_.each(b,function(b){var c=this.get(b.name,b.inout);c?c.morph(b):(b=new a.Outlet(b),this.add(b))}.bind(this));return this}return this._outlets},add:function(b){var c=this.key(b);outlets=this._outlets;_in=this.inputs;_out=this.outputs;if(b.node)throw"Adding outlet to two nodes at once.";if(outlets[c])throw"Adding two identical outlets to same node.";
b.link(this);outlets[c]=b;(b.inout==a.IN?_in:_out).push(b);return this},remove:function(b){var c=this._outlets,d=this.key(b),e=b.inout==a.IN?this.inputs:this.outputs;if(b.node!=this)throw"Removing outlet from wrong node.";b.disconnect();b.link(null);delete c[d];e.splice(e.indexOf(b),1);return this},connect:function(a,c,d){var e={},f={};_.each(a.inputs,function(a){if(d||!a.input){var b=a.type,c=[b,a.hint].join("-");f[c]||(f[c]=a);e[b]=e[b]||[];e[b].push(a)}});_.each(this.outputs,function(a){if(!c||
!a.output.length){var b=a.type,d=[b,a.hint].join("-");f[d]?(f[d].connect(a),delete f[d],e[b].splice(e[b].indexOf(a),1)):e[b]&&e[b].length&&e[b].shift().connect(a)}});return this},disconnect:function(a){_.each(this.inputs,function(a){a.disconnect()});_.each(this.outputs,function(a){a.disconnect()});return this}}})(ShaderGraph);
(function(a){a.Outlets=0;a.Outlet=function(b,c,d,e,f,g,h){if("object"==typeof b)return new a.Outlet(b.inout,b.name,b.hint,b.type,b.category,b.exposed,b.meta);this.node=null;this.inout=b;this.name=c;this.hint=d||c;this.type=e;this.category=f;this.exposed=!!g;this.meta=h||{};this.index=++a.Outlets;this.input=this.key=null;this.output=[]};a.Outlet.prototype={id:function(){return["_sg",this.name,this.index].join("_")},expose:function(a){this.exposed=a},morph:function(a){this.inout=a.inout;this.name=a.name;
this.type=a.type;this.category=a.category;this.exposed=a.exposed;this.meta=a.meta||{}},connect:function(b){if(this.inout==a.IN&&b.inout==a.OUT)return b.connect(this);if(this.inout!=a.OUT||b.inout!=a.IN)throw console.log(this,b),"Can't connect out/out or in/in outlets.";b.input!=this&&(b.disconnect(),b.input=this,this.output.push(b))},disconnect:function(b){if(this.inout==a.IN)this.input&&this.input.disconnect(this);else if(b){var c=this.output.indexOf(b);0<=c&&(this.output.splice(c,1),b.input=null)}else _.each(this.output,
function(a){a.input=null}),this.output=[]},link:function(a){this.node=a}}})(ShaderGraph);\u03c0=Math.PI;\u03c4=2*\u03c0;(function(a){for(var b in a)if(!window[b])throw"Error: MathBox requires "+a[b];})({THREE:"Three.js",tQuery:"tQuery.js (bundle)",ThreeBox:"ThreeBox.js",ThreeRTT:"ThreeRTT.js"});window.MathBox={};window.mathBox=function(a,b){!a||a instanceof Node||(b=a,a=null);return tQuery.createWorld(b).mathBox(a,b)};
MathBox.getShader=function(a){var b=document.getElementById(a);return b&&b.textContent||a};MathBox.signum=function(a){return 0<a?1:0>a?-1:0};MathBox.loop=function(a,b){for(var c=0;c<a;++c)b(c)};MathBox.Attributes=function(){};
MathBox.Attributes.prototype={get:function(a){return void 0===a?this.__attributes||{}:this.__attributes?this.__attributes[a]:void 0},set:function(a,b){function c(a,b){try{b=h(a,b),d[a]=b,f[a]=b}catch(c){throw"Exception setting '"+a+"' to '"+b+"': "+c;}}this.__attributes||(this.__attributes={});this.__validators||(this.__validators={});var d={},e=this.__validators,f=this.__attributes,g=this,h=function(a,b){if(void 0===e[a]){var c="validate"+a.charAt(0).toUpperCase()+a.slice(1);e[a]=g[c]||!1}return e[a]?
e[a].call(this,b):b}.bind(this);void 0!==a&&null!==a&&(a.constructor==String?c(a,b):_.each(a,function(a,b){c(b,a)}),this.emit("change",d))}};MicroEvent.mixin(MathBox.Attributes);MathBox.Attributes.mixin=function(a){_.each(["get","set","on","emit"],function(b){a.prototype[b]=MathBox.Attributes.prototype[b]})};MathBox.Animator=function(){this.active=[]};MathBox.Animator.now=1;
MathBox.Animator.prototype={finalState:function(a){var b=_.extend({},a.get());a.__queue&&_.each(a.__queue,function(a,d){_.each(a,function(a){a.to&&(b[d]=a.to)})});return b},attach:function(a){if(!a.__queue){if(!a.__attributes)throw"Cannot attach to object without attributes";var b=this,c=a.set;a.set=function(a,e,f){if(!f){f=a;if(void 0===a||null===a)return;a.constructor==String&&(f={},f[a]=e);b.stop(this,f)}c.call(this,a,e)};a.__queue={};a.__animations=0}},hurry:function(a,b,c){c=c||4;_.each(b||a.__queue,
function(b,e){_.each(a.__queue[e],function(a){a.hurry(c)})}.bind(this))},stop:function(a,b){_.each(b||a.__queue,function(b,d){for(;a.__queue[d];)this.dequeue(a,d,!0)}.bind(this))},animate:function(a,b,c){c=_.extend({duration:300},c||{});this.attach(a);_.each(b,function(b,e){var f=a.__queue[e]=a.__queue[e]||[];if(c.delay){var g=new MathBox.Animator.Delay(a,e,c.delay);f.push(g);0==a.__animations++&&this.active.push(a)}a.__validators[e]&&(b=a.__validators[e].call(a,b));g=new MathBox.Animator.Animation(a,
e,b,c.duration,c.callback,c.ease);f.push(g);c.hold&&(g=new MathBox.Animator.Delay(a,e,c.hold),f.push(g),0==a.__animations++&&this.active.push(a));0==a.__animations++&&this.active.push(a)}.bind(this))},dequeue:function(a,b,c){var d=a.__queue[b];if(d){var e=d.shift();0==d.length&&delete a.__queue[b];c&&e.skip();0==--a.__animations&&this.active.splice(this.active.indexOf(a),1)}},update:function(a){MathBox.Animator.now+=a;a=this.active.slice();_.each(a,function(a){var c=0;_.each(a.__queue,function e(f,
g){var h=f[0];value=h.apply(c||0);h.done()&&(c=h.extra(),this.dequeue(a,g),f[0]&&e.call(this,f,g))}.bind(this))}.bind(this))}};MathBox.Animator.Delay=function(a,b,c){this.object=a;this.key=b;this.duration=c;this.fraction=this.start=0};
MathBox.Animator.Delay.prototype={init:function(a){this.start=MathBox.Animator.now-(a||0)},apply:function(a){this.start||this.init(a);this.fraction=0<this.duration?Math.min(1,(MathBox.Animator.now-this.start)/this.duration):1},skip:function(){this.duration=0},hurry:function(a){this.duration=this.duration*this.fraction+this.duration*(1-this.fraction)/a},extra:function(){return MathBox.Animator.now-this.start-this.duration},done:function(){return 1==this.fraction}};
MathBox.Animator.Animation=function(a,b,c,d,e,f){this.object=a;this.key=b;this.from=null;this.to=c;this.duration=d;this.fraction=this.start=0;this.callback=e;this.ease=f};
MathBox.Animator.Animation.prototype={init:function(a){this.start=MathBox.Animator.now-(a||0);null===this.from&&(this.from=this.object.get(this.key));void 0===this.from&&(this.from=0)},apply:function(a){function b(a,b){return a+(b-a)*k}function c(a,e){void 0===e&&(e=a);void 0===a&&(a=e);if(e===a)return a;if(typeof a!=typeof e)throw console.log(d,f),"Data type mismatch between from/to values in animator. "+f+": "+a+" ("+a.constructor+"), "+e+"("+e.constructor+")";var g;switch(typeof e){default:case "string":throw"Unimplemented value type in animator. ("+
typeof e+")";case "function":return function(){return c(a.apply(this,arguments),e.apply(this,arguments))};case "boolean":return.5<h?e:a;case "number":return b(a,e);case "object":if(!a)return e;if(!e)return a;if(e.constructor==Array)return g=[],MathBox.loop(a.length,function(b){g[b]=c(a[b],e[b])}),g;if(e.constructor===THREE.Matrix4){g=new THREE.Matrix4;for(var k=0;16>k;++k)g.elements[k]=b(a.elements[k],e.elements[k]);return g}return e.constructor===THREE.Vector3?(g=new THREE.Vector3,g.x=b(a.x,e.x),
g.y=b(a.y,e.y),g.z=b(a.z,e.z),g):e.constructor===THREE.Color?(g=new THREE.Color,g.r=b(a.r,e.r),g.g=b(a.g,e.g),g.b=b(a.b,e.b),g):.5<h?e:a}}this.start||this.init(a);var d=this.object;a=this.from;var e=this.to,f=this.key,g=this.ease,h;this.fraction=h=0<this.duration?Math.min(1,(MathBox.Animator.now-this.start)/(this.duration||1)):1;var k;switch(g){case "in":k=1-(1-h)*(1-h);break;case "out":k=h*h;break;case "linear":k=h;break;default:k=.5-.5*Math.cos(h*\u03c0)}a=c(a,e);this.object.set(this.key,a,!0)},
hurry:function(a){this.duration=this.duration*this.fraction+this.duration*(1-this.fraction)/a},skip:function(){this.duration=0;this.fraction=1;this.done()},extra:function(){return MathBox.Animator.now-this.start-this.duration},done:function(){return 1==this.fraction?(this.object.set(this.key,this.to,!0),this.callback&&this.callback(),this.callback=null,!0):!1}};
MathBox.Stage=function(a,b,c){this.options=a=a||{};this._world=b;this.overlay=c;b&&b.on("resize",function(a,b){this.overlay.size(a,b);this.width=a;this.height=b}.bind(this));this.primitives=[];this.materials=new MathBox.Materials(this);this.animator=new MathBox.Animator;this._transition=0;this._speed=1;b&&(this.cameraProxy=new MathBox.CameraProxy(b,this.options));this.viewport({});this.loadPrimitives();void 0!==a.transition&&this.transition(a.transition);void 0!==a.speed&&this.speed(a.speed)};
MathBox.Stage.prototype=new THREE.Object3D;MathBox.Attributes.mixin(MathBox.Stage);MicroEvent.mixin(MathBox.Stage);
MathBox.Stage.prototype=_.extend(MathBox.Stage.prototype,{update:function(){var a=this._viewport,b=this._world.tCamera(),c=this.width,d=this.height,e=this._speed;this.cameraProxy.update();var f=+new Date;this.last||(this.last=f-1E3/60);this.animator.update(e*(f-this.last));this.last=f;a.update(this);_.each(this.primitives,function(e){e.adjust(a,b,c,d,this);e=e.renderables();_.each(e,function(e){e.isVisible()&&e.adjust(a,b,c,d,this)}.bind(this))}.bind(this));this.overlay&&this.overlay.update(b)},add:function(a,
b){if(a instanceof THREE.Object3D)return a instanceof MathBox.Sprite?this.overlay.add(a):THREE.Object3D.prototype.add.call(this,a);this._add(a);b=this.animateOptions(b);var c=a.style.get("opacity");b&&0<c&&(a.style.set("opacity",0),this.animator.animate(a.style,{opacity:c},b));return this},remove:function(a,b){if(a instanceof THREE.Object3D)return a instanceof MathBox.Sprite?this.overlay.remove(a):THREE.Object3D.prototype.remove.call(this,a);if("string"==typeof a)return _.each(this.select(a),function(a){this.remove(a,
b)}.bind(this));if(!a.singleton){var c=function(){this._remove(a)}.bind(this);b=this.animateOptions(b);var d=a.style.get("opacity");b&&0<d?(b.callback=c,this.animator.animate(a.style,{opacity:0},b),a.removed=!0):c();return this}},_add:function(a){var b=this.materials;-1==this.primitives.indexOf(a)&&(this.primitives.push(a),a.make(),a=a.renderables(),_.each(a,function(a){a.make(b);a.object&&this.add(a.object)}.bind(this)))},_remove:function(a){if(-1!=this.primitives.indexOf(a)){this.primitives.splice(this.primitives.indexOf(a),
1);var b=a.renderables();_.each(b,function(a){a.object&&this.remove(a.object);a.destroy()}.bind(this));a.destroy()}},select:function(a,b){var c=[];if("object"==typeof a)return a.constructor==Array?a:[a];var d=function(a){var c=[];if("*"==a)return c=this.primitives.slice(),c.push(this.viewport()),c.push(this.cameraProxy),c;if(a==+a)return _.each(this.primitives,function(d){!b&&d.removed||d.get("sequence")!=a||c.push(d)}),c;var d=a.match(/^\s*#([a-zA-Z0-9_-]+)|([a-zA-Z0-9_-]+)?\s*$/);if(!d)return[];
var h=d[2],k=d[1];if(k)_.each(this.primitives,function(a){!b&&a.removed||a.get("id")!=k||c.push(a)});else{if("camera"==h)return this.cameraProxy&&[this.cameraProxy]||[];if("viewport"==h)return[this.viewport()];h&&_.each(this.primitives,function(a){!b&&a.removed||a.type()!=h||c.push(a)})}return c}.bind(this),c=[];a=(""+a).split(",");_.each(a,function(a){c=c.concat(d(a))});return c},set:function(a,b){b=this.extractStyle(b);_.each(this.select(a),function(a){a.set(b);b.style&&a.style.set(b.style)});return this},
get:function(a){var b=this.animator;a=this.select(a);if(1>a.length)return{};var c=a[0];a=b.finalState(c);c.style&&(b=b.finalState(c.style),a.style=b);return a},transition:function(a){return void 0!==a?(this._transition=a,this):this._transition},speed:function(a){return void 0!==a?(this._speed=a,this):this._speed},animateOptions:function(a,b){var c=this._transition;!0===a&&(a={});if(c||b||a&&(a.delay||a.duration||a.hold))a=_.extend({delay:0,duration:c||0,hold:0},a||{});if(a&&(a.delay||a.duration||
a.hold))return a},animate:function(a,b,c){var d=this.animator;b=this.extractStyle(b);c=this.animateOptions(c,!0);b.style&&(_.each(this.select(a),function(a){c?d.animate(a.style,b.style,c):a.style.set(b.style)}),b=_.extend({},b),delete b.style);_.each(this.select(a),function(a){c?d.animate(a,b,c):a.set(b)});return this},clone:function(a,b,c){_.each(this.select(a),function(a){var e=this.get(a);delete e.sequence;var f=_.extend({},b),g=[];_.each(b,function(a,c){if("id"==c||"boolean"==typeof a||null===
a)e[c]=b[c],g.push(c)});_.each(g,function(a){delete f[a]});e.id==a.get("id")&&(e.id=(e.id||"")+"-clone");a=this.spawn(a.type(),e,{duration:0});this.animate(a,f,c)}.bind(this));return this},hurry:function(a,b,c){var d=this.animator;_.each(this.select(a,!0),function(a){d.hurry(a,b,c);a.style&&d.hurry(a.style,b,c)});return this},halt:function(a,b){var c=this.animator;_.each(this.select(a,!0),function(a){c.stop(a,b);a.style&&c.stop(a.style,b)});return this},viewport:function(a){if(void 0!==a){if(!this._viewport||
a.type&&a.type!=this.options.viewport.type){this._viewport&&(a=_.extend({},this._viewport.get(),a));this._viewport=MathBox.Viewport.make(a);a=this.primitives.slice();var b=this;_.each(a,function(a){b._remove(a);b._add(a)})}else this._viewport.set(a);this.options.viewport=this._viewport.get();return this}return this._viewport},camera:function(a){_.each(this.select("camera"),function(b){b.set(a)});return this},start:function(){this._world&&this._world.start();return this},stop:function(){this._world&&
this._world.stop();return this},world:function(){return this._world},extractStyle:function(a){var b=MathBox.Style.prototype.defaults(),c=null;_.each(a,function(d,e){void 0!==b[e]&&(delete a[e],c=c||{},c[e]=d)});c&&(a.style=_.extend(a.style||{},c));return a},spawn:function(a,b,c){return MathBox.Primitive.types[a]?(this[a](b,c),this.primitives[this.primitives.length-1]):this},loadPrimitives:function(){_.each(MathBox.Primitive.types,function(a,b){this[b]=function(b,d){a.validateArgs&&(b=a.validateArgs(b));
var e=new a(this.extractStyle(b));this.add(e,d);return this}}.bind(this))}});MathBox.Materials=function(a){this.stage=a;this.cache={}};
MathBox.Materials.prototype={hash:function(a){var b=Object.keys(a),c="";b.sort();_.each(b,function(b){c+=b+"/";c+=a[b]+"/"});return c},clone:function(a){var b=new THREE.ShaderMaterial({vertexShader:a.vertexShader,fragmentShader:a.fragmentShader});b.attributes=a.attributes?{}:null;b.uniforms={};b.wireframe=a.wireframe;b.applyUniforms=a.applyUniforms;b.applyAttributes=a.applyAttributes;_.each(a.uniforms,function(a,d){b.uniforms[d]={type:a.type,value:a.value&&a.value.clone?a.value.clone():a.value}});
_.each(a.attributes,function(a,d){b.attributes[d]={type:a.type,value:a.value}});return b},generic:function(a){a=a||{};if(!a.shaders||!Object.keys(a.shaders).length){var b=this.hash(a);if(this.cache[b])return this.clone(this.cache[b])}var c=this.factory(),d=a.shaders||{};d.position?d.position(c,this):(this.position(c,a),a.absolute||(a.shaded&&a.smooth?(c.group(),this.viewport(c),c.next(),this.viewport(c),c.next(),this.viewport(c),c.combine()):this.viewport(c)));a=this.finalize(c,a);b&&(this.cache[b]=
a);return a},position:function(a,b){b=b||{};a.snippet(b.shaded&&b.smooth?"getPositionDUDV":"getPosition");b.absolute||(b.shaded&&b.smooth?a.group().snippet("mathTransform").next().snippet("mathTransform").next().snippet("mathTransform").combine():a.snippet("mathTransform"));return a},factory:function(){return new ShaderGraph.Factory},finalize:function(a,b){b=b||{};var c=b.shaders||{};b.shaded?b.smooth?a.snippet("projectToViewDUDV"):a.snippet("projectToViewNormal"):a.snippet("projectToView");c.material?
c.material(a,this):a.material("vertexOutput",{points:"fragmentSolidPoint",mesh:b.shaded?"fragmentShaded":"fragmentSolid"}[b.type]||"fragmentSolid");c=a.end().compile();c=new THREE.ShaderMaterial({uniforms:c.uniforms,attributes:c.attributes,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader});b.wireframe&&(c.wireframe=!0);var d=this.apply.bind(this);c.applyUniforms=function(a){d(this,a,"uniforms")};c.applyAttributes=function(a){d(this,a,"attributes")};return c},apply:function(a,b,c){var d=
a[c];_.each(b,function(a,b){var c=d[b];c&&(a instanceof THREE.Color&&(a.x=a.r,a.y=a.g,a.z=a.b),c.value=a,c.needsUpdate=!0)});if("uniforms"==c){c=a.uniforms;if(b.map&&(c.texture&&(c.texture.value=b.map),c.offsetRepeat)){var e=b.map.offset,f=b.map.repeat;c.offsetRepeat.value.set(e.x,e.y,f.x,f.y)}void 0!==b.lineWidth&&(a.wireframeLinewidth=a.linewidth=b.lineWidth);void 0!==b.opacity&&(a.transparent=1>b.opacity)}},viewport:function(a,b){this.stage.viewport().shader(a,b)}};
MathBox.Ticks=function(a,b,c,d,e,f,g){var h=(b-a)/(c||10);d=d||1;e=e||10;var k=d*((g||0)+Math.pow(e,Math.floor(Math.log(h/d)/Math.log(e))));c=_.map(0==e%2?[e/2,1,.5]:[1],function(a){return k*a});var l=_.reduce(c,function(a,b){return Math.abs(b-h)<Math.abs(a-h)?b:a},k);f=+!f;a=(Math.ceil(a/l)+f)*l;b=(Math.floor(b/l)-f)*l;c=Math.ceil((b-a)/l)+1;var m=[];MathBox.loop(c,function(b){m.push(a+b*l)});return m};MathBox.TicksLog=function(a,b,c,d,e,f){};
tQuery.World.registerInstance("mathBox",function(a,b){a=a||document.body;this.threeBox(a,b);var c=new MathBox.Overlay;a.appendChild(c.domElement);c.domElement.style.position="absolute";c.domElement.style.left=0;c.domElement.style.top=0;c.domElement.style.right=0;c.domElement.style.bottom=0;var d=new MathBox.Stage(b,this,c),e=function(){d.update()};this.tScene().add(d);this._tRenderer.setClearColor(16777215,1);d.unhook=function(){this.loop().unhookPreRender(e)};this.loop().hookPreRender(e);b.cameraControls||
(c=this.tCamera(),c.position.x=0,c.position.y=0,c.position.z=b.orbit,c.lookAt(new THREE.Vector3(0,0,0)));return d});MathBox.Director=function(a,b){this._stage=a;this.script=b||[];this.rollback={};this.clocks={};this.time=this.lastCommand=this.step=0;this.lastTime=+new Date};
MathBox.Director.prototype={clock:function(a,b){if(a>this.step)return 0;var c=+new Date;this.time+=(c-this.lastTime)*this.stage().speed();this.lastTime=c;if(b||!this.clocks[a])this.clocks[a]=this.time;return.001*(this.time-this.clocks[a])},invert:function(a){var b=this._stage,c=[],d,e=a[0],f=a[1],g=a[2]||{},h=a[3];"remove"==e&&(h=g);h={delay:h&&void 0!==h.hold?h.hold/4:0,duration:h&&void 0!==h.duration?h.duration/4:0,hold:h&&void 0!==h.delay?h.delay/4:0};switch(e){case "add":d=[0];case "clone":d=
d||b.select(f);_.each(d,function(a,b){c.push(["remove",g.sequence||MathBox.Primitive.sequence+1+b,h])});break;case "remove":d=b.select(f);_.each(d,function(a){c.push(["add",a.type(),b.get(a),h])});break;case "animate":case "set":d=b.select(f),_.each(d,function(a){var d=b.get(a),f={};for(i in g)f[i]=d.style&&void 0!==d.style[i]?d.style[i]:d[i];c.push([e,a.singleton||a.get("sequence"),f,h])})}return c},invertDelay:function(a){function b(a){var b=a[2]||{},c=["opacity"];if("animate"==a[0])for(d in c=
[],b)if("style"==d)for(j in b.style)c.push(j);else c.push(d);return c}var c=[],d,e={};a.forEach(function(a){var c=a[0],d=a[1]||"",f=a[2]||{},g=a[3]||{};if("set"==c)return null;"add"==c&&(d=f.sequence);"remove"==c&&(g=f);b(a).forEach(function(a){a=[d,a].join(".");e[a]||(e[a]=[]);g=g||{};e[a].push((g.delay||0)+(g.duration||0)+(g.hold||0))})});var f=0;for(d in e)var g=e[d]=e[d].reduce(function(a,b){return a+b}),f=Math.max(f,g);a.forEach(function(a){var d=a[0],g=a[1]||"",m=a[2]||{},v=a[3]||{},q;if("set"==
d)return c.push(a);"add"==d&&(q=g,g=m.sequence);"remove"==d&&(v=m);b(a).forEach(function(a){var b=[g,a].join("."),h=v.delay||0,z=v.duration||0,u=v.hold||0;void 0!==e[b]&&(h+=f-e[b],delete e[b]);v={delay:h,duration:z,hold:u};"add"==d&&c.push([d,q,m,v]);"remove"==d?c.push([d,g,v]):(b={},b[a]=m.style&&void 0!==m.style[a]?m.style[a]:m[a],c.push([d,g,b,v]))})});return c},apply:function(a,b,c,d){var e=this._stage;_.each(a,function(a){var g=a[0]||"",h=a[1]||"",k=a[2]||{},l=a[3]||{};"remove"==g&&(l=k);b&&
(a=this.invert(a),a=[0,0].concat(a),Array.prototype.splice.apply(b,a));d&&l&&(l=_.extend({},l),l.delay/=2,l.duration/=2,l.hold/=2);c&&(l={delay:0,duration:0,hold:0},"animate"==g&&(g="set"));switch(g){case "clone":e.clone(h,k,l);break;case "add":e.spawn(h,k,l);break;case "remove":_.each(e.select(h),function(a){e.remove(a,l)});break;case "set":var g=e.select(h),m=k.constructor==Array;_.each(g,function(a,b){e.set(a,m?k[b]:k)});break;case "animate":g=e.select(h),m=k.constructor==Array,_.each(g,function(a,
b){e.animate(a,m?k[b]:k,l)})}}.bind(this));return this},insert:function(a){a[0].constructor!=Array&&(a=[a]);this.script.splice(this.step,0,a);this.forward();return this},is:function(a){if(!this.script.length)return!1;for(;0>a;)a+=this.script.length+1;for(;a>=this.script.length+1;)a-=this.script.length+1;return a==this.step},isFirst:function(){return this.is(0)},isLast:function(){return this.is(-1)},go:function(a,b){if(this.script.length){for(;0>a;)a+=this.script.length+1;for(;a>=this.script.length+
1;)a-=this.script.length+1;for(;a>this.step;)this.forward(b);for(;a<this.step;)this.back(b)}},skipping:function(){var a=+new Date,b=!1;500>a-this.lastCommand&&(b=!0);this.stage().hurry("*");this.lastCommand=a;return b},forward:function(a,b){if(!(this.step>=this.script.length)){var c=this.step,d=this.script[c],e=this.rollback[c]=[];this.step++;var f=function(){this.apply(d,e,a,a?!1:this.skipping());this.rollback[c]=this.invertDelay(e);this.clock(c+1,!0);this.emit("go",c+1,1)}.bind(this);b?setTimeout(f,
+b):f();return this}},back:function(a,b){if(!(0>=this.step)){this.step--;var c=this.step,d=this.rollback[c],e=function(){this.apply(d,null,a||this.skipping());delete this.rollback[c];this.emit("go",c,-1)}.bind(this);b?setTimeout(e,+b):e();return this}},stage:function(){return this._stage}};_.each(MathBox.Stage.prototype,function(a,b){MathBox.Director.prototype[b]||(MathBox.Director.prototype[b]=function(){var b=this.stage[a].apply(this.stage,arguments);return b===this.stage?this:b})});MicroEvent.mixin(MathBox.Director);
MathBox.Style=function(a){var b=this.defaults();a=_.extend(b,a||{});this.set(a)};
MathBox.Style.prototype={defaults:function(){return{color:new THREE.Color(3178736),opacity:1,lineWidth:2,pointSize:5,mathScale:new THREE.Vector3(1,1,1),mathRotation:new THREE.Vector3,mathPosition:new THREE.Vector3,worldScale:new THREE.Vector3(1,1,1),worldRotation:new THREE.Vector3,worldPosition:new THREE.Vector3,zIndex:0,map:null,mapColor:0,mapOpacity:0}},validateColor:function(a){if(a.constructor==Array){a=a.concat([0,0,0]);var b=new THREE.Color;return b.setRGB.apply(b,a)}return a.constructor==Number?
new THREE.Color(a):a.constructor!=THREE.Color?this.get("color"):a},validateMathScale:function(a){if(a.constructor==Array){a=a.concat([1,1,1]);var b=new THREE.Vector3;return b.set.apply(b,a)}return a.constructor!=THREE.Vector3?this.get("mathScale"):a},validateMathRotation:function(a){if(a.constructor==Array){a=a.concat([0,0,0]);var b=new THREE.Vector3;return b.set.apply(b,a)}return a.constructor!=THREE.Vector3?this.get("mathRotation"):a},validateMathPosition:function(a){if(a.constructor==Array){a=
a.concat([0,0,0]);var b=new THREE.Vector3;return b.set.apply(b,a)}return a.constructor!=THREE.Vector3?this.get("mathPosition"):a},validateWorldScale:function(a){if(a.constructor==Array){a=a.concat([1,1,1]);var b=new THREE.Vector3;return b.set.apply(b,a)}return a.constructor!=THREE.Vector3?this.get("worldScale"):a},validateWorldRotation:function(a){if(a.constructor==Array){a=a.concat([0,0,0]);var b=new THREE.Vector3;return b.set.apply(b,a)}return a.constructor!=THREE.Vector3?this.get("worldRotation"):
a},validateWorldPosition:function(a){if(a.constructor==Array){a=a.concat([0,0,0]);var b=new THREE.Vector3;return b.set.apply(b,a)}return a.constructor!=THREE.Vector3?this.get("worldPosition"):a}};MathBox.Attributes.mixin(MathBox.Style);
MathBox.CameraProxy=function(a,b){this.set({orbit:void 0===b.orbit?3.5:b.orbit,phi:void 0===b.phi?\u03c4/4:b.phi,theta:b.theta||0,lookAt:b.lookAt||[0,0,0]});this.singleton="camera";var c=this.controls=a.getCameraControls()||ThreeBox.OrbitControls.bind(a.tCamera(),null,this.get());this.on("change",function(a){_.each(a,function(a,b){"lookAt"!=b&&("theta"==b&&(a=Math.min(\u03c0/2-1E-4,Math.max(-\u03c0/2+1E-4,a))),c[b]=a)});a.lookAt&&c.lookAt.set.apply(c.lookAt,a.lookAt);c.update()});c.update();this.update=
function(){this.set({orbit:c.orbit,phi:c.phi,theta:Math.min(\u03c0/2-1E-4,Math.max(-\u03c0/2+1E-4,c.theta))},null,!0);var a=this.get("lookAt");a[0]=c.lookAt.x;a[1]=c.lookAt.y;a[2]=c.lookAt.z}};MathBox.Attributes.mixin(MathBox.CameraProxy);MathBox.Overlay=function(){(this.domElement=document.createElement("div")).className="mathbox-overlay";this.sprites=[];this.v=new THREE.Vector3;this.q=new THREE.Vector3};
MathBox.Overlay.prototype={size:function(a,b){this.width=a;this.height=b;this.domElement.style.width=a+"px";this.domElement.style.height=b+"px"},add:function(a){-1==this.sprites.indexOf(a)&&(this.sprites.push(a),a.element.parentNode||this.domElement.appendChild(a.element),_.each(a.children,function(a){this.add(a)}.bind(this)))},remove:function(a){var b;-1!=(b=this.sprites.indexOf(a))&&(this.sprites.splice(b,1),a.element.parentNode&&a.element.parentNode.removeChild(a.element),_.each(a.children,function(a){this.remove(a)}.bind(this)))},
update:function(a){a.fov?this.fov=.5/Math.tan(a.fov*Math.PI/360)*this.height:(this.fov=null,this.cx=a.left+a.right,this.cy=a.top+a.bottom,this.dx=this.width/(a.right-a.left),this.dy=this.height/(a.bottom-a.top));_.each(this.sprites,function(b){this._update(b,a)}.bind(this));_.each(this.sprites,function(b){this._measure(b,a)}.bind(this));_.each(this.sprites,function(b){this._vis(b,a)}.bind(this))},_measure:function(a,b){if(a.measure){var c=a.element;a.width=c.offsetWidth;a.height=c.offsetHeight;a.measure=
!1}},_vis:function(a,b){if(a.render&&(a.width||a.height)){var c=a.left,d=a.top,e=a.width+c,f=a.height+d;found=!1;_.each(this.sprites,function(b){if(b===a)found=!0;else if(found&&b.render){var h=b.left,k=b.top,l=b.width+h,m=b.height+k;e<h||c>l||f<k||d>m||(b.element.style.display="none",b.render=!1)}})}},_update:function(a,b){for(var c=this.v,d=this.q,e=a.render,f=a.visible,g=a.parent;f&&g;)f=f&&g.visible,g=g.parent;a.render=f&&0<a.opacity;if(a.render)e||(a.element.style.display="block"),c.copy(a.position),
c.applyProjection(b.matrixWorldInverse),this.fov?(e=-(c.x/c.z)*this.fov+.5*this.width,f=c.y/c.z*this.fov+.5*this.height):(e=(c.x-this.cx)*this.dx+.5*this.width,f=(c.y-this.cy)*this.dy+.5*this.height),a.distance&&(d.copy(a.tangent).multiplyScalar(.01),d.add(a.position),d.applyProjection(b.matrixWorldInverse),g=0<a.distance?1:-1,d.sub(c),d.z=0,d.normalize().multiplyScalar(a.distance),e+=Math.abs(d.y)*g,f+=Math.abs(d.x)*g),e=Math.round(e),f=Math.round(f),a.left!==e&&(a.left=e,a.element.style.left=e+
"px"),a.top!==f&&(a.top=f,a.element.style.top=f+"px"),a.lastOpacity!==a.opacity&&(a.element.style.opacity=a.opacity,a.lastOpacity=a.opacity);else if(e||null===e)a.element.style.display="none"}};
MathBox.Sprite=function(a,b,c){this.element=a;this.tangent=b||new THREE.Vector3(1,0,0);this.distance=c||0;this.height=this.width=0;this.measure=this.visible=!0;this.render=null;this.content="";this.lastOpacity=this.lastTop=this.lastLeft=null;a.style.position="absolute";a.style.left=0;a.style.top=0;a.style.opacity=0;THREE.Object3D.call(this)};MathBox.Sprite.prototype=_.extend(new THREE.Object3D,{});
MathBox.Primitive=function(a){if(null!==a){var b=this.defaults();a&&(a.style=_.extend(b.style,a.style||{}),a=_.extend(b,a||{}));a=a||b;this.set(a);this.style=new MathBox.Style;this.style.set(this.get().style||{});this.on("change",function(a){void 0!==a.style&&this.style.set(a.style)}.bind(this));this.set("sequence",a.sequence||++MathBox.Primitive.sequence);this.set("id",a.id||this.sequence);this.init()}};MathBox.Primitive.sequence=0;MathBox.Primitive.types={};
MathBox.Primitive.prototype={defaults:function(){return{}},type:function(){return"primitive"},init:function(){},make:function(){},destroy:function(){},renderables:function(){return[]},adjust:function(a){}};MathBox.Attributes.mixin(MathBox.Primitive);MicroEvent.mixin(MathBox.Primitive);MathBox.Curve=function(a){null!==a&&MathBox.Primitive.call(this,a)};
MathBox.Curve.prototype=_.extend(new MathBox.Primitive(null),{defaults:function(){return{n:64,domain:[0,1],data:null,expression:function(){return 0},live:!0,points:!1,line:!0,style:{}}},type:function(){return"curve"},renderables:function(){return[this.line,this.points]},adjust:function(a){a=this.get();this.line.show(a.line);this.points.show(a.points);(a.line||a.points)&&0<this.style.get("opacity")&&a.live&&this.calculate()},make:function(){var a=this.get(),b=this.style,c=a.n,d=this.vertices=[];MathBox.loop(c,
function(){d.push(new THREE.Vector3)});c=function(c){return new MathBox.Renderable.Mesh(d,{type:c,dynamic:a.live},b)};this.line=c("line");this.points=c("points");this.calculate()},calculate:function(){var a=this.vertices,b=this.get(),c=b.data,d=b.domain,e=b.n,f=d[0],g=(d[1]-f)/(e-1),h;MathBox.loop(e,function(d){h=c&&void 0!==c[d]?c[d]:b.expression.call(this,f,d);var e=0,m=0,v=0;if(h instanceof Array){var q=h.length;0<q&&(e=h[0]);1<q&&(m=h[1]);2<q&&(v=h[2])}else e=f,m=+h;a[d].set(e,m,v);f+=g}.bind(this))}});
MathBox.Primitive.types.curve=MathBox.Curve;MathBox.Bezier=function(a){MathBox.Curve.call(this,a)};
MathBox.Bezier.prototype=_.extend(new MathBox.Curve(null),{defaults:function(){return{n:64,domain:[0,1],data:null,order:3,expression:function(){return 0},live:!0,points:!1,line:!0,style:{}}},type:function(){return"bezier"},calculate:function(){var a=this.vertices,b=this.get(),c=b.domain,d=b.data,e=b.order,f=b.n;if(1>e||3<e)throw"Bezier curve order must be 1, 2 or 3.";var g=[],h;MathBox.loop(e+1,function(a){h=d&&void 0!==d[a]?d[a]:b.expression.call(this,a,a);var c=a=0,e=0;if(h instanceof Array){var f=
h.length;0<f&&(a=h[0]);1<f&&(c=h[1]);2<f&&(e=h[2])}else a=l,c=+h;g.push(new THREE.Vector3(a,c,e))}.bind(this));var k={bezierPoints:g},l=c[0],m=(c[1]-l)/(f-1);MathBox.loop(f,function(b){a[b].set(l,0,0);l+=m});c={uniforms:k,shaders:{position:function(a,b){a.snippet("bezier"+e).snippet("mathTransform");b.viewport(a)}}};this.line.set(c);this.points.set(c)}});MathBox.Primitive.types.bezier=MathBox.Bezier;
MathBox.Axis=function(a){null!==a&&(MathBox.Primitive.call(this,a),this.on("change",function(a){void 0!==a.size&&this.arrow&&this.arrow.set("size",a.size)}))};
MathBox.Axis.prototype=_.extend(new MathBox.Primitive(null),{defaults:function(){return{axis:0,offset:[0,0,0],n:2,arrow:!0,line:!0,labels:!1,decimals:2,distance:15,ticks:10,tickUnit:1,tickScale:10,size:.07,style:{lineWidth:4,color:new THREE.Color(7368816)},formatter:null,zero:!0}},renderables:function(){return[this.line,this.ticks,this.arrow,this.labels]},type:function(){return"axis"},adjust:function(a,b){var c=this.get(),d=c.axis,e=c.offset,f=c.arrow,g=c.line,h=c.labels,k=c.n,l=c.ticks,m=c.tickUnit,
v=c.tickScale,c=c.decimals,q=this.points,y=this.labelPoints,x=this.labelTangent,w=this.tickPoints,z=this.tickSigns,u=[0,0,0],B=new THREE.Vector3;new THREE.Vector4;var G=a.axis(d),A=G[0],G=G[1],C=(G-A)/(k-1);B.set.apply(B,e);MathBox.loop(k,function(a){u[d]=A+a*C;q[a].set.apply(q[a],u);q[a].add(B)});this.line.show(g);this.arrow.show(f);k=this.scale=MathBox.Ticks(A,G,l,m,v,!0);this.ticks.show(!!l);if(l){l=Math.floor(w.length/2);k.length>l&&(k=k.slice(0,l));var l=[0,0,0],F;l[2==d?0:1-d]=.01*(G-A);this.epsilon.set.apply(this.epsilon,
l);u=[0,0,0];_.each(k,function(a,b){u[d]=a;var c=2*b;w[c].set.apply(w[c],u);w[c].add(B);z[c]=1;w[c+1].copy(w[c]);z[c+1]=-1;y[b].copy(w[c]);F=c+1});l=F+1;for(k=w.length;l<k;)w[l].copy(w[F]),z[l]=z[F],l++}u=[0,0,0];u[d]=1;x.set.apply(x,u);this.labels.show(!!h);this.labels.set("decimals",c)},make:function(){var a=this.get(),b=a.n,c=a.size,d=a.ticks,e=a.distance,f=a.formatter,g=this.style,h=this.points=[],k=this.labelPoints=[],l=this.labelTangent=new THREE.Vector3,m=this.tickPoints=[],v=this.tickSigns=
[],q=this.epsilon=new THREE.Vector3;MathBox.loop(b,function(a){h.push(new THREE.Vector3)});MathBox.loop(4*d,function(a){k.push(new THREE.Vector3)});MathBox.loop(8*d,function(a){m.push(new THREE.Vector3);v.push(1)});var d={dynamic:!0,size:c,offset:.5},c={dynamic:!0,size:.2*c},e={dynamic:!0,distance:e},y=function(b){b=this.scale[b];return 0!=b||a.zero?f?f(b):b:""}.bind(this);this.line=new MathBox.Renderable.Mesh(h,{dynamic:!0,type:"line"},g);this.arrow=new MathBox.Renderable.ArrowHead(h[b-2],h[b-1],
d,g);this.ticks=new MathBox.Renderable.Ticks(m,v,q,c,g);this.labels=new MathBox.Renderable.Labels(k,l,y,e,g)}});MathBox.Axis.validateArgs=function(a){"number"==typeof a&&(a={axis:a});return a};MathBox.Primitive.types.axis=MathBox.Axis;MathBox.Grid=function(a){null!==a&&MathBox.Primitive.call(this,a)};
MathBox.Grid.prototype=_.extend(new MathBox.Primitive(null),{defaults:function(){return{axis:[0,1],offset:[0,0,0],show:[!0,!0],n:2,ticks:[10,10],tickUnit:[1,1],tickScale:[10,10],style:{lineWidth:1,color:new THREE.Color(10526880)}}},type:function(){return"grid"},renderables:function(){return this.lines||[]},adjust:function(a){function b(a,b,c,d,e){var f=l.slice(),g=0,h=MathBox.Ticks(b.min,b.max,b.ticks,b.tickUnit,b.tickScale,!0);h.length>d&&(h=h.slice(0,d));_.each(h,function(d){f[b.axis]=d+l[b.axis];
f[c.axis]=c.min+l[c.axis];MathBox.loop(e-1,function(b){a[g].set.apply(a[g],f);g++;f[c.axis]+=c.inv;a[g].set.apply(a[g],f);g++})});d=Math.max(0,g-1);for(h=a.length;g<h;)a[g++].copy(a[d])}var c=this.get(),d=c.axis,e=c.ticks,f=c.tickUnit,g=c.tickScale,h=c.n,k=c.show,l=c.offset,c=this.points,m=this.limit,v=[];"number"==typeof h&&(h=[h,h]);_.each(d,function(b,c){var d=a.axis(b);v.push({axis:b,min:d[0],max:d[1],inv:(d[1]-d[0])/(h[c]-1),ticks:e[c],tickUnit:f[c],tickScale:g[c]})});this.lines[0].show(k[0]);
this.lines[1].show(k[1]);k[0]&&b(c[0],v[1],v[0],m[0],h[0]);k[1]&&b(c[1],v[0],v[1],m[1],h[1])},make:function(a){var b=this.get();a=b.ticks;var c=b.n,d=this.points=[[],[]],b=this.style;"number"==typeof c&&(c=[c,c]);var e=this.limit=[0,0];_.each(a,function(a,b){b=1-b;e[b]=4*a;MathBox.loop(e[b]*(c[b]-1)*2,function(a){d[b].push(new THREE.Vector3)})});this.lines=[];this.lines.push(new MathBox.Renderable.Mesh(d[0],{type:"line",strip:!1,dynamic:!0},b));this.lines.push(new MathBox.Renderable.Mesh(d[1],{type:"line",
strip:!1,dynamic:!0},b))}});MathBox.Primitive.types.grid=MathBox.Grid;MathBox.Vector=function(a){null!==a&&(MathBox.Primitive.call(this,a),this.render=[],this.arrows=[],this.line=this.points=this.vertices=null,this.on("change",function(a){void 0!==a.size&&_.each(this.arrows,function(c){c.set("size",a.size)})}))};MathBox.Vector.vLast=new THREE.Vector3;MathBox.Vector.vCurrent=new THREE.Vector3;
MathBox.Vector.prototype=_.extend(new MathBox.Primitive(null),{defaults:function(){return{n:1,data:null,arrow:!0,expression:function(){return 0},live:!0,style:{},size:.07}},type:function(){return"vector"},renderables:function(){return this.render},adjust:function(a){var b=this.get();0<this.style.get("opacity")&&(b.arrow||b.live)&&this.calculate(a);_.each(this.arrows,function(a){a.show(b.arrow)})},make:function(){var a=this.get(),b=a.arrow,c=this.style,d=a.n,e=this.vertices=[],f=this.points=[],g=this.render=
[],h=this.arrows=[],k={dynamic:a.live,type:"line",strip:!1},l={size:a.size},m=0;MathBox.loop(d,function(){e.push(new THREE.Vector3);e.push(new THREE.Vector3);f.push(new THREE.Vector3);f.push(new THREE.Vector3);if(b){var a=new MathBox.Renderable.ArrowHead(f[m++],f[m++],l,c);g.push(a);h.push(a)}});this.line=new MathBox.Renderable.Mesh(e,k,c);g.push(this.line);this.calculate()},calculate:function(a){var b=this.vertices,c=this.arrows,d=this.points,e=this.get(),f=e.data,g=e.arrow,h=e.n,k=e.size,l=this.style.get("mathScale"),
m=0,v=0;MathBox.loop(2*h,function(h){p=f&&void 0!==f[h]?f[h]:e.expression.call(this,v,m);var y=0,x=0,w=0;if(p instanceof Array){var z=p.length;0<z&&(y=p[0]);1<z&&(x=p[1]);2<z&&(w=p[2])}else y=h,x=+p,w=0;d[h].set(y,x,w);b[h].set(y,x,w);a&&g&&1==h%2&&(y=MathBox.Vector.vLast,x=MathBox.Vector.vCurrent,x.copy(b[h]),y.copy(b[h-1]),a.to(x),a.to(y),x.sub(y).multiplyScalar(l),z=x.length(),w=Math.min(1,.5*z/k),w=(1-(1-w)*(1-w))*k,z-=w,x.normalize().multiplyScalar(z).divideScalar(l).add(y),a.from(x),b[h].copy(x),
c[v].set({size:w}));v=m?v+1:v;m=(m+1)%2}.bind(this))}});MathBox.Primitive.types.vector=MathBox.Vector;MathBox.Surface=function(a){null!==a&&MathBox.Primitive.call(this,a)};
MathBox.Surface.prototype=_.extend(new MathBox.Primitive(null),{defaults:function(){return{n:[64,64],domain:[[0,1],[0,1]],data:null,expression:function(){return 0},live:!0,points:!1,line:!1,mesh:!0,doubleSided:!0,flipSided:!1,shaded:!0,style:{}}},type:function(){return"surface"},renderables:function(){return[this.mesh,this.line,this.points]},adjust:function(a){a=this.get();this.mesh.show(a.mesh);this.line.show(a.line);this.points.show(a.points);(a.mesh||a.line||a.points)&&0<this.style.get("opacity")&&
a.live&&this.calculate()},make:function(){var a=this.get(),b=this.style,c=a.n;"number"==typeof c&&(c=[c,c]);var d=this.geometry=new THREE.PlaneGeometry(2,2,c[0]-1,c[1]-1);this.vertices=d.vertices;this.mesh=new MathBox.Renderable.Mesh(d,{type:"mesh",doubleSided:a.doubleSided,flipSided:a.flipSided,shaded:a.shaded,smooth:!0,dynamic:a.live},b);this.line=new MathBox.Renderable.Mesh(d,{type:"mesh",shaded:a.shaded,smooth:!0,dynamic:a.live,wireframe:!0},b);this.points=new MathBox.Renderable.Mesh(d.vertices,
{type:"points",dynamic:a.live},b);if(a.shaded){var e=this.tangents=[[],[]];MathBox.loop(c[0]*c[1],function(){e[0].push(new THREE.Vector3);e[1].push(new THREE.Vector3)})}this.calculate()},calculate:function(){var a=this.vertices,b=this.tangents,c=this.get(),d=c.data,e=c.domain,f=c.n,g=c.flipSided,h=g?1:0,g=g?0:1;"number"==typeof f&&(f=[f,f]);var k=e[0][0],l=e[1][0],m=(e[0][1]-k)/(f[0]-1),v=(e[1][1]-l)/(f[1]-1),q,y=0;MathBox.loop(f[1],function(b){k=e[0][0];MathBox.loop(f[0],function(e){q=d&&void 0!==
d[b]&&void 0!==d[b][e]?d[b][e]:c.expression.call(this,k,l,e,b,y);var f=e=0,g=0;if(q instanceof Array){var h=q.length;0<h&&(e=q[0]);1<h&&(f=q[1]);2<h&&(g=q[2])}else e=k,f=+q,g=l;a[y].set(e,f,g);k+=m;y++}.bind(this));l+=v}.bind(this));if(c.shaded){var y=0,l=e[1][0],x=f[0];MathBox.loop(f[1],function(c){k=e[0][0];var d=c?c-1:0,g=Math.min(f[1]-1,c+1);MathBox.loop(f[0],function(e){var h=e?e-1:0,l=Math.min(f[0]-1,e+1),q=a[e+c*x];l==e?b[0][y].subVectors(q,a[h+c*x]).add(q):b[0][y].copy(a[l+c*x]);g==c?b[1][y].subVectors(q,
a[e+d*x]).add(q):b[1][y].copy(a[e+g*x]);k+=m;y++});l+=v});this.line.set("attributes",{positionDU:b[h],positionDV:b[g]});this.mesh.set("attributes",{positionDU:b[h],positionDV:b[g]})}}});MathBox.Primitive.types.surface=MathBox.Surface;MathBox.BezierSurface=function(a){this.matrixX=new THREE.Matrix4;this.matrixY=new THREE.Matrix4;this.matrixZ=new THREE.Matrix4;this.coefficients=new THREE.Matrix4;this.coefficients.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0);MathBox.Surface.call(this,a)};
MathBox.BezierSurface.prototype=_.extend(new MathBox.Surface(null),{defaults:function(){return{n:[64,64],domain:[[0,1],[0,1]],data:null,order:3,expression:function(){return 0},live:!0,points:!1,line:!1,mesh:!0,doubleSided:!0,flipSided:!1,shaded:!0,style:{}}},type:function(){return"bezierSurface"},calculate:function(){var a=this.vertices,b=this.get(),c=b.domain,d=b.data,e=b.order,f=b.shaded,g=b.n;"number"==typeof g&&(g=[g,g]);if(3!=e)throw"Bezier surface order must be 3.";var h=[],k;MathBox.loop(e+
1,function(a){MathBox.loop(e+1,function(c){k=d&&void 0!==d[a]&&void 0!==d[a][c]?d[a][c]:b.expression.call(this,c,a,c,a);var e=0,f=0,g=0;k instanceof Array?(c=k.length,0<c&&(e=k[0]),1<c&&(f=k[1]),2<c&&(g=k[2])):(e=c,f=+k,g=a);h.push([e,f,g])}.bind(this))}.bind(this));k=h;this.matrixX.set(k[0][0],k[1][0],k[2][0],k[3][0],k[4][0],k[5][0],k[6][0],k[7][0],k[8][0],k[9][0],k[10][0],k[11][0],k[12][0],k[13][0],k[14][0],k[15][0]);this.matrixY.set(k[0][1],k[1][1],k[2][1],k[3][1],k[4][1],k[5][1],k[6][1],k[7][1],
k[8][1],k[9][1],k[10][1],k[11][1],k[12][1],k[13][1],k[14][1],k[15][1]);this.matrixZ.set(k[0][2],k[1][2],k[2][2],k[3][2],k[4][2],k[5][2],k[6][2],k[7][2],k[8][2],k[9][2],k[10][2],k[11][2],k[12][2],k[13][2],k[14][2],k[15][2]);var l=this.coefficients;this.matrixX.multiply(l).transpose().multiply(l);this.matrixY.multiply(l).transpose().multiply(l);this.matrixZ.multiply(l).transpose().multiply(l);var l={bezierSurfaceX:this.matrixX,bezierSurfaceY:this.matrixY,bezierSurfaceZ:this.matrixZ},m=c[0][0],v=c[1][0],
q=(c[0][1]-m)/(g[0]-1),y=(c[1][1]-v)/(g[1]-1),x=0;MathBox.loop(g[1],function(b){m=c[0][0];MathBox.loop(g[0],function(b){a[x].set(m,v,0);m+=q;x++}.bind(this));v+=y}.bind(this));l={uniforms:l,shaders:{position:function(a,b){f?(a.snippet("bezierSurface"+e),a.group(),a.snippet("mathTransform"),b.viewport(a),a.next(),a.snippet("mathTransform"),b.viewport(a),a.next(),a.snippet("mathTransform"),b.viewport(a),a.combine()):(a.snippet("bezierSurface"+e).snippet("mathTransform"),b.viewport(a))}}};this.mesh.set(l);
this.line.set(l);this.points.set(l)}});MathBox.Primitive.types.bezierSurface=MathBox.BezierSurface;MathBox.Platonic=function(a){null!==a&&MathBox.Primitive.call(this,a)};
MathBox.Platonic.prototype=_.extend(new MathBox.Primitive(null),{defaults:function(){return{n:1,type:"cube",points:!1,line:!1,mesh:!0,doubleSided:!0,flipSided:!1,shaded:!0,style:{}}},type:function(){return"platonic"},renderables:function(){return[this.mesh,this.line,this.points]},adjust:function(a){a=this.get();this.mesh.show(a.mesh);this.line.show(a.line);this.points.show(a.points)},make:function(){var a=this.get(),b=this.style,c;switch(a.type){case "cube":c=new THREE.CubeGeometry(2,2,2,1,1,1)}this.mesh=
new MathBox.Renderable.Mesh(c,{type:"mesh",doubleSided:a.doubleSided,flipSided:a.flipSided,shaded:a.shaded,smooth:!1,dynamic:a.live},b);this.line=new MathBox.Renderable.Mesh(c,{type:"mesh",shaded:a.shaded,smooth:!1,dynamic:a.live,wireframe:!0},b);this.points=new MathBox.Renderable.Mesh(c.vertices,{type:"points",dynamic:a.live},b)}});MathBox.Primitive.types.platonic=MathBox.Platonic;
MathBox.Renderable=function(a,b){if(null!==a){this.id=++MathBox.Renderable.id;var c=this.defaults();a&&(a=_.extend(c,a||{}));this.set(a||c);this.geometry=this.material=this.object=null;this.visible=!0;this.style=b||new MathBox.Style;this.style.on("change",this.styleCallback=this.refreshStyle.bind(this));this.on("change",this.uniformsCallback=this.refreshOptions.bind(this));this.mathTransform=new THREE.Matrix4}};MathBox.Renderable.id=0;
MathBox.Renderable.prototype={defaults:function(){return{}},make:function(a){},destroy:function(){},show:function(a){a=void 0===a?!0:!!a;a!=this.visible&&(this.visible=a,this.refresh())},isVisible:function(){return this.object&&this.object.visible},composeTransform:function(a,b,c){var d=new THREE.Matrix4,e=new THREE.Matrix4;d.identity();b=new THREE.Euler(b.x,b.y,b.z,this.object.rotation.order);d.makeRotationFromEuler(b);e.makeScale(c.x,c.y,c.z);this.mathTransform.multiplyMatrices(d,e);c=this.mathTransform.elements;
c[12]=a.x;c[13]=a.y;c[14]=a.z},refreshStyle:function(a){var b=this.style.get();a=a||b;this.material&&this.material.applyUniforms(a);if(this.object){this.object.frustumCulled=!1;a.worldPosition&&(this.object.position=b.worldPosition);a.worldRotation&&(this.object.rotation=b.worldRotation);a.worldScale&&(this.object.scale=b.worldScale);if(a.mathPosition||a.mathRotation||a.mathScale)this.composeTransform(b.mathPosition,b.mathRotation,b.mathScale),this.material&&this.material.applyUniforms({mathTransform:this.mathTransform});
void 0!==a.opacity&&(this.object.visible=this.visible&&0<b.opacity);void 0===a.opacity&&void 0===a.zIndex||!this.material||(this.object.renderDepth=b.zIndex*(1==b.opacity?1:-1))}},refreshOptions:function(a){var b=this.get();a=a||b;if(this.material){b=this.get();if(void 0!==a.doubleSided||void 0!==a.flipSided)this.material.side=b.doubleSided?THREE.DoubleSide:b.flipSided?THREE.BackSide:THREE.FrontSide,b={flipSided:b.doubleSided&&b.flipSided?-1:1},this.material.applyUniforms(b);(b=this.get().uniforms)&&
this.material.applyUniforms(b);(b=this.get().attributes)&&this.material.applyAttributes(b)}},refresh:function(){this.refreshStyle();this.refreshOptions()},adjust:function(a){this.material&&this.material.applyUniforms(a.uniforms())}};MathBox.Attributes.mixin(MathBox.Renderable);MathBox.Renderable.Mesh=function(a,b,c){this.points=a;MathBox.Renderable.call(this,b,c)};
MathBox.Renderable.Mesh.prototype=_.extend(new MathBox.Renderable(null),{defaults:function(){return{type:"points",doubleSided:!0,dynamic:!1,absolute:!1,strip:!0,shaders:{}}},make:function(a){var b=this.get(),c=b.type,d=b.strip,e={points:THREE.PointCloud,line:THREE.Line,mesh:THREE.Mesh}[c];if(!e)throw"Invalid Mesh type '"+c+"'";a=this.material=a.generic(b);var f;f=this.points;f instanceof Array?(f=this.geometry=new THREE.Geometry,f.vertices=this.points):f=this.geometry=f;f.dynamic=b.dynamic;switch(c){case "line":b=
new THREE.Line(f,a,d?THREE.LineStrip:THREE.LinePieces);break;default:b=new e(f,a)}this.object=b;this.refresh()},adjust:function(a){this.get().dynamic&&(this.geometry.verticesNeedUpdate=!0);MathBox.Renderable.prototype.adjust.call(this,a)}});MathBox.Renderable.ArrowHead=function(a,b,c,d){this.from=a;this.to=b;MathBox.Renderable.call(this,c,d)};MathBox.Renderable.ArrowHead.geometry=new THREE.CylinderGeometry(.33,0,1,16,1);
MathBox.Renderable.ArrowHead.prototype=_.extend(new MathBox.Renderable(null),{defaults:function(){return{offset:0,absolute:!0,size:.1}},make:function(a){var b=this.get();a=this.material=a.generic(b);this._from=new THREE.Vector3;this._to=new THREE.Vector3;this.diff=new THREE.Vector3;this.bi=new THREE.Vector3;this.normal=new THREE.Vector3(0,0,1);b=this.geometry=MathBox.Renderable.ArrowHead.geometry;this.object=new THREE.Mesh(b,a);this.refresh()},isVisible:function(){return this.visible&&0<this.style.get("opacity")},
adjust:function(a){var b=this.get(),c=b.offset,d=this._from.copy(this.from),e=this._to.copy(this.to);d.applyProjection(this.mathTransform);e.applyProjection(this.mathTransform);a.to(d);a.to(e);d=this.diff.subVectors(d,e);if(.001>d.length())this.object.visible=!1;else{this.object.visible=this.visible;d=d.normalize();this.normal.x=this.diff.y+.1;this.normal.y=this.diff.z+.2;this.normal.z=this.diff.x+.3;this.normal.normalize();var f=this.bi.crossVectors(this.normal,this.diff).normalize(),g=this.normal.crossVectors(this.bi,
this.diff),b=b.size,h=new THREE.Matrix4;if(0===h.determinant())throw Error("Matrix is singular!!!");h.set(f.x,d.x,g.x,e.x,f.y,d.y,g.y,e.y,f.z,d.z,g.z,e.z,0,0,0,1);if(0===h.determinant())throw Error("Matrix is singular!!!");h.scale(new THREE.Vector3(b,b,b));if(0===h.determinant())throw Error("Matrix is singular!!!");this.object.updateMatrix();if(0===this.object.matrix.determinant())throw Error("Matrix is singular!!!");this.object.matrix.multiply(h);if(0===this.object.matrix.determinant())throw Error("Matrix is singular!!!");
h.identity().setPosition({x:0,y:.5-c,z:0});if(0===h.determinant())throw Error("Matrix is singular!!!");this.object.matrix.multiply(h);if(0===this.object.matrix.determinant())throw Error("Matrix is singular!!!");this.object.matrixAutoUpdate=!1;this.object.matrixWorldNeedsUpdate=!0;MathBox.Renderable.prototype.adjust.call(this,a)}}});MathBox.Renderable.Ticks=function(a,b,c,d,e){this.points=a;this.signs=b;this.epsilon=c;MathBox.Renderable.call(this,d,e)};
MathBox.Renderable.Ticks.prototype=_.extend(new MathBox.Renderable(null),{defaults:function(){return{dynamic:!1,absolute:!1,size:.1}},make:function(a){var b=this.get(),c=this.points;a=this.material=a.generic({type:"line",shaders:{position:function(a,c){c.position(a,b);a.snippet("tickVertexSplit");a.group();c.viewport(a);a.next();c.viewport(a);a.combine();a.snippet("tickVertexJoin")}}});var d=this.geometry=new THREE.Geometry;d.vertices=c;this.object=new THREE.Line(d,a,THREE.LinePieces);this.refresh()},
adjust:function(a){var b=this.get();this.material&&this.material.applyAttributes({tickSign:this.signs});this.material&&this.material.applyUniforms({tickEpsilon:this.epsilon,tickSize:b.size});b.dynamic&&(this.material.attributes.tickSign.needsUpdate=!0,this.geometry.verticesNeedUpdate=!0);MathBox.Renderable.prototype.adjust.call(this,a)}});MathBox.Renderable.Labels=function(a,b,c,d,e){this.points=a;this.tangent=b;this.callback=c;this.sprites=[];MathBox.Renderable.call(this,d,e)};
MathBox.Renderable.Labels.prototype=_.extend(new MathBox.Renderable(null),{defaults:function(){return{absolute:!0,distance:15,size:1}},make:function(a){this.get();var b=this.tangent,c=this.sprites;a=this.points.length;this._anchor=new THREE.Vector3;var d=document.createElement("div"),e=this.object=new MathBox.Sprite(d);d.className="mathbox-labels";MathBox.loop(a,function(a){a=document.createElement("div");var d=document.createElement("div");a.appendChild(d);var h=new MathBox.Sprite(a,b);a.className=
"mathbox-label";d.className="mathbox-wrap";d.style.position="relative";d.style.display="inline-block";d.style.left="-50%";d.style.top="-.5em";c.push(h);e.add(h)})},adjust:function(a,b,c,d,e){var f=this.get(),g=this.points;b=this.sprites;var h=this.callback,k=f.decimals,l=this.style.get("opacity"),m=window.MathJax&&MathJax.Hub,v=1/Math.log(10);_.each(b,function(b,c){b.position.copy(g[c]);a.to(b.position);b.position.applyProjection(e.matrix);b.distance=f.distance;b.opacity=l;var d="";if(h){d=h(c);void 0===
d&&(d="");if(+d==d){var w=+d;if(0!=w)var d=0>w?-1:1,w=Math.abs(w),z=Math.pow(10,k-1-Math.floor(Math.log(w)*v)),d=w=d*Math.round(z*w)/z}m||(d=(""+d).replace(/^-/,"\u2013"))}b.content!==d&&(w=b.element.children[0],b.content=d,b.measure=!0,m?(w.innerHTML="\\("+d+"\\)",MathJax.Hub.queue.Push(["Typeset",MathJax.Hub,w])):w.innerHTML=d)});MathBox.Renderable.prototype.adjust.call(this,a)}});
MathBox.Viewport=function(a){if(null!==a){var b=this.defaults();a=_.extend(b,a||{});this.set(a);this.singleton="viewport";this._uniforms={}}};
MathBox.Viewport.prototype={defaults:function(){return{type:"none",rotation:[0,0,0],position:[0,0,0]}},uniforms:function(){return this._uniforms},axis:function(a){return[0,1]},to:function(a){},from:function(a){},update:function(a){var b=this.get();_.each(["position","rotation"],function(c){a[c].set.apply(a[c],b[c])})},shader:function(a){a.snippet("mathToWorld")},validateRotation:function(a){return a.constructor===Array?(a=a.concat([0,0,0]),a.slice(0,3)):this.get("rotation")},validatePosition:function(a){return a.constructor===
Array?(a=a.concat([0,0,0]),a.slice(0,3)):this.get("position")}};MathBox.Attributes.mixin(MathBox.Viewport,"type");MathBox.Viewport.types={};MathBox.Viewport.make=function(a){return new (MathBox.Viewport.types[a.type]||MathBox.Viewport.types.cartesian||MathBox.Viewport)(a)};
MathBox.ViewportCartesian=function(a){if(null!==a){var b=MathBox.Viewport;b.call(this,a);this.super=b.prototype;this.transform=new THREE.Matrix4;this.inverse=new THREE.Matrix4;_.extend(this._uniforms,{viewportTransform:this.transform,viewportInverse:this.inverse})}};
MathBox.ViewportCartesian.prototype=_.extend(new MathBox.Viewport(null),{defaults:function(){return{type:"cartesian",range:[[-1,1],[-1,1],[-1,1]],scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]}},to:function(a){a.applyProjection(this.transform)},from:function(a){a.applyProjection(this.inverse)},axis:function(a){var b=this.get().range[a];a=b[0];var c=b[1],b=Math.min(a,c);a=Math.max(a,c);return[b,a]},update:function(a){var b=this.get(),c=b.range,d=b.scale,b=c[0][0],e=c[1][0],f=c[2][0],g=c[0][1]-b,h=
c[1][1]-e,c=c[2][1]-f,k=d[0],l=d[1],d=d[2],m=[g/(2*k),0,0,b+g/2,0,h/(2*l),0,e+h/2,0,0,c/(2*d),f+c/2,0,0,0,1];this.transform.set.apply(this.transform,[2*k/g,0,0,-(2*b+g)*k/g,0,2*l/h,0,-(2*e+h)*l/h,0,0,2*d/c,-(2*f+c)*d/c,0,0,0,1]);this.inverse.set.apply(this.inverse,m);MathBox.Viewport.prototype.update.call(this,a)},validateRange:function(a){a=a||[];for(var b=0;3>b;++b){a[b]=a[b]||[];for(var c=0;2>c;++c)a[b][c]=void 0!==a[b][c]?a[b][c]:2*c-1}return a},validateScale:function(a){a=a||[];for(var b=0;3>
b;++b)a[b]=a[b]||1;return a}});MathBox.Attributes.mixin(MathBox.Viewport);MathBox.Viewport.types.cartesian=MathBox.ViewportCartesian;MathBox.ViewportPolar=function(a){var b=MathBox.ViewportCartesian;b.call(this,a);this.super=b.prototype;_.extend(this._uniforms,{polarAlpha:0,polarAspect:1,polarPower:1,polarFold:1,polarFocus:1,polarHelix:0})};
MathBox.ViewportPolar.prototype=_.extend(new MathBox.ViewportCartesian(null),{defaults:function(){return{type:"polar",range:[[-1,1],[-1,1],[-1,1]],polar:1,fold:1,power:1,helix:0,scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]}},to:function(a){var b=this._uniforms.polarAspect,c=this._uniforms.polarFocus,d=this._uniforms.polarAlpha,e=this._uniforms.polarPower,f=this._uniforms.polarHelix;a.x*=this._uniforms.polarFold;a.y=MathBox.signum(a.y)*Math.pow(Math.abs(a.y),e);if(1E-4<d){var e=c+a.y*b,g=a.x*d;
a.z+=a.x*f*d;a.x=Math.sin(g)*e;a.y=(Math.cos(g)*e-c)/b}a.applyProjection(this.transform)},from:function(a){var b=this._uniforms.polarAspect,c=this._uniforms.polarFocus,d=this._uniforms.polarAlpha,e=this._uniforms.polarFold,f=this._uniforms.polarPower,g=this._uniforms.polarHelix;a.applyProjection(this.inverse);if(1E-4<d){var h=a.x,k=a.y*b+c,l=Math.sqrt(h*h+k*k);theta=Math.atan2(h,k);a.x=theta/d;a.y=(l-c)/b;a.z-=a.x*g*d}a.x/=e;a.y=MathBox.signum(a.y)*Math.pow(Math.abs(a.y),1/f)},axis:function(a){var b=
this.super.axis.call(this,a);min=b[0];max=b[1];alpha=this._uniforms.polarAlpha;aspect=this._uniforms.polarAspect;focus=this._uniforms.polarFocus;1==a&&0<alpha&&(max=Math.max(Math.abs(max),Math.abs(min)),min=Math.max(-focus/aspect+.001,min));return[min,max]},update:function(a){var b=this.get(),c=b.range,d=b.scale,e=b.polar,f=b.fold,g=b.power,b=b.helix,h=1,k=c[0][0],l=c[1][0],m=c[2][0],v=c[0][1]-k,q=c[1][1]-l,c=c[2][1]-m,y=d[0],x=d[1],d=d[2],h=0<v?1:-1,w=Math.abs(q),w=v+(w*h-v)*e,h=Math.abs(w/y/(q/
x)),z=[w/(2*y),0,0,k+v/2,0,q/(2*x),0,l+q/2,0,0,c/(2*d),m+c/2,0,0,0,1];this.transform.set.apply(this.transform,[2*y/w,0,0,-(2*k+v)*y/v,0,2*x/q,0,-(2*l+q)*x/q,0,0,2*d/c,-(2*m+c)*d/c,0,0,0,1]);this.inverse.set.apply(this.inverse,z);this._uniforms.polarAlpha=e;this._uniforms.polarAspect=h;this._uniforms.polarFold=f;this._uniforms.polarPower=g;this._uniforms.polarFocus=0<e?1/e-1:0;this._uniforms.polarHelix=b;MathBox.Viewport.prototype.update.call(this,a)},shader:function(a){a.snippet("polarPower").snippet("cartesianToPolar").snippet("mathToWorld")},
validatePolar:function(a){return Math.max(0,Math.min(1,+a||0))},validateFold:function(a){return+a||0},validatePower:function(a){return+a||0},validateHelix:function(a){return+a||0}});MathBox.Attributes.mixin(MathBox.Viewport);MathBox.Viewport.types.polar=MathBox.ViewportPolar;MathBox.ViewportProjective=function(a){var b=MathBox.ViewportCartesian;b.call(this,a);this.super=b.prototype;_.extend(this._uniforms,{projectiveTransform:new THREE.Matrix4,projectiveInverse:new THREE.Matrix4})};
MathBox.ViewportProjective.prototype=_.extend(new MathBox.ViewportCartesian(null),{defaults:function(){return{type:"projective",range:[[-1,1],[-1,1],[-1,1]],scale:[1,1,1],rotation:[0,0,0],position:[0,0,0],projective:[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]}},to:function(a){a.applyProjection(this._uniforms.projectiveTransform);a.applyProjection(this.transform)},from:function(a){a.applyProjection(this.inverse);a.applyProjection(this._uniforms.projectiveInverse)},update:function(a){var b=this._uniforms.projectiveTransform,
c=this.get("projective");b.set.apply(b,c[0].concat(c[1],c[2],c[3]));this._uniforms.projectiveInverse.getInverse(b,!0);MathBox.ViewportCartesian.prototype.update.call(this,a)},shader:function(a){a.snippet("projectiveTransform").snippet("mathToWorld")},validateProjective:function(a){if(a.constructor==Array){for(var b=0;3>b;++b)a[b]=a[b]&&a.constructor==Array&&a[b]||[],a[b]=a[b].concat([0,0,0,0]).slice(0,4);return a}}});MathBox.Attributes.mixin(MathBox.Viewport);MathBox.Viewport.types.projective=MathBox.ViewportProjective;
MathBox.ViewportSphere=function(a){var b=MathBox.ViewportCartesian;b.call(this,a);this.super=b.prototype;_.extend(this._uniforms,{sphereAlpha:0,sphereAspectX:1,sphereAspectY:1,sphereYScale:1,sphereFocus:1})};
MathBox.ViewportSphere.prototype=_.extend(new MathBox.ViewportCartesian(null),{defaults:function(){return{type:"sphere",range:[[-1,1],[-1,1],[-1,1]],sphere:1,scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]}},to:function(a){var b=this._uniforms.sphereAspectX,c=this._uniforms.sphereAspectY,d=this._uniforms.sphereYScale,e=this._uniforms.sphereFocus,f=this._uniforms.sphereAlpha;if(1E-4<f){var g=e+a.z*b,h=a.x*f,d=a.y*f/c*d,f=Math.cos(d)*g;a.x=Math.sin(h)*f;a.y=Math.sin(d)*g*c;a.z=(Math.cos(h)*f-e)/b}a.applyProjection(this.transform)},
from:function(a){var b=this._uniforms.sphereAspectX,c=this._uniforms.sphereAspectY,d=this._uniforms.sphereYScale,e=this._uniforms.sphereFocus,f=this._uniforms.sphereAlpha;a.applyProjection(this.inverse);if(1E-4<f){var g=a.x,h=a.y/c,k=a.z*b+e,l=Math.sqrt(g*g+h*h+k*k),h=Math.atan2(h,Math.sqrt(g*g+k*k)),g=Math.atan2(g,k);a.x=g/f;a.y=h/f*c/d;a.z=(l-e)/b}},axis:function(a){var b=this.super.axis.call(this,a);min=b[0];max=b[1];alpha=this._uniforms.sphereAlpha;beta=this._uniforms.sphereBeta;aspectX=this._uniforms.sphereAspectX;
aspectY=this._uniforms.sphereAspectY;focus=this._uniforms.sphereFocus;2==a&&0<alpha&&(max=Math.max(Math.abs(max),Math.abs(min)),min=Math.max(-focus/aspectX,min));return[min,max]},update:function(a){var b=this.get(),c=b.range,d=b.scale,b=b.sphere,e=0<b?1/b-1:0,f=c[0][0],g=c[1][0],h=c[2][0],k=c[0][1]-f,l=c[1][1]-g,c=c[2][1]-h,m=d[0],v=d[1],d=d[2],q=0<k?1:-1,y=0<l?1:-1,x=Math.abs(c),q=k+(x*q-k)*b,y=l+(x*y-l)*b,x=c/d;aspectX=q/m/x;aspectY=y/v/x/aspectX;aspectZ=l/k*m/v*2;yScale=Math.min(aspectY/b,1+(aspectZ-
1)*b);x=[q/(2*m),0,0,f+k/2,0,y/(2*v),0,g+l/2,0,0,c/(2*d),h+c/2,0,0,0,1];this.transform.set.apply(this.transform,[2*m/q,0,0,-(2*f+k)*m/k,0,2*v/y,0,-(2*g+l)*v/l,0,0,2*d/c,-(2*h+c)*d/c,0,0,0,1]);this.inverse.set.apply(this.inverse,x);this._uniforms.sphereAlpha=b;this._uniforms.sphereAspectX=aspectX;this._uniforms.sphereAspectY=aspectY;this._uniforms.sphereYScale=yScale;this._uniforms.sphereFocus=e;MathBox.Viewport.prototype.update.call(this,a)},shader:function(a){a.snippet("cartesianToSphere").snippet("mathToWorld")},
validateSphere:function(a){return Math.max(0,Math.min(1,+a||0))}});MathBox.Attributes.mixin(MathBox.Viewport);MathBox.Viewport.types.sphere=MathBox.ViewportSphere;
